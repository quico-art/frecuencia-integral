<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frecuencia Integral Academy</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&amp;family=DM+Sans:wght@300;400;500;600&amp;display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:#f7f5f1;color:#1c1814}

/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(247,245,241,.95);backdrop-filter:blur(12px);border-bottom:1px solid #e4ddd3;height:66px;display:flex;align-items:center;padding:0 32px;justify-content:space-between}
.nav-logo{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:400}
.nav-logo span{font-size:11px;display:block;color:#7a7168;letter-spacing:.1em;text-transform:uppercase}
.nav-links{display:flex;gap:28px}
.nav-links a{font-size:13px;color:#3d3730;text-decoration:none;cursor:pointer}
.nav-links a:hover{color:#2b7d7a}
.nav-btns{display:flex;gap:10px;align-items:center}
.btn-ghost{background:none;border:1px solid #d1c8bc;padding:8px 18px;border-radius:8px;font-size:13px;cursor:pointer;color:#3d3730;font-family:'DM Sans',sans-serif}
.btn-ghost:hover{background:#f0ece4}
.btn-primary{background:#2b7d7a;color:white;border:none;padding:9px 20px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif}
.btn-primary:hover{background:#3d9e9b}

/* PAGES */
.page{display:none}
.page.active{display:block}
/* Wix-style page push when sidebar opens */
nav, .page.active {
  transition: margin-left .25s cubic-bezier(.4,0,.2,1), left .25s cubic-bezier(.4,0,.2,1);
}
nav.sb-pushed { left: 56px !important; right: 0 !important; }
nav.sb-pushed-wide { left: 316px !important; right: 0 !important; }
.page.active.sb-pushed { margin-left: 56px; }
.page.active.sb-pushed-wide { margin-left: 316px; }

/* PUBLIC PAGE */
.hero{min-height:100vh;display:flex;align-items:center;justify-content:center;text-align:center;padding:100px 32px 60px;background:linear-gradient(135deg,#f7f5f1 0%,#f0ece4 100%)}
.hero h1{font-family:'Cormorant Garamond',serif;font-size:clamp(42px,6vw,80px);font-weight:300;line-height:1.1;margin-bottom:24px}
.hero h1 em{font-style:italic;color:#2b7d7a}
.hero p{font-size:16px;color:#7a7168;max-width:560px;margin:0 auto 36px;line-height:1.7}
.hero-btns{display:flex;gap:14px;justify-content:center;flex-wrap:wrap}
.btn-hero{padding:14px 32px;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif}
.btn-hero-main{background:#2b7d7a;color:white;border:none}
.btn-hero-main:hover{background:#3d9e9b}
.btn-hero-sec{background:none;border:2px solid #2b7d7a;color:#2b7d7a}
.btn-hero-sec:hover{background:#e8f4f3}

.section{padding:80px 32px;max-width:1100px;margin:0 auto}
.s-tag{font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.15em;margin-bottom:12px}
.s-title{font-family:'Cormorant Garamond',serif;font-size:clamp(32px,4vw,52px);font-weight:300;margin-bottom:16px}
.s-sub{font-size:15px;color:#7a7168;line-height:1.7;max-width:900px}

.puertas-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;margin-top:48px}
.puerta-card{background:white;border-radius:16px;overflow:hidden;border:1px solid #e4ddd3;transition:transform .2s,box-shadow .2s}
.puerta-card:hover{transform:translateY(-4px);box-shadow:0 12px 40px rgba(0,0,0,.08)}
.pc-head{padding:28px 24px 20px;color:white}
.pc-blanca{background:linear-gradient(135deg,#b8ad9e,#8a8078)}
.pc-roja{background:linear-gradient(135deg,#bf4637,#8b2d22)}
.pc-azul{background:linear-gradient(135deg,#2c5f9e,#1a3d6e)}
.pc-arcoiris{background:linear-gradient(135deg,#b8935a,#8a6a35)}
.pc-icon{font-size:28px;margin-bottom:10px}
.pc-name{font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:300;margin-bottom:4px}
.pc-weeks{font-size:11px;opacity:.75}
.pc-body{padding:20px 24px}
.pc-price{font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:4px}
.pc-billing{font-size:12px;color:#7a7168;margin-bottom:16px}
.btn-puerta{width:100%;padding:11px;border-radius:8px;border:none;font-size:13px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;background:#2b7d7a;color:white;transition:background .2s}
.btn-puerta:hover{background:#3d9e9b}

/* AUTH PAGE */
.auth-wrap{min-height:100vh;display:grid;grid-template-columns:1fr 1fr;padding-top:66px}
.auth-left{background:linear-gradient(145deg,#1c1814,#2a241e);padding:60px 48px;display:flex;flex-direction:column;justify-content:center}
.auth-left h2{font-family:'Cormorant Garamond',serif;font-size:42px;font-weight:300;color:white;line-height:1.2;margin-bottom:16px}
.auth-left h2 em{color:#3d9e9b;font-style:italic}
.auth-left p{font-size:14px;color:rgba(255,255,255,.55);line-height:1.7;margin-bottom:32px}
.auth-perks{list-style:none}
.auth-perks li{font-size:13px;color:rgba(255,255,255,.65);padding:6px 0;display:flex;align-items:center;gap:10px}
.auth-perks li::before{content:'‚ú¶';color:#b89558;font-size:9px}
.auth-right{background:#f7f5f1;display:flex;align-items:center;justify-content:center;padding:48px}
.auth-box{width:100%;max-width:400px;background:white;border-radius:20px;padding:40px;border:1px solid #e4ddd3;box-shadow:0 4px 24px rgba(0,0,0,.06)}
.auth-box h3{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:400;margin-bottom:6px}
.auth-box .sub{font-size:13px;color:#7a7168;margin-bottom:28px}
.auth-tabs{display:flex;border-radius:8px;overflow:hidden;border:1.5px solid #e4ddd3;margin-bottom:24px}
.auth-tab{flex:1;padding:10px;background:none;border:none;font-size:13px;font-weight:500;color:#7a7168;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all .2s}
.auth-tab.active{background:#2b7d7a;color:white}
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px}
.form-group input{width:100%;padding:11px 14px;border:1.5px solid #e4ddd3;border-radius:8px;font-size:14px;font-family:'DM Sans',sans-serif;background:#faf8f5;transition:border-color .2s;outline:none}
.form-group input:focus{border-color:#2b7d7a;background:white}
.btn-login{width:100%;padding:13px;background:#2b7d7a;color:white;border:none;border-radius:9px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;transition:background .2s;margin-top:8px}
.btn-login:hover{background:#3d9e9b}
.btn-login:disabled{background:#a89e93;cursor:not-allowed}
.demo-hint{margin-top:14px;padding:12px;background:#f0ece4;border-radius:8px;font-size:12px;color:#7a7168;text-align:center}
.back-link{display:block;text-align:center;margin-top:16px;font-size:12px;color:#7a7168;cursor:pointer;text-decoration:underline}

/* STUDENT AREA */
.student-wrap{display:flex;min-height:100vh;padding-top:66px}
.sidebar{width:260px;background:#1c1814;position:fixed;top:66px;left:0;bottom:0;overflow-y:auto;padding:24px 0}
.sidebar-user{padding:20px 24px;border-bottom:1px solid rgba(255,255,255,.08);margin-bottom:8px}
.sidebar-name{font-size:15px;font-weight:600;color:white;margin-bottom:4px}
.sidebar-email{font-size:11px;color:rgba(255,255,255,.4)}
.sidebar-badge{display:inline-block;margin-top:8px;background:#b89558;color:white;font-size:10px;font-weight:700;padding:3px 10px;border-radius:100px;text-transform:uppercase;letter-spacing:.06em}
.sidebar-nav{padding:8px 12px}
.nav-item{display:flex;align-items:center;gap:12px;padding:11px 14px;border-radius:9px;font-size:13px;color:rgba(255,255,255,.6);cursor:pointer;transition:all .2s;border:none;background:none;width:100%;text-align:left;font-family:'DM Sans',sans-serif}
.nav-item:hover{background:rgba(255,255,255,.07);color:white}
.nav-item.active{background:rgba(43,125,122,.2);color:#3d9e9b}
.nav-item-icon{font-size:16px;width:20px;text-align:center}
.main-content{margin-left:260px;flex:1;padding:36px;min-height:calc(100vh - 66px)}

.dashboard-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:32px}
.stat-card{background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3}
.stat-label{font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:8px}
.stat-value{font-family:'Cormorant Garamond',serif;font-size:36px;font-weight:300;color:#1c1814}
.stat-sub{font-size:12px;color:#a89e93;margin-top:4px}

.weeks-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-top:24px}
.week-card{background:white;border-radius:12px;padding:16px;border:1px solid #e4ddd3;cursor:pointer;transition:all .2s}
.week-card:hover{border-color:#2b7d7a;box-shadow:0 4px 16px rgba(43,125,122,.1)}
.week-card.completed{background:#e8f4f3;border-color:#7fbfbd}
.week-card.in-progress{border-color:#b89558;background:#fdf6ec}
.week-num{font-size:10px;font-weight:700;color:#a89e93;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px}
.week-title{font-size:12px;font-weight:500;color:#1c1814;line-height:1.4}
.week-status{font-size:11px;margin-top:8px}

/* MODAL */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(28,24,20,.7);backdrop-filter:blur(6px);z-index:400;align-items:center;justify-content:center;padding:0}
.modal-overlay.open{display:flex}
.modal{background:white;width:100%;height:100vh;max-width:100%;overflow:hidden;display:flex;flex-direction:column}
.modal-header{padding:20px 40px;border-bottom:1px solid #e4ddd3;display:flex;align-items:center;justify-content:space-between;background:white;flex-shrink:0}
.modal-header-left{display:flex;align-items:center;gap:20px}
.modal-week-badge{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.modal-title{font-family:'Cormorant Garamond',serif;font-size:26px;font-weight:400;line-height:1.2}
.modal-puerta-tag{font-size:11px;color:#7a7168;margin-top:3px;letter-spacing:.04em}
.modal-close{background:#f7f5f1;border:none;width:36px;height:36px;border-radius:50%;font-size:16px;cursor:pointer;color:#7a7168;display:flex;align-items:center;justify-content:center;transition:background .2s;flex-shrink:0}
.modal-close:hover{background:#e4ddd3;color:#1c1814}
.modal-layout{display:flex;flex:1;overflow:hidden}
.modal-sidebar{width:200px;background:#1c1814;flex-shrink:0;padding:24px 0;display:flex;flex-direction:column;gap:4px}
.modal-nav-btn{display:flex;align-items:center;gap:10px;padding:12px 20px;background:none;border:none;font-size:13px;color:rgba(255,255,255,.55);cursor:pointer;font-family:'DM Sans',sans-serif;text-align:left;width:100%;transition:all .2s;border-left:3px solid transparent}
.modal-nav-btn:hover{background:rgba(255,255,255,.07);color:white}
.modal-nav-btn.active{background:rgba(43,125,122,.2);color:#3d9e9b;border-left-color:#3d9e9b}
.modal-nav-icon{font-size:16px;width:20px;text-align:center}
.modal-body{padding:40px 48px;overflow-y:auto;flex:1;background:#f7f5f1}
.modal-tabs{display:none}
.tab-content{display:none}
.tab-content.active{display:block}
.exercise-step{display:flex;gap:14px;padding:16px;background:white;border-radius:12px;margin-bottom:12px;align-items:flex-start;border:1px solid #e4ddd3}
.step-num{min-width:32px;height:32px;background:#2b7d7a;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:white;flex-shrink:0}
.step-text{font-size:14px;line-height:1.75;color:#3d3730;padding-top:4px}
.concept-card{background:white;border-radius:12px;padding:18px 20px;margin-bottom:12px;border-left:4px solid #2b7d7a;border:1px solid #e4ddd3;border-left:4px solid #2b7d7a}
.concept-name{font-weight:600;font-size:14px;margin-bottom:6px;color:#1c1814}
.concept-desc{font-size:13px;color:#7a7168;line-height:1.7}
.material-item{display:flex;align-items:center;gap:12px;padding:12px 14px;background:white;border-radius:10px;margin-bottom:8px;border:1px solid #e4ddd3}
.material-icon{font-size:18px}
.material-name{flex:1;font-size:13px;color:#3d3730}
.btn-sm{font-size:11px;font-weight:600;color:#2b7d7a;background:#e8f4f3;border:none;padding:5px 12px;border-radius:6px;cursor:pointer}
.task-item{display:flex;align-items:center;gap:12px;padding:14px 16px;background:white;border-radius:10px;margin-bottom:8px;cursor:pointer;transition:background .2s;border:1px solid #e4ddd3}
.task-item:hover{background:#e8f4f3;border-color:#7fbfbd}
.task-item.done{background:#e8f4f3;border-color:#7fbfbd}
.task-item.done .task-cb{background:#2b7d7a;border-color:#2b7d7a}
.task-item.done .task-cb::after{content:'‚úì';color:white;font-size:10px;font-weight:700}
.task-cb{width:20px;height:20px;border-radius:5px;border:2px solid #d1c8bc;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .2s}
.task-text{font-size:14px;color:#3d3730;line-height:1.5}
.btn-complete{width:100%;padding:16px;background:#2b7d7a;color:white;border:none;border-radius:12px;font-size:15px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;margin-top:24px;transition:background .2s}
.btn-complete:hover{background:#3d9e9b}
.btn-complete:disabled{background:#d1c8bc;cursor:not-allowed}

/* TOAST */
.toast{position:fixed;bottom:24px;right:24px;z-index:999;background:#1c1814;color:white;padding:12px 20px;border-radius:10px;font-size:13px;opacity:0;transition:opacity .3s;pointer-events:none}
.toast.show{opacity:1}


/* FILTER */
.filter-bar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:24px}
.filter-btn{padding:7px 16px;border-radius:100px;border:1.5px solid #d1c8bc;background:none;font-size:12px;font-weight:600;cursor:pointer;color:#7a7168;font-family:'DM Sans',sans-serif;transition:all .2s}
.filter-btn.active{background:#2b7d7a;border-color:#2b7d7a;color:white}

/* ADMIN PANEL */
.admin-wrap{min-height:100vh;padding-top:66px;background:#f7f5f1}
.admin-header{background:#1c1814;padding:32px 40px;display:flex;align-items:center;justify-content:space-between}
.admin-header h1{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:300;color:white}
.admin-header h1 span{color:#3d9e9b;font-style:italic}
.admin-body{padding:32px 40px;max-width:1300px;margin:0 auto}
.admin-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:32px}
.admin-stat{background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3;text-align:center}
.admin-stat-val{font-family:'Cormorant Garamond',serif;font-size:40px;font-weight:300;color:#1c1814}
.admin-stat-label{font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-top:4px}
.admin-table-wrap{background:white;border-radius:16px;border:1px solid #e4ddd3;overflow:hidden}
.admin-table-header{padding:20px 24px;border-bottom:1px solid #e4ddd3;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px}
.admin-table-title{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:400}
.admin-search{padding:8px 14px;border:1.5px solid #e4ddd3;border-radius:8px;font-size:13px;font-family:'DM Sans',sans-serif;outline:none;width:220px}
.admin-search:focus{border-color:#2b7d7a}
.admin-table{width:100%;border-collapse:collapse}
.admin-table th{font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;padding:12px 16px;text-align:left;background:#faf8f5;border-bottom:1px solid #e4ddd3}
.admin-table td{padding:14px 16px;font-size:13px;color:#3d3730;border-bottom:1px solid #f0ece4;vertical-align:middle}
.admin-table tr:last-child td{border-bottom:none}
.admin-table tr:hover td{background:#faf8f5}
.admin-badge{display:inline-block;padding:3px 10px;border-radius:100px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.06em}
.badge-blanca{background:#f0ede8;color:#8a8078}
.badge-roja{background:#fdecea;color:#bf4637}
.badge-azul{background:#e8eef8;color:#2c5f9e}
.badge-arcoiris{background:#f3edf8;color:#7b4fa6}
.badge-oro{background:#fdf5e6;color:#b89558}
.admin-progress-bar{height:6px;background:#e4ddd3;border-radius:3px;width:100px;overflow:hidden}
.admin-progress-fill{height:100%;background:#2b7d7a;border-radius:3px;transition:width .3s}
.admin-empty{text-align:center;padding:60px;color:#a89e93;font-size:14px}
.btn-admin-nav{background:#b89558;color:white;border:none;padding:9px 18px;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;letter-spacing:.04em}
.btn-admin-nav:hover{background:#c9a86c}
.admin-refresh{background:#e8f4f3;color:#2b7d7a;border:none;padding:8px 16px;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif}
.admin-refresh:hover{background:#d0eae9}

/* PDF FULLSCREEN MODAL */
.pdf-modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:9000;flex-direction:column}
.pdf-modal-overlay.open{display:flex}
.pdf-modal-topbar{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;background:#1c1814;flex-shrink:0}
.pdf-modal-topbar-name{font-size:13px;font-weight:600;color:white;max-width:70%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pdf-modal-topbar-actions{display:flex;gap:10px;align-items:center}
.btn-pdf-fullscreen-dl{background:#2b7d7a;color:white;border:none;padding:8px 16px;border-radius:7px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;text-decoration:none}
.btn-pdf-fullscreen-close{background:rgba(255,255,255,.1);color:white;border:none;padding:8px 14px;border-radius:7px;font-size:13px;cursor:pointer;font-family:'DM Sans',sans-serif}
.pdf-modal-topbar .btn-pdf-fullscreen-close:hover{background:rgba(255,255,255,.2)}
.pdf-modal-frame{flex:1;width:100%;border:none;background:#525659}

/* MATERIALES PDF */
.materiales-puerta{margin-bottom:36px}
.materiales-puerta-title{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:400;margin-bottom:16px;display:flex;align-items:center;gap:10px;padding-bottom:10px;border-bottom:1px solid #e4ddd3}
.pdf-card{background:white;border-radius:14px;border:1px solid #e4ddd3;overflow:hidden;margin-bottom:14px;transition:box-shadow .2s}
.pdf-card:hover{box-shadow:0 4px 20px rgba(0,0,0,.07)}
.pdf-card-header{display:flex;align-items:center;gap:14px;padding:16px 20px;cursor:pointer}
.pdf-icon{width:40px;height:48px;background:linear-gradient(135deg,#e8f4f3,#d0eae9);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.pdf-info{flex:1}
.pdf-name{font-size:14px;font-weight:500;color:#1c1814;margin-bottom:3px}
.pdf-meta{font-size:11px;color:#a89e93}
.pdf-actions{display:flex;gap:8px;align-items:center}
.btn-pdf-view{background:#e8f4f3;color:#2b7d7a;border:none;padding:7px 14px;border-radius:7px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;transition:background .2s}
.btn-pdf-view:hover{background:#d0eae9}
.btn-pdf-dl{background:#f7f5f1;color:#3d3730;border:1px solid #d1c8bc;padding:7px 14px;border-radius:7px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;text-decoration:none;transition:background .2s}
.btn-pdf-dl:hover{background:#f0ece4}
.pdf-viewer-wrap{display:none;border-top:1px solid #e4ddd3;background:#f7f5f1}
.pdf-viewer-wrap.open{display:block}
.pdf-viewer-wrap iframe{width:100%;height:520px;border:none;display:block}
.pdf-viewer-bar{display:flex;align-items:center;justify-content:space-between;padding:10px 20px;background:#1c1814}
.pdf-viewer-bar span{font-size:12px;color:rgba(255,255,255,.6)}
.btn-pdf-close{background:none;border:none;color:rgba(255,255,255,.6);font-size:18px;cursor:pointer;padding:0 4px}

@media(max-width:768px){
  .auth-wrap{grid-template-columns:1fr}
  .auth-left{display:none}
  .sidebar{display:none}
  .main-content{margin-left:0}
  .nav-links{display:none}
}
</style>
<style id="nmDynStyle">.nav-links a{color:#3d3730!important}.nav-links a:hover{color:#2b7d7a!important}</style></head>
<body class="" data-nm-state="{&quot;nav&quot;:[{&quot;id&quot;:&quot;nav17716996591321&quot;,&quot;label&quot;:&quot;El Viaje&quot;,&quot;linkType&quot;:&quot;anchor&quot;,&quot;anchor&quot;:&quot;&quot;,&quot;color&quot;:&quot;&quot;,&quot;style&quot;:&quot;normal&quot;,&quot;emoji&quot;:&quot;&quot;,&quot;newTab&quot;:false,&quot;children&quot;:[]},{&quot;id&quot;:&quot;nav17716996591322&quot;,&quot;label&quot;:&quot;Precios&quot;,&quot;linkType&quot;:&quot;anchor&quot;,&quot;anchor&quot;:&quot;#Estructura del Sistema TCT Las Cinco Puertas&quot;,&quot;color&quot;:&quot;&quot;,&quot;style&quot;:&quot;normal&quot;,&quot;emoji&quot;:&quot;&quot;,&quot;newTab&quot;:false,&quot;children&quot;:[],&quot;url&quot;:&quot;&quot;,&quot;pageSlug&quot;:&quot;&quot;}],&quot;pages&quot;:[],&quot;cats&quot;:[]}">

<!-- NAV -->
<nav style="background: rgba(247, 245, 241, 0.95); border-bottom-color: rgb(228, 221, 211); height: 66px; position: fixed;">
  <div class="nav-logo">Frecuencia Integral<span>Academy</span></div>
  <div class="nav-links"><a>El Viaje</a><a onclick="(function(){var el=document.getElementById(&quot;Estructura del Sistema TCT Las Cinco Puertas&quot;);if(el)el.scrollIntoView({behavior:&quot;smooth&quot;});else window.location.hash=&quot;#Estructura del Sistema TCT Las Cinco Puertas&quot;;})()" href="#">Precios</a></div>
  <div class="nav-btns">
    <button class="btn-ghost" id="btnLogin" onclick="goTo('auth')">Acceso Alumnos</button>
    <button class="btn-primary" id="btnInscribirse" onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})">Iniciarse Ahora</button>
    <button class="btn-ghost" id="btnDash" style="display:none" onclick="goTo('student')">Mi Dashboard</button>
    <button class="btn-admin-nav" id="btnAdmin" style="display:none" onclick="goTo('admin')">‚öô Admin</button>
    <button class="btn-ghost" id="btnLogout" style="display:none" onclick="doLogout()">Salir</button>
  </div>
</nav>

<!-- PAGE: PUBLIC -->
<div class="page active" id="page-public">

  <!-- HERO -->
  <div class="hero">
    <div>
      <div class="s-tag" style="">Sistema TCT ¬∑ 48 Semanas</div>
      <h1 style="">La Frecuencia que<br><em style="">Transforma</em> tu Realidad</h1>
      <p style="" class=""></p><p style="">Descubre el Sistema TCT, una integraci√≥n √∫nica de Dzogchen, Cuarto Camino y UCDM con tecnolog√≠a vibracional mediante cuencos tibetanos y la visi√≥n de los libros ¬´El ser consciente. M√°s all√° del resultado¬ª y ¬´El ser consciente. M√°s all√° de la acci√≥n: vivir con presencia en la vida cotidiana¬ª , que te acompa√±ar√°n en tu proceso de transformaci√≥n del cuerpo, la energ√≠a y la mente.</p><p></p>
      <div class="hero-btns" style="">
        <button class="btn-hero btn-hero-main" onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})">Explorar las Puertas ‚Üí</button>
        <button class="btn-hero btn-hero-sec" onclick="goTo('auth')">Acceso Alumnos</button>
      </div>
    </div>
  </div>

  <!-- BANDA VISUAL -->
  <div style="display:grid;grid-template-columns:1fr 1fr 1fr;height:340px;overflow:hidden">
    <div style="overflow:hidden;position:relative">
      <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=700&q=80" alt="Monta√±a" style="width:100%;height:100%;object-fit:cover;filter:brightness(0.88) saturate(1.1)">
      <div style="position:absolute;bottom:20px;left:20px;color:white;font-family:'Cormorant Garamond',serif;font-size:18px;text-shadow:0 2px 8px rgba(0,0,0,.5)">Presencia</div>
    </div>
    <div style="overflow:hidden;position:relative">
      <img src="https://images.unsplash.com/photo-1545389336-cf090694435e?w=700&q=80" alt="Meditaci√≥n" style="width:100%;height:100%;object-fit:cover;filter:brightness(0.85) saturate(1.15)">
      <div style="position:absolute;bottom:20px;left:20px;color:white;font-family:'Cormorant Garamond',serif;font-size:18px;text-shadow:0 2px 8px rgba(0,0,0,.5)">Vibraci√≥n</div>
    </div>
    <div style="overflow:hidden;position:relative">
      <img src="https://images.unsplash.com/photo-1470770841072-f978cf4d019e?w=700&q=80" alt="Luz" style="width:100%;height:100%;object-fit:cover;filter:brightness(0.88) saturate(1.1)">
      <div style="position:absolute;bottom:20px;left:20px;color:white;font-family:'Cormorant Garamond',serif;font-size:18px;text-shadow:0 2px 8px rgba(0,0,0,.5)">Transformaci√≥n</div>
    </div>
  </div>

  <!-- LAS PUERTAS -->
  <div id="puertas" style="background:white;padding:80px 32px">
    <div class="section" style="padding:0">
      <div class="s-tag" style="">Estructura del Sistema TCT</div>
      <h2 class="s-title" style="">Las Cinco Puertas</h2>
      <p class="s-sub" style="">Un recorrido progresivo de 48 semanas hacia la maestr√≠a del ser.</p>
      <div class="puertas-grid">
        <div class="puerta-card">
          <div class="pc-head pc-blanca">
            <div class="pc-icon" style="">üåø</div>
            <div class="pc-name" style="">Puerta Blanca</div>
            <div class="pc-weeks" style="">Semanas 1‚Äì12 ¬∑ Cimentaci√≥n</div>
          </div>
          <div class="pc-body">
            <div class="pc-price" style="">‚Ç¨95<span style="font-size: 14px; color: rgb(122, 113, 104);">/mes</span></div>
            <div class="pc-billing" style="">3 meses ¬∑ ‚Ç¨285 total</div>
            <button class="btn-puerta" onclick="handlePurchase('puerta_blanca')">Seleccionar</button>
          </div>
        </div>
        <div class="puerta-card">
          <div class="pc-head pc-roja">
            <div class="pc-icon" style="">üî•</div>
            <div class="pc-name" style="">Puerta Roja</div>
            <div class="pc-weeks" style="">Semanas 13‚Äì24 ¬∑ Purificaci√≥n</div>
          </div>
          <div class="pc-body">
            <div class="pc-price" style="">‚Ç¨95<span style="font-size: 14px; color: rgb(122, 113, 104);">/mes</span></div>
            <div class="pc-billing" style="">Requiere Puerta Blanca</div>
            <button class="btn-puerta" onclick="handlePurchase('puerta_roja')">Seleccionar</button>
          </div>
        </div>
        <div class="puerta-card">
          <div class="pc-head pc-azul">
            <div class="pc-icon" style="">üîµ</div>
            <div class="pc-name" style="">Puerta Azul</div>
            <div class="pc-weeks" style="">Semanas 25‚Äì36 ¬∑ Maestr√≠a</div>
          </div>
          <div class="pc-body">
            <div class="pc-price" style="">‚Ç¨95<span style="font-size: 14px; color: rgb(122, 113, 104);">/mes</span></div>
            <div class="pc-billing" style="">Requiere Puerta Roja</div>
            <button class="btn-puerta" onclick="handlePurchase('puerta_azul')">Seleccionar</button>
          </div>
        </div>
        <div class="puerta-card">
          <div class="pc-head" style="background:linear-gradient(135deg,#7b4fa6,#5a3080)">
            <div class="pc-icon" style="">üåà</div>
            <div class="pc-name" style="">Puerta Arcoiris</div>
            <div class="pc-weeks" style="">Transformaci√≥n Avanzada</div>
          </div>
          <div class="pc-body">
            <div class="pc-price" style="">‚Ç¨95<span style="font-size: 14px; color: rgb(122, 113, 104);">/mes</span></div>
            <div class="pc-billing" style="">Requiere las 3 puertas</div>
            <button class="btn-puerta" onclick="handlePurchase('puerta_arcoiris')">Seleccionar</button>
          </div>
        </div>
        <div class="puerta-card" style="border-color:#b89558">
          <div class="pc-head pc-arcoiris">
            <div class="pc-icon" style="">‚ú®</div>
            <div class="pc-name" style="">Puerta Oro</div>
            <div class="pc-weeks" style="">Todo el programa ¬∑ Pago √∫nico</div>
          </div>
          <div class="pc-body">
            <div class="pc-price" style="">‚Ç¨890</div>
            <div class="pc-billing" style="">Acceso completo 24 meses</div>
            <button class="btn-puerta" style="background:#b89558" onclick="handlePurchase('puerta_oro')">Seleccionar</button>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- EL VIAJE -->
  <div id="viaje" style="padding:80px 32px;background:#f7f5f1" class="">
    <div style="max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:80px;align-items:start">
      <div style="position:sticky;top:100px">
        <div style="display: inline-block; background: rgb(232, 244, 243); color: rgb(43, 125, 122); font-size: 11px; font-weight: 700; letter-spacing: 0.12em; text-transform: uppercase; padding: 6px 14px; border-radius: 100px; margin-bottom: 20px;">El Viaje de Transformaci√≥n</div>
        <h2 style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: clamp(36px, 4vw, 56px); font-weight: 300; line-height: 1.1; margin-bottom: 20px;">48 Semanas que<br>Cambian tu Vida</h2>
        <p style="font-size: 15px; color: rgb(122, 113, 104); line-height: 1.75; margin-bottom: 32px;">Un camino progresivo desde el enraizamiento f√≠sico hasta la maestr√≠a espiritual ‚Äî 36 semanas de pr√°ctica guiada y 12 semanas de integraci√≥n.</p>
        <button onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})" style="background:#2b7d7a;color:white;border:none;padding:14px 28px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif">Comenzar el Viaje ‚Üí</button>
      </div>
      <div style="display:flex;flex-direction:column;gap:0">
        <div style="display:flex;gap:20px;padding:28px 0;border-bottom:1px solid #e4ddd3">
          <div style="width: 44px; height: 44px; border-radius: 50%; background: rgba(184, 173, 158, 0.125); border: 2px solid rgb(184, 173, 158); display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0;">üåø</div>
          <div>
            <div style="font-size: 11px; font-weight: 700; color: rgb(184, 173, 158); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 6px;">Semanas 1‚Äì12</div>
            <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 22px; font-weight: 400; color: rgb(184, 173, 158); margin-bottom: 8px;">Puerta Blanca ‚Äî Enraizamiento</div>
            <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.7; margin-bottom: 12px;">Cuerpo y presencia f√≠sica a trav√©s del Cuarto Camino y El Deportista Consciente.</div>
            <div style="display: flex; gap: 6px; flex-wrap: wrap;">
              <span style="background: rgb(240, 236, 228); color: rgb(122, 113, 104); font-size: 11px; padding: 4px 10px; border-radius: 100px;">Cuarto Camino</span>
              <span style="background: rgb(240, 236, 228); color: rgb(122, 113, 104); font-size: 11px; padding: 4px 10px; border-radius: 100px;">El Deportista Consciente</span>
              <span style="background: rgb(240, 236, 228); color: rgb(122, 113, 104); font-size: 11px; padding: 4px 10px; border-radius: 100px;" class="">Cuencos Tibetanos I - Puerta Blanca ¬∑ El cuerpo</span>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:20px;padding:28px 0;border-bottom:1px solid #e4ddd3">
          <div style="width: 44px; height: 44px; border-radius: 50%; background: rgba(191, 70, 55, 0.125); border: 2px solid rgb(191, 70, 55); display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0;">üî•</div>
          <div>
            <div style="font-size: 11px; font-weight: 700; color: rgb(191, 70, 55); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 6px;">Semanas 13‚Äì24</div>
            <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 22px; font-weight: 400; color: rgb(191, 70, 55); margin-bottom: 8px;">Puerta Roja ‚Äî Purificaci√≥n</div>
            <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.7; margin-bottom: 12px;">Transformaci√≥n emocional y purificaci√≥n energ√©tica a trav√©s de UCDM y el Cuarto Camino emocional.</div>
            <div style="display: flex; gap: 6px; flex-wrap: wrap;">
              <span style="background: rgb(253, 240, 238); color: rgb(191, 70, 55); font-size: 11px; padding: 4px 10px; border-radius: 100px;">UCDM: El Perd√≥n</span>
              <span style="background: rgb(253, 240, 238); color: rgb(191, 70, 55); font-size: 11px; padding: 4px 10px; border-radius: 100px;">Cuencos Tibetanos II - Puerta Roja ¬∑ La energ√≠a-Voz</span>
              <span style="background: rgb(253, 240, 238); color: rgb(191, 70, 55); font-size: 11px; padding: 4px 10px; border-radius: 100px;">Mantras Sagrados</span>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:20px;padding:28px 0;border-bottom:1px solid #e4ddd3">
          <div style="width: 44px; height: 44px; border-radius: 50%; background: rgba(44, 95, 158, 0.125); border: 2px solid rgb(44, 95, 158); display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0;">üîµ</div>
          <div>
            <div style="font-size: 11px; font-weight: 700; color: rgb(44, 95, 158); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 6px;">Semanas 25‚Äì36</div>
            <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 22px; font-weight: 400; color: rgb(44, 95, 158); margin-bottom: 8px;">Puerta Azul ‚Äî Maestr√≠a</div>
            <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.7; margin-bottom: 12px;">Expansi√≥n mental y maestr√≠a espiritual a trav√©s del Dzogchen y El Ser Consciente.</div>
            <div style="display: flex; gap: 6px; flex-wrap: wrap;">
              <span style="background: rgb(238, 243, 251); color: rgb(44, 95, 158); font-size: 11px; padding: 4px 10px; border-radius: 100px;">Dzogchen ¬∑ Rigpa</span>
              <span style="background: rgb(238, 243, 251); color: rgb(44, 95, 158); font-size: 11px; padding: 4px 10px; border-radius: 100px;" class="">Cuencos Tibetanos III - Puerta Azul ¬∑ La mente&nbsp; + Anexos</span><span style="background: rgb(238, 243, 251); color: rgb(44, 95, 158); font-size: 11px; padding: 4px 10px; border-radius: 100px;" class="">Cuencos Tibetanos IV - Puerta Anexos ¬∑&nbsp; Ejercicios y rituales pr√°cticos</span>
              <span style="background: rgb(238, 243, 251); color: rgb(44, 95, 158); font-size: 11px; padding: 4px 10px; border-radius: 100px;">El Ser Consciente</span>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:20px;padding:28px 0">
          <div style="width: 44px; height: 44px; border-radius: 50%; background: rgba(123, 79, 166, 0.125); border: 2px solid rgb(123, 79, 166); display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0;">üåà</div>
          <div>
            <div style="font-size: 11px; font-weight: 700; color: rgb(123, 79, 166); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 6px;">Semanas 37‚Äì48</div>
            <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 22px; font-weight: 400; color: rgb(123, 79, 166); margin-bottom: 8px;">Puerta de Integraci√≥n ‚Äî Retiro</div>
            <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.7; margin-bottom: 12px;">S√≠ntesis de las tres puertas. Vivir desde la coherencia, el prop√≥sito y la conexi√≥n.</div>
            <div style="display: flex; gap: 6px; flex-wrap: wrap;">
              <span style="background: rgb(245, 240, 251); color: rgb(123, 79, 166); font-size: 11px; padding: 4px 10px; border-radius: 100px;">Integraci√≥n Total</span>
              <span style="background: rgb(245, 240, 251); color: rgb(123, 79, 166); font-size: 11px; padding: 4px 10px; border-radius: 100px;">Diarios de Pr√°ctica</span>
              <span style="background: rgb(245, 240, 251); color: rgb(123, 79, 166); font-size: 11px; padding: 4px 10px; border-radius: 100px;">Maestr√≠a Cotidiana</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>



  <!-- PILARES -->
  <div id="pilares" style="padding:80px 32px;background:#f0ece4">
    <div style="max-width:1100px;margin:0 auto">
      <div style="font-size: 11px; font-weight: 700; color: rgb(122, 113, 104); text-transform: uppercase; letter-spacing: 0.15em; margin-bottom: 12px; text-align: center;">Los Pilares del Sistema TCT</div>
      <h2 style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: clamp(32px, 4vw, 52px); font-weight: 300; color: rgb(28, 24, 20); text-align: center; margin-bottom: 16px;" class="ed-selected-ring">9Tradiciones para una transformaci√≥n.</h2>
      <p style="font-size: 15px; color: rgb(122, 113, 104); line-height: 1.7; max-width: 680px; margin: 0px auto 60px; text-align: center;">El Sistema TCT integra las tradiciones m√°s profundas de la humanidad con herramientas vibracionales √∫nicas para crear un camino completo de despertar consciente.</p>

      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:24px;margin-bottom:48px">

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">üèîÔ∏è</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">Dzogchen</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">La tradici√≥n tibetana m√°s elevada. Nos revela la naturaleza primordial de la mente ‚Äî <em style="color: rgb(43, 125, 122); font-style: italic;">Rigpa</em> ‚Äî la consciencia pura, abierta y luminosa que ya est√° presente. No hay nada que alcanzar, solo reconocer lo que somos.</div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üîµ Puerta Azul ¬∑ üåà Integraci√≥n
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">‚öôÔ∏è</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">El Cuarto Camino ¬∑ Gurdjieff</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">El despertar en la vida cotidiana. A trav√©s del <em style="color: rgb(43, 125, 122); font-style: italic;">recuerdo de s√≠</em>, la auto-observaci√≥n y el trabajo sobre los tres centros (f√≠sico, emocional, intelectual), aprendemos a salir del sue√±o autom√°tico y vivir con presencia real.</div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üåø Puerta Blanca ¬∑ üî• Puerta Roja
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">üíõ</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">Un Curso de Milagros</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">La v√≠a directa para la sanaci√≥n de la mente. UCDM nos gu√≠a para deshacer el sistema del ego basado en el miedo y elegir el sistema del amor y la unidad. El <em style="color: rgb(43, 125, 122); font-style: italic;">perd√≥n real</em> como herramienta de liberaci√≥n.</div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üî• Puerta Roja ¬∑ üîµ Puerta Azul
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">üåø</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">Cuencos Tibetanos I</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">Fundamentos vibracionales. Iniciaci√≥n al sonido sagrado y la presencia corporal. La tecnolog√≠a vibracional que abre la Puerta Blanca y sienta las bases del camino.</div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üåø Puerta Blanca
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">üî•</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">Cuencos Tibetanos II</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">Nivel terap√©utico. Purificaci√≥n emocional y liberaci√≥n de bloqueos energ√©ticos. El sonido como herramienta de transformaci√≥n profunda de la energ√≠a interior.</div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üî• Puerta Roja
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">üîµ</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">Cuencos Tibetanos III</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">Nivel espiritual avanzado. Apertura de la consciencia y conexi√≥n con Rigpa. El sonido como puente hacia los estados m√°s elevados de percepci√≥n.</div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üîµ Puerta Azul
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">üåà</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">Cuencos Tibetanos IV</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">Protocolos para transformar la mente. Integraci√≥n de las tres frecuencias para la transformaci√≥n completa. El sonido como s√≠ntesis final del camino.</div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üåà Integraci√≥n
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">üèÉ</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">El Deportista Consciente</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">Presencia en la acci√≥n. El cuerpo como templo y el rendimiento desde la consciencia. El sentido m√°s all√° del √©xito y el fracaso. <em style="color: rgb(43, 125, 122); font-style: italic;">M√°s all√° del resultado.</em></div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üåø Puerta Blanca
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size: 32px; margin-bottom: 16px;">üßò</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 24px; color: rgb(28, 24, 20); margin-bottom: 10px;">El Ser Consciente</div>
          <div style="font-size: 13px; color: rgb(90, 82, 72); line-height: 1.75; margin-bottom: 16px;">Vivir con presencia total. La integraci√≥n cuerpo-mente-consciencia en lo cotidiano. <em style="color: rgb(43, 125, 122); font-style: italic;">M√°s all√° de la acci√≥n: vivir con presencia en la vida cotidiana.</em></div>
          <div style="background: rgb(240, 236, 228); border-radius: 10px; padding: 14px; font-size: 12px; color: rgb(122, 113, 104);">
            <div style="font-weight: 700; color: rgb(61, 55, 48); margin-bottom: 6px;">Presente en</div>
            üî• Puerta Roja ¬∑ üîµ Puerta Azul
          </div>
        </div>

      </div>

      <div style="text-align: center; margin-top: 48px;">
        <button onclick="goTo('auth')" style="background:#2b7d7a;color:white;border:none;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif">Comenzar mi Transformaci√≥n ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- 9 PILARES MANDALA -->
  <div id="pilares-mandala" style="padding:80px 32px;background:#2e2820">
    <div style="max-width:1100px;margin:0 auto;text-align:center">
      <div style="font-size:11px;font-weight:700;color:#b89558;text-transform:uppercase;letter-spacing:.15em;margin-bottom:12px">La Integraci√≥n Total</div>
      <h2 style="font-family:'Cormorant Garamond',serif;font-size:clamp(28px,4vw,48px);font-weight:300;color:white;margin-bottom:12px">9 Pilares ¬∑ Un Solo Ser</h2>
      <p style="font-size:14px;color:rgba(255,255,255,.45);max-width:600px;margin:0 auto 56px;line-height:1.75">Cada tradici√≥n y herramienta ilumina el mismo centro. No hay jerarqu√≠a ‚Äî hay convergencia. Todas las sendas apuntan al mismo punto: t√∫.</p>

      <div style="position:relative;width:min(800px,92vw);aspect-ratio:1;margin:0 auto">
        <svg viewBox="0 0 800 800" xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%">
          <defs>
            <radialGradient id="mbg" cx="50%" cy="50%" r="50%">
              <stop offset="0%" stop-color="#b89558" stop-opacity=".12"/>
              <stop offset="100%" stop-color="#b89558" stop-opacity="0"/>
            </radialGradient>
            <radialGradient id="mcenter" cx="50%" cy="50%" r="50%">
              <stop offset="0%" stop-color="#b89558" stop-opacity=".35"/>
              <stop offset="100%" stop-color="#b89558" stop-opacity="0"/>
            </radialGradient>
            <filter id="mglow"><feGaussianBlur stdDeviation="4" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
            <filter id="mglows"><feGaussianBlur stdDeviation="3" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
          </defs>

          <!-- Background glow -->
          <circle cx="400" cy="400" r="380" fill="url(#mbg)"/>

          <!-- Rings -->
          <circle cx="400" cy="400" r="350" fill="none" stroke="rgba(184,149,88,.08)" stroke-width="1"/>
          <circle cx="400" cy="400" r="300" fill="none" stroke="rgba(184,149,88,.18)" stroke-width="1.5"/>
          <circle cx="400" cy="400" r="210" fill="none" stroke="rgba(184,149,88,.07)" stroke-width="1" stroke-dasharray="4,12"/>
          <circle cx="400" cy="400" r="120" fill="none" stroke="rgba(184,149,88,.1)"  stroke-width="1"/>

          <!-- Lines from center to each node -->
          <g stroke="rgba(184,149,88,.28)" stroke-width="1.2">
            <line x1="400" y1="400" x2="400.0" y2="100.0"/>
            <line x1="400" y1="400" x2="592.8" y2="170.2"/>
            <line x1="400" y1="400" x2="695.4" y2="347.9"/>
            <line x1="400" y1="400" x2="659.8" y2="550.0"/>
            <line x1="400" y1="400" x2="502.6" y2="681.9"/>
            <line x1="400" y1="400" x2="297.4" y2="681.9"/>
            <line x1="400" y1="400" x2="140.2" y2="550.0"/>
            <line x1="400" y1="400" x2="104.6" y2="347.9"/>
            <line x1="400" y1="400" x2="207.2" y2="170.2"/>
          </g>

          <!-- Node 1: Dzogchen -->
          <g filter="url(#mglows)">
            <circle cx="400.0" cy="100.0" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="400.0" y="90" text-anchor="middle" font-size="26">üèîÔ∏è</text>
            <text x="400.0" y="108" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">Dzogchen</text>
          </g>
          <!-- Node 2: IV Camino -->
          <g filter="url(#mglows)">
            <circle cx="592.8" cy="170.2" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="592.8" y="160" text-anchor="middle" font-size="26">‚öôÔ∏è</text>
            <text x="592.8" y="178" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">IV Camino</text>
          </g>
          <!-- Node 3: UCDM -->
          <g filter="url(#mglows)">
            <circle cx="695.4" cy="347.9" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="695.4" y="338" text-anchor="middle" font-size="26">üíõ</text>
            <text x="695.4" y="356" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">UCDM</text>
          </g>
          <!-- Node 4: Cuencos I -->
          <g filter="url(#mglows)">
            <circle cx="659.8" cy="550.0" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="659.8" y="540" text-anchor="middle" font-size="26">üåø</text>
            <text x="659.8" y="558" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">Cuencos I</text>
          </g>
          <!-- Node 5: Cuencos II -->
          <g filter="url(#mglows)">
            <circle cx="502.6" cy="681.9" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="502.6" y="672" text-anchor="middle" font-size="26">üî•</text>
            <text x="502.6" y="690" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">Cuencos II</text>
          </g>
          <!-- Node 6: Cuencos III -->
          <g filter="url(#mglows)">
            <circle cx="297.4" cy="681.9" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="297.4" y="672" text-anchor="middle" font-size="26">üîµ</text>
            <text x="297.4" y="690" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">Cuencos III</text>
          </g>
          <!-- Node 7: Cuencos IV -->
          <g filter="url(#mglows)">
            <circle cx="140.2" cy="550.0" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="140.2" y="540" text-anchor="middle" font-size="26">üåà</text>
            <text x="140.2" y="558" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">Cuencos IV</text>
          </g>
          <!-- Node 8: Deportista -->
          <g filter="url(#mglows)">
            <circle cx="104.6" cy="347.9" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="104.6" y="338" text-anchor="middle" font-size="26">üèÉ</text>
            <text x="104.6" y="356" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">Deportista</text>
          </g>
          <!-- Node 9: Ser Consciente -->
          <g filter="url(#mglows)">
            <circle cx="207.2" cy="170.2" r="44" fill="#2e2820" stroke="#b89558" stroke-width="2"/>
            <text x="207.2" y="160" text-anchor="middle" font-size="26">üßò</text>
            <text x="207.2" y="178" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.7)" font-family="DM Sans, sans-serif" font-weight="500">Ser Consciente</text>
          </g>

          <!-- Center glow -->
          <circle cx="400" cy="400" r="72" fill="url(#mcenter)" filter="url(#mglow)"/>
          <circle cx="400" cy="400" r="56" fill="#2e2820" stroke="rgba(184,149,88,.5)" stroke-width="2"/>
          <circle cx="400" cy="400" r="44" fill="rgba(184,149,88,.06)" stroke="rgba(184,149,88,.2)" stroke-width="1"/>

          <!-- "El Ser" above star -->
          <text x="400" y="389" text-anchor="middle" font-size="10" fill="#d4a85a" font-family="Cormorant Garamond, serif" font-style="italic">El Ser</text>

          <!-- 9-pointed star -->
          <polygon
            points="400.0,386.0 402.1,394.4 409.0,389.3 405.2,397.0 413.8,397.6 405.9,401.0 412.1,407.0 403.9,404.6 404.8,413.2 400.0,406.0 395.2,413.2 396.1,404.6 387.9,407.0 394.1,401.0 386.2,397.6 394.8,397.0 391.0,389.3 397.9,394.4"
            fill="#b89558" opacity=".9" filter="url(#mglow)"/>

          <!-- "Humano" below star -->
          <text x="400" y="422" text-anchor="middle" font-size="10" fill="#d4a85a" font-family="Cormorant Garamond, serif" font-style="italic">Humano</text>
        </svg>
      </div>
    </div>
  </div>

  <!-- JOYAS -->
  <div id="joyas" style="padding:80px 32px;background:white" class="">
    <div style="max-width:1100px;margin:0 auto" class="">
      <div style="font-size: 11px; font-weight: 700; color: rgb(184, 149, 88); text-transform: uppercase; letter-spacing: 0.15em; margin-bottom: 12px;">Las Joyas del Sistema</div>
      <h2 style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: clamp(32px, 4vw, 52px); font-weight: 300; margin-bottom: 16px;">Tu Joya Personal</h2>
      <p style="font-size: 15px; color: rgb(122, 113, 104); line-height: 1.7; max-width: 1200px; margin-bottom: 48px;" class="">Cada alumno recibe una joya sagrada personalizada seg√∫n su camino. Las joyas son herramientas vibracionales que amplifican y anclan la frecuencia de cada Puerta.</p>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px">
        <div style="background:#f5f2ec;border-radius:16px;padding:28px;text-align:center;border:1px solid #d9d2c8">
          <div style="font-size: 36px; margin-bottom: 12px;">üåø</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 20px; color: rgb(138, 128, 120); margin-bottom: 8px;">Joya Blanca</div>
          <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.6;">Cuarzo blanco o selenita. Purifica y ancla la presencia en el cuerpo.</div>
        </div>
        <div style="background:#fdf0ee;border-radius:16px;padding:28px;text-align:center;border:1px solid #e8c4be">
          <div style="font-size: 36px; margin-bottom: 12px;">üî•</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 20px; color: rgb(191, 70, 55); margin-bottom: 8px;">Joya Roja</div>
          <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.6;">Granate o cornalina. Transforma la energ√≠a emocional y activa el coraz√≥n.</div>
        </div>
        <div style="background:#eef3fb;border-radius:16px;padding:28px;text-align:center;border:1px solid #bacde8">
          <div style="font-size: 36px; margin-bottom: 12px;">üîµ</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 20px; color: rgb(44, 95, 158); margin-bottom: 8px;">Joya Azul</div>
          <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.6;">Lapisl√°zuli o aguamarina. Abre la mente y conecta con la sabidur√≠a.</div>
        </div>
        <div style="background:#f5f0fb;border-radius:16px;padding:28px;text-align:center;border:1px solid #cbbde8">
          <div style="font-size: 36px; margin-bottom: 12px;">üåà</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 20px; color: rgb(123, 79, 166); margin-bottom: 8px;">Joya Arcoiris</div>
          <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.6;">Amatista o turmalina. Integra las tres puertas y eleva la vibraci√≥n.</div>
        </div>
        <div style="background:linear-gradient(135deg,#fdf6ec,#f5eedd);border-radius:16px;padding:28px;text-align:center;border:1px solid #d4b87a">
          <div style="font-size: 36px; margin-bottom: 12px;">‚ú®</div>
          <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 20px; color: rgb(184, 149, 88); margin-bottom: 8px;">Joya Oro</div>
          <div style="font-size: 13px; color: rgb(122, 113, 104); line-height: 1.6;">Citrina o pirita dorada. La joya de la maestr√≠a total y la abundancia.</div>
        </div>
      </div>
      <div style="margin-top: 40px; text-align: center;">
        <button onclick="goTo('auth')" style="background:#b89558;color:white;border:none;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif">‚ú¶ Descubrir mi Joya Personal</button>
      </div>
    </div>
  </div>

  <!-- TESTIMONIOS -->
  <div id="testimonios" style="background:#f0ece4;padding:80px 32px">
    <div style="max-width:1100px;margin:0 auto">
      <!-- Imagen ambiental -->
      <div style="border-radius:20px;overflow:hidden;height:280px;margin-bottom:60px;position:relative">
        <img src="https://images.unsplash.com/photo-1516979187457-637abb4f9353?w=1200&q=80" alt="Meditaci√≥n cuencos" style="width:100%;height:100%;object-fit:cover;filter:brightness(0.75) saturate(1.2)">
        <div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;padding:32px">
          <div style="font-family:'Cormorant Garamond',serif;font-size:clamp(28px,4vw,48px);font-weight:300;color:white;line-height:1.2;text-shadow:0 2px 16px rgba(0,0,0,.4)">"El sonido que transforma<br>desde adentro."</div>
        </div>
      </div>
      <div style="font-size: 11px; font-weight: 700; color: rgb(122, 113, 104); text-transform: uppercase; letter-spacing: 0.15em; margin-bottom: 12px; text-align: center;">Testimonios</div>
      <h2 style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 42px; font-weight: 300; color: rgb(28, 24, 20); text-align: center; margin-bottom: 48px;">Lo que dicen nuestros alumnos</h2>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px">
        <div style="background:white;border-radius:16px;padding:28px;border:1px solid #e4ddd3">
          <div style="font-size: 14px; color: rgb(61, 55, 48); line-height: 1.8; margin-bottom: 20px; font-style: italic;">"El Sistema TCT ha transformado completamente mi relaci√≥n con el cuerpo y la mente. Nunca pens√© que podr√≠a experimentar tanta paz interior en mi vida cotidiana."</div>
          <div style="font-weight: 600; color: rgb(28, 24, 20); font-size: 13px;">Mar√≠a G.</div>
          <div style="font-size: 12px; color: rgb(122, 113, 104);">Puerta Azul completada</div>
        </div>
        <div style="background:white;border-radius:16px;padding:28px;border:1px solid #e4ddd3" class="">
          <div style="font-size: 14px; color: rgb(61, 55, 48); line-height: 1.8; margin-bottom: 20px; font-style: italic;">"Los cuencos tibetanos y los protocolos de sonido cambiaron mi forma de gestionar el estr√©s. Es una herramienta incomparable para el bienestar."</div>
          <div style="font-weight: 600; color: rgb(28, 24, 20); font-size: 13px;">Carlos M.</div>
          <div style="font-size: 12px; color: rgb(122, 113, 104);">Puerta Oro ¬∑ Programa completo</div>
        </div>
        <div style="background:white;border-radius:16px;padding:28px;border:1px solid #e4ddd3">
          <div style="font-size: 14px; color: rgb(61, 55, 48); line-height: 1.8; margin-bottom: 20px; font-style: italic;">"Marga tiene un don especial para transmitir el conocimiento espiritual de forma pr√°ctica y accesible. Las canalizaciones son un regalo."</div>
          <div style="font-weight: 600; color: rgb(28, 24, 20); font-size: 13px;">Laura P.</div>
          <div style="font-size: 12px; color: rgb(122, 113, 104);">Puerta Arcoiris completada</div>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer style="background:#111;padding:40px 32px;text-align:center">
    <div style="font-family: &quot;Cormorant Garamond&quot;, serif; font-size: 20px; color: white; margin-bottom: 8px;">Frecuencia Integral Academy</div>
    <div style="font-size: 12px; color: rgb(122, 113, 104); margin-bottom: 20px;">Sistema TCT ¬∑ Transformaci√≥n Consciente Trascendental</div>
    
    <div style="margin-top: 28px; font-size: 11px; color: rgba(255, 255, 255, 0.25);">¬© 2026 Frecuencia Integral Academy ¬∑ Todos los derechos reservados</div>
  </footer>


  
</div><!-- /page-public -->

<!-- PAGE: AUTH -->
<div class="page" id="page-auth">
  <div class="auth-wrap">
    <div class="auth-left">
      <h2>Entra en tu<br>espacio de<br><em>transformaci√≥n</em></h2>
      <p>Accede a tus semanas de formaci√≥n, ejercicios detallados, audios de cuencos tibetanos y tu joya personalizada.</p>
      <ul class="auth-perks">
        <li>48 semanas de contenido estructurado</li>
        <li>73+ ejercicios con instrucciones paso a paso</li>
        <li>Canalizaciones de Marga Barcel√≥</li>
        <li>Frecuencias 432Hz, 528Hz, 963Hz</li>
        <li>Test de Joya Personalizada</li>
        <li>Progreso guardado en tiempo real</li>
      </ul>
    </div>
    <div class="auth-right">
      <div class="auth-box">
        <h3>Bienvenido</h3>
        <p class="sub">Accede a tu √°rea de alumnos</p>
        <div class="auth-tabs">
          <button class="auth-tab active" id="tab-login" onclick="switchTab('login')">Iniciar Sesi√≥n</button>
          <button class="auth-tab" id="tab-register" onclick="switchTab('register')">Registrarse</button>
        </div>

        <div id="form-login" data-protonpass-form="">
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="inp-email" value="test@frecuenciaintegral.com">
          </div>
          <div class="form-group">
            <label>Contrase√±a</label>
            <input type="password" id="inp-pass" value="TestUser2026!">
          </div>
          <button class="btn-login" id="btn-login" onclick="doLogin()">Entrar al √Årea de Alumnos</button>
          <div class="demo-hint">üîë Demo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ec98899f98ac8a9e898f9989828f858d858298898b9e8d80c28f8381">[email&nbsp;protected]</a> / TestUser2026!</div>
        </div>

        <div id="form-register" style="display:none">
          <div class="form-group">
            <label>Nombre</label>
            <input type="text" id="inp-name" placeholder="Tu nombre completo">
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="inp-reg-email" placeholder="tu@email.com">
          </div>
          <div class="form-group">
            <label>Contrase√±a</label>
            <input type="password" id="inp-reg-pass" placeholder="M√≠nimo 8 caracteres">
          </div>
          <button class="btn-login" id="btn-register" onclick="doRegister()">Crear Cuenta</button>
        </div>

        <a class="back-link" onclick="goTo('public')">‚Üê Volver a la web</a>
      </div>
    </div>
  </div>
</div><!-- /page-auth -->

<!-- PAGE: STUDENT -->
<div class="page" id="page-student">
  <div class="student-wrap">

    <!-- SIDEBAR -->
    <div class="sidebar">
      <div class="sidebar-user">
        <div class="sidebar-name" id="sb-name">Alumno TCT</div>
        <div class="sidebar-email" id="sb-email">‚Äî</div>
        <div class="sidebar-badge" id="sb-plan">Puerta Oro</div>
      </div>
      <div class="sidebar-nav">
        <button class="nav-item active" onclick="showView('dashboard')"><span class="nav-item-icon">üè†</span>Dashboard</button>
        <button class="nav-item" onclick="showView('formaciones')"><span class="nav-item-icon">üìö</span>Formaciones</button>
        <button class="nav-item" onclick="showView('multimedia')"><span class="nav-item-icon">üéµ</span>Multimedia</button>
        <button class="nav-item" onclick="showView('materiales')"><span class="nav-item-icon">üìÑ</span>Materiales PDF</button>
        <button class="nav-item" onclick="showView('progreso')"><span class="nav-item-icon">üìä</span>Mi Progreso</button>
        <button class="nav-item" style="margin-top:auto;color:rgba(255,255,255,.4)" onclick="doLogout()"><span class="nav-item-icon">üö™</span>Cerrar Sesi√≥n</button>
      </div>
    </div>

    <!-- MAIN -->
    <div class="main-content">

      <!-- DASHBOARD VIEW -->
      <div id="view-dashboard">
        <h1 style="font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:300;margin-bottom:8px">Bienvenido, <span id="dash-name">Alumno</span> ‚ú¶</h1>
        <p style="color:#7a7168;font-size:14px;margin-bottom:28px">Sistema TCT ‚Äî Tu camino de transformaci√≥n</p>
        <div class="dashboard-grid">
          <div class="stat-card">
            <div class="stat-label">Progreso General</div>
            <div class="stat-value" id="stat-progreso">0%</div>
            <div class="stat-sub" id="stat-sub-progreso">0 de 48 semanas</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Semana Actual</div>
            <div class="stat-value" id="stat-semana">1</div>
            <div class="stat-sub">En curso</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Puerta Actual</div>
            <div class="stat-value" style="font-size:28px" id="stat-puerta">üåø Blanca</div>
            <div class="stat-sub">Cimentaci√≥n</div>
          </div>
        </div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <button class="btn-primary" onclick="showView('formaciones')">Ver Formaciones ‚Üí</button>
          <button class="btn-ghost" onclick="showView('multimedia')">Biblioteca Multimedia</button>
        </div>
      </div>

      <!-- FORMACIONES VIEW -->
      <div id="view-formaciones" style="display:none">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:20px">Las 48 Semanas</h2>
        <div class="filter-bar">
          <button class="filter-btn active" onclick="filterWeeks('all',this)">Todas</button>
          <button class="filter-btn" onclick="filterWeeks('Blanca',this)">üåø Blanca</button>
          <button class="filter-btn" onclick="filterWeeks('Roja',this)">üî• Roja</button>
          <button class="filter-btn" onclick="filterWeeks('Azul',this)">üîµ Azul</button>
          <button class="filter-btn" onclick="filterWeeks('Arcoiris',this)">üåà Arcoiris</button>
        </div>
        <div class="weeks-grid" id="weeks-grid"><div class="week-card in-progress" onclick="openWeekModal(1)"><div class="week-num">Semana 1 ¬∑ ‚ñ∂</div><div class="week-title">El Precio Oculto de Vivir Acelerados</div><div class="week-status" style="color:#b89558">En curso</div></div><div class="week-card" onclick="openWeekModal(2)"><div class="week-num">Semana 2 ¬∑ ‚óã</div><div class="week-title">Cuando Ganar Ya No Es Suficiente</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(3)"><div class="week-num">Semana 3 ¬∑ ‚óã</div><div class="week-title">Cuerpo, Mente y Consciencia: Una Sola Unidad</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(4)"><div class="week-num">Semana 4 ¬∑ ‚óã</div><div class="week-title">El Ego en la Vida Cotidiana</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(5)"><div class="week-num">Semana 5 ¬∑ ‚óã</div><div class="week-title">La Emoci√≥n, el Error y la Presi√≥n como Camino</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(6)"><div class="week-num">Semana 6 ¬∑ ‚óã</div><div class="week-title">El Entrenamiento como V√≠a de Despertar</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(7)"><div class="week-num">Semana 7 ¬∑ ‚óã</div><div class="week-title">El Campo de Consciencia Compartido</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(8)"><div class="week-num">Semana 8 ¬∑ ‚óã</div><div class="week-title">Sonido, Vibraci√≥n y Armonizaci√≥n del Sistema</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(9)"><div class="week-num">Semana 9 ¬∑ ‚óã</div><div class="week-title">Cuando el Sistema No Sostiene lo que Promete</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(10)"><div class="week-num">Semana 10 ¬∑ ‚óã</div><div class="week-title">El L√≠mite como Punto de Despertar</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(11)"><div class="week-num">Semana 11 ¬∑ ‚óã</div><div class="week-title">M√°s All√° del Resultado: El Sentido del Camino</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(12)"><div class="week-num">Semana 12 ¬∑ ‚óã</div><div class="week-title">Integraci√≥n de la Puerta Blanca</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(13)"><div class="week-num">Semana 13 ¬∑ ‚óã</div><div class="week-title">Introducci√≥n a la Puerta Roja y la Energ√≠a</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(14)"><div class="week-num">Semana 14 ¬∑ ‚óã</div><div class="week-title">El Sonido Primordial y los Mantras</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(15)"><div class="week-num">Semana 15 ¬∑ ‚óã</div><div class="week-title">Los 6 Reinos del Samsara y la Gesti√≥n Emocional</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(16)"><div class="week-num">Semana 16 ¬∑ ‚óã</div><div class="week-title">El Cuarto Camino - Recuerdo de S√≠ y Observaci√≥n</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(17)"><div class="week-num">Semana 17 ¬∑ ‚óã</div><div class="week-title">El Cuarto Camino - Trabajo sobre los Centros</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(18)"><div class="week-num">Semana 18 ¬∑ ‚óã</div><div class="week-title">UCDM - La Paradoja de la Felicidad y el Perd√≥n</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(19)"><div class="week-num">Semana 19 ¬∑ ‚óã</div><div class="week-title">UCDM - Gesti√≥n Emocional y el Instante Santo</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(20)"><div class="week-num">Semana 20 ¬∑ ‚óã</div><div class="week-title">Protocolos de Sonido - Purificar el Samsara</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(21)"><div class="week-num">Semana 21 ¬∑ ‚óã</div><div class="week-title">Protocolos de Sonido - El Pilar del Medio</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(22)"><div class="week-num">Semana 22 ¬∑ ‚óã</div><div class="week-title">Alquimia de la Energ√≠a - La Cruz Cabal√≠stica</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(23)"><div class="week-num">Semana 23 ¬∑ ‚óã</div><div class="week-title">La F√≥rmula de la Felicidad - Aceptaci√≥n</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(24)"><div class="week-num">Semana 24 ¬∑ ‚óã</div><div class="week-title">Integraci√≥n de la Puerta Roja</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(25)"><div class="week-num">Semana 25 ¬∑ ‚óã</div><div class="week-title">Introducci√≥n a la Puerta Azul y la Mente</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(26)"><div class="week-num">Semana 26 ¬∑ ‚óã</div><div class="week-title">La Mente seg√∫n Diversas Tradiciones</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(27)"><div class="week-num">Semana 27 ¬∑ ‚óã</div><div class="week-title">Dzogchen - La Mente Natural (Rigpa)</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(28)"><div class="week-num">Semana 28 ¬∑ ‚óã</div><div class="week-title">La Met√°fora del Espejo y la Visi√≥n No-Dual</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(29)"><div class="week-num">Semana 29 ¬∑ ‚óã</div><div class="week-title">UCDM en la Puerta Azul - El Testigo Santo</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(30)"><div class="week-num">Semana 30 ¬∑ ‚óã</div><div class="week-title">El Ser Consciente - Vivir con Presencia</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(31)"><div class="week-num">Semana 31 ¬∑ ‚óã</div><div class="week-title">Protocolos de Sonido - Desintoxicaci√≥n</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(32)"><div class="week-num">Semana 32 ¬∑ ‚óã</div><div class="week-title">Objetos Sagrados y el Proceso de Liberaci√≥n</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(33)"><div class="week-num">Semana 33 ¬∑ ‚óã</div><div class="week-title">Manifestar la Fuerza Interior</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(34)"><div class="week-num">Semana 34 ¬∑ ‚óã</div><div class="week-title">Transformaci√≥n de la Mente para la Felicidad</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(35)"><div class="week-num">Semana 35 ¬∑ ‚óã</div><div class="week-title">La Noche Oscura del Alma</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(36)"><div class="week-num">Semana 36 ¬∑ ‚óã</div><div class="week-title">Integraci√≥n de la Puerta Azul</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(37)"><div class="week-num">Semana 37 ¬∑ ‚óã</div><div class="week-title">S√≠ntesis del M√©todo TCT - Las Tres Puertas</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(38)"><div class="week-num">Semana 38 ¬∑ ‚óã</div><div class="week-title">La Alquimia del Ser</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(39)"><div class="week-num">Semana 39 ¬∑ ‚óã</div><div class="week-title">El Campo Invisible que Todos Sostenemos</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(40)"><div class="week-num">Semana 40 ¬∑ ‚óã</div><div class="week-title">Pr√°ctica Integrada - El Diario del Cuarto Camino</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(41)"><div class="week-num">Semana 41 ¬∑ ‚óã</div><div class="week-title">Pr√°ctica Integrada - El Diario del Perd√≥n</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(42)"><div class="week-num">Semana 42 ¬∑ ‚óã</div><div class="week-title">Pr√°ctica Integrada - El Diario de la Mente Feliz</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(43)"><div class="week-num">Semana 43 ¬∑ ‚óã</div><div class="week-title">El Arte de la No-Interferencia</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(44)"><div class="week-num">Semana 44 ¬∑ ‚óã</div><div class="week-title">El Legado Invisible - La Vida como Servicio</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(45)"><div class="week-num">Semana 45 ¬∑ ‚óã</div><div class="week-title">La Comunicaci√≥n desde la Fuente</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(46)"><div class="week-num">Semana 46 ¬∑ ‚óã</div><div class="week-title">Maestr√≠a en la Vida Cotidiana</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(47)"><div class="week-num">Semana 47 ¬∑ ‚óã</div><div class="week-title">El Ciclo Permanente - La Espiral de Transformaci√≥n</div><div class="week-status" style="color:#a89e93">Pendiente</div></div><div class="week-card" onclick="openWeekModal(48)"><div class="week-num">Semana 48 ¬∑ ‚óã</div><div class="week-title">Cierre y Continuaci√≥n del Camino</div><div class="week-status" style="color:#a89e93">Pendiente</div></div></div>
      </div>

      <!-- MULTIMEDIA VIEW -->
      <div id="view-multimedia" style="display:none">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:20px">Biblioteca Multimedia</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px" id="media-grid"><div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.08)'" onmouseout="this.style.transform='';this.style.boxShadow=''" onclick="toast('Reproduciendo: Cuencos Tibetanos ‚Äî Fundamentos üéµ')"><div style="background:#f5f2ec;height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">üéµ</div><div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">Cuencos ¬∑ 32 min</div><div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">Cuencos Tibetanos ‚Äî Fundamentos</div></div></div><div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.08)'" onmouseout="this.style.transform='';this.style.boxShadow=''" onclick="toast('Reproduciendo: Canalizaci√≥n Marga ‚Äî Puerta Blanca üéµ')"><div style="background:#fdf0ee;height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">üå∏</div><div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">Canalizaci√≥n ¬∑ 18 min</div><div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">Canalizaci√≥n Marga ‚Äî Puerta Blanca</div></div></div><div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.08)'" onmouseout="this.style.transform='';this.style.boxShadow=''" onclick="toast('Reproduciendo: Meditaci√≥n de Presencia Corporal üéµ')"><div style="background:#eef3fb;height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">üßò</div><div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">Meditaci√≥n ¬∑ 15 min</div><div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">Meditaci√≥n de Presencia Corporal</div></div></div><div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.08)'" onmouseout="this.style.transform='';this.style.boxShadow=''" onclick="toast('Reproduciendo: Frecuencia 432Hz ‚Äî Armon√≠a Natural üéµ')"><div style="background:#f5f2ec;height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">üåø</div><div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">Frecuencia ¬∑ 40 min</div><div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">Frecuencia 432Hz ‚Äî Armon√≠a Natural</div></div></div><div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.08)'" onmouseout="this.style.transform='';this.style.boxShadow=''" onclick="toast('Reproduciendo: Cuencos ‚Äî Nivel Terap√©utico üéµ')"><div style="background:#fdf0ee;height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">üî•</div><div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">Cuencos ¬∑ 45 min</div><div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">Cuencos ‚Äî Nivel Terap√©utico</div></div></div><div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.08)'" onmouseout="this.style.transform='';this.style.boxShadow=''" onclick="toast('Reproduciendo: UCDM ‚Äî Introducci√≥n al Perd√≥n üéµ')"><div style="background:#fdf6ec;height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">üí´</div><div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">Teor√≠a ¬∑ 28 min</div><div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">UCDM ‚Äî Introducci√≥n al Perd√≥n</div></div></div><div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.08)'" onmouseout="this.style.transform='';this.style.boxShadow=''" onclick="toast('Reproduciendo: Dzogchen ‚Äî Introducci√≥n a Rigpa üéµ')"><div style="background:#eef3fb;height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">üîµ</div><div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">Teor√≠a ¬∑ 35 min</div><div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">Dzogchen ‚Äî Introducci√≥n a Rigpa</div></div></div><div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.08)'" onmouseout="this.style.transform='';this.style.boxShadow=''" onclick="toast('Reproduciendo: Frecuencia 963Hz ‚Äî La Luz üéµ')"><div style="background:#eef3fb;height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">‚ú®</div><div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">Frecuencia ¬∑ 48 min</div><div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">Frecuencia 963Hz ‚Äî La Luz</div></div></div></div>
      </div>

      <!-- MATERIALES VIEW -->
      <div id="view-materiales" style="display:none">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:8px">Materiales PDF</h2>
        <p style="color:#7a7168;font-size:14px;margin-bottom:28px">Descarga o visualiza los libros y documentos de tu programa</p>
        <div id="materiales-content"></div>
      </div>

      <!-- PROGRESO VIEW -->
      <div id="view-progreso" style="display:none">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:20px">Mi Progreso</h2>
        <div id="progreso-list"></div>
      </div>

    </div>
  </div>
</div><!-- /page-student -->

<!-- MODAL SEMANA -->
<div class="modal-overlay" id="week-modal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-header-left">
        <div class="modal-week-badge" id="modal-badge">üìö</div>
        <div>
          <div class="modal-title" id="modal-title">Semana</div>
          <div class="modal-puerta-tag" id="modal-puerta"></div>
        </div>
      </div>
      <button class="modal-close" onclick="closeModal()">‚úï</button>
    </div>
    <div class="modal-layout">
      <!-- Sidebar navegaci√≥n -->
      <div class="modal-sidebar">
        <button class="modal-nav-btn active" onclick="switchModalTab(0,this)" data-tab="0">
          <span class="modal-nav-icon">üìñ</span>Descripci√≥n
        </button>
        <button class="modal-nav-btn" onclick="switchModalTab(1,this)" data-tab="1">
          <span class="modal-nav-icon">üí°</span>Conceptos
        </button>
        <button class="modal-nav-btn" onclick="switchModalTab(2,this)" data-tab="2">
          <span class="modal-nav-icon">üßò</span>Ejercicio
        </button>
        <button class="modal-nav-btn" onclick="switchModalTab(3,this)" data-tab="3">
          <span class="modal-nav-icon">üìÑ</span>Materiales
        </button>
        <button class="modal-nav-btn" onclick="switchModalTab(4,this)" data-tab="4">
          <span class="modal-nav-icon">‚úÖ</span>Completar
        </button>
      </div>
      <!-- Contenido -->
      <div class="modal-body">
        <div id="modal-content"></div>
      </div>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
// ‚îÄ‚îÄ CONFIG SUPABASE ‚îÄ‚îÄ
const SB_URL  = 'https://jtwbbyjspanirbsuoipa.supabase.co';
const SB_ANON = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0d2JieWpzcGFuaXJic3VvaXBhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1MjcwMTMsImV4cCI6MjA4NzEwMzAxM30.EnKFo0Hedbhja3Lgy0FR99U9FACY6ZyoadnteoyONns';

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
let sb = null;
let user = null;
let completedWeeks = [];
let currentWeek = 1;
let currentFilter = 'all';
let weekData = {};

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
window.addEventListener('DOMContentLoaded', function() {
  // Init Supabase
  if (window.supabase) {
    sb = window.supabase.createClient(SB_URL, SB_ANON);
    sb.auth.onAuthStateChange(function(event, session) {
      if (event === 'SIGNED_IN' && session) onLogin(session.user);
      if (event === 'SIGNED_OUT') onLogout();
    });
    sb.auth.getSession().then(function(r) {
      if (r.data.session) onLogin(r.data.session.user);
    });
  }
  renderWeeks();
  renderMedia();
});

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ
function goTo(page) {
  document.querySelectorAll('.page').forEach(function(p){ p.classList.remove('active'); });
  var newPage = document.getElementById('page-' + page);
  newPage.classList.add('active');
  // Maintain sidebar push if open
  var sb = document.getElementById('wixSideBar');
  if(sb && sb.style.display !== 'none') {
    var p2 = document.getElementById('wixPanel2');
    var isWide = p2 && p2.style.display !== 'none';
    newPage.classList.add(isWide ? 'sb-pushed-wide' : 'sb-pushed');
  }
  window.scrollTo(0,0);
  if (page === 'student') refreshDashboard();
}

function showView(view) {
  ['dashboard','formaciones','multimedia','materiales','progreso'].forEach(function(v){
    document.getElementById('view-' + v).style.display = v === view ? 'block' : 'none';
  });
  document.querySelectorAll('.nav-item').forEach(function(btn){
    btn.classList.remove('active');
  });
  event.currentTarget.classList.add('active');
  if (view === 'progreso') renderProgreso();
  if (view === 'materiales') renderMateriales();
}

// ‚îÄ‚îÄ AUTH ‚îÄ‚îÄ
function switchTab(tab) {
  document.getElementById('form-login').style.display = tab === 'login' ? 'block' : 'none';
  document.getElementById('form-register').style.display = tab === 'register' ? 'block' : 'none';
  document.getElementById('tab-login').classList.toggle('active', tab === 'login');
  document.getElementById('tab-register').classList.toggle('active', tab === 'register');
}

async function doLogin() {
  const email = document.getElementById('inp-email').value.trim();
  const pass  = document.getElementById('inp-pass').value;
  if (!email || !pass) { toast('Completa email y contrase√±a'); return; }

  const btn = document.getElementById('btn-login');
  btn.textContent = 'Conectando...';
  btn.disabled = true;

  try {
    if (sb) {
      const { data, error } = await sb.auth.signInWithPassword({ email, password: pass });
      if (error) throw error;
    } else {
      // Demo fallback
      if (email !== 'test@frecuenciaintegral.com') throw new Error('Email incorrecto');
      if (pass !== 'TestUser2026!') throw new Error('Contrase√±a incorrecta');
      user = { id: 'demo', email, user_metadata: { full_name: 'Alumno TCT' } };
      onLogin(user);
    }
  } catch(e) {
    // Fallback demo
    if (email === 'test@frecuenciaintegral.com' && pass === 'TestUser2026!') {
      user = { id: 'demo', email, user_metadata: { full_name: 'Alumno TCT' } };
      onLogin(user);
    } else {
      toast('Error: ' + e.message);
    }
  }

  btn.textContent = 'Entrar al √Årea de Alumnos';
  btn.disabled = false;
}

async function doRegister() {
  const name  = document.getElementById('inp-name').value.trim();
  const email = document.getElementById('inp-reg-email').value.trim();
  const pass  = document.getElementById('inp-reg-pass').value;
  if (!name || !email || !pass) { toast('Completa todos los campos'); return; }
  if (pass.length < 8) { toast('Contrase√±a m√≠nimo 8 caracteres'); return; }

  const btn = document.getElementById('btn-register');
  btn.textContent = 'Creando cuenta...';
  btn.disabled = true;

  try {
    if (sb) {
      const { error } = await sb.auth.signUp({ email, password: pass, options: { data: { full_name: name } } });
      if (error) throw error;
      toast('Revisa tu email para confirmar la cuenta ‚úâÔ∏è');
    }
  } catch(e) {
    toast('Error: ' + e.message);
  }

  btn.textContent = 'Crear Cuenta';
  btn.disabled = false;
}

// ‚îÄ‚îÄ ADMIN EMAILS (solo administradores reales) ‚îÄ‚îÄ
const ADMIN_EMAILS = ['quico@frecuenciaintegral.com', 'admin@frecuenciaintegral.com'];

async function onLogin(u) {
  user = u;
  const name = u.user_metadata?.full_name || u.email.split('@')[0];

  // Cargar perfil completo (role + plan)
  let userRole = 'alumno';
  let userPlan = 'Blanca';
  if (sb && u.id !== 'demo') {
    try {
      const { data: profile } = await sb.from('profiles').select('role, plan').eq('id', u.id).single();
      if (profile) {
        userRole = profile.role || 'alumno';
        userPlan = profile.plan || 'Blanca';
      }
    } catch(e) { console.log('No profile yet'); }
  }

  const isAdmin = userRole === 'admin' || ADMIN_EMAILS.includes(u.email);

  // Cargar progreso
  if (sb && u.id !== 'demo') {
    try {
      const { data } = await sb.from('user_progress').select('week_number,status').eq('user_id', u.id);
      if (data) {
        completedWeeks = data.filter(function(p){ return p.status === 'completed'; }).map(function(p){ return p.week_number; });
        const inProg = data.find(function(p){ return p.status === 'in_progress'; });
        currentWeek = inProg ? inProg.week_number : (completedWeeks.length + 1);
      }
    } catch(e) { console.log('No progress table yet'); }
  }

  // Guardar plan en estado global
  user._plan = userPlan;
  user._role = userRole;

  // Actualizar sidebar
  document.getElementById('sb-name').textContent = name;
  document.getElementById('sb-email').textContent = u.email;
  document.getElementById('sb-plan').textContent = '‚ú® Puerta ' + userPlan;
  document.getElementById('sb-plan').style.background = 
    userPlan === 'Oro' ? '#b89558' :
    userPlan === 'Arcoiris' ? '#7b4fa6' :
    userPlan === 'Azul' ? '#2c5f9e' :
    userPlan === 'Roja' ? '#bf4637' : '#8a8078';

  document.getElementById('btnLogin').style.display = 'none';
  document.getElementById('btnInscribirse').style.display = 'none';
  document.getElementById('btnDash').style.display = '';
  document.getElementById('btnLogout').style.display = '';
  document.getElementById('btnAdmin').style.display = isAdmin ? '' : 'none';

  goTo('student');
  toast('Bienvenido/a, ' + name + '! ‚ú®');
}

function onLogout() {
  user = null;
  completedWeeks = [];
  currentWeek = 1;
  document.getElementById('btnLogin').style.display = '';
  document.getElementById('btnInscribirse').style.display = '';
  document.getElementById('btnDash').style.display = 'none';
  document.getElementById('btnLogout').style.display = 'none';
  document.getElementById('btnAdmin').style.display = 'none';
}

async function doLogout() {
  if (sb) await sb.auth.signOut();
  onLogout();
  goTo('public');
  toast('Sesi√≥n cerrada');
}

// ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ
function refreshDashboard() {
  const name = user ? (user.user_metadata?.full_name || user.email.split('@')[0]) : 'Alumno';
  document.getElementById('dash-name').textContent = name;
  const pct = Math.round((completedWeeks.length / 48) * 100);
  document.getElementById('stat-progreso').textContent = pct + '%';
  document.getElementById('stat-sub-progreso').textContent = completedWeeks.length + ' de 48 semanas';
  document.getElementById('stat-semana').textContent = currentWeek;
  const puerta = currentWeek <= 12 ? 'üåø Blanca' : currentWeek <= 24 ? 'üî• Roja' : currentWeek <= 36 ? 'üîµ Azul' : 'üåà Arcoiris';
  document.getElementById('stat-puerta').textContent = puerta;
  renderWeeks();
}

// ‚îÄ‚îÄ WEEKS ‚îÄ‚îÄ
const WEEKS_DATA = [
  {w:1,p:'Blanca',t:'El Precio Oculto de Vivir Acelerados'},
  {w:2,p:'Blanca',t:'Cuando Ganar Ya No Es Suficiente'},
  {w:3,p:'Blanca',t:'Cuerpo, Mente y Consciencia: Una Sola Unidad'},
  {w:4,p:'Blanca',t:'El Ego en la Vida Cotidiana'},
  {w:5,p:'Blanca',t:'La Emoci√≥n, el Error y la Presi√≥n como Camino'},
  {w:6,p:'Blanca',t:'El Entrenamiento como V√≠a de Despertar'},
  {w:7,p:'Blanca',t:'El Campo de Consciencia Compartido'},
  {w:8,p:'Blanca',t:'Sonido, Vibraci√≥n y Armonizaci√≥n del Sistema'},
  {w:9,p:'Blanca',t:'Cuando el Sistema No Sostiene lo que Promete'},
  {w:10,p:'Blanca',t:'El L√≠mite como Punto de Despertar'},
  {w:11,p:'Blanca',t:'M√°s All√° del Resultado: El Sentido del Camino'},
  {w:12,p:'Blanca',t:'Integraci√≥n de la Puerta Blanca'},
  {w:13,p:'Roja',t:'Introducci√≥n a la Puerta Roja y la Energ√≠a'},
  {w:14,p:'Roja',t:'El Sonido Primordial y los Mantras'},
  {w:15,p:'Roja',t:'Los 6 Reinos del Samsara y la Gesti√≥n Emocional'},
  {w:16,p:'Roja',t:'El Cuarto Camino - Recuerdo de S√≠ y Observaci√≥n'},
  {w:17,p:'Roja',t:'El Cuarto Camino - Trabajo sobre los Centros'},
  {w:18,p:'Roja',t:'UCDM - La Paradoja de la Felicidad y el Perd√≥n'},
  {w:19,p:'Roja',t:'UCDM - Gesti√≥n Emocional y el Instante Santo'},
  {w:20,p:'Roja',t:'Protocolos de Sonido - Purificar el Samsara'},
  {w:21,p:'Roja',t:'Protocolos de Sonido - El Pilar del Medio'},
  {w:22,p:'Roja',t:'Alquimia de la Energ√≠a - La Cruz Cabal√≠stica'},
  {w:23,p:'Roja',t:'La F√≥rmula de la Felicidad - Aceptaci√≥n'},
  {w:24,p:'Roja',t:'Integraci√≥n de la Puerta Roja'},
  {w:25,p:'Azul',t:'Introducci√≥n a la Puerta Azul y la Mente'},
  {w:26,p:'Azul',t:'La Mente seg√∫n Diversas Tradiciones'},
  {w:27,p:'Azul',t:'Dzogchen - La Mente Natural (Rigpa)'},
  {w:28,p:'Azul',t:'La Met√°fora del Espejo y la Visi√≥n No-Dual'},
  {w:29,p:'Azul',t:'UCDM en la Puerta Azul - El Testigo Santo'},
  {w:30,p:'Azul',t:'El Ser Consciente - Vivir con Presencia'},
  {w:31,p:'Azul',t:'Protocolos de Sonido - Desintoxicaci√≥n'},
  {w:32,p:'Azul',t:'Objetos Sagrados y el Proceso de Liberaci√≥n'},
  {w:33,p:'Azul',t:'Manifestar la Fuerza Interior'},
  {w:34,p:'Azul',t:'Transformaci√≥n de la Mente para la Felicidad'},
  {w:35,p:'Azul',t:'La Noche Oscura del Alma'},
  {w:36,p:'Azul',t:'Integraci√≥n de la Puerta Azul'},
  {w:37,p:'Arcoiris',t:'S√≠ntesis del M√©todo TCT - Las Tres Puertas'},
  {w:38,p:'Arcoiris',t:'La Alquimia del Ser'},
  {w:39,p:'Arcoiris',t:'El Campo Invisible que Todos Sostenemos'},
  {w:40,p:'Arcoiris',t:'Pr√°ctica Integrada - El Diario del Cuarto Camino'},
  {w:41,p:'Arcoiris',t:'Pr√°ctica Integrada - El Diario del Perd√≥n'},
  {w:42,p:'Arcoiris',t:'Pr√°ctica Integrada - El Diario de la Mente Feliz'},
  {w:43,p:'Arcoiris',t:'El Arte de la No-Interferencia'},
  {w:44,p:'Arcoiris',t:'El Legado Invisible - La Vida como Servicio'},
  {w:45,p:'Arcoiris',t:'La Comunicaci√≥n desde la Fuente'},
  {w:46,p:'Arcoiris',t:'Maestr√≠a en la Vida Cotidiana'},
  {w:47,p:'Arcoiris',t:'El Ciclo Permanente - La Espiral de Transformaci√≥n'},
  {w:48,p:'Arcoiris',t:'Cierre y Continuaci√≥n del Camino'}
];

function renderWeeks() {
  const grid = document.getElementById('weeks-grid');
  if (!grid) return;
  const filtered = currentFilter === 'all' ? WEEKS_DATA : WEEKS_DATA.filter(function(w){ return w.p === currentFilter; });
  grid.innerHTML = filtered.map(function(w) {
    const done = completedWeeks.includes(w.w);
    const cur  = w.w === currentWeek;
    const icon = done ? '‚úÖ' : cur ? '‚ñ∂' : '‚óã';
    const cls  = done ? 'week-card completed' : cur ? 'week-card in-progress' : 'week-card';
    return '<div class="' + cls + '" onclick="openWeekModal(' + w.w + ')">' +
      '<div class="week-num">Semana ' + w.w + ' ¬∑ ' + icon + '</div>' +
      '<div class="week-title">' + w.t + '</div>' +
      '<div class="week-status" style="color:' + (done?'#2b7d7a':cur?'#b89558':'#a89e93') + '">' +
      (done ? 'Completada' : cur ? 'En curso' : 'Pendiente') + '</div>' +
    '</div>';
  }).join('');
}

function filterWeeks(puerta, btn) {
  currentFilter = puerta;
  document.querySelectorAll('.filter-btn').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
  renderWeeks();
}

// ‚îÄ‚îÄ WEEK MODAL ‚îÄ‚îÄ
let currentModalWeek = null;

function openWeekModal(weekNum) {
  currentModalWeek = weekNum;
  const w = WEEKS_DATA.find(function(x){ return x.x === weekNum; }) || WEEKS_DATA[weekNum-1];
  const done = completedWeeks.includes(weekNum);
  const colors = {Blanca:'#b8ad9e',Roja:'#bf4637',Azul:'#2c5f9e',Arcoiris:'#7b4fa6'};
  const color = colors[w.p] || '#2b7d7a';

  document.getElementById('modal-title').textContent = 'Semana ' + weekNum + ': ' + w.t;
  document.getElementById('modal-puerta').textContent = '‚ú¶ Puerta ' + w.p + (done ? ' ¬∑ ‚úÖ Completada' : '');

  // Get exercise data from global if available
  const d = (typeof WD !== 'undefined') ? WD[weekNum] : null;

  const tabs = [
    // Tab 0: Descripci√≥n
    '<div style="background:#f7f5f1;border-radius:12px;padding:20px;border-left:3px solid ' + color + '">' +
    '<div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:10px">Material de Estudio</div>' +
    '<p style="font-size:14px;line-height:1.75;color:#3d3730">' + (d ? d.m : 'Contenido de la semana ' + weekNum + '.') + '</p></div>',

    // Tab 1: Conceptos
    d && d.c && d.c.length > 0
      ? d.c.map(function(c){ return '<div class="concept-card" style="border-color:' + color + '"><div class="concept-name">' + c[0] + '</div><div class="concept-desc">' + c[1] + '</div></div>'; }).join('')
      : '<p style="color:#7a7168;font-size:14px">Conceptos clave de la semana ' + weekNum + '.</p>',

    // Tab 2: Ejercicio
    (function() {
      if (!d || !d.et) return '<p style="color:#7a7168;font-size:14px">Ejercicio pr√°ctico de la semana ' + weekNum + '.</p>';
      return '<div style="background:linear-gradient(135deg,' + color + '18,' + color + '08);border:1px solid ' + color + '30;border-radius:14px;padding:20px;margin-bottom:20px">' +
        '<div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:8px">‚ú¶ Ejercicio Pr√°ctico</div>' +
        '<div style="font-family:\'Cormorant Garamond\',serif;font-size:18px;font-weight:400;margin-bottom:10px">' + d.et + '</div>' +
        (d.eo ? '<div style="font-size:13px;color:#3d3730;font-style:italic">Objetivo: ' + d.eo + '</div>' : '') +
        (d.er ? '<div style="font-size:11px;color:#a89e93;margin-top:8px">üìö ' + d.er + '</div>' : '') +
        '</div>' +
        (d.ep && d.ep.length > 0 ? '<div>' + d.ep.map(function(p,i){ return '<div class="exercise-step"><div class="step-num">' + (i+1) + '</div><div class="step-text">' + p + '</div></div>'; }).join('') + '</div>' : '');
    })(),

    // Tab 3: Materiales PDF
    (function() {
      var pdfs = MATERIALES[w.p] ? MATERIALES[w.p].pdfs : [];
      if (pdfs.length === 0) return '<p style="color:#7a7168;font-size:14px">No hay materiales para esta puerta.</p>';
      var mcolor = MATERIALES[w.p] ? MATERIALES[w.p].color : '#2b7d7a';
      return '<div style="margin-bottom:12px;font-size:12px;color:#7a7168">Materiales de la <strong>Puerta ' + w.p + '</strong></div>' +
        pdfs.map(function(pdf, i) {
          var mid = 'modal-pdf-' + weekNum + '-' + i;
          return '<div class="pdf-card">' +
            '<div class="pdf-card-header" onclick="togglePdfViewer(\'' + mid + '\')">' +
              '<div class="pdf-icon">üìÑ</div>' +
              '<div class="pdf-info"><div class="pdf-name" style="font-size:13px">' + pdf.name + '</div><div class="pdf-meta">PDF ¬∑ Haz clic para ver</div></div>' +
              '<div class="pdf-actions">' +
                '<button class="btn-pdf-view" onclick="event.stopPropagation();togglePdfViewer(\'' + mid + '\')">üëÅ Ver</button>' +
                '<a class="btn-pdf-dl" href="' + pdf.url + '" download target="_blank" onclick="event.stopPropagation()">‚¨á</a>' +
              '</div>' +
            '</div>' +
            '<div class="pdf-viewer-wrap" id="' + mid + '">' +
              '<div class="pdf-viewer-bar"><span>' + pdf.name + '</span><button class="btn-pdf-close" onclick="togglePdfViewer(\'' + mid + '\')">‚úï</button></div>' +
              '<iframe src="" data-src="' + pdf.url + '" loading="lazy"></iframe>' +
            '</div>' +
          '</div>';
        }).join('');
    })(),

    // Tab 4: Completar
    '<div>' +
    ['He le√≠do el material de estudio','He realizado el ejercicio pr√°ctico','He escuchado el audio de la semana','He anotado mis reflexiones'].map(function(t,i){
      return '<div class="task-item" id="task-' + weekNum + '-' + i + '" onclick="toggleTask(' + weekNum + ',' + i + ')"><div class="task-cb"></div><div class="task-text">' + t + '</div></div>';
    }).join('') +
    '<button class="btn-complete" onclick="markComplete(' + weekNum + ')" ' + (done ? 'disabled style="background:#d1c8bc"' : '') + '>' +
    (done ? '‚úÖ Semana Completada' : '‚ú¶ Marcar como Completada') + '</button></div>'
  ];

  document.getElementById('modal-content').innerHTML =
    tabs.map(function(content, i){ return '<div class="tab-content ' + (i===0?'active':'') + '" id="modal-tab-' + i + '">' + content + '</div>'; }).join('');

  // Set badge icon
  const icons = {Blanca:'üåø', Roja:'üî•', Azul:'üîµ', Arcoiris:'üåà'};
  const badgeColors = {Blanca:'#f0ede8', Roja:'#fdecea', Azul:'#e8eef8', Arcoiris:'#f3edf8'};
  document.getElementById('modal-badge').textContent = icons[w.p] || 'üìö';
  document.getElementById('modal-badge').style.background = badgeColors[w.p] || '#e8f4f3';

  // Reset sidebar nav
  document.querySelectorAll('.modal-nav-btn').forEach(function(t,i){ t.classList.toggle('active', i===0); });
  document.getElementById('week-modal').classList.add('open');
}

function closeModal() {
  document.getElementById('week-modal').classList.remove('open');
}

function switchModalTab(idx, btn) {
  document.querySelectorAll('.tab-content').forEach(function(t){ t.classList.remove('active'); });
  document.getElementById('modal-tab-' + idx).classList.add('active');
  document.querySelectorAll('.modal-nav-btn').forEach(function(t){ t.classList.remove('active'); });
  btn.classList.add('active');
}

function toggleTask(weekNum, idx) {
  document.getElementById('task-' + weekNum + '-' + idx).classList.toggle('done');
}

async function markComplete(weekNum) {
  const w = WEEKS_DATA[weekNum-1];
  if (sb && user && user.id !== 'demo') {
    try {
      await sb.from('user_progress').upsert({
        user_id: user.id, week_number: weekNum,
        puerta: w.p, status: 'completed',
        completion_percentage: 100,
        completed_at: new Date().toISOString()
      }, { onConflict: 'user_id,week_number' });
      if (weekNum < 48) {
        await sb.from('user_progress').upsert({
          user_id: user.id, week_number: weekNum+1,
          puerta: WEEKS_DATA[weekNum].p, status: 'in_progress',
          completion_percentage: 0
        }, { onConflict: 'user_id,week_number' });
      }
    } catch(e) { console.log('Error saving:', e); }
  }
  if (!completedWeeks.includes(weekNum)) completedWeeks.push(weekNum);
  if (weekNum === currentWeek && currentWeek < 48) currentWeek++;
  closeModal();
  refreshDashboard();
  toast('Semana ' + weekNum + ' completada! üéâ');
}

// ‚îÄ‚îÄ MATERIALES PDF ‚îÄ‚îÄ
const MATERIALES = {
  'Blanca': {
    icon: 'üåø', color: '#b8ad9e',
    pdfs: [
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20%20BLANCA/El-deportista-consciente-Mas-alla-del-resultado.pdf' },
      { name: 'TCT-I ‚Äî Puerta Blanca', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20%20BLANCA/TCT-I-PUERTA-BLANCA.pdf' }
    ]
  },
  'Roja': {
    icon: 'üî•', color: '#bf4637',
    pdfs: [
      { name: 'TCT-II ‚Äî Puerta Roja', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ROJA/TCT-II-PUERTA-ROJA.pdf' },
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ROJA/El-deportista-consciente-Mas-alla-del-resultado.pdf' },
      { name: 'El Ser Consciente ‚Äî M√°s all√° de la acci√≥n', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ROJA/El-Ser-Consciente-Mas-alla-de-la-accion-Vivir-con-presencia-en-la-vida-cotidiana.pdf' }
    ]
  },
  'Azul': {
    icon: 'üîµ', color: '#2c5f9e',
    pdfs: [
      { name: 'TCT-III ‚Äî Puerta Azul', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20AZUL/TCT-III-PUERTA-AZUL.pdf' },
      { name: 'TCT-IV ‚Äî Anexos', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20AZUL/TCT-IV-PUERTA-ANEXOS.pdf' },
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20AZUL/El-deportista-consciente-Mas-alla-del-resultado.pdf' },
      { name: 'El Ser Consciente ‚Äî M√°s all√° de la acci√≥n', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20AZUL/El-Ser-Consciente-Mas-alla-de-la-accion-Vivir-con-presencia-en-la-vida-cotidiana.pdf' }
    ]
  },
  'Arcoiris': {
    icon: 'üåà', color: '#7b4fa6',
    pdfs: [
      { name: 'TCT-I ‚Äî Puerta Blanca', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-I-PUERTA-BLANCA.pdf' },
      { name: 'TCT-II ‚Äî Puerta Roja', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-II-PUERTA-ROJA.pdf' },
      { name: 'TCT-III ‚Äî Puerta Azul', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-III-PUERTA-AZUL.pdf' },
      { name: 'TCT-IV ‚Äî Anexos', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-IV-PUERTA-ANEXOS.pdf' },
      { name: 'El Ser Consciente ‚Äî M√°s all√° de la acci√≥n', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/El-Ser-Consciente-Mas-alla-de-la-accion-Vivir-con-presencia-en-la-vida-cotidiana.pdf' },
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/El-deportista-consciente-Mas-alla-del-resultado.pdf' }
    ]
  },
  'Oro': {
    icon: '‚ú®', color: '#b89558',
    pdfs: [
      { name: 'TCT-I ‚Äî Puerta Blanca', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-I-PUERTA-BLANCA.pdf' },
      { name: 'TCT-II ‚Äî Puerta Roja', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-II-PUERTA-ROJA.pdf' },
      { name: 'TCT-III ‚Äî Puerta Azul', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-III-PUERTA-AZUL.pdf' },
      { name: 'TCT-IV ‚Äî Anexos', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-IV-PUERTA-ANEXOS.pdf' },
      { name: 'El Ser Consciente ‚Äî M√°s all√° de la acci√≥n', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/El-Ser-Consciente-Mas-alla-de-la-accion-Vivir-con-presencia-en-la-vida-cotidiana.pdf' },
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/El-deportista-consciente-Mas-alla-del-resultado.pdf' },
      { name: 'Presentaci√≥n PDL ‚Äî Arte y Espiritualidad', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ORO/PRESENTACION-PDL-ARTE-Y-ESPIRITUALIDAD.pdf' }
    ]
  }
};

var _pdfViewerOpen = {};

function renderMateriales() {
  var puertaActual = currentWeek <= 12 ? 'Blanca' : currentWeek <= 24 ? 'Roja' : currentWeek <= 36 ? 'Azul' : 'Arcoiris';
  var puertas = ['Blanca','Roja','Azul','Arcoiris','Oro'];
  var html = '';
  puertas.forEach(function(p) {
    var m = MATERIALES[p];
    var pdfsHtml = m.pdfs.map(function(pdf, i) {
      var id = 'pdf-' + p + '-' + i;
      var shortName = pdf.name.length > 50 ? pdf.name.substring(0,48)+'‚Ä¶' : pdf.name;
      return '<div class="pdf-card">' +
        '<div class="pdf-card-header" onclick="togglePdfViewer(\'' + id + '\')">' +
          '<div class="pdf-icon">üìÑ</div>' +
          '<div class="pdf-info"><div class="pdf-name">' + shortName + '</div><div class="pdf-meta">PDF ¬∑ Haz clic para ver</div></div>' +
          '<div class="pdf-actions">' +
            '<button class="btn-pdf-view" onclick="event.stopPropagation();togglePdfViewer(\'' + id + '\')">üëÅ Ver</button>' +
            '<a class="btn-pdf-dl" href="' + pdf.url + '" download target="_blank" onclick="event.stopPropagation()">‚¨á Descargar</a>' +
          '</div>' +
        '</div>' +
        '<div class="pdf-viewer-wrap" id="' + id + '">' +
          '<div class="pdf-viewer-bar"><span>' + pdf.name + '</span><button class="btn-pdf-close" onclick="togglePdfViewer(\'' + id + '\')">‚úï</button></div>' +
          '<iframe src="" data-src="' + pdf.url + '" loading="lazy"></iframe>' +
        '</div>' +
      '</div>';
    }).join('');
    html += '<div class="materiales-puerta">' +
      '<div class="materiales-puerta-title" style="color:' + m.color + '">' +
        '<span style="font-size:22px">' + m.icon + '</span> Puerta ' + p +
      '</div>' +
      pdfsHtml +
    '</div>';
  });
  document.getElementById('materiales-content').innerHTML = html;
}

function togglePdfViewer(id) {
  // Find the iframe data-src from the inline viewer (kept in DOM but hidden)
  var wrap = document.getElementById(id);
  var iframe = wrap ? wrap.querySelector('iframe') : null;
  var url = iframe ? iframe.getAttribute('data-src') : null;
  // Find name from the card
  var card = wrap ? wrap.closest('.pdf-card') : null;
  var name = card ? card.querySelector('.pdf-name').textContent : 'Documento PDF';
  if (url) openPdfFullscreen(url, name);
}

function openPdfFullscreen(url, name) {
  document.getElementById('pdf-fullscreen-name').textContent = name;
  document.getElementById('pdf-fullscreen-frame').src = url;
  document.getElementById('pdf-fullscreen-dl').href = url;
  document.getElementById('pdf-fullscreen-modal').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closePdfFullscreen() {
  document.getElementById('pdf-fullscreen-modal').classList.remove('open');
  document.getElementById('pdf-fullscreen-frame').src = '';
  document.body.style.overflow = '';
}

// Close on Escape key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') closePdfFullscreen();
});

// ‚îÄ‚îÄ MULTIMEDIA ‚îÄ‚îÄ
function renderMedia() {
  const items = [
    {icon:'üéµ',title:'Cuencos Tibetanos ‚Äî Fundamentos',cat:'Cuencos',dur:'32 min',bg:'#f5f2ec'},
    {icon:'üå∏',title:'Canalizaci√≥n Marga ‚Äî Puerta Blanca',cat:'Canalizaci√≥n',dur:'18 min',bg:'#fdf0ee'},
    {icon:'üßò',title:'Meditaci√≥n de Presencia Corporal',cat:'Meditaci√≥n',dur:'15 min',bg:'#eef3fb'},
    {icon:'üåø',title:'Frecuencia 432Hz ‚Äî Armon√≠a Natural',cat:'Frecuencia',dur:'40 min',bg:'#f5f2ec'},
    {icon:'üî•',title:'Cuencos ‚Äî Nivel Terap√©utico',cat:'Cuencos',dur:'45 min',bg:'#fdf0ee'},
    {icon:'üí´',title:'UCDM ‚Äî Introducci√≥n al Perd√≥n',cat:'Teor√≠a',dur:'28 min',bg:'#fdf6ec'},
    {icon:'üîµ',title:'Dzogchen ‚Äî Introducci√≥n a Rigpa',cat:'Teor√≠a',dur:'35 min',bg:'#eef3fb'},
    {icon:'‚ú®',title:'Frecuencia 963Hz ‚Äî La Luz',cat:'Frecuencia',dur:'48 min',bg:'#eef3fb'},
  ];
  const grid = document.getElementById('media-grid');
  if (!grid) return;
  grid.innerHTML = items.map(function(m){
    return '<div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform=\'translateY(-3px)\';this.style.boxShadow=\'0 8px 24px rgba(0,0,0,.08)\'" onmouseout="this.style.transform=\'\';this.style.boxShadow=\'\'" onclick="toast(\'Reproduciendo: ' + m.title + ' üéµ\')">' +
      '<div style="background:' + m.bg + ';height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">' + m.icon + '</div>' +
      '<div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">' + m.cat + ' ¬∑ ' + m.dur + '</div>' +
      '<div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">' + m.title + '</div></div></div>';
  }).join('');
}

// ‚îÄ‚îÄ PROGRESO ‚îÄ‚îÄ
function renderProgreso() {
  const puertas = [
    {name:'Blanca',icon:'üåø',color:'#b8ad9e',weeks:[1,2,3,4,5,6,7,8,9,10,11,12]},
    {name:'Roja',icon:'üî•',color:'#bf4637',weeks:[13,14,15,16,17,18,19,20,21,22,23,24]},
    {name:'Azul',icon:'üîµ',color:'#2c5f9e',weeks:[25,26,27,28,29,30,31,32,33,34,35,36]},
    {name:'Arcoiris',icon:'üåà',color:'#7b4fa6',weeks:[37,38,39,40,41,42,43,44,45,46,47,48]},
  ];
  document.getElementById('progreso-list').innerHTML = puertas.map(function(p){
    const done = p.weeks.filter(function(w){ return completedWeeks.includes(w); }).length;
    const pct = Math.round((done/12)*100);
    return '<div style="background:white;border-radius:14px;padding:20px;margin-bottom:16px;border:1px solid #e4ddd3">' +
      '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">' +
      '<div style="display:flex;align-items:center;gap:10px"><span style="font-size:22px">' + p.icon + '</span>' +
      '<div><div style="font-weight:600;font-size:15px">Puerta ' + p.name + '</div>' +
      '<div style="font-size:12px;color:#7a7168">' + done + ' de 12 semanas completadas</div></div></div>' +
      '<div style="font-family:\'Cormorant Garamond\',serif;font-size:32px;font-weight:300">' + pct + '%</div></div>' +
      '<div style="background:#f0ece4;border-radius:100px;height:6px;overflow:hidden">' +
      '<div style="background:' + p.color + ';height:100%;width:' + pct + '%;border-radius:100px;transition:width .5s"></div></div>' +
      '</div>';
  }).join('');
}

// ‚îÄ‚îÄ STRIPE ‚îÄ‚îÄ
async function handlePurchase(planId) {
  if (!user) { goTo('auth'); return; }
  toast('Preparando pago...');
  try {
    const { data: { session } } = await sb.auth.getSession();
    const res = await fetch('https://jtwbbyjspanirbsuoipa.supabase.co/functions/v1/create-checkout', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + session.access_token },
      body: JSON.stringify({ plan_id: planId, success_url: location.href + '?paid=ok', cancel_url: location.href })
    });
    const d = await res.json();
    if (d.checkout_url) window.location.href = d.checkout_url;
    else toast('Error: ' + (d.error || 'Int√©ntalo de nuevo'));
  } catch(e) {
    toast('Configura Stripe para activar pagos');
  }
}

// Check stripe return
(function(){
  const p = new URLSearchParams(location.search);
  if (p.get('paid') === 'ok') setTimeout(function(){ toast('Pago completado! Acceso activado üéâ'); }, 500);
})();

// ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ
function toast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  setTimeout(function(){ el.classList.remove('show'); }, 3000);
}

var WD = {};
WD[1]={m:'Esta semana exploramos el estado de "sue√±o en movimiento" en el que vive la mayor√≠a de la gente, un estado de acci√≥n constante pero sin presencia real. Analizamos c√≥mo esta forma de vida conduce a la fragmentaci√≥n del yo, donde la identidad se construye alrededor de roles y funciones, y el "hacer" sustituye al "ser".',c:[['El Sue√±o en Movimiento','Actuar de forma autom√°tica, con la mente saltando de una cosa a otra, perdiendo la experiencia directa.'],['La Fragmentaci√≥n del Yo','La divisi√≥n interna en m√∫ltiples "yoes" (el yo del trabajo, el yo social, etc.) y la creencia de que somos uno de esos roles.'],['El Cuerpo como Espejo','El cuerpo no miente. Tensiones, dolores y fatiga son a menudo reflejos de una desalineaci√≥n interna y una falta de presencia.'],['El Ego como Guardi√°n','El ego protege una identidad construida y fr√°gil. No hay que combatirlo, sino observarlo para que pierda su rigidez.']],et:'Primer Reconocimiento de la Presencia',eo:'Realizar una pausa consciente para reconocer la presencia que ya est√° aqu√≠, sin fabricarla.',er:'"El Deportista Consciente", Cap. 1.9.',ep:['En alg√∫n momento del d√≠a, detente por unos instantes. No intentes relajarte ni concentrarte.','Simplemente observa: la respiraci√≥n tal como es, las sensaciones del cuerpo, los pensamientos que aparecen y se van.','Reconoce, sin buscarlo, que hay una  consciencia  que est√° percibiendo todo eso. No la analices.','Permanece unos segundos sin hacer nada con ello. Un instante de presencia real transforma m√°s que horas de acci√≥n inconsciente.']};
WD[2]={m:'Exploramos el "instante despu√©s" del logro, ese momento de vac√≠o que revela que el resultado externo no puede sostener el sentido de la vida de forma duradera. Analizamos la espiral de la "b√∫squeda que no descansa" (logro ‚Üí alivio ‚Üí vac√≠o ‚Üí nueva b√∫squeda) y el cansancio del sentido que esto genera.',c:[['El Instante Despu√©s','El vac√≠o que sigue al √©xito y que ense√±a sobre la naturaleza impermanente de lo condicionado.'],['El Yo que Nunca se Sacia','La identidad construida sobre el "hacer" siempre necesita m√°s para sentirse completa.'],['Del Logro a la Presencia','El giro radical donde el sentido deja de buscarse en el resultado y comienza a encontrarse en la calidad de presencia de la acci√≥n'],['La Verdadera Competici√≥n','No es contra otros, sino contra nuestros propios automatismos y el olvido de la presencia.']],et:'Habitar la Acci√≥n sin Buscar Completarte',eo:'Realizar una acci√≥n importante desde la presencia, sin pedirle que defina tu identidad.',er:'"El Deportista Consciente", Cap. 2.12.',ep:['Antes de una acci√≥n importante del d√≠a (una reuni√≥n, una conversaci√≥n, una decisi√≥n), detente unos instantes.','Reconoce el deseo de hacerlo bien y, si aparece, el miedo a fallar.','Preg√∫ntate en silencio: "¬øPuedo estar plenamente aqu√≠, aunque el resultado sea incierto?".','Siente el cuerpo. Siente la respiraci√≥n.','Permite que la acci√≥n ocurra sin pedirle que te defina. Un solo gesto vivido desde la presencia vale m√°s que mil acciones hechas desde la carencia.']};
WD[3]={m:'Esta semana abordamos la ilusi√≥n de la separaci√≥n entre cuerpo, mente y consciencia. Comprendemos que no son partes que deban coordinarse, sino una sola realidad que se manifiesta de diferentes formas. Cuando esta unidad se fragmenta, el rendimiento se resiente y aparece el desgaste.',c:[['La Ilusi√≥n de la Separaci√≥n','Vivir fragmentados (pensar una cosa, sentir otra, hacer una tercera) es la fuente de gran parte del malestar cotidiano.'],['El Cuerpo como Expresi√≥n de la Totalidad','Cada gesto y postura manifiesta el estado interior completo. Escuchar el cuerpo es habitarlo.'],['La Mente como Herramienta, no como Tirana','El problema no es pensar, sino vivir dominados por el pensamiento, perdiendo la experiencia directa.'],['Consciencia','El Elemento Olvidado:  Es el espacio vivo en el que todo ocurre. Recordarla no a√±ade nada, sino que despierta la experiencia.']],et:'Habitar la Unidad en el Movimiento',eo:'Realizar una acci√≥n sencilla permitiendo que la unidad cuerpo-mente-consciencia se manifieste naturalmente.',er:'"El Ser Consciente", Cap. 3.7.',ep:['Elige una acci√≥n sencilla del d√≠a: caminar, escribir, lavar los platos.','Antes de empezar, siente el cuerpo completo, reconoce la respiraci√≥n y observa la mente sin intervenir.','Realiza la acci√≥n sin a√±adir nada. No busques hacerlo mejor, permite hacerlo presente.','Observa si la calidad del gesto cambia, si el cuerpo se organiza solo, si el esfuerzo disminuye.']};
WD[4]={m:'El ego no es un enemigo, es una estructura necesaria. El conflicto surge de la identificaci√≥n con √©l. Esta semana, aprendemos a observar el ego sin juicio, reconociendo sus patrones y miedos. La presi√≥n del d√≠a a d√≠a es un campo privilegiado para esta observaci√≥n, ya que hace visible lo que normalmente se oculta.',c:[['Identificaci√≥n','El Verdadero Problema:  Creer que somos nuestros pensamientos, emociones o historia personal. Esto vuelve la vida fr√°gil y defensi'],['El Ego y el Miedo','El ego vive del miedo (a fallar, a no ser reconocido, a perder el control), que a menudo se disfraza de autoexigencia o necesidad '],['El Ego bajo Presi√≥n','La presi√≥n no crea el ego, lo muestra. Por eso es un campo de observaci√≥n tan valioso.'],['El Ego Observado desde la Presencia','Cuando el ego es observado, pierde rigidez. Entre el impulso y la reacci√≥n aparece un espacio de libertad.']],et:'Observar el Patr√≥n sin Nombrarlo',eo:'Observar una reacci√≥n egoica despu√©s de que ocurra, sin juicio ni an√°lisis, para debilitar el automatismo.',er:'"El Ser Consciente", Cap. 4.7.',ep:['Despu√©s de una situaci√≥n que te haya activado (una discusi√≥n, una cr√≠tica, un conflicto), recuerda el momento.','Observa la reacci√≥n interna: la direcci√≥n de la energ√≠a, la necesidad que apareci√≥ (controlar, defenderte, retirarte).','No le pongas nombre. No intentes corregirlo. No lo justifiques.','Simplemente permite que la memoria de la reacci√≥n est√© ah√≠, sin convertirla en tu identidad. Lo que se observa sin juicio, pierde poder.']};
WD[5]={m:'Cambiamos la mirada sobre la emoci√≥n, el error y la presi√≥n. En lugar de verlos como obst√°culos a evitar o controlar, los reconocemos como manifestaciones naturales de la experiencia y como portales hacia una mayor presencia. El sufrimiento no nace de estas experiencias, sino de la forma en que nos relacionamos con ellas.',c:[['La Emoci√≥n como Energ√≠a en Movimiento','El problema no es sentir, sino identificarse. Cuando una emoci√≥n es reconocida sin interferencia, se completa y se disuelve.'],['El Error como Colapso de la Ilusi√≥n de Control','El error interrumpe la narrativa del control y abre una puerta a la presencia desnuda, si no se vive desde la culpa o la defensa.'],['No-Rechazo y Autoliberaci√≥n','Rechazar la experiencia la fija. Reconocerla sin lucha permite que se libere por s√≠ misma.']],et:'Reconocer y Auto-liberar la Emoci√≥n',eo:'Permitir que una emoci√≥n intensa se mueva y se disuelva sin interferencia mental.',er:'"El Ser Consciente", Cap. 5.7.',ep:['La pr√≥xima vez que aparezca una emoci√≥n intensa, detente un instante.','No la nombres ni la expliques. Simplemente siente su energ√≠a en el cuerpo. Observa d√≥nde se manifiesta.','Reconoce el espacio de consciencia en el que esa emoci√≥n est√° apareciendo.','No hagas nada con ella. Permite que se mueva, cambie o se disuelva por s√≠ sola.']};
WD[6]={m:'La vida cotidiana, con su repetici√≥n, es el espejo m√°s preciso de nuestra forma de estar en el mundo. El entrenamiento diario, ya sea f√≠sico, profesional o personal, se convierte en una pr√°ctica consciente. La disciplina deja de ser rigidez y se transforma en un compromiso con la presencia.',c:[['La Repetici√≥n como Espejo','Lo que hacemos cada d√≠a revela nuestros automatismos, resistencias y zonas de ausencia.'],['Entrenar sin Estar Presente','El "hacer mec√°nico" produce resultados, pero tambi√©n desgaste y desconexi√≥n.'],['La Disciplina Consciente','No es una imposici√≥n externa, sino una alineaci√≥n interna. No te obligas, te recuerdas.'],['El Cansancio como Se√±al','A menudo no indica falta de descanso, sino desconexi√≥n prolongada.']],et:'Entrenar como si Fuera la Primera Vez',eo:'Romper el automatismo en una actividad habitual a trav√©s de la atenci√≥n plena.',er:'"El Deportista Consciente", Cap. 7.7.',ep:['Elige una actividad habitual que suelas hacer en autom√°tico (conducir, ducharte, una tarea repetitiva del trabajo).','Durante un d√≠a, decide hacerla con una atenci√≥n deliberada.','Real√≠zala un poco m√°s despacio. Observa cada gesto, cada sensaci√≥n.','Permanece curioso, como si fuera la primera vez que lo haces. No busques cambiarla, solo obs√©rvala. La frescura no est√° en lo nuevo, sino en la atenci√≥n.']};
WD[7]={m:'Nadie vive ni despierta aislado. La consciencia es relacional. Nuestras relaciones (familia, equipo, trabajo) son el camino, no un obst√°culo. Cada persona influye en el "campo invisible" del grupo con su estado interno. La presencia no es solo un acto interior, es un acto relacional.',c:[['El Mito del Individuo Aislado','La vida siempre ocurre en relaci√≥n. Pensamientos y emociones se contagian y amplifican en el campo colectivo.'],['El Ego Colectivo','Grupos, familias e ideolog√≠as construyen identidades compartidas ("nosotros" vs. "ellos") que ofrecen seguridad pero tambi√©n rigid'],['La Comunicaci√≥n como Pr√°ctica de Consciencia','Escuchar sin preparar respuesta, permitir silencios, hablar desde lo verdadero. La comunicaci√≥n consciente busca contacto, no conv']],et:'Habitar el Campo Colectivo con Presencia',eo:'Observar tu influencia en el campo relacional y practicar la presencia no impositiva.',er:'"El Ser Consciente", Cap. 8.11.',ep:['En tu pr√≥xima interacci√≥n grupal (una reuni√≥n de trabajo, una cena familiar), toma un momento para observar el "clima" del encuentro.','Reconoce tu propio estado interno (¬øtensi√≥n, apertura, defensa?).','Nota c√≥mo tu estado influye en el ambiente y c√≥mo el ambiente influye en ti.','No intentes cambiar a nadie ni dirigir la situaci√≥n. Simplemente, elige estar presente. Escucha m√°s. Habla menos. La presencia es contagiosa cuando no intenta imponerse.']};
WD[8]={m:'El ser humano es un campo vibracional. El sonido act√∫a directamente sobre este campo, ordenando desde la vibraci√≥n lo que la mente no puede corregir. Los cuencos tibetanos son herramientas de armonizaci√≥n profunda que facilitan la descarga de tensiones y el reordenamiento natural del sistema.',c:[['El Sonido como V√≠a Directa a la Presencia','El sonido rompe la continuidad del di√°logo interno y devuelve la atenci√≥n al presente sin necesidad de interpretaci√≥n.'],['Vibraci√≥n y Coherencia','El sonido influye en la respiraci√≥n, el tono corporal y la regulaci√≥n emocional, restableciendo la coherencia del sistema nervioso'],['El Sonido como Pr√°ctica de No-Hacer','Escuchar profundamente es una forma de no-hacer. La mente deja de intervenir y la consciencia se ampl√≠a.']],et:'Equilibrar la Energ√≠a con Cuencos',eo:'Utilizar el sonido de un cuenco para armonizar el campo energ√©tico.',er:'"TCT Puerta Blanca-Roja", p√°g. 51.',ep:['Si√©ntate o t√∫mbate en una posici√≥n c√≥moda.','Toma un cuenco tibetano. Si no tienes, puedes usar una grabaci√≥n de alta calidad.','Percute o fricciona el cuenco suavemente. Cierra los ojos.','En lugar de "escuchar" con los o√≠dos, siente la vibraci√≥n en tu cuerpo. Imagina que el sonido lava y limpia tu campo energ√©tico.','Sigue el sonido hasta que se desvanezca por completo en el silencio. Permanece en ese silencio unos instantes.']};
WD[9]={m:'A veces, la herida no es personal, sino sist√©mica. Exploramos la "herida invisible" que se genera cuando un sistema (laboral, familiar, social) promete algo que no sostiene, creando una incoherencia que afecta a la identidad y la confianza del individuo.',c:[['La Promesa como Acto de Poder','Las promesas organizan la conducta, pero cuando no se sostienen en la realidad, generan p√©rdida de confianza.'],['La Herida Invisible','Sensaci√≥n persistente de no ser suficiente, miedo a fallar, desconfianza. La persona internaliza como culpa lo que es un fallo est'],['Transformar la Herida sin Negarla','Sanar no es borrar, es integrar. La herida reconocida puede volverse sensibilidad y comprensi√≥n.']],et:'Distinguir el Hecho de la Herida',eo:'Separar un evento objetivo de la interpretaci√≥n identitaria y la herida emocional que gener√≥.',er:'"El Deportista Consciente", Cap. 10.11.',ep:['Piensa en una situaci√≥n en la que te sentiste decepcionado o traicionado por un sistema o una persona.','Escribe, de la forma m√°s objetiva y concreta posible, el  hecho: qu√© se dijo, qu√© ocurri√≥. (Sin adjetivos, sin juicios, sin "porqu√©s").','A continuaci√≥n, escribe qu√© apareci√≥ en ti a partir de ese hecho: las  emociones  (rabia, tristeza), los  pensamientos  ("no soy v√°lido", "no se puede confiar en nadie"), las  reacciones corporales.','Observa la diferencia entre el hecho externo y tu reacci√≥n interna. Reconoce que la herida no es el hecho en s√≠, sino la historia que te cuentas sobre √©l. Esto crea un espacio para no identificarte con la herida.']};
WD[10]={m:'El l√≠mite (agotamiento, enfermedad, bloqueo) no es un fracaso, es una se√±al y una puerta. Interrumpe la inercia y obliga a detenerse. La pausa impuesta, si se acepta conscientemente, se transforma en una pr√°ctica de escucha profunda que reordena todo el sistema.',c:[['El L√≠mite como Interrupci√≥n del Automatismo','Detiene lo que no pod√≠a detenerse voluntariamente.'],['Cuando el Cuerpo Toma la Palabra','La lesi√≥n o enfermedad no es castigo, es comunicaci√≥n. Expresa lo que la mente no ha querido escuchar.'],['La Pausa como Pr√°ctica Consciente','La pausa no es tiempo perdido, es espacio para sentir, escuchar y reorganizar.'],['Volver sin Regresar al Mismo Lugar','Tras un l√≠mite, no se vuelve al punto anterior. Se vuelve distinto. El l√≠mite transforma.']],et:'Escuchar el L√≠mite sin Intentar Corregirlo',eo:'Practicar la aceptaci√≥n y la escucha frente a una limitaci√≥n f√≠sica o mental.',er:'"El Ser Consciente", Cap. 11.8.',ep:['Busca un momento de quietud. Lleva la atenci√≥n al cuerpo o a la zona donde sientas el l√≠mite (un dolor, cansancio, bloqueo mental).','No intentes cambiar nada. No lo analices. No luches contra la sensaci√≥n.','En lugar de eso, "esc√∫chala". Pregunta internamente: "¬øQu√© est√° pidiendo ser escuchado aqu√≠?".','Permanece con la sensaci√≥n, ofreci√©ndole un espacio de presencia sin juicio. Escuchar es ya una forma de cuidado.']};
WD[11]={m:'El camino aut√©ntico conduce m√°s all√° del resultado. El resultado es una experiencia, no una identidad. El sentido no se construye, se reconoce en la coherencia, en la presencia y en la simplicidad de estar. El "fracaso" se integra como parte del camino y el "√©xito" se vive sin apego.',c:[['El Resultado como Experiencia, no Identidad','Cuando el resultado define qui√©nes somos, la vida se vuelve fr√°gil. Cuando se vive como experiencia, informa, ense√±a y pasa.'],['El Sentido se Reconoce, no se Construye','Aparece cuando dejamos de huir de lo que est√° ocurriendo y vivimos desde la presencia.'],['El Legado Invisible','A menudo, el legado m√°s duradero no son los logros, sino la forma en que escuchamos, atravesamos la dificultad y ofrecimos presenc']],et:'Recordar sin Buscar',eo:'Experimentar la simplicidad de la presencia sin intenci√≥n de lograr o mejorar nada.',er:'"El Ser Consciente", Cap. 12.7.',ep:['No hagas nada especial. Si√©ntate o permanece de pie unos instantes.','Siente el cuerpo. La respiraci√≥n. El espacio que te rodea.','No busques un estado de presencia. No intentes comprender nada.','Simplemente permite que lo que ya est√° aqu√≠ se reconozca solo.','Reconoce que ya est√°s aqu√≠. Eso es suficiente.']};
WD[12]={m:'Esta semana la dedicamos a integrar los aprendizajes de la Puerta Blanca. Repasamos los conceptos clave: la diferencia entre acci√≥n mec√°nica y acci√≥n consciente, la observaci√≥n del ego sin identificaci√≥n, y el habitar el cuerpo como ancla de la presencia. El objetivo es consolidar la pr√°ctica de la "pausa consciente" como herramienta fundamental para la vida diaria. Reflexi√≥n Final de la Puerta Bl',c:[],et:'de Integraci√≥n: El D√≠a Consciente',eo:'Aplicar las herramientas de la Puerta Blanca de forma integrada a lo largo de un d√≠a.',er:'',ep:['Al Despertar:  Antes de levantarte, dedica un minuto a "habitar tu cuerpo". Siente el contacto con la cama, la respiraci√≥n, la energ√≠a presente.','Durante una Tarea Rutinaria:  Elige una tarea (ej. lavarte los dientes) y real√≠zala con plena atenci√≥n, como si fuera la primera vez (Ejercicio Semana 6).','En una Interacci√≥n Social:  Practica la escucha sin preparar respuesta (Ejercicio Semana 7). Observa tu campo emocional y el del grupo.','Cuando Surja una Emoci√≥n Fuerte:  Haz una pausa y reconoce la emoci√≥n en el cuerpo sin juzgarla (Ejercicio Semana 5).','Antes de Dormir:  Dedica un minuto a "recordar sin buscar" (Ejercicio Semana 11). Simplemente, reconoce que est√°s aqu√≠, concluyendo el d√≠a. Anota en un diario cualquier descubrimiento o dificultad. La clave no es la perfecci√≥n, sino la intenci√≥n de recordar. Puerta Roja: Purificaci√≥n (Semanas 13-24)']};
WD[13]={m:'La Puerta Roja se asocia con la "voz-energ√≠a", el centro energ√©tico de la garganta (chakra Vishuddha), simbolizado por la s√≠laba "A" y el color rojo. Comprendemos que todo es vibraci√≥n, sonido y frecuencia. Los bloqueos energ√©ticos, originados en el transgeneracional, el proyecto sentido o nuestra vida cronol√≥gica, se manifiestan como desequilibrios en nuestro campo energ√©tico antes de afectar al ',c:[['La Puerta de la Voz-Energ√≠a','El centro de la garganta como portal para la expresi√≥n y transformaci√≥n de la energ√≠a.'],['Vibraci√≥n, Sonido y Frecuencia','Entender que somos seres vibracionales y que el sonido es una herramienta poderosa para la armonizaci√≥n.'],['El Origen de los Bloqueos','Introducci√≥n a los conceptos de transgeneracional, proyecto sentido y bioshock como fuentes de desequilibrios energ√©ticos.'],['Un Sonido Relajado, una Mente Libre','La conexi√≥n directa entre nuestro estado vibracional interno y nuestra paz mental.']],et:'Sentir la Vibraci√≥n de la Voz',eo:'Conectar con el centro energ√©tico de la garganta a trav√©s de la propia voz.',er:'',ep:['Si√©ntate c√≥modamente con la espalda recta. Cierra los ojos y realiza tres respiraciones profundas.','Coloca suavemente las yemas de los dedos en tu garganta.','Toma una inhalaci√≥n profunda y, al exhalar, emite un sonido "Aaaaaaah" largo y sostenido, en un tono que te resulte c√≥modo y natural.','Conc√©ntrate en la vibraci√≥n que sientes bajo tus dedos. Siente c√≥mo el sonido se origina y se expande desde ese centro.','Repite varias veces, explorando diferentes tonos y vol√∫menes. Observa c√≥mo cambia la sensaci√≥n.','Finaliza permaneciendo en silencio, sintiendo la resonancia que queda en tu cuerpo.']};
WD[14]={m:'Los mantras son "tecnolog√≠as de la mente" dise√±adas para liberar la mente del pensamiento discursivo a trav√©s de la vibraci√≥n. Estudiamos la diferencia entre mantra y afirmaci√≥n, y exploramos mantras de diversas tradiciones (budista, cham√°nica, cabal√≠stica) como herramientas para elevar nuestra frecuencia vibratoria y enfocar la intenci√≥n.',c:[['Mantra','Del s√°nscrito "man" (mente) y "tra" (liberar). Sonidos que crean altas vibraciones para enfocar la mente y catalizar cambios.'],['Sonido Primordial (OM/A)','El sonido del cual emergen todas las dem√°s vibraciones. La s√≠laba "A" es fundamental en la Puerta Roja.'],['Mantras y Deidades','Muchos mantras son invocaciones que nos conectan con arquetipos o cualidades energ√©ticas espec√≠ficas (compasi√≥n, sanaci√≥n, prosper'],['Transmisi√≥n Energ√©tica','En algunas tradiciones, la plena activaci√≥n de un mantra requiere una transmisi√≥n de un maestro que ya lo ha realizado.']],et:'Meditaci√≥n con el Mantra "Om Mani Padme Hum"',eo:'Cultivar la compasi√≥n y purificar la mente a trav√©s del mantra de Avalokiteshvara.',er:'"TCT Puerta Blanca-Roja", p√°g. 111.',ep:['Si√©ntate en una postura de meditaci√≥n c√≥moda.','Comienza con unas respiraciones conscientes para calmar la mente.','Empieza a recitar el mantra "Om Mani Padme Hum", ya sea en voz alta o mentalmente.','Mientras lo recitas, puedes visualizar una luz blanca y pura que emana de tu coraz√≥n y se expande, llenando todo tu ser y extendi√©ndose a todos los seres sintientes, dese√°ndoles paz y liberaci√≥n del sufrimiento.','No te preocupes por la pronunciaci√≥n perfecta. La intenci√≥n y la repetici√≥n son lo m√°s importante.']};
WD[15]={m:'Desde la cosmolog√≠a budista, exploramos los 6 Reinos o "Lokas" como representaciones de estados mentales dominados por una emoci√≥n espec√≠fica (orgullo, celos, deseo, ignorancia, apego, ira). Comprendemos que, aunque vivimos en el reino humano, transitamos por estos estados constantemente. La purificaci√≥n consiste en reconocer estas emociones en nosotros y, a trav√©s de la pr√°ctica, disminuir su pod',c:[['Samsara','El ciclo de existencia condicionada, caracterizado por el sufrimiento y la impermanencia.'],['Los 6 Reinos','Dioses (Orgullo), Semi-dioses (Celos), Humanos (Deseo), Animales (Ignorancia), Pretas/Esp√≠ritus hambrientos (Apego), Infiernos (Ir'],['La Preciada Vida Humana','El reino humano es el √∫nico desde el cual es posible alcanzar la iluminaci√≥n, ya que equilibra el placer y el sufrimiento, permiti'],['Purificaci√≥n de los Lokas','El objetivo no es eliminar los reinos, sino dejar de ser arrastrados por las emociones que los gobiernan.']],et:'Meditaci√≥n de los 6 Reinos con Soporte',eo:'Observar y comenzar a purificar la influencia de una de las emociones de los 6 reinos.',er:'"TCT Puerta Blanca-Roja", p√°g. 77-79.',ep:['Elige uno de los 6 reinos para trabajar durante esta sesi√≥n (ej. Reino de los Pretas - Apego).','Si√©ntate frente a una vela. Percute un cuenco tibetano tres veces y realiza tres respiraciones profundas.','Paso B (5 min):  Con los ojos abiertos, enfoca tu atenci√≥n en la llama de la vela. Deja que tu mente se calme.','Paso C (5 min):  Cierra los ojos. Dirige tu mirada interna hacia la localizaci√≥n corporal del reino elegido (Pretas: zona del abdomen/plexo solar). Respira hacia esa zona y simplemente observa la emoci√≥n del apego en tu vida. ¬øA qu√© te aferras? ¬øQu√© miedos surgen al pensar en soltar? Observa sin jui','Paso D (5 min):  Abre los ojos y vuelve a enfocar la atenci√≥n en la vela, pero ahora manteniendo la consciencia de lo que has observado en el paso C. Observa qu√© cambia en tu percepci√≥n.']};
WD[16]={m:'Profundizamos en las herramientas pr√°cticas del Cuarto Camino. El ser humano es una "m√°quina" que funciona con patrones autom√°ticos. El trabajo consiste en despertar de este automatismo a trav√©s de la "auto-observaci√≥n sin juicio" y el "recuerdo de s√≠".',c:[['La M√°quina Humana','Nuestros pensamientos, emociones y acciones son mayormente reacciones mec√°nicas a est√≠mulos internos y externos.'],['Auto-observaci√≥n sin Juicio','La pr√°ctica de observar nuestros patrones (posturas, gestos, tonos de voz, pensamientos recurrentes) sin intentar cambiarlos, just'],['Recuerdo de S√≠','El acto de ser consciente de uno mismo ("Yo soy") y de lo que se est√° haciendo al mismo tiempo. Es una atenci√≥n dividida que rompe'],['Choques Conscientes','Interrupciones deliberadas del automatismo para crear una "chispa" de consciencia (ej. cambiar de mano para hacer una tarea, hacer']],et:'Pausas de Consciencia',eo:'Introducir "choques conscientes" en la rutina diaria para romper el automatismo.',er:'Anexo VI de "TCT Puerta Azul", Semana 1.',ep:['Programa una alarma en tu tel√©fono para que suene 3 veces a lo largo del d√≠a en momentos inesperados.','Cuando suene la alarma, det√©n lo que est√°s haciendo por 30 segundos.','Preg√∫ntate: "¬øD√≥nde estoy? ¬øQu√© estoy haciendo? ¬øCu√°l es mi estado interno (pensamiento, emoci√≥n, sensaci√≥n corporal)?".','Observa sin juzgar. No necesitas cambiar nada.','Despu√©s de los 30 segundos, contin√∫a con tu actividad. El objetivo es simplemente crear una breve interrupci√≥n en el "sue√±o despierto".']};
WD[17]={m:'Gurdjieff describe al ser humano como un carruaje con tres centros principales: Intelectual (la mente pensante), Emocional (sentimientos y reacciones afectivas) y Motor-Instintivo (cuerpo y funciones autom√°ticas). Normalmente, estos centros trabajan de forma desequilibrada. El trabajo consiste en observarlos y armonizarlos.',c:[['Centro Intelectual','Su trabajo correcto es pensar, analizar y planificar. Su trabajo incorrecto es el parloteo mental incesante, la preocupaci√≥n y la '],['Centro Emocional','Su trabajo correcto es sentir emociones superiores (compasi√≥n, alegr√≠a). Su trabajo incorrecto es la reactividad de las emociones '],['Armonizaci√≥n de los Centros','La pr√°ctica de observar qu√© centro est√° activo en cada momento y evitar que un centro haga el trabajo de otro (ej. "pensar" una em']],et:'Transformaci√≥n Emocional',eo:'Observar una emoci√≥n negativa sin identificarse y negarse a expresarla mec√°nicamente.',er:'Anexo VI de "TCT Puerta Azul", Semana 6.',ep:['La pr√≥xima vez que sientas una emoci√≥n negativa (irritaci√≥n, impaciencia, tristeza), haz una pausa.','Reconoce  la emoci√≥n internamente: "Estoy sintiendo irritaci√≥n".','No te identifiques:  Recuerda que "t√∫" no eres la irritaci√≥n; eres la consciencia que la observa.','No la expreses mec√°nicamente:  Toma la decisi√≥n consciente de no actuar desde esa emoci√≥n (no levantar la voz, no hacer un gesto brusco).','Observa la energ√≠a:  Siente la energ√≠a de la emoci√≥n en tu cuerpo sin hacer nada con ella. Observa c√≥mo, al no ser alimentada por la reacci√≥n, pierde fuerza y se transforma.']};
WD[18]={m:'Iniciamos la integraci√≥n de Un Curso de Milagros. La felicidad, seg√∫n UCDM, no se encuentra en el mundo, que es una proyecci√≥n de nuestro pensamiento de separaci√≥n. La verdadera felicidad es nuestro estado natural en Dios, y se recupera deshaciendo la culpa a trav√©s del perd√≥n. El perd√≥n no es condonar un acto, sino reconocer que lo que cre√≠amos que nos hicieron nunca ocurri√≥ realmente en el nivel',c:[['La Paradoja de la Felicidad seg√∫n UCDM','Buscamos la felicidad donde no se puede encontrar (en el mundo de la percepci√≥n). La verdadera felicidad es un recuerdo de nuestra'],['El Perd√≥n como Clave de la Felicidad','El perd√≥n es la herramienta para liberar la mente de la culpa y el resentimiento, que son los √∫nicos obst√°culos para la paz.'],['Nivel 1','El Testigo Santo:  Invitar al Esp√≠ritu Santo a observar nuestros pensamientos de juicio y ataque sin condenarlos.'],['Nivel 2','El Perd√≥n como Camino Directo:  Aplicar la f√≥rmula del perd√≥n a cualquier situaci√≥n que nos perturbe la paz.']],et:'El Diario del Perd√≥n',eo:'Aplicar el proceso de perd√≥n de UCDM a una situaci√≥n espec√≠fica.',er:'Anexo V de "TCT Puerta Azul".',ep:['Elige una persona o situaci√≥n que te cause resentimiento o malestar.','Escribe en un diario: "Me siento [emoci√≥n] por [situaci√≥n/persona] porque creo que [juicio/ataque]".','Reconoce que estos pensamientos son del ego y te est√°n robando la paz.','Di (mental o en voz alta): "Esp√≠ritu Santo, veo esto de otra manera. Elijo la paz en lugar de este conflicto. Te entrego estos pensamientos de juicio para que sean corregidos".','Visualiza a la persona (y a ti mismo) envuelta en una luz sanadora, reconociendo la inocencia que ambos compart√≠s como Hijos de Dios.']};
WD[19]={m:'UCDM ense√±a que todo dolor emocional proviene de un pensamiento de ataque o separaci√≥n. La gesti√≥n emocional no consiste en analizar la emoci√≥n, sino en llevar el pensamiento que la caus√≥ a la correcci√≥n del Esp√≠ritu Santo. El "Instante Santo" es la pr√°ctica de retirar nuestra atenci√≥n del pasado y el futuro para abrir un momento presente al Amor de Dios.',c:[['El Proceso UCDM para Emociones','Cuando surge el dolor, reconocer que es una se√±al de que hemos elegido al ego como maestro. El √∫nico remedio es cambiar de maestro'],['Meditaci√≥n "El Instante Santo"','Una pr√°ctica para aquietar la mente y unirse al Esp√≠ritu Santo en el ahora, donde no hay problemas.'],['Elecci√≥n sobre Circunstancia','La clave de la felicidad constante es recordar que siempre podemos elegir la paz, sin importar las circunstancias externas.'],['Amor sobre Miedo','Cada momento es una elecci√≥n entre dos sistemas de pensamiento: el del ego (miedo) o el del Esp√≠ritu Santo (amor).']],et:'Meditaci√≥n "El Instante Santo"',eo:'Experimentar un momento de paz y conexi√≥n m√°s all√° del tiempo.',er:'Anexo V de "TCT Puerta Azul".',ep:['Busca un lugar tranquilo donde no te interrumpan por 5-10 minutos.','Cierra los ojos y di: "Tengo la voluntad de dejar a un lado todos mis problemas, planes y juicios por un momento. Deseo experimentar este Instante Santo contigo, Esp√≠ritu Santo".','No intentes vaciar tu mente. Simplemente, retira tu inter√©s de los pensamientos que surjan. D√©jalos pasar sin engancharte.','Enfoca tu atenci√≥n en la sensaci√≥n de paz o quietud que pueda surgir, por sutil que sea.','Descansa en este espacio, sabiendo que en este instante no te falta nada y est√°s perfectamente a salvo en el Amor de Dios.']};
WD[20]={m:'Volvemos a los protocolos de sonido, esta vez con una comprensi√≥n m√°s profunda de la energ√≠a emocional. El protocolo "Purificar la Rueda del Samsara" utiliza los cuencos tibetanos para trabajar directamente sobre los centros energ√©ticos asociados a los 6 Reinos, ayudando a liberar las emociones negativas estancadas.',c:[['Masaje Vibracional','El uso de cuencos directamente sobre el cuerpo o en su campo energ√©tico para inducir una relajaci√≥n profunda y un reequilibrio vib'],['Fase 1 (Percusi√≥n)','Utiliza golpes continuos para "despertar" y "romper" los bloqueos energ√©ticos en cada centro.'],['Fase 2 (Fricci√≥n)','Utiliza un sonido sostenido para "limpiar" y "armonizar" la energ√≠a liberada.'],['Intenci√≥n Consciente','El terapeuta y el receptor mantienen una intenci√≥n clara de purificaci√≥n durante toda la sesi√≥n.']],et:'Autotratamiento con un Cuenco',eo:'Utilizar un cuenco para limpiar el propio campo energ√©tico.',er:'Adaptado del protocolo "Rueda del Samsara".',ep:['Si√©ntate c√≥modamente. Coloca un cuenco tibetano en la palma de tu mano izquierda.','Comienza a friccionar el cuenco con la baqueta en tu mano derecha, generando un sonido continuo.','Lentamente, mueve el cuenco alrededor de tu cuerpo, a unos 10-15 cm de distancia. Comienza por la cabeza y desciende lentamente hacia los pies.','Presta especial atenci√≥n a las zonas donde sientas tensi√≥n o pesadez. Permanece en esas √°reas un poco m√°s, permitiendo que la vibraci√≥n disuelva el bloqueo.','Visualiza que cualquier energ√≠a densa se desprende de tu cuerpo y es absorbida por la tierra.','Termina colocando el cuenco sobre tu coraz√≥n y percuti√©ndolo suavemente tres veces.']};
WD[21]={m:'Integramos la sabidur√≠a de la C√°bala con el sonido. El "Pilar del Medio" es el eje energ√©tico central del √Årbol de la Vida, que corresponde a nuestra columna vertebral y a los chakras principales. Este protocolo utiliza cuencos afinados con notas espec√≠ficas para activar y equilibrar cada uno de los centros (Sefirot) de este pilar, promoviendo la alineaci√≥n entre el cielo y la tierra dentro de nos',c:[['El Pilar del Medio','El eje central de energ√≠a que conecta la consciencia c√≥smica (Keter) con la manifestaci√≥n terrenal (Malkuth).'],['Sefirot','Emanaciones o atributos divinos en el √Årbol de la Vida, que tambi√©n son centros de consciencia en el ser humano.'],['Correspondencia Nota-Centro','Cada Sefira del Pilar del Medio resuena con una nota musical espec√≠fica, que se utiliza para activarla.'],['Nombres de Poder','La recitaci√≥n de los nombres divinos asociados a cada Sefira potencia el efecto de la vibraci√≥n sonora.']],et:'Meditaci√≥n del Pilar del Medio',eo:'Activar y equilibrar el eje energ√©tico central a trav√©s de la visualizaci√≥n y el sonido (mantra).',er:'"TCT Puerta Blanca-Roja", p√°g. 135-137.',ep:['Ponte de pie, con los pies separados a la anchura de los hombros. Cierra los ojos.','Visualiza una esfera de luz blanca brillante por encima de tu cabeza (Keter). Vibra el nombre  "E-HE-IEH"  (pronunciado "Ejei√©"). Siente c√≥mo la luz desciende a tu cabeza.','Visualiza la luz descendiendo hasta tu garganta (Daat). Vibra el nombre  "YEHOVA-ELOHIM".','Visualiza la luz descendiendo a tu coraz√≥n (Tiferet). Vibra el nombre  "YEHOVA-ELOAH-VA-DAATH". Siente c√≥mo la luz se expande desde tu coraz√≥n.','Visualiza la luz descendiendo a tu zona genital/base de la columna (Yesod). Vibra el nombre  "SHADDAI-EL-CHAI".']};
WD[22]={m:'La Cruz Cabal√≠stica es un ritual que establece un espacio sagrado y equilibra el microcosmos (el ser humano) con el macrocosmos (el universo). A trav√©s de la visualizaci√≥n de la luz y la vibraci√≥n de nombres de poder, se traza una cruz de luz en el campo energ√©tico, anclando las energ√≠as divinas y creando un centro de poder y equilibrio.',c:[['ATAH (A Ti)','Se traza la luz desde arriba hasta el pecho, reconociendo la Fuente Divina.'],['MALKUTH (El Reino)','Se baja la luz hasta los pies, anclando la divinidad en la tierra.'],['VE-GEVURAH (Y el Poder)','Se traza la luz hasta el hombro derecho, invocando la fuerza y el rigor.'],['VE-GEDULAH (Y la Gloria)','Se traza la luz hasta el hombro izquierdo, invocando la misericordia y la expansi√≥n.']],et:'Realizar la Cruz Cabal√≠stica',eo:'Centrar y proteger el campo energ√©tico.',er:'"TCT Puerta Blanca-Roja", p√°g. 138-140.',ep:['Ponte de pie mirando al Este. Realiza varias respiraciones profundas.','Visualiza una luz brillante sobre tu cabeza. Con tu dedo √≠ndice derecho, toca tu frente y vibra  "ATAH".','Baja la mano hasta tu pecho, visualizando el rayo de luz descendiendo. Vibra  "MALKUTH".','Toca tu hombro derecho, visualizando un rayo de luz desde el centro del pecho. Vibra  "VE-GEVURAH".','Toca tu hombro izquierdo, visualizando el rayo de luz cruzando tu pecho. Vibra  "VE-GEDULAH".']};
WD[23]={m:'Sintetizamos los aprendizajes de las Puertas Blanca y Roja en la "F√≥rmula Esencial de la Felicidad". La felicidad no es una meta, sino la resonancia de un ser en equilibrio. Esta semana nos enfocamos en los dos primeros componentes: Aceptaci√≥n (el fruto de la Puerta Blanca) y Prop√≥sito (el fruto de la Puerta Roja).',c:[['Aceptaci√≥n','Es la cimentaci√≥n f√≠sica y la presencia en el ahora. Es la paz que surge de aceptar lo que es, sin resistencia. Es el resultado de'],['Prop√≥sito','Es la purificaci√≥n de la energ√≠a y la acci√≥n consciente. Surge cuando nuestra energ√≠a emocional ya no est√° atrapada en el pasado (']],et:'Clarificando el Prop√≥sito',eo:'Conectar con un sentido de prop√≥sito que vaya m√°s all√° de las metas del ego.',er:'',ep:['Dedica 15 minutos a una escritura reflexiva.','Preg√∫ntate: "Si el miedo y la necesidad de aprobaci√≥n no fueran un factor, ¬øa qu√© dedicar√≠a mi energ√≠a?".','Escribe sobre las actividades que te hacen sentir vivo, conectado y expansivo.','Reflexiona: "¬øC√≥mo puedo traer m√°s de esta energ√≠a a mi vida diaria, incluso en peque√±os actos?".','El prop√≥sito no tiene que ser una gran misi√≥n. Puede ser tan simple como "ser un espacio de paz para los dem√°s" o "crear belleza en mi entorno".']};
WD[24]={m:'Esta semana consolidamos las pr√°cticas de purificaci√≥n emocional. Repasamos la transformaci√≥n de las emociones a trav√©s de la observaci√≥n (Cuarto Camino), el perd√≥n (UCDM) y la vibraci√≥n (Sonido). El objetivo es desarrollar una maestr√≠a emocional que no se basa en el control, sino en la capacidad de permitir que la energ√≠a fluya sin que nos secuestre. Reflexi√≥n Final de la Puerta Roja: La purifica',c:[],et:'de Integraci√≥n: El Alquimista Emocional',eo:'Utilizar una herramienta diferente para cada tipo de perturbaci√≥n emocional.',er:'',ep:['Para la Irritaci√≥n o la Ira (Cuarto Camino):  La pr√≥xima vez que te sientas irritado, practica la "no-expresi√≥n mec√°nica". Reconoce la energ√≠a, pero elige no actuarla. Obs√©rvala hasta que se transforme.','Para el Resentimiento o la Culpa (UCDM):  Si un pensamiento sobre el pasado te perturba, realiza el "Diario del Perd√≥n". Entrega el juicio al Esp√≠ritu Santo y elige la paz.','Para la Ansiedad o el Estr√©s General (Sonido):  Cuando te sientas abrumado, dedica 5 minutos a escuchar un cuenco tibetano o a cantar un mantra (como "OM"). Permite que la vibraci√≥n re-sintonice tu sistema nervioso. La pr√°ctica consiste en reconocer qu√© herramienta es m√°s adecuada para cada momento,']};
WD[25]={m:'La Puerta Azul corresponde al centro del coraz√≥n, simbolizado por la s√≠laba "HUM" y el color azul. Aqu√≠, "mente" no se refiere a la mente ordinaria (pensamientos, intelecto), sino a la naturaleza real de la mente: un estado que nunca fue creado, que est√° m√°s all√° de todas las creencias y filosof√≠as. El objetivo es aprender a "estar relajado y reposar en nuestra condici√≥n natural".',c:[['La Puerta de la Mente (Coraz√≥n)','El centro del coraz√≥n como sede de la mente no-dual o Rigpa.'],['Visi√≥n Dualista vs. Visi√≥n Total 360¬∞','Pasar de una percepci√≥n unidireccional (sujeto-objeto) a una visi√≥n panor√°mica y no-dual donde todo est√° interconectado.'],['Ma-rigpa vs. Rigpa','Ma-rigpa es la ignorancia o el no-reconocimiento de nuestra verdadera condici√≥n. Rigpa es el conocimiento directo, la sabidur√≠a pr'],['Visi√≥n Circular','Todos los conceptos y pr√°cticas de las tres puertas est√°n interconectados. La Puerta Azul integra y culmina las dos anteriores.']],et:'La Pregunta "¬øQui√©n Soy?"',eo:'Utilizar la autoindagaci√≥n para ir m√°s all√° de las identificaciones superficiales.',er:'"TCT Puerta Azul Anexos", p√°g. 99.',ep:['Si√©ntate en silencio por unos minutos.','Preg√∫ntate internamente: "¬øQui√©n soy yo?".','Observa las respuestas que surgen autom√°ticamente: "Soy [tu nombre]", "Soy [tu profesi√≥n]", "Soy un padre/madre", "Soy mis pensamientos", "Soy mis emociones".','A cada respuesta, reconoce: "Tengo este rol/pensamiento/cuerpo, pero no soy solo esto".','Contin√∫a preguntando: "¬øQui√©n soy yo m√°s all√° de todo eso? ¬øQui√©n es el que observa todo esto?".']};
WD[26]={m:'Para comprender la naturaleza de la mente, primero debemos entender c√≥mo la hemos conceptualizado. Esta semana exploramos diferentes perspectivas sobre la mente: desde la psicolog√≠a convencional y transpersonal hasta las visiones radicales del hinduismo y los fil√≥sofos Jiddu y U.G. Krishnamurti. Esto nos ayuda a ver que nuestras ideas sobre la mente son construcciones, no la realidad √∫ltima.',c:[['Psicolog√≠a Convencional','La mente como producto del cerebro, un conjunto de procesos cognitivos (percepci√≥n, memoria, pensamiento).'],['Psicolog√≠a Transpersonal','La mente como algo que trasciende el ego, con niveles pre-egoicos, egoicos y transpersonales.'],['Hinduismo','La mente con sus diferentes niveles (Manas, Buddhi, Ahamkara, Chitta) que deben ser purificados para realizar el Atman (el verdade'],['Jiddu Krishnamurti','La mente est√° condicionada por el pasado. El verdadero problema es la mente misma, no los problemas que crea. Buscar la verdad a t']],et:'Observando el Condicionamiento',eo:'Tomar consciencia de c√≥mo la mente est√° condicionada por el pasado.',er:'',ep:['Elige una opini√≥n o creencia fuerte que tengas (pol√≠tica, social, personal).','Si√©ntate en silencio y rastrea el origen de esa creencia. ¬øDe d√≥nde vino? ¬øLa aprendiste de tu familia, de la escuela, de la cultura?','Observa las emociones que est√°n asociadas a esa creencia. ¬øQu√© sientes cuando alguien la desaf√≠a?','Preg√∫ntate: "¬øQui√©n ser√≠a yo sin esta creencia?".','El objetivo no es cambiar la creencia, sino ver que es algo adquirido, una construcci√≥n del pasado, no una verdad absoluta sobre qui√©n eres.']};
WD[27]={m:'El Dzogchen ofrece una visi√≥n radical: la mente en su estado natural (Rigpa) es ya pura, l√∫cida y libre. No es algo que se deba crear o alcanzar, sino reconocer. La "mente ordinaria" no es la mente conceptual y ocupada, sino este estado primordial que est√° siempre presente, como un cielo claro detr√°s de las nubes de pensamientos y emociones.',c:[['Mente Ordinaria/Natural (Rigpa)','La conciencia primordial, pura, luminosa, espont√°nea y no-conceptual. Es innata e inmutable.'],['Obst√°culos a la Mente Natural','Los conceptos, las emociones negativas y los apegos oscurecen el reconocimiento de Rigpa, pero no pueden manchar su naturaleza.'],['La Iluminaci√≥n como Reconocimiento','La iluminaci√≥n no es un estado futuro, sino la realizaci√≥n de nuestra verdadera naturaleza, que es la mente natural, aqu√≠ y ahora.']],et:'Descansar en la Conciencia',eo:'Tener un atisbo de la mente natural m√°s all√° de los pensamientos.',er:'Adaptado de las ense√±anzas de Dzogchen.',ep:['Si√©ntate c√≥modamente y cierra los ojos.','Permite que tus pensamientos vengan y vayan sin prestarles atenci√≥n. No los sigas, no los rechaces.','Lleva tu atenci√≥n no a los pensamientos, sino al  espacio  en el que los pensamientos aparecen.','Date cuenta de que hay una conciencia silenciosa y espaciosa que es consciente de los pensamientos, pero que no es los pensamientos.','Descansa en esa conciencia abierta y receptiva. No intentes "hacer" nada. Simplemente, s√© esa conciencia que observa.']};
WD[28]={m:'La met√°fora del espejo es central en el Dzogchen para explicar la naturaleza de la mente. La mente natural es como un espejo: claro, puro y capaz de reflejar cualquier cosa sin ser afectado por los reflejos. Los pensamientos, emociones y percepciones son los reflejos. El error (ma-rigpa) es olvidarse de que somos el espejo e identificarnos con los reflejos.',c:[['El Espejo','Representa la mente natural, pura e inmutable.'],['Los Reflejos','Simbolizan los pensamientos, emociones y percepciones, que son impermanentes y cambiantes.'],['La Pr√°ctica','Consiste en "limpiar el espejo" (eliminar los oscurecimientos de la ignorancia y el apego) para reconocer su claridad inherente.'],['Beneficios','Comprender esta analog√≠a nos ayuda a observar nuestros pensamientos sin identificarnos con ellos, reduciendo el sufrimiento.']],et:'Ser el Espejo',eo:'Experimentar la des-identificaci√≥n de los pensamientos usando la met√°fora del espejo.',er:'',ep:['Si√©ntate en meditaci√≥n.','Visualiza tu mente como un espejo perfectamente limpio y brillante.','Observa c√≥mo los pensamientos, las im√°genes y las sensaciones aparecen como reflejos en la superficie del espejo.','Nota que el espejo no juzga los reflejos. No se aferra a los "buenos" ni rechaza los "malos". Simplemente, refleja.','Cuando aparezca un pensamiento, n√≥mbralo internamente como "reflejo" y d√©jalo pasar.','Identif√≠cate con el espejo, no con los reflejos. Siente la cualidad de calma, claridad e imperturbabilidad del espejo mismo.']};
WD[29]={m:'Llevamos los principios de UCDM a su nivel m√°s profundo. El "Testigo Santo" es la perspectiva del Esp√≠ritu Santo en nuestra mente, que observa el mundo del ego sin juicio y con compasi√≥n. El objetivo final es trascender la observaci√≥n y recordar nuestra Unidad con Dios y con toda la Creaci√≥n. La felicidad no es aceptar "lo que es" en el mundo de la ilusi√≥n, sino recordar "lo que siempre ha sido" e',c:[['Nivel 3','Unidad (Recordar Qui√©n Soy):  Trascender la dualidad de observador y observado. La pr√°ctica es descansar en la afirmaci√≥n "Soy tal'],['Correcci√≥n de Distorsiones','UCDM corrige las distorsiones cognitivas no reemplazando un pensamiento por otro, sino reconociendo que solo el Amor es real.'],['Meditaci√≥n "Solo el Amor es Real"','Una pr√°ctica para retirar la creencia en la realidad del miedo, el ataque y el sufrimiento.'],['Unidad sobre Separaci√≥n','La clave de la maestr√≠a es aplicar consistentemente el principio de que la separaci√≥n es una ilusi√≥n y que solo la unidad es verda']],et:'Meditaci√≥n "Solo el Amor es Real"',eo:'Retirar la fe en el sistema de pensamiento del ego y descansar en la certeza del Amor.',er:'Anexo V de "TCT Puerta Azul".',ep:['Si√©ntate en silencio y trae a la mente una situaci√≥n de miedo o conflicto.','Observa los pensamientos y emociones asociados a ella.','Ahora, afirma con convicci√≥n: "Esto no es real. Es una sombra del pasado. Solo el Amor es real".','Visualiza una luz dorada que representa el Amor de Dios disolviendo la situaci√≥n de miedo.','Repite la lecci√≥n de UCDM: "Puedo elegir la paz en lugar de esto".','Descansa en la sensaci√≥n de paz que surge al soltar la creencia en el miedo.']};
WD[30]={m:'Esta semana nos sumergimos en la esencia del libro "El Ser Consciente". La verdadera pr√°ctica espiritual no ocurre en el retiro, sino en medio de la vida real: en el trabajo, en las relaciones, en la dificultad. La presencia no es algo que se a√±ade, sino que se recuerda. El objetivo es habitar la vida sin huir de ella ni idealizarla, encontrando el despertar en lo ordinario.',c:[['Presencia en la Acci√≥n','El sentido se encuentra en la calidad de presencia con la que se vive cada acci√≥n, no en el resultado.'],['Flow y Acci√≥n sin Esfuerzo','Cuando dejamos de interferir con el control mental, la acci√≥n se ordena sola y surge desde una inteligencia m√°s profunda.'],['El Esfuerzo como Se√±al de Desalineaci√≥n','El esfuerzo psicol√≥gico excesivo es una se√±al de lucha interna y olvido de la presencia.'],['La Vida como Pr√°ctica Consciente','Cada gesto, conversaci√≥n y decisi√≥n es una oportunidad para recordar.']],et:'Una Sola Cosa a la Vez',eo:'Combatir la multitarea y la fragmentaci√≥n de la atenci√≥n, cultivando la presencia en una sola acci√≥n.',er:'Anexo II de "El Ser Consciente".',ep:['Elige una actividad para los pr√≥ximos 15 minutos (responder un correo, leer un informe, preparar una comida).','Comprom√©tete a hacer  solo eso  durante ese tiempo.','Si tu mente divaga o sientes el impulso de hacer otra cosa (revisar el tel√©fono, pensar en la siguiente tarea), n√≥talo amablemente y trae tu atenci√≥n de vuelta a la √∫nica tarea presente.','No lo hagas con tensi√≥n, sino con una elecci√≥n calmada y deliberada.','Observa c√≥mo la simplicidad de hacer una sola cosa ordena la mente y profundiza la calidad de la acci√≥n.']};
WD[31]={m:'Aplicamos los protocolos de sonido m√°s avanzados para la Puerta Azul. El "Masaje Vibracional de Desintoxicaci√≥n" es un protocolo exhaustivo para limpiar el cuerpo f√≠sico y energ√©tico a trav√©s de la percusi√≥n y fricci√≥n sistem√°tica. El "Masaje para Despertar la Memoria Ancestral" utiliza notas y mantras espec√≠ficos para conectar con la sabidur√≠a profunda que reside en nuestro ADN espiritual.',c:[['Desintoxicaci√≥n Vibracional','El sonido como medio para liberar toxinas f√≠sicas y energ√©ticas acumuladas en los tejidos y el campo √°urico.'],['Memoria Ancestral','La idea de que llevamos en nosotros una sabidur√≠a innata y una conexi√≥n con nuestro linaje espiritual, que puede ser despertada a '],['Sincronizaci√≥n de Sonido y Mantra','La combinaci√≥n de la vibraci√≥n del cuenco con la recitaci√≥n interna de mantras ("Me Veo", "Me Reconozco", "Me Perdono", "Me Amo") ']],et:'Despertar la Memoria Ancestral (Adaptado)',eo:'Realizar una meditaci√≥n de autosanaci√≥n y conexi√≥n con la sabidur√≠a interna.',er:'"TCT Puerta Azul Anexos", p√°g. 80-83.',ep:['Si√©ntate o t√∫mbate. Coloca tus manos sobre tu coraz√≥n.','Respira profundamente y, con cada exhalaci√≥n, repite internamente el mantra:  "Me Veo". Siente que te ves a ti mismo con compasi√≥n.','Contin√∫a respirando y cambia el mantra a:  "Me Reconozco". Reconoce tu luz, tu fuerza y tu divinidad.','Cambia el mantra a:  "Me Perdono". Perd√≥nate por cualquier juicio o error, liberando toda culpa.','Finalmente, cambia el mantra a:  "Me Amo". Siente un amor incondicional que nace desde tu coraz√≥n y se expande por todo tu ser.']};
WD[32]={m:'Los objetos sagrados (cuencos, mandalas, cristales, estatuillas) act√∫an como puentes para conectar con estados superiores de conciencia. El Tagdrol ("liberaci√≥n a trav√©s del contacto") es un m√©todo del budismo tibetano que utiliza estos objetos como catalizadores para despertar recuerdos del alma y liberar bloqueos k√°rmicos. El poder no est√° en el objeto, sino en nuestra capacidad de resonar con l',c:[['Tagdrol','Liberaci√≥n a trav√©s del contacto, la visi√≥n o el sonido de objetos sagrados.'],['El Proceso de 5 Fases','Reconocimiento, Consagraci√≥n, Comunicaci√≥n Sagrada, Liberaci√≥n e Integraci√≥n.'],['Mecanismos de Sanaci√≥n','Los objetos act√∫an a nivel psicol√≥gico (proyecciones del inconsciente), energ√©tico (reequilibrio de chakras) y espiritual (reconex'],['Creaci√≥n de un Altar Personal','Un altar es un espacio f√≠sico dedicado a anclar nuestra intenci√≥n espiritual y a trabajar con nuestros objetos sagrados.']],et:'El Di√°logo con el Objeto Sagrado',eo:'Establecer una comunicaci√≥n intuitiva con un objeto personal para recibir gu√≠a.',er:'Anexo III de "TCT Puerta Azul", p√°g. 132.',ep:['Elige un objeto que tenga un significado especial para ti (un cristal, una joya, una foto, una figura).','Limpia energ√©ticamente el objeto (puedes pasarlo por el humo de incienso o salvia, o usar el sonido de un cuenco).','Si√©ntate en silencio, sost√©n el objeto en tus manos y cierra los ojos.','Sincroniza tu respiraci√≥n con el objeto, imaginando que inhalas su esencia y exhalas tu energ√≠a hacia √©l.','Pregunta mentalmente: "¬øQu√© mensaje tienes para m√≠ en este momento de mi vida?".']};
WD[33]={m:'El verdadero poder no es el control externo, sino la maestr√≠a interior que surge de la conexi√≥n con nuestra fuente. Esta fuerza se manifiesta como calma en el caos, decisiones claras y creatividad espont√°nea. Las pr√°cticas de esta semana se centran en disolver los obst√°culos (identificaci√≥n con el ego, creencias limitantes) y anclarnos en el poder del ahora.',c:[['Poder Aut√©ntico','No es dominio, sino maestr√≠a interior. Surge del autoconocimiento y la conciencia expandida.'],['Las Tres Fuentes del Poder','Presencia Consciente, Intuici√≥n Profunda y Coherencia Interna (alineaci√≥n de pensamiento, emoci√≥n y acci√≥n).'],['Anclaje en el Poder Presencial','Desarrollar una estabilidad interna que no depende de las circunstancias externas.']],et:'Expansi√≥n de Conciencia "El C√≠rculo del Yo Soy"',eo:'Experimentar la sensaci√≥n de unidad con toda la existencia, disolviendo los l√≠mites del ego.',er:'Anexo II de "TCT Puerta Azul", p√°g. 124.',ep:['Si√©ntate en meditaci√≥n y visualiza un punto de luz brillante en el centro de tu coraz√≥n.','Con cada respiraci√≥n, permite que esa luz se expanda, llenando primero todo tu cuerpo.','Contin√∫a expandiendo la luz m√°s all√° de tu cuerpo, hasta que llene la habitaci√≥n, luego el edificio, la ciudad...','Sigue expandiendo tu conciencia hasta que abarque todo el planeta, el sistema solar y finalmente, el cosmos entero.','Permanece en esta sensaci√≥n de ser el espacio vasto y silencioso que contiene todo el universo.']};
WD[34]={m:'La felicidad no es algo que se obtiene, sino algo que se reconoce cuando la mente deja de obstaculizarla. Esta semana integramos pr√°cticas espec√≠ficas para reestructurar la mente y cultivar las virtudes que generan felicidad de forma natural: gratitud, perd√≥n, aceptaci√≥n y presencia.',c:[['La Paradoja de la Felicidad','La felicidad es el estado natural de una mente en calma, no el resultado de condiciones externas.'],['El Proceso RAIN (Tara Brach)','Una t√©cnica para gestionar emociones: Reconocer, Aceptar, Investigar, No-identificaci√≥n.'],['Tonglen (Dar y Recibir)','Pr√°ctica tibetana para transformar el sufrimiento en compasi√≥n, inspirando el dolor y exhalando paz.'],['F√≥rmula Esencial','Felicidad = Aceptaci√≥n + Prop√≥sito + Conexi√≥n.']],et:'El Proceso RAIN para una Emoci√≥n Dif√≠cil',eo:'Aplicar un m√©todo mindfulness para relacionarse con una emoci√≥n dif√≠cil de forma compasiva.',er:'Anexo IV de "TCT Puerta Azul", p√°g. 146.',ep:['Cuando surja una emoci√≥n dif√≠cil (miedo, enfado, tristeza), haz una pausa.','R - Reconocer:  Nombra la emoci√≥n para tus adentros: "Ah, esto es ansiedad" o "Estoy sintiendo tristeza".','A - Aceptar:  Permite que la emoci√≥n est√© ah√≠, sin luchar contra ella ni juzgarte por sentirla. Puedes decirte: "Est√° bien sentir esto".','I - Investigar:  Con una curiosidad amable, explora c√≥mo se siente la emoci√≥n en tu cuerpo. ¬øD√≥nde est√°? ¬øEs caliente, fr√≠a, tensa, vibrante? ¬øQu√© creencia est√° detr√°s de esta emoci√≥n? ¬øQu√© necesita esta parte herida de ti?','N - No-identificaci√≥n:  Date cuenta de que t√∫ no eres la emoci√≥n. Eres la conciencia espaciosa en la que la emoci√≥n est√° ocurriendo. Descansa en esta conciencia m√°s amplia, viendo la emoci√≥n como una nube pasajera.']};
WD[35]={m:'El camino del guerrero espiritual implica transitar por la "noche oscura del alma", un viaje a las profundidades del ser para enfrentar a nuestros demonios internos (el ego, la sombra). Es en esta aparente oscuridad donde se produce la purificaci√≥n m√°s profunda y donde la luz de la consciencia puede brillar sin impedimentos. Este proceso requiere la fusi√≥n perfecta de las tres puertas: un cuerpo p',c:[['La Noche Oscura del Alma','Un per√≠odo de desolaci√≥n espiritual y desidentificaci√≥n de las viejas estructuras del ego, que precede a una profunda transformaci'],['Vencerse a Uno Mismo','La verdadera batalla no es externa, sino contra nuestros propios automatismos y la identificaci√≥n con el ego.'],['La Fusi√≥n de las Tres Puertas','La maestr√≠a se alcanza cuando el movimiento del cuerpo, la vibraci√≥n de la energ√≠a y la creaci√≥n de la mente surgen de una √∫nica f']],et:'Contemplaci√≥n del Proceso Espiritual',eo:'Reflexionar sobre el propio viaje espiritual utilizando el esquema simb√≥lico presentado.',er:'"TCT Puerta Azul Anexos", p√°g. 53-68.',ep:['Observa la secuencia de im√°genes que describen el proceso espiritual, desde el espacio vac√≠o hasta la realizaci√≥n del cuerpo de arco iris.','Reflexiona sobre en qu√© punto del camino te sientes. ¬øEst√°s en la fase de la mente dualista, empezando a purificar la visi√≥n, o has tenido atisbos del estado de Rigpa?','Contempla la imagen del "viaje del guerrero" y la interacci√≥n de las tres puertas (Cuerpo-Movimiento, Voz-Vibraci√≥n, Mente-Creaci√≥n).','No se trata de juzgar tu progreso, sino de tomar consciencia de tu proceso con honestidad y compasi√≥n. Reconoce que cada paso, incluso los dif√≠ciles, forma parte del camino de regreso a casa.']};
WD[36]={m:'La integraci√≥n de la Puerta Azul es la encarnaci√≥n de la visi√≥n no-dual en la vida diaria. Es dejar de "hacer" las pr√°cticas para "ser" la pr√°ctica. Es vivir como el espejo: reflejando la vida tal como es, con sus alegr√≠as y dolores, sin ser manchado ni definido por ella. La maestr√≠a no es la ausencia de reflejos (pensamientos, emociones), sino el reconocimiento ininterrumpido de nuestra naturalez',c:[],et:'de Integraci√≥n: Vivir el D√≠a como el Espejo',eo:'Mantener el reconocimiento de la mente-espejo durante las actividades cotidianas.',er:'',ep:['Comienza el d√≠a con la intenci√≥n: "Hoy, recuerdo que soy el espejo, no los reflejos".','Durante el d√≠a, cuando surja una situaci√≥n (agradable o desagradable), un pensamiento o una emoci√≥n, n√≥talo y di internamente: "Un reflejo".','Observa la tendencia de la mente a identificarse, a reaccionar, a aferrarse o a rechazar el reflejo.','Amablemente, una y otra vez, trae tu identidad de vuelta al espejo: a la conciencia silenciosa, clara y espaciosa que simplemente observa.','Presta especial atenci√≥n a los momentos de interacci√≥n. ¬øPuedes ver a la otra persona como un reflejo en tu espejo, sin juicio? ¬øPuedes ver tus propias reacciones como reflejos tambi√©n?','Al final del d√≠a, reflexiona: ¬øEn qu√© momentos fue m√°s f√°cil recordar que eres el espejo? ¬øEn qu√© momentos te identificaste m√°s con los reflejos? No hay juicio, solo observaci√≥n para la pr√≥xima pr√°ctica. Puerta Integraci√≥n (Semanas 37-48) Tema Central:  S√≠ntesis y Encarnaci√≥n. Fuentes Principales:  ']};
WD[37]={m:'Repasamos el viaje completo, viendo c√≥mo cada puerta construye sobre la anterior. La Puerta Blanca nos dio el  suelo  (el cuerpo presente). La Puerta Roja nos dio el  coraz√≥n  (la energ√≠a purificada). La Puerta Azul nos dio el  cielo  (la mente espaciosa). Ahora, en la Puerta de Integraci√≥n, aprendemos a vivir simult√°neamente en el suelo, el coraz√≥n y el cielo. Son tres dimensiones de una √∫nica Re',c:[],et:'Meditaci√≥n de las Tres Puertas',eo:'Unificar la conciencia de los tres centros en una sola meditaci√≥n.',er:'',ep:['Si√©ntate en una postura c√≥moda.','Puerta Blanca (5 min):  Lleva tu atenci√≥n a tu cuerpo. Siente el contacto con el suelo, el peso, la postura. Habita tu cuerpo f√≠sico plenamente. Siente la presencia s√≥lida y cimentada.','Puerta Roja (5 min):  Lleva tu atenci√≥n a tu centro energ√©tico, al √°rea del coraz√≥n y la garganta. Siente la energ√≠a vital que pulsa en ti. Con cada respiraci√≥n, siente c√≥mo esta energ√≠a se purifica y se vuelve m√°s sutil y amorosa.','Puerta Azul (5 min):  Expande tu atenci√≥n para incluir el espacio de la mente. Observa los pensamientos como nubes en un cielo vasto y claro. Descansa en la conciencia espaciosa y no-dual.','Integraci√≥n (5 min):  Mant√©n simult√°neamente la conciencia del cuerpo (suelo), la energ√≠a (coraz√≥n) y la mente (cielo). Siente c√≥mo eres las tres cosas a la vez: anclado, vibrante y espacioso.']};
WD[38]={m:'Profundizamos en la "F√≥rmula Esencial de la Felicidad" como el mapa para la integraci√≥n. La felicidad no es una emoci√≥n pasajera, sino la resonancia de un ser en equilibrio. Este equilibrio se sostiene sobre tres pilares que hemos cultivado a lo largo del viaje: Aceptaci√≥n (Puerta Blanca):  La paz que viene de estar presente en el ahora y aceptar la realidad tal como es, comenzando por nuestro pro',c:[],et:'Reflexi√≥n sobre los Tres Pilares',eo:'Evaluar c√≥mo se manifiestan los tres pilares de la felicidad en tu vida actual.',er:'',ep:['Aceptaci√≥n:  ¬øEn qu√© √°reas de mi vida estoy practicando la aceptaci√≥n? ¬øEn qu√© √°reas todav√≠a hay resistencia y lucha? ¬øC√≥mo es mi relaci√≥n con mi cuerpo en este momento?','Prop√≥sito:  ¬øQu√© actividades o acciones me dan un sentido de prop√≥sito? ¬øMis acciones diarias est√°n alineadas con mis valores m√°s profundos? ¬øC√≥mo puedo expresar mi prop√≥sito de formas peque√±as hoy?','Conexi√≥n:  ¬øCu√°ndo me siento m√°s conectado conmigo mismo, con los dem√°s y con la vida? ¬øQu√© h√°bitos o patrones de pensamiento me hacen sentir separado? ¬øC√≥mo puedo cultivar una mayor sensaci√≥n de conexi√≥n?']};
WD[39]={m:'La maestr√≠a no es un logro individualista. Recordamos que cada uno de nosotros, con nuestro estado de conciencia, contribuye al "campo invisible" de la humanidad. Una sociedad consciente no es una utop√≠a, sino el resultado de individuos que asumen la responsabilidad de su propia presencia. El gesto m√°s pol√≠tico y transformador es, a menudo, el m√°s silencioso: escuchar de verdad, no reaccionar auto',c:[],et:'Ofrecer Presencia',eo:'Practicar la contribuci√≥n consciente al campo colectivo.',er:'',ep:['Elige una interacci√≥n del d√≠a (con un familiar, un colega, un dependiente en una tienda).','Antes de la interacci√≥n, toma un momento para centrarte. Conecta con tu cuerpo y tu respiraci√≥n. Establece la intenci√≥n de "ofrecer presencia".','Durante la interacci√≥n, tu √∫nico objetivo es estar plenamente presente. Escucha sin interrumpir. Mira a la persona a los ojos. Siente el campo emocional entre vosotros.','No intentes arreglar, aconsejar o cambiar nada. Tu √∫nica ofrenda es tu atenci√≥n plena y tu presencia no-reactiva.','Observa el efecto que este simple acto tiene en la interacci√≥n y en tu propio estado interno.']};
WD[40]={m:'Retomamos la herramienta del diario desde la perspectiva del Cuarto Camino, pero ahora con la visi√≥n integrada de las tres puertas. El diario se convierte en un laboratorio para la auto-observaci√≥n de los tres centros en acci√≥n y para registrar los momentos de "recuerdo de s√≠" y de "identificaci√≥n". Estructura del Diario Integrado: Observaci√≥n de los Centros:  Al final del d√≠a, anota una situaci√≥n',c:[],et:'Mantener el Diario del Cuarto Camino',eo:'Utilizar la escritura como una herramienta sistem√°tica para aumentar la autoconciencia.',er:'',ep:[]};
WD[41]={m:'La pr√°ctica del perd√≥n de UCDM es el coraz√≥n de la purificaci√≥n de la Puerta Roja y la maestr√≠a de la Puerta Azul. Esta semana, nos comprometemos a hacer del perd√≥n una pr√°ctica diaria y sistem√°tica, utilizando el diario como una herramienta para no dejar que ning√∫n resentimiento o juicio se arraigue en la mente. Estructura del Diario del Perd√≥n: Ma√±ana:  Establece el prop√≥sito del d√≠a: "Por encim',c:[],et:'Mantener el Diario del Perd√≥n',eo:'Hacer del perd√≥n una respuesta autom√°tica a cualquier forma de conflicto.',er:'',ep:[]};
WD[42]={m:'Desde la perspectiva del Dzogchen, la felicidad es nuestro estado natural. El diario se convierte en una herramienta no para "lograr" la felicidad, sino para registrar los momentos en que recordamos nuestra naturaleza de espejo y para observar los patrones que oscurecen esa felicidad. Estructura del Diario de la Mente Feliz: Momentos de "Espejo":  Anota cualquier momento en que te sentiste como el',c:[],et:'Mantener el Diario de la Mente Feliz',eo:'Estabilizar el reconocimiento de la mente natural.',er:'',ep:[]};
WD[43]={m:'La culminaci√≥n de la pr√°ctica es la "acci√≥n sin esfuerzo" o Wu Wei. No significa pasividad, sino actuar en perfecta armon√≠a con el fluir de la vida. Esto solo es posible cuando el ego, con su necesidad de controlar, planificar y forzar, se ha relajado. La no-interferencia es confiar en la inteligencia m√°s profunda del Ser, que sabe qu√© hacer y cu√°ndo hacerlo sin necesidad de la deliberaci√≥n consta',c:[],et:'La Danza del No-Esfuerzo',eo:'Practicar la acci√≥n que surge de la quietud en lugar de la urgencia del ego.',er:'Anexo II de "TCT Puerta Azul", p√°g. 124.',ep:['Establece la intenci√≥n para el d√≠a: "Hoy permitir√© que la vida fluya a trav√©s de m√≠".','Ante cada decisi√≥n o acci√≥n, especialmente si sientes urgencia o ansiedad, haz una pausa.','Respira y conecta con la quietud de tu centro.','Preg√∫ntate: "¬øEsta acci√≥n surge del miedo y la necesidad de controlar, o del flujo natural y la respuesta intuitiva?".','Act√∫a solo cuando la respuesta venga de la quietud. Si no hay claridad, espera. La inacci√≥n consciente es a menudo la acci√≥n m√°s poderosa.']};
WD[44]={m:'Cuando la b√∫squeda del ego para "conseguir algo" se disuelve, emerge una nueva motivaci√≥n: el servicio. El servicio no es necesariamente una acci√≥n grandiosa, sino la expresi√≥n natural de un coraz√≥n abierto. Es el reconocimiento de que nuestra paz y nuestra felicidad son inseparables de la paz y la felicidad de todos. Nuestro legado m√°s importante no es lo que logramos, sino la calidad de presenci',c:[],et:'Un Acto de Servicio An√≥nimo',eo:'Experimentar la alegr√≠a de dar sin ninguna expectativa de reconocimiento.',er:'',ep:['Busca una oportunidad para realizar un peque√±o acto de servicio o bondad de forma an√≥nima.','Puede ser algo simple: dejar una nota amable, hacer una peque√±a donaci√≥n, limpiar un espacio compartido sin que nadie te vea, enviar un pensamiento de amor a alguien con quien tienes dificultades.','El √∫nico requisito es que nadie sepa que lo hiciste t√∫.','Observa la sensaci√≥n que surge. La alegr√≠a del servicio puro no viene de la gratitud externa, sino de la alineaci√≥n interna con el flujo del amor.']};
WD[45]={m:'La comunicaci√≥n se convierte en una de las pr√°cticas de maestr√≠a m√°s importantes. La comunicaci√≥n del ego busca tener raz√≥n, defenderse o manipular. La comunicaci√≥n desde la Fuente busca la conexi√≥n y la verdad. Implica escuchar desde el silencio, hablar desde el coraz√≥n y reconocer al Ser en la otra persona, m√°s all√° de su personalidad. Concepto Clave: Escuchar para Conectar, no para Responder La',c:[],et:'La Conversaci√≥n Consciente',eo:'Transformar una conversaci√≥n ordinaria en una pr√°ctica de presencia.',er:'Anexo II de "TCT Puerta Azul", p√°g. 125.',ep:['Elige una conversaci√≥n que tendr√°s hoy.','Antes de empezar, establece la intenci√≥n de escuchar para conectar, no para ganar.','Durante la conversaci√≥n, mant√©n una parte de tu atenci√≥n en tu propio estado interno. ¬øEst√°s presente? ¬øEst√°s reaccionando?','Cuando la otra persona hable, escucha con todo tu ser. Intenta sentir lo que hay detr√°s de sus palabras.','Cuando sea tu turno de hablar, haz una pausa. Permite que tus palabras surjan de la quietud y la honestidad, no de la reacci√≥n.']};
WD[46]={m:'La maestr√≠a no es un estado est√°tico, sino una cualidad de serenidad radiante que impregna todas nuestras actividades. Es la capacidad de permanecer centrado y en paz en medio del caos del mundo. No es una paz pasiva, sino una calma activa y din√°mica que surge de la confianza inquebrantable en la Realidad. Es el fruto de la integraci√≥n de las tres puertas: un cuerpo relajado, un coraz√≥n abierto y ',c:[],et:'Anclar la Serenidad',eo:'Cultivar la serenidad como estado de fondo a lo largo del d√≠a.',er:'',ep:['Comienza el d√≠a con 5 minutos de silencio, conectando con la sensaci√≥n de paz interior.','A lo largo del d√≠a, utiliza un "ancla" para volver a esa sensaci√≥n. Puede ser una palabra ("Paz"), una imagen (un lago en calma) o una sensaci√≥n f√≠sica (el contacto de tus pies con el suelo).','Cada vez que te sientas arrastrado por el estr√©s o el drama, utiliza tu ancla para hacer una pausa y reconectar con la serenidad que est√° siempre disponible debajo del ruido de la superficie.','La pr√°ctica es volver, una y otra vez, a este centro de calma, hasta que se convierta en tu forma natural de estar en el mundo.']};
WD[47]={m:'El camino espiritual no es una l√≠nea recta, sino una espiral. Volveremos a enfrentar los mismos temas (el ego, el miedo, el perd√≥n), pero cada vez desde un nivel de conciencia m√°s elevado. La integraci√≥n no es un final, sino el comienzo de un trabajo continuo, donde cada vuelta de la espiral profundiza nuestra comprensi√≥n y encarnaci√≥n. Concepto Clave: No hay Regresi√≥n, solo Profundizaci√≥n Cuando ',c:[],et:'Revisi√≥n en Espiral',eo:'Reconocer el progreso en espiral en tu propio camino.',er:'',ep:['Reflexiona sobre un desaf√≠o o patr√≥n con el que has trabajado durante este curso.','Recuerda c√≥mo te relacionabas con √©l al principio (Puerta Blanca). ¬øC√≥mo lo abordaste durante la Puerta Roja? ¬øY desde la perspectiva de la Puerta Azul?','Observa c√≥mo tu comprensi√≥n y tu capacidad para manejarlo han cambiado, aunque el tema central sea el mismo.','Reconoce y honra tu progreso. Si el patr√≥n sigue apareciendo, dale la bienvenida como una oportunidad para una sanaci√≥n a√∫n m√°s profunda, en la siguiente vuelta de la espiral.']};
WD[48]={m:'El viaje de 48 semanas llega a su fin, pero el verdadero Camino apenas comienza. Hemos recibido un mapa y un conjunto de herramientas, pero ahora nos corresponde caminar. El cierre no es una graduaci√≥n, sino un compromiso renovado con la pr√°ctica de la presencia en cada momento de la vida. Reflexi√≥n Final del M√©todo TCT: El objetivo del M√©todo TCT nunca fue convertirte en alguien diferente. Fue ay',c:[],et:'Final: La Promesa a Ti Mismo',eo:'Sellar el compromiso con tu propio despertar.',er:'',ep:['Busca un momento y un lugar tranquilos.','Escribe una carta a tu Ser futuro (el que leer√° esto en un a√±o).','En la carta, describe los aprendizajes m√°s importantes de este viaje. ¬øQu√© has descubierto sobre ti mismo? ¬øQu√© pr√°cticas te han servido m√°s?','Hazte una promesa. No una promesa de "ser perfecto" o "no volver a caer", sino una promesa de "recordar". Prom√©tete que seguir√°s practicando la pausa, que ser√°s amable contigo mismo, que seguir√°s eligiendo la paz.','Guarda la carta en un lugar seguro y pon un recordatorio en tu calendario para leerla dentro de un a√±o. Ser√° un poderoso recordatorio de tu compromiso y un testimonio de tu continuo viaje en la espiral. "Sigue tu camino, con tu propio ritmo, vive en paz, con amor... vive. ¬°S√© la frecuencia del unive']};



// ‚îÄ‚îÄ ADMIN PANEL ‚îÄ‚îÄ
var _adminData = [];

async function loadAdminData() {
  if (!sb) { toast('Sin conexi√≥n a Supabase'); return; }
  const tbody = document.getElementById('admin-tbody');
  tbody.innerHTML = '<tr><td colspan="7" class="admin-empty">‚è≥ Cargando datos...</td></tr>';

  try {
    // Load all users from auth (via user_progress table + auth.users view if available)
    const { data: profiles, error: pe } = await sb.from('user_progress')
      .select('user_id, week_number, status, puerta, completed_at')
      .order('user_id');

    // Try to get user emails from a profiles/users table if it exists
    let usersMap = {};
    try {
      const { data: users } = await sb.from('profiles').select('id, email, full_name, created_at, plan');
      if (users) users.forEach(function(u){ usersMap[u.id] = u; });
    } catch(e) {
      // profiles table may not exist yet ‚Äî that's ok
    }

    if (!profiles || profiles.length === 0) {
      tbody.innerHTML = '<tr><td colspan="7" class="admin-empty">No hay datos de progreso a√∫n. Los alumnos aparecer√°n aqu√≠ cuando inicien su formaci√≥n.</td></tr>';
      document.getElementById('admin-total').textContent = '0';
      document.getElementById('admin-activos').textContent = '0';
      document.getElementById('admin-semana-media').textContent = '‚Äî';
      document.getElementById('admin-completadas').textContent = '0';
      return;
    }

    // Agregate by user
    var byUser = {};
    profiles.forEach(function(p) {
      if (!byUser[p.user_id]) byUser[p.user_id] = { user_id: p.user_id, completed: [], current: 1, puerta: 'Blanca' };
      if (p.status === 'completed') byUser[p.user_id].completed.push(p.week_number);
      if (p.status === 'in_progress') byUser[p.user_id].current = p.week_number;
      if (p.puerta) byUser[p.user_id].puerta = p.puerta;
    });

    _adminData = Object.values(byUser);
    renderAdminTable(_adminData, usersMap);

    // Stats
    var total = _adminData.length;
    var activos = _adminData.filter(function(u){ return u.completed.length > 0; }).length;
    var totalCompleted = _adminData.reduce(function(acc, u){ return acc + u.completed.length; }, 0);
    var semanaMedia = total > 0 ? Math.round(_adminData.reduce(function(acc,u){ return acc + u.current; },0) / total) : 0;
    document.getElementById('admin-total').textContent = total;
    document.getElementById('admin-activos').textContent = activos;
    document.getElementById('admin-semana-media').textContent = semanaMedia;
    document.getElementById('admin-completadas').textContent = totalCompleted;

  } catch(e) {
    tbody.innerHTML = '<tr><td colspan="7" class="admin-empty">Error cargando datos: ' + e.message + '</td></tr>';
    console.error('Admin error:', e);
  }
}

function renderAdminTable(data, usersMap) {
  var tbody = document.getElementById('admin-tbody');
  if (!data || data.length === 0) {
    tbody.innerHTML = '<tr><td colspan="7" class="admin-empty">No se encontraron alumnos.</td></tr>';
    return;
  }
  var badgeClass = { Blanca:'badge-blanca', Roja:'badge-roja', Azul:'badge-azul', Arcoiris:'badge-arcoiris', Oro:'badge-oro' };
  var puertas = { Blanca:'üåø Blanca', Roja:'üî• Roja', Azul:'üîµ Azul', Arcoiris:'üåà Arcoiris', Oro:'‚ú® Oro' };
  tbody.innerHTML = data.map(function(u) {
    var profile = usersMap[u.user_id] || {};
    var name = profile.full_name || '‚Äî';
    var email = profile.email || u.user_id.substring(0,8) + '...';
    var plan = profile.plan || u.puerta || 'Blanca';
    var pct = Math.round((u.completed.length / 48) * 100);
    var fecha = profile.created_at ? new Date(profile.created_at).toLocaleDateString('es-ES') : '‚Äî';
    return '<tr>' +
      '<td><strong style="font-size:13px">' + name + '</strong></td>' +
      '<td style="color:#7a7168">' + email + '</td>' +
      '<td><span class="admin-badge ' + (badgeClass[plan]||'badge-blanca') + '">' + (puertas[plan]||plan) + '</span></td>' +
      '<td style="font-weight:600">Sem. ' + u.current + '</td>' +
      '<td><div style="display:flex;align-items:center;gap:8px"><div class="admin-progress-bar"><div class="admin-progress-fill" style="width:' + pct + '%"></div></div><span style="font-size:11px;color:#7a7168">' + pct + '%</span></div></td>' +
      '<td>' + u.completed.length + ' / 48</td>' +
      '<td style="color:#a89e93;font-size:12px">' + fecha + '</td>' +
    '</tr>';
  }).join('');
}

function filterAdminTable(query) {
  var q = query.toLowerCase();
  var filtered = _adminData.filter(function(u){
    return (u.user_id||'').toLowerCase().includes(q) ||
           (u.puerta||'').toLowerCase().includes(q);
  });
  renderAdminTable(filtered, {});
}

// Override goTo to load admin data when navigating to admin
var _originalGoTo = goTo;
function goTo(page) {
  document.querySelectorAll('.page').forEach(function(p){ p.classList.remove('active'); });
  document.getElementById('page-' + page).classList.add('active');
  window.scrollTo(0,0);
  if (page === 'student') refreshDashboard();
  if (page === 'admin') loadAdminData();
}

// Close modal on outside click
document.getElementById('week-modal').addEventListener('click', function(e){
  if (e.target === this) closeModal();
});
</script>
    
  


<!-- TOAST -->
<div class="toast" id="toast"></div>





<!-- PAGE: ADMIN -->
<div class="page" id="page-admin">
  <div class="admin-wrap">
    <div class="admin-header">
      <h1>Panel <span>Admin</span> ‚Äî Frecuencia Integral Academy</h1>
      <div style="display:flex;gap:10px">
        <button class="admin-refresh" onclick="loadAdminData()">‚Üª Actualizar</button>
        <button class="btn-ghost" style="color:white;border-color:rgba(255,255,255,.2)" onclick="goTo('student')">‚Üê Volver al Dashboard</button>
      </div>
    </div>
    <div class="admin-body">
      <!-- Stats -->
      <div class="admin-stats">
        <div class="admin-stat">
          <div class="admin-stat-val" id="admin-total">‚Äî</div>
          <div class="admin-stat-label">Alumnos Totales</div>
        </div>
        <div class="admin-stat">
          <div class="admin-stat-val" id="admin-activos">‚Äî</div>
          <div class="admin-stat-label">Con Progreso</div>
        </div>
        <div class="admin-stat">
          <div class="admin-stat-val" id="admin-semana-media">‚Äî</div>
          <div class="admin-stat-label">Semana Media</div>
        </div>
        <div class="admin-stat">
          <div class="admin-stat-val" id="admin-completadas">‚Äî</div>
          <div class="admin-stat-label">Semanas Completadas</div>
        </div>
      </div>
      <!-- Table -->
      <div class="admin-table-wrap">
        <div class="admin-table-header">
          <div class="admin-table-title">Alumnos Registrados</div>
          <input class="admin-search" id="admin-search" type="text" placeholder="üîç Buscar alumno..." oninput="filterAdminTable(this.value)">
        </div>
        <div style="overflow-x:auto">
          <table class="admin-table" id="admin-table">
            <thead>
              <tr>
                <th>Alumno</th>
                <th>Email</th>
                <th>Plan / Puerta</th>
                <th>Semana Actual</th>
                <th>Progreso</th>
                <th>Completadas</th>
                <th>Registro</th>
              </tr>
            </thead>
            <tbody id="admin-tbody">
              <tr><td colspan="7" class="admin-empty">Cargando alumnos...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div><!-- /page-admin -->

<!-- PDF FULLSCREEN MODAL -->
<div class="pdf-modal-overlay" id="pdf-fullscreen-modal">
  <div class="pdf-modal-topbar">
    <div class="pdf-modal-topbar-name" id="pdf-fullscreen-name"></div>
    <div class="pdf-modal-topbar-actions">
      <a class="btn-pdf-fullscreen-dl" id="pdf-fullscreen-dl" href="#" download="" target="_blank">‚¨á Descargar</a>
      <button class="btn-pdf-fullscreen-close" onclick="closePdfFullscreen()">‚úï Cerrar</button>
    </div>
  </div>
  <iframe class="pdf-modal-frame" id="pdf-fullscreen-frame" src=""></iframe>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- GESTOR DE HEADER, CATEGOR√çAS Y P√ÅGINAS OCULTAS           -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- PANEL PRINCIPAL DEL GESTOR -->
<div id="hcpPanel" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;z-index:10010;background:rgba(0,0,0,.7);backdrop-filter:blur(4px)">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:min(94vw,860px);max-height:90vh;background:#161210;border-radius:16px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 24px 80px rgba(0,0,0,.8);font-family:'DM Sans',sans-serif">

    <!-- Header del panel -->
    <div style="background:#1c1814;padding:16px 24px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,.1);flex-shrink:0">
      <div style="display:flex;align-items:center;gap:12px">
        <span style="font-size:18px">üóÇÔ∏è</span>
        <div>
          <div style="font-size:14px;font-weight:700;color:white">Gestor de Navegaci√≥n y P√°ginas</div>
          <div style="font-size:10px;color:rgba(255,255,255,.4);margin-top:1px">Header ¬∑ Categor√≠as ¬∑ P√°ginas ocultas</div>
        </div>
      </div>
      <button onclick="hcpClose()" style="background:rgba(255,255,255,.08);border:none;color:rgba(255,255,255,.5);width:32px;height:32px;border-radius:8px;font-size:16px;cursor:pointer">‚úï</button>
    </div>

    <!-- Tabs -->
    <div style="display:flex;border-bottom:1px solid rgba(255,255,255,.08);flex-shrink:0;background:#1a1510">
      <button onclick="hcpTab('header')" class="hcp-tab active" id="hcpTabHeader">üîó Header</button>
      <button onclick="hcpTab('cats')" class="hcp-tab" id="hcpTabCats">üìÇ Categor√≠as</button>
      <button onclick="hcpTab('pages')" class="hcp-tab" id="hcpTabPages">üìÑ P√°ginas</button>
    </div>

    <!-- Content area -->
    <div id="hcpContent" style="flex:1;overflow-y:auto;padding:20px 24px">

      <!-- ‚ïê‚ïê‚ïê TAB: HEADER ‚ïê‚ïê‚ïê -->
      <div id="hcpSecHeader">
        <div style="color:rgba(255,255,255,.5);font-size:10px;text-transform:uppercase;letter-spacing:.1em;margin-bottom:16px">Configura el logo, enlaces y botones del header</div>

        <!-- Logo -->
        <div class="hcp-card">
          <div class="hcp-card-title">üè∑Ô∏è Logo / Nombre del sitio</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
            <div>
              <div class="hcp-label">Nombre principal</div>
              <input id="hcpLogoName" class="hcp-inp" value="Frecuencia Integral" placeholder="Nombre del sitio">
            </div>
            <div>
              <div class="hcp-label">Subt√≠tulo (debajo)</div>
              <input id="hcpLogoSub" class="hcp-inp" value="Academy" placeholder="Subt√≠tulo">
            </div>
          </div>
          <div style="margin-top:10px">
            <div class="hcp-label">URL al hacer clic en el logo</div>
            <input id="hcpLogoUrl" class="hcp-inp" value="#" placeholder="# o https://...">
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
            <div style="flex:1;min-width:120px">
              <div class="hcp-label">Color nombre</div>
              <div style="display:flex;gap:5px;align-items:center">
                <input type="color" id="hcpLogoColor" value="#1c1814" style="width:30px;height:30px;border:none;border-radius:5px;cursor:pointer">
                <input id="hcpLogoColorTxt" class="hcp-inp" value="#1c1814" style="flex:1" oninput="document.getElementById('hcpLogoColor').value=this.value">
              </div>
            </div>
            <div style="flex:1;min-width:120px">
              <div class="hcp-label">Color subt√≠tulo</div>
              <div style="display:flex;gap:5px;align-items:center">
                <input type="color" id="hcpLogoSubColor" value="#7a7168" style="width:30px;height:30px;border:none;border-radius:5px;cursor:pointer">
                <input id="hcpLogoSubColorTxt" class="hcp-inp" value="#7a7168" style="flex:1" oninput="document.getElementById('hcpLogoSubColor').value=this.value">
              </div>
            </div>
            <div style="flex:1;min-width:120px">
              <div class="hcp-label">Tama√±o fuente</div>
              <select id="hcpLogoSize" class="hcp-inp">
                <option value="16px">16px</option><option value="18px">18px</option>
                <option value="20px" selected="">20px</option><option value="22px">22px</option>
                <option value="24px">24px</option><option value="28px">28px</option>
              </select>
            </div>
            <div style="flex:1;min-width:120px">
              <div class="hcp-label">Fuente</div>
              <select id="hcpLogoFont" class="hcp-inp">
                <option value="'Cormorant Garamond',serif" selected="">Cormorant</option>
                <option value="'DM Sans',sans-serif">DM Sans</option>
                <option value="Georgia,serif">Georgia</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Fondo del nav -->
        <div class="hcp-card">
          <div class="hcp-card-title">üé® Fondo y borde del header</div>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px">
            <div>
              <div class="hcp-label">Color fondo</div>
              <div style="display:flex;gap:5px;align-items:center">
                <input type="color" id="hcpNavBg" value="#f7f5f1" style="width:30px;height:30px;border:none;border-radius:5px;cursor:pointer">
                <input id="hcpNavBgTxt" class="hcp-inp" value="rgba(247,245,241,.95)" style="flex:1">
              </div>
            </div>
            <div>
              <div class="hcp-label">Color borde inferior</div>
              <div style="display:flex;gap:5px;align-items:center">
                <input type="color" id="hcpNavBorder" value="#e4ddd3" style="width:30px;height:30px;border:none;border-radius:5px;cursor:pointer">
                <input id="hcpNavBorderTxt" class="hcp-inp" value="#e4ddd3" style="flex:1">
              </div>
            </div>
            <div>
              <div class="hcp-label">Alto del header</div>
              <select id="hcpNavHeight" class="hcp-inp">
                <option value="56px">56px</option><option value="66px" selected="">66px</option>
                <option value="72px">72px</option><option value="80px">80px</option>
              </select>
            </div>
          </div>
          <!-- Paleta r√°pida fondo -->
          <div style="margin-top:8px;display:flex;gap:5px;flex-wrap:wrap">
            <div onclick="document.getElementById('hcpNavBgTxt').value=this.dataset.v;document.getElementById('hcpNavBg').value='#f7f5f1'" data-v="rgba(247,245,241,.95)" style="width:28px;height:22px;background:#f7f5f1;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.2)" title="Crema"></div>
            <div onclick="document.getElementById('hcpNavBgTxt').value=this.dataset.v" data-v="rgba(28,24,20,.96)" style="width:28px;height:22px;background:#1c1814;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.2)" title="Negro"></div>
            <div onclick="document.getElementById('hcpNavBgTxt').value=this.dataset.v" data-v="rgba(43,125,122,.96)" style="width:28px;height:22px;background:#2b7d7a;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.2)" title="Verde"></div>
            <div onclick="document.getElementById('hcpNavBgTxt').value=this.dataset.v" data-v="rgba(255,255,255,.97)" style="width:28px;height:22px;background:white;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.2)" title="Blanco"></div>
            <div onclick="document.getElementById('hcpNavBgTxt').value=this.dataset.v" data-v="transparent" style="width:28px;height:22px;background:linear-gradient(135deg,#ccc 25%,transparent 25%,transparent 75%,#ccc 75%),linear-gradient(135deg,#ccc 25%,white 25%,white 75%,#ccc 75%);background-size:6px 6px;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.2)" title="Transparente"></div>
          </div>
        </div>

        <!-- Nav links -->
        <div class="hcp-card">
          <div class="hcp-card-title">üîó Enlaces de navegaci√≥n
            <button onclick="hcpAddLink()" class="hcp-btn-sm" style="margin-left:auto">+ A√±adir enlace</button>
          </div>
          <div id="hcpLinksList" style="display:flex;flex-direction:column;gap:6px"></div>
          <div style="margin-top:10px;padding:8px 10px;background:rgba(255,255,255,.04);border-radius:6px;font-size:10px;color:rgba(255,255,255,.35)">
            üí° Usa <code style="background:rgba(255,255,255,.08);padding:1px 4px;border-radius:3px">#id-seccion</code> para scroll o <code style="background:rgba(255,255,255,.08);padding:1px 4px;border-radius:3px">page:nombre</code> para ir a una p√°gina custom
          </div>
        </div>

        <!-- Botones header -->
        <div class="hcp-card">
          <div class="hcp-card-title">üîò Botones del header</div>
          <div id="hcpBtnsList" style="display:flex;flex-direction:column;gap:8px"></div>
        </div>

        <button onclick="hcpApplyHeader()" class="hcp-apply-btn">‚úÖ Aplicar cambios al header</button>
      </div>

      <!-- ‚ïê‚ïê‚ïê TAB: CATEGOR√çAS ‚ïê‚ïê‚ïê -->
      <div id="hcpSecCats" style="display:none">
        <div style="color:rgba(255,255,255,.5);font-size:10px;text-transform:uppercase;letter-spacing:.1em;margin-bottom:16px">√Årbol de categor√≠as y subcategor√≠as hasta 3 niveles</div>

        <div class="hcp-card">
          <div class="hcp-card-title">üìÇ √Årbol de categor√≠as
            <button onclick="hcpAddCat(null,0)" class="hcp-btn-sm" style="margin-left:auto">+ Categor√≠a ra√≠z</button>
          </div>
          <div id="hcpCatTree" style="display:flex;flex-direction:column;gap:3px"></div>
        </div>

        <!-- Editor de categor√≠a -->
        <div id="hcpCatEditor" style="display:none" class="hcp-card">
          <div class="hcp-card-title" id="hcpCatEdTitle">‚úèÔ∏è Editar categor√≠a</div>
          <input type="hidden" id="hcpCatEdId">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px">
            <div>
              <div class="hcp-label">Nombre</div>
              <input id="hcpCatEdName" class="hcp-inp" placeholder="Nombre de la categor√≠a">
            </div>
            <div>
              <div class="hcp-label">Emoji / Icono</div>
              <input id="hcpCatEdIcon" class="hcp-inp" placeholder="üìÇ (opcional)">
            </div>
            <div>
              <div class="hcp-label">URL / Destino</div>
              <input id="hcpCatEdUrl" class="hcp-inp" placeholder="# o page:nombre o https://...">
            </div>
            <div>
              <div class="hcp-label">Descripci√≥n corta</div>
              <input id="hcpCatEdDesc" class="hcp-inp" placeholder="Descripci√≥n (opcional)">
            </div>
          </div>
          <div style="display:flex;gap:8px;align-items:center;margin-bottom:10px;flex-wrap:wrap">
            <label style="display:flex;align-items:center;gap:5px;font-size:11px;color:rgba(255,255,255,.6);cursor:pointer">
              <input type="checkbox" id="hcpCatEdVisible" checked=""> Visible en navegaci√≥n
            </label>
            <label style="display:flex;align-items:center;gap:5px;font-size:11px;color:rgba(255,255,255,.6);cursor:pointer">
              <input type="checkbox" id="hcpCatEdOpenNew"> Abrir en nueva pesta√±a
            </label>
          </div>
          <div style="display:flex;gap:6px">
            <button onclick="hcpSaveCat()" class="hcp-apply-btn" style="flex:1">üíæ Guardar categor√≠a</button>
            <button onclick="document.getElementById('hcpCatEditor').style.display='none'" class="hcp-btn-sm">Cancelar</button>
          </div>
        </div>

        <div style="margin-top:16px;padding:12px 14px;background:rgba(184,149,88,.08);border:1px solid rgba(184,149,88,.2);border-radius:10px;font-size:11px;color:rgba(255,255,255,.5);line-height:1.6">
          <strong style="color:#b89558">üìã C√≥mo usar:</strong><br>
          ‚Ä¢ <strong>Nivel 1</strong> ‚Äî categor√≠as principales ‚Üí aparecen en el men√∫ principal<br>
          ‚Ä¢ <strong>Nivel 2</strong> ‚Äî subcategor√≠as ‚Üí desplegable al pasar el rat√≥n<br>
          ‚Ä¢ <strong>Nivel 3</strong> ‚Äî sub-subcategor√≠as ‚Üí men√∫ lateral o columna adicional<br>
          ‚Ä¢ Drag &amp; drop o usa las flechas para reordenar
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê TAB: P√ÅGINAS ‚ïê‚ïê‚ïê -->
      <div id="hcpSecPages" style="display:none">
        <div style="color:rgba(255,255,255,.5);font-size:10px;text-transform:uppercase;letter-spacing:.1em;margin-bottom:16px">P√°ginas/landings independientes ‚Äî no aparecen en la navegaci√≥n autom√°ticamente</div>

        <div class="hcp-card">
          <div class="hcp-card-title">üìÑ P√°ginas creadas
            <button onclick="hcpCreatePage()" class="hcp-btn-sm" style="margin-left:auto;background:rgba(43,125,122,.25);color:#3d9e9b;border-color:rgba(43,125,122,.4)">+ Nueva p√°gina</button>
          </div>
          <div id="hcpPagesList" style="display:flex;flex-direction:column;gap:6px"></div>
          <div style="margin-top:10px;padding:10px;background:rgba(255,255,255,.03);border-radius:8px;font-size:10px;color:rgba(255,255,255,.3);line-height:1.7">
            üí° Las p√°ginas creadas aqu√≠ son accesibles mediante <code style="background:rgba(255,255,255,.06);padding:1px 4px;border-radius:3px">goTo('page-slug')</code> o desde un enlace con <code style="background:rgba(255,255,255,.06);padding:1px 4px;border-radius:3px">page:slug</code>. No aparecen en el header salvo que las a√±adas manualmente como enlace.
          </div>
        </div>

        <!-- Editor de p√°gina -->
        <div id="hcpPageEditor" style="display:none" class="hcp-card">
          <div class="hcp-card-title" id="hcpPageEdTitle">‚úèÔ∏è Nueva p√°gina</div>
          <input type="hidden" id="hcpPageEdId">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px">
            <div>
              <div class="hcp-label">T√≠tulo de la p√°gina</div>
              <input id="hcpPageEdName" class="hcp-inp" placeholder="Ej: Pol√≠tica de privacidad">
            </div>
            <div>
              <div class="hcp-label">Slug / ID √∫nico <span style="color:#bf4637">*</span></div>
              <input id="hcpPageEdSlug" class="hcp-inp" placeholder="privacy-policy (sin espacios)">
            </div>
          </div>
          <div style="margin-bottom:10px">
            <div class="hcp-label">Descripci√≥n / Notas internas</div>
            <textarea id="hcpPageEdDesc" class="hcp-inp" rows="2" style="resize:vertical" placeholder="Para uso interno, no se muestra"></textarea>
          </div>
          <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px">
            <label style="display:flex;align-items:center;gap:5px;font-size:11px;color:rgba(255,255,255,.6);cursor:pointer">
              <input type="checkbox" id="hcpPageEdVisible"> Visible (activar p√°gina)
            </label>
            <label style="display:flex;align-items:center;gap:5px;font-size:11px;color:rgba(255,255,255,.6);cursor:pointer">
              <input type="checkbox" id="hcpPageEdInNav"> A√±adir al men√∫ de navegaci√≥n
            </label>
          </div>
          <!-- Plantillas -->
          <div style="margin-bottom:12px">
            <div class="hcp-label">Plantilla inicial</div>
            <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:6px">
              <button onclick="hcpPageTpl('blank')" class="hcp-tpl-btn">‚¨ú En blanco</button>
              <button onclick="hcpPageTpl('landing')" class="hcp-tpl-btn">üöÄ Landing</button>
              <button onclick="hcpPageTpl('legal')" class="hcp-tpl-btn">üìã Legal/Texto</button>
              <button onclick="hcpPageTpl('about')" class="hcp-tpl-btn">üë§ Sobre M√≠</button>
              <button onclick="hcpPageTpl('contact')" class="hcp-tpl-btn">üì© Contacto</button>
              <button onclick="hcpPageTpl('thanks')" class="hcp-tpl-btn">üôè Gracias</button>
              <button onclick="hcpPageTpl('sales')" class="hcp-tpl-btn">üí∞ Ventas</button>
            </div>
          </div>
          <div style="display:flex;gap:6px">
            <button onclick="hcpSavePage()" class="hcp-apply-btn" style="flex:1">üíæ Crear p√°gina</button>
            <button onclick="document.getElementById('hcpPageEditor').style.display='none'" class="hcp-btn-sm">Cancelar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer del panel -->
    <div style="padding:12px 24px;border-top:1px solid rgba(255,255,255,.08);background:#1a1510;display:flex;align-items:center;justify-content:space-between;flex-shrink:0">
      <span id="hcpMsg" style="font-size:11px;color:#3d9e9b"></span>
      <button onclick="hcpClose()" style="background:rgba(255,255,255,.07);color:rgba(255,255,255,.45);border:none;padding:7px 16px;border-radius:7px;font-size:12px;cursor:pointer">Cerrar</button>
    </div>
  </div>
</div>

<!-- MEN√ö DE NAVEGACI√ìN CON DROPDOWNS (reemplaza nav-links) -->
<style>
/* ‚îÄ‚îÄ HCP Panel ‚îÄ‚îÄ */
.hcp-tab{background:none;border:none;color:rgba(255,255,255,.45);padding:12px 18px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;border-bottom:2px solid transparent;transition:all .15s}
.hcp-tab:hover{color:rgba(255,255,255,.75)}
.hcp-tab.active{color:#3d9e9b;border-bottom-color:#3d9e9b}
.hcp-card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:14px 16px;margin-bottom:12px}
.hcp-card-title{font-size:11px;font-weight:700;color:rgba(255,255,255,.6);text-transform:uppercase;letter-spacing:.07em;margin-bottom:12px;display:flex;align-items:center;gap:8px}
.hcp-label{font-size:9px;text-transform:uppercase;letter-spacing:.07em;color:rgba(255,255,255,.35);margin-bottom:4px}
.hcp-inp{background:#1c1814;color:white;border:1px solid rgba(255,255,255,.12);padding:7px 10px;border-radius:7px;font-size:12px;font-family:'DM Sans',sans-serif;outline:none;width:100%;box-sizing:border-box}
.hcp-inp:focus{border-color:#3d9e9b}
.hcp-btn-sm{background:#252118;color:rgba(255,255,255,.6);border:1px solid rgba(255,255,255,.12);padding:5px 12px;border-radius:6px;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap}
.hcp-btn-sm:hover{background:#353028;color:white}
.hcp-apply-btn{background:#2b7d7a;color:white;border:none;padding:9px 20px;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap}
.hcp-apply-btn:hover{background:#3d9e9b}
.hcp-tpl-btn{background:#1c1814;color:rgba(255,255,255,.65);border:1px solid rgba(255,255,255,.12);padding:6px 12px;border-radius:6px;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif}
.hcp-tpl-btn:hover{background:#2b7d7a;color:white;border-color:#2b7d7a}
/* Cat tree */
.hcp-cat-item{display:flex;align-items:center;gap:6px;padding:7px 10px;background:rgba(255,255,255,.04);border-radius:7px;border:1px solid rgba(255,255,255,.07);cursor:pointer;transition:background .12s}
.hcp-cat-item:hover{background:rgba(255,255,255,.08)}
.hcp-cat-l1{margin-left:0}
.hcp-cat-l2{margin-left:20px;border-left:2px solid rgba(43,125,122,.3)}
.hcp-cat-l3{margin-left:40px;border-left:2px solid rgba(184,149,88,.3)}
/* Link row editor */
.hcp-link-row{display:flex;align-items:center;gap:6px;padding:7px 10px;background:rgba(255,255,255,.04);border-radius:7px;border:1px solid rgba(255,255,255,.07)}
/* Nav dropdown */
.nav-links{position:relative}
.nav-links>a,.nav-links>.nav-dd-trigger{font-size:13px;color:#3d3730;text-decoration:none;cursor:pointer;display:flex;align-items:center;gap:4px;padding:4px 0;position:relative}
.nav-links>a:hover,.nav-links>.nav-dd-trigger:hover{color:#2b7d7a}
.nav-dd{position:absolute;top:calc(100% + 10px);left:50%;transform:translateX(-50%);background:white;border:1px solid #e4ddd3;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,.12);min-width:200px;padding:6px;z-index:200;display:none;flex-direction:column;gap:2px}
.nav-dd-trigger:hover .nav-dd,.nav-dd:hover{display:flex}
.nav-dd-item{padding:8px 12px;border-radius:8px;font-size:13px;color:#3d3730;cursor:pointer;display:flex;align-items:center;gap:8px;text-decoration:none;position:relative}
.nav-dd-item:hover{background:#f0ece4;color:#2b7d7a}
.nav-dd-item.has-sub::after{content:'‚Ä∫';margin-left:auto;font-size:16px;color:#b8ad9e}
.nav-dd3{position:absolute;top:0;left:100%;margin-left:4px;background:white;border:1px solid #e4ddd3;border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,.1);min-width:190px;padding:6px;z-index:201;display:none;flex-direction:column;gap:2px}
.nav-dd-item:hover .nav-dd3{display:flex}
</style>

<!-- EDITOR BUTTON -->
<!-- ZONA SECRETA: triple-clic esquina inferior izquierda activa el editor -->
<div id="edSecretZone" onclick="edSecretClick()" style="position:fixed;bottom:0;left:0;width:50px;height:50px;z-index:99998;cursor:default;-webkit-tap-highlight-color:transparent"></div>

<!-- MODAL CONTRASE√ëA EDITOR -->
<div id="edPwdModal" style="display: none; position: fixed; inset: 0px; z-index: 999999; background: rgba(0, 0, 0, 0.75); backdrop-filter: blur(6px); align-items: center; justify-content: center;">
  <div style="background: rgb(28, 24, 20); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 16px; padding: 32px 36px; width: min(340px, 90vw); box-shadow: rgba(0, 0, 0, 0.7) 0px 20px 60px; font-family: &quot;DM Sans&quot;, sans-serif;" data-protonpass-form="">
    <div style="text-align:center;margin-bottom:22px">
      <div style="font-size:32px;margin-bottom:10px">üîê</div>
      <div style="font-size:16px;font-weight:700;color:white">Acceso al Editor</div>
      <div style="font-size:12px;color:rgba(255,255,255,.35);margin-top:5px">Introduce la contrase√±a para editar</div>
    </div>
    <input id="edPwdInput" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="off" style="width: 100%; box-sizing: border-box; background: rgb(37, 33, 24); color: white; border: 1px solid rgba(255, 255, 255, 0.2); padding: 13px 14px; border-radius: 9px; font-size: 16px; font-family: &quot;DM Sans&quot;, sans-serif; outline: none; margin-bottom: 8px; text-align: center; letter-spacing: 0.15em;" onkeydown="if(event.key==='Enter')edPwdCheck()">
    <div id="edPwdErr" style="display: none; color: rgb(240, 128, 128); font-size: 11px; text-align: center; margin-bottom: 10px;">‚ùå Contrase√±a incorrecta</div>
    <div style="display:flex;gap:8px;margin-top:4px">
      <button onclick="edPwdCheck()" style="flex:1;background:#2b7d7a;color:white;border:none;padding:12px;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif">Entrar</button>
      <button onclick="edPwdCancel()" style="background:rgba(255,255,255,.06);color:rgba(255,255,255,.4);border:1px solid rgba(255,255,255,.1);padding:12px 16px;border-radius:8px;font-size:13px;cursor:pointer">Cancelar</button>
    </div>
    <div style="margin-top:18px;padding-top:14px;border-top:1px solid rgba(255,255,255,.07);font-size:10px;color:rgba(255,255,255,.18);text-align:center;line-height:1.6">
      Los visitantes no ven esta pantalla ni saben que existe.
    </div>
  </div>
</div>

<!-- BOT√ìN EDITOR (oculto ‚Äî aparece solo tras contrase√±a correcta) -->
<button onclick="wixSideBarOpen()" id="edOpenBtn" style="position: fixed; bottom: 80px; left: 24px; z-index: 99999; background: rgb(28, 24, 20); color: white; border: 2px solid rgba(255, 255, 255, 0.2); padding: 10px 18px; border-radius: 100px; font-size: 12px; font-weight: 700; cursor: pointer; font-family: &quot;DM Sans&quot;, sans-serif; box-shadow: rgba(0, 0, 0, 0.5) 0px 4px 20px; display: none;" class="">‚úèÔ∏è Editor</button>

<!-- BOT√ìN GESTOR (visible solo con editor abierto) -->
<button onclick="hcpOpen()" id="hcpOpenBtn" style="display:none;position:fixed;bottom:80px;left:130px;z-index:99999;background:#2b7d7a;color:white;border:2px solid rgba(255,255,255,.15);padding:10px 18px;border-radius:100px;font-size:12px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;box-shadow:0 4px 20px rgba(0,0,0,.4)">üóÇÔ∏è Navegaci√≥n</button>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- BARRA FLOTANTE DE FORMATO (aparece al selec. texto) -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="edFmtBar" style="display: none; position: fixed; z-index: 10003; background: rgb(22, 18, 16); border: 1px solid rgba(255, 255, 255, 0.18); border-radius: 10px; padding: 5px 7px; gap: 2px; align-items: center; box-shadow: rgba(0, 0, 0, 0.7) 0px 6px 28px; flex-wrap: wrap; max-width: 640px;" data-protonpass-form="">
  <!-- Info fuente actual -->
  <div id="edFontInfo" style="display:flex;align-items:center;gap:5px;background:rgba(255,255,255,.06);border-radius:6px;padding:3px 8px;margin-right:4px;min-width:120px">
    <span id="edFontInfoFamily" style="font-size:10px!important;color:#b89558;font-weight:700;max-width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">‚Äî</span>
    <span style="font-size:9px!important;color:rgba(255,255,255,.25)">¬∑</span>
    <span id="edFontInfoSize" style="font-size:10px!important;color:rgba(255,255,255,.55);white-space:nowrap">‚Äî</span>
  </div>
  <div class="efbsep"></div>
  <!-- Formato b√°sico -->
  <button onclick="edFmt('bold')" class="efb" title="Negrita Ctrl+B"><b>B</b></button>
  <button onclick="edFmt('italic')" class="efb" title="Cursiva Ctrl+I"><i style="font-style:italic">I</i></button>
  <button onclick="edFmt('underline')" class="efb" title="Subrayado" style="text-decoration:underline">U</button>
  <button onclick="edFmt('strikeThrough')" class="efb" title="Tachado" style="text-decoration:line-through">S</button>
  <div class="efbsep"></div>
  <!-- Alineaci√≥n -->
  <button onclick="edFmt('justifyLeft')" class="efb" title="Izquierda">‚â°‚¨õ</button>
  <button onclick="edFmt('justifyCenter')" class="efb" title="Centrar">‚¨õ‚â°</button>
  <button onclick="edFmt('justifyRight')" class="efb" title="Derecha">‚â°‚¨õ</button>
  <div class="efbsep"></div>
  <!-- Encabezados -->
  <button onclick="edFmtBlock('h1')" class="efb efb-lbl" title="T√≠tulo H1">H1</button>
  <button onclick="edFmtBlock('h2')" class="efb efb-lbl" title="T√≠tulo H2">H2</button>
  <button onclick="edFmtBlock('h3')" class="efb efb-lbl" title="T√≠tulo H3">H3</button>
  <button onclick="edFmtBlock('p')" class="efb efb-lbl" title="P√°rrafo">P</button>
  <div class="efbsep"></div>
  <!-- Listas -->
  <button onclick="edFmt('insertUnorderedList')" class="efb" title="Lista vi√±etas">‚Ä¢‚â°</button>
  <button onclick="edFmt('insertOrderedList')" class="efb" title="Lista numerada">1.‚â°</button>
  <div class="efbsep"></div>
  <!-- Color texto inline -->
  <div style="display:flex;align-items:center;gap:3px">
    <span style="font-size:9px;color:rgba(255,255,255,.4)">A</span>
    <input type="color" id="efbTxtColor" value="#1c1814" style="width:22px;height:22px;border:none;border-radius:3px;cursor:pointer;padding:0" onchange="edApplyFontColor(this.value)" title="Color texto">
  </div>
  <!-- Resaltar -->
  <div style="display:flex;align-items:center;gap:3px">
    <span style="font-size:9px;color:rgba(255,255,255,.4)">‚ñì</span>
    <input type="color" id="efbHlColor" value="#fff9c4" style="width:22px;height:22px;border:none;border-radius:3px;cursor:pointer;padding:0" onchange="edFmtHighlight(this.value)" title="Resaltar texto">
  </div>
  <div class="efbsep"></div>
  <!-- Tama√±o inline -->
  <select onchange="if(this.value){edApplyFontSize(this.value);this.value=''}" style="background:#2a2420;color:white;border:1px solid rgba(255,255,255,.15);padding:2px 3px;border-radius:5px;font-size:10px;cursor:pointer;max-width:52px" title="Tama√±o texto">
    <option value="">px</option>
    <option value="10px">10</option><option value="11px">11</option><option value="12px">12</option>
    <option value="13px">13</option><option value="14px">14</option><option value="15px">15</option>
    <option value="16px">16</option><option value="18px">18</option><option value="20px">20</option>
    <option value="22px">22</option><option value="24px">24</option><option value="28px">28</option>
    <option value="32px">32</option><option value="36px">36</option><option value="40px">40</option>
    <option value="48px">48</option><option value="56px">56</option><option value="64px">64</option>
    <option value="72px">72</option><option value="80px">80</option><option value="96px">96</option>
  </select>
  <input type="number" min="8" max="200" placeholder="px" title="Tam. libre" style="width:38px;background:#2a2420;color:white;border:1px solid rgba(255,255,255,.15);padding:2px 4px;border-radius:5px;font-size:10px;outline:none" onkeydown="if(event.key==='Enter'&amp;&amp;this.value){edApplyFontSize(this.value+'px');this.value=''}">
  <div class="efbsep"></div>
  <!-- Tipograf√≠a inline -->
  <select onchange="if(this.value){edApplyFontInline(this.value);this.value=''}" style="background:#2a2420;color:white;border:1px solid rgba(255,255,255,.15);padding:2px 3px;border-radius:5px;font-size:10px;cursor:pointer;max-width:80px">
    <option value="">Font</option>
    <option value="'DM Sans',sans-serif">DM Sans</option>
    <option value="'Cormorant Garamond',serif">Cormorant</option>
    <option value="Georgia,serif">Georgia</option>
    <option value="Arial,sans-serif">Arial</option>
    <option value="'Helvetica Neue',sans-serif">Helvetica</option>
    <option value="'Times New Roman',serif">Times NR</option>
    <option value="'Courier New',monospace">Courier</option>
  </select>
  <div class="efbsep"></div>
  <!-- Superscript / Subscript -->
  <button onclick="edFmt('superscript')" class="efb" title="Super√≠ndice" style="font-size:9px">X¬≤</button>
  <button onclick="edFmt('subscript')" class="efb" title="Sub√≠ndice" style="font-size:9px">X‚ÇÇ</button>
  <!-- Link -->
  <button onclick="edAddLink()" class="efb" title="Enlace">üîó</button>
  <!-- Cerrar -->
  <button onclick="edFmtBarHide()" style="background:none;border:none;color:rgba(255,255,255,.3);font-size:13px;cursor:pointer;padding:1px 5px;margin-left:2px;line-height:1">‚úï</button>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- PANEL LATERAL DE PROPIEDADES                       -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="edPropsPanel" style="display: none; position: fixed; right: 0px; top: 0px; bottom: 0px; z-index: 9996; width: 268px; background: rgb(22, 18, 16); border-left: 1px solid rgba(255, 255, 255, 0.1); overflow-y: auto; font-family: &quot;DM Sans&quot;, sans-serif; padding-bottom: 120px;" data-protonpass-form="">

  <!-- Header -->
  <div style="position:sticky;top:0;z-index:2;background:#161210;padding:10px 14px 8px;border-bottom:1px solid rgba(255,255,255,.1);display:flex;align-items:center;justify-content:space-between">
    <span style="font-size:11px;font-weight:700;color:#3d9e9b;letter-spacing:.08em">‚öô PROPIEDADES</span>
    <div style="display:flex;align-items:center;gap:6px">
      <code id="edPropsTag" style="font-size:9px;color:rgba(255,255,255,.3);background:rgba(255,255,255,.06);padding:2px 5px;border-radius:3px">&lt;div&gt;</code>
      <button onclick="edCloseProps()" style="background:none;border:none;color:rgba(255,255,255,.3);font-size:14px;cursor:pointer;padding:0 2px">‚úï</button>
    </div>
  </div>

  <!-- SECCI√ìN: TAMA√ëO -->
  <div class="epp-sec">
    <div class="epp-lbl">üìê Tama√±o del contenedor</div>
    <div class="epp-grid2">
      <div><div class="epp-sub">Ancho (W)</div>
        <input id="prpW" type="text" placeholder="auto" class="epp-inp" oninput="edPropLive('width',this.value)" title="px / % / auto / vw"></div>
      <div><div class="epp-sub">Alto (H)</div>
        <input id="prpH" type="text" placeholder="auto" class="epp-inp" oninput="edPropLive('height',this.value)" title="px / vh / auto"></div>
      <div><div class="epp-sub">M√°x. ancho</div>
        <input id="prpMW" type="text" placeholder="none" class="epp-inp" oninput="edPropLive('maxWidth',this.value)"></div>
      <div><div class="epp-sub">M√≠n. alto</div>
        <input id="prpMH" type="text" placeholder="auto" class="epp-inp" oninput="edPropLive('minHeight',this.value)"></div>
    </div>
    <!-- Presets ancho r√°pido -->
    <div style="display:flex;gap:3px;flex-wrap:wrap;margin-top:5px">
      <button onclick="edPropQ('width','100%')" class="epp-chip">100%</button>
      <button onclick="edPropQ('maxWidth','1200px')" class="epp-chip">1200px</button>
      <button onclick="edPropQ('maxWidth','900px')" class="epp-chip">900px</button>
      <button onclick="edPropQ('maxWidth','700px')" class="epp-chip">700px</button>
      <button onclick="edPropQ('maxWidth','500px')" class="epp-chip">500px</button>
      <button onclick="edPropQ('margin','0 auto')" class="epp-chip" style="color:#3d9e9b">‚Üî Centrar</button>
    </div>
  </div>

  <!-- SECCI√ìN: PADDING -->
  <div class="epp-sec">
    <div class="epp-lbl">‚Üî Espaciado interno (padding)</div>
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:4px;margin-bottom:6px">
      <div><div class="epp-sub">‚Üë Top</div><input id="prpPT" type="text" placeholder="0" class="epp-inp" oninput="edPropLive('paddingTop',this.value)"></div>
      <div><div class="epp-sub">‚Üì Bot</div><input id="prpPB" type="text" placeholder="0" class="epp-inp" oninput="edPropLive('paddingBottom',this.value)"></div>
      <div><div class="epp-sub">‚Üê Izq</div><input id="prpPL" type="text" placeholder="0" class="epp-inp" oninput="edPropLive('paddingLeft',this.value)"></div>
      <div><div class="epp-sub">‚Üí Der</div><input id="prpPR" type="text" placeholder="0" class="epp-inp" oninput="edPropLive('paddingRight',this.value)"></div>
    </div>
    <div style="display:flex;gap:3px;flex-wrap:wrap">
      <button onclick="edPropQ('padding','8px')" class="epp-chip">8px</button>
      <button onclick="edPropQ('padding','16px')" class="epp-chip">16px</button>
      <button onclick="edPropQ('padding','24px')" class="epp-chip">24px</button>
      <button onclick="edPropQ('padding','32px')" class="epp-chip">32px</button>
      <button onclick="edPropQ('padding','40px')" class="epp-chip">40px</button>
      <button onclick="edPropQ('padding','48px 64px')" class="epp-chip">48√ó64</button>
      <button onclick="edPropQ('padding','80px 40px')" class="epp-chip">80√ó40</button>
    </div>
  </div>

  <!-- SECCI√ìN: FONDO -->
  <div class="epp-sec">
    <div class="epp-lbl">üé® Color de fondo</div>
    <!-- Picker + hex -->
    <div style="display:flex;gap:6px;align-items:center;margin-bottom:8px">
      <input type="color" id="prpBgPk" value="#f7f5f1" style="width:36px;height:36px;border:none;border-radius:6px;cursor:pointer;padding:0;flex-shrink:0" onchange="edPropBg(this.value)">
      <input id="prpBgHex" type="text" placeholder="#rrggbb / transparent" class="epp-inp" style="flex:1" onchange="edPropBg(this.value)" oninput="edPropBgInput(this.value)">
      <button onclick="edPropBg('transparent')" class="epp-xbtn" title="Sin fondo">‚àÖ</button>
    </div>
    <!-- Paleta r√°pida -->
    <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:6px">
      <div onclick="edPropBg('#ffffff')" class="epp-sw" style="background:#fff;border-color:#ccc" title="Blanco"></div>
      <div onclick="edPropBg('#f7f5f1')" class="epp-sw" style="background:#f7f5f1" title="Crema claro"></div>
      <div onclick="edPropBg('#f0ece4')" class="epp-sw" style="background:#f0ece4" title="Crema"></div>
      <div onclick="edPropBg('#e8e3d8')" class="epp-sw" style="background:#e8e3d8" title="Arena"></div>
      <div onclick="edPropBg('#d4cfc6')" class="epp-sw" style="background:#d4cfc6" title="Gris arena"></div>
      <div onclick="edPropBg('#1c1814')" class="epp-sw" style="background:#1c1814" title="Negro TCT"></div>
      <div onclick="edPropBg('#2a241e')" class="epp-sw" style="background:#2a241e" title="Oscuro"></div>
      <div onclick="edPropBg('#3d3028')" class="epp-sw" style="background:#3d3028" title="Marr√≥n oscuro"></div>
      <div onclick="edPropBg('#2b7d7a')" class="epp-sw" style="background:#2b7d7a" title="Verde TCT"></div>
      <div onclick="edPropBg('#3d9e9b')" class="epp-sw" style="background:#3d9e9b" title="Verde claro"></div>
      <div onclick="edPropBg('#e8f4f3')" class="epp-sw" style="background:#e8f4f3" title="Verde muy claro"></div>
      <div onclick="edPropBg('#1c5a58')" class="epp-sw" style="background:#1c5a58" title="Verde oscuro"></div>
      <div onclick="edPropBg('#b89558')" class="epp-sw" style="background:#b89558" title="Oro TCT"></div>
      <div onclick="edPropBg('#d4b878')" class="epp-sw" style="background:#d4b878" title="Oro claro"></div>
      <div onclick="edPropBg('#fdf6e3')" class="epp-sw" style="background:#fdf6e3" title="Oro muy claro"></div>
      <div onclick="edPropBg('#bf4637')" class="epp-sw" style="background:#bf4637" title="Rojo Puerta"></div>
      <div onclick="edPropBg('#fdecea')" class="epp-sw" style="background:#fdecea" title="Rojo muy claro"></div>
      <div onclick="edPropBg('#2c5f9e')" class="epp-sw" style="background:#2c5f9e" title="Azul Puerta"></div>
      <div onclick="edPropBg('#e8eef7')" class="epp-sw" style="background:#e8eef7" title="Azul muy claro"></div>
      <div onclick="edPropBg('#7b4fa6')" class="epp-sw" style="background:#7b4fa6" title="Violeta"></div>
    </div>
    <!-- Gradientes predefinidos -->
    <div class="epp-sub" style="margin-bottom:4px">Gradientes r√°pidos</div>
    <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:6px">
      <div onclick="edPropBg('linear-gradient(135deg,#f7f5f1,#e8e3d8)')" class="epp-grad" style="background:linear-gradient(135deg,#f7f5f1,#e8e3d8)" title="Crema"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#2b7d7a,#1c5a58)')" class="epp-grad" style="background:linear-gradient(135deg,#2b7d7a,#1c5a58)" title="Verde"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#1c1814,#3d3028)')" class="epp-grad" style="background:linear-gradient(135deg,#1c1814,#3d3028)" title="Oscuro"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#b89558,#8a6a35)')" class="epp-grad" style="background:linear-gradient(135deg,#b89558,#8a6a35)" title="Oro"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#2c5f9e,#1a3d6e)')" class="epp-grad" style="background:linear-gradient(135deg,#2c5f9e,#1a3d6e)" title="Azul"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#bf4637,#8b2d22)')" class="epp-grad" style="background:linear-gradient(135deg,#bf4637,#8b2d22)" title="Rojo"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#7b4fa6,#4a2d6e)')" class="epp-grad" style="background:linear-gradient(135deg,#7b4fa6,#4a2d6e)" title="Violeta"></div>
      <div onclick="edPropBg('linear-gradient(160deg,#2b7d7a 0%,#1c1814 100%)')" class="epp-grad" style="background:linear-gradient(160deg,#2b7d7a,#1c1814)" title="Verde ‚Üí Negro"></div>
    </div>
    <!-- Gradiente personalizado -->
    <div class="epp-sub" style="margin-bottom:4px">Crear gradiente</div>
    <div style="display:flex;gap:5px;align-items:center">
      <input type="color" id="prpG1" value="#2b7d7a" style="width:28px;height:28px;border:none;border-radius:5px;cursor:pointer;padding:0" onchange="edBuildGrad()">
      <input type="color" id="prpG2" value="#f0ece4" style="width:28px;height:28px;border:none;border-radius:5px;cursor:pointer;padding:0" onchange="edBuildGrad()">
      <select id="prpGDir" onchange="edBuildGrad()" style="flex:1;background:#2a2420;color:white;border:1px solid rgba(255,255,255,.15);padding:3px;border-radius:5px;font-size:10px">
        <option value="135deg">‚Üò Diagonal</option><option value="to right">‚Üí Horizontal</option>
        <option value="to bottom">‚Üì Vertical</option><option value="45deg">‚Üó Diagonal 2</option>
        <option value="180deg">‚Üë Vertical inv.</option>
      </select>
      <div id="prpGPreview" style="width:36px;height:28px;border-radius:5px;border:1px solid rgba(255,255,255,.1);background:linear-gradient(135deg,#2b7d7a,#f0ece4);cursor:pointer" onclick="edBuildGrad(true)" title="Aplicar"></div>
    </div>
  </div>

  <!-- SECCI√ìN: COLOR TEXTO -->
  <div class="epp-sec">
    <div class="epp-lbl">‚úçÔ∏è Color de texto del bloque</div>
    <div style="display:flex;gap:6px;align-items:center;margin-bottom:8px">
      <input type="color" id="prpTxtPk" value="#1c1814" style="width:36px;height:36px;border:none;border-radius:6px;cursor:pointer;padding:0;flex-shrink:0" onchange="edPropTxtColor(this.value)">
      <input id="prpTxtHex" type="text" placeholder="#1c1814" class="epp-inp" style="flex:1" onchange="edPropTxtColor(this.value)">
    </div>
    <div style="display:flex;gap:4px;flex-wrap:wrap">
      <div onclick="edPropTxtColor('#1c1814')" class="epp-sw" style="background:#1c1814" title="Negro TCT"></div>
      <div onclick="edPropTxtColor('#ffffff')" class="epp-sw" style="background:#fff;border-color:#ccc" title="Blanco"></div>
      <div onclick="edPropTxtColor('#7a7168')" class="epp-sw" style="background:#7a7168" title="Gris TCT"></div>
      <div onclick="edPropTxtColor('#5a5248')" class="epp-sw" style="background:#5a5248" title="Gris oscuro"></div>
      <div onclick="edPropTxtColor('#2b7d7a')" class="epp-sw" style="background:#2b7d7a" title="Verde TCT"></div>
      <div onclick="edPropTxtColor('#3d9e9b')" class="epp-sw" style="background:#3d9e9b" title="Verde claro"></div>
      <div onclick="edPropTxtColor('#b89558')" class="epp-sw" style="background:#b89558" title="Oro TCT"></div>
      <div onclick="edPropTxtColor('#bf4637')" class="epp-sw" style="background:#bf4637" title="Rojo Puerta"></div>
      <div onclick="edPropTxtColor('#2c5f9e')" class="epp-sw" style="background:#2c5f9e" title="Azul Puerta"></div>
      <div onclick="edPropTxtColor('#7b4fa6')" class="epp-sw" style="background:#7b4fa6" title="Violeta"></div>
    </div>
  </div>

  <!-- SECCI√ìN: TIPOGRAF√çA DEL BLOQUE -->
  <div class="epp-sec">
    <div class="epp-lbl">üî§ Tipograf√≠a del bloque</div>
    <select onchange="if(this.value){edPropQ('fontFamily',this.value);this.value=''}" class="epp-inp" style="width:100%;margin-bottom:6px">
      <option value="">‚Äî Fuente del contenedor ‚Äî</option>
      <option value="'DM Sans',sans-serif">DM Sans (principal)</option>
      <option value="'Cormorant Garamond',serif">Cormorant Garamond (t√≠tulos)</option>
      <option value="Georgia,serif">Georgia</option>
      <option value="Arial,sans-serif">Arial</option>
      <option value="'Helvetica Neue',sans-serif">Helvetica Neue</option>
      <option value="'Times New Roman',serif">Times New Roman</option>
      <option value="'Courier New',monospace">Courier New</option>
    </select>
    <div class="epp-grid2">
      <div><div class="epp-sub">Tama√±o</div>
        <input id="prpFS" type="text" placeholder="16px" class="epp-inp" oninput="edPropLive('fontSize',this.value)"></div>
      <div><div class="epp-sub">Grosor</div>
        <select onchange="edPropQ('fontWeight',this.value)" class="epp-inp">
          <option value="">‚Äî</option>
          <option value="300">300 Fino</option><option value="400">400 Normal</option>
          <option value="500">500 Medio</option><option value="600">600 Semi</option>
          <option value="700">700 Bold</option><option value="800">800 Extra</option>
        </select></div>
      <div><div class="epp-sub">Interlineado</div>
        <input id="prpLH" type="text" placeholder="1.6" class="epp-inp" oninput="edPropLive('lineHeight',this.value)"></div>
      <div><div class="epp-sub">Alineaci√≥n</div>
        <select onchange="edPropQ('textAlign',this.value)" class="epp-inp">
          <option value="">‚Äî</option><option value="left">Izquierda</option>
          <option value="center">Centro</option><option value="right">Derecha</option>
          <option value="justify">Justificado</option>
        </select></div>
      <div><div class="epp-sub">Letra espac.</div>
        <input type="text" placeholder="0em" class="epp-inp" oninput="edPropLive('letterSpacing',this.value)"></div>
      <div><div class="epp-sub">Transformar</div>
        <select onchange="edPropQ('textTransform',this.value)" class="epp-inp">
          <option value="">‚Äî</option><option value="uppercase">MAY√öS</option>
          <option value="lowercase">min√∫s</option><option value="capitalize">Primer</option>
          <option value="none">Normal</option>
        </select></div>
    </div>
  </div>

  <!-- SECCI√ìN: BORDE -->
  <div class="epp-sec">
    <div class="epp-lbl">üî≤ Borde</div>
    <div style="display:flex;gap:5px;align-items:center;margin-bottom:7px">
      <input type="color" id="prpBdPk" value="#e4ddd3" style="width:30px;height:30px;border:none;border-radius:5px;cursor:pointer;padding:0;flex-shrink:0" onchange="edPropBorder(this.value)">
      <input id="prpBdHex" type="text" placeholder="#e4ddd3" class="epp-inp" style="flex:1" onchange="edPropBorder(this.value)">
      <button onclick="edPropQ('border','none')" class="epp-xbtn" title="Sin borde">‚àÖ</button>
    </div>
    <!-- Paleta borde -->
    <div style="display:flex;gap:3px;flex-wrap:wrap;margin-bottom:7px">
      <div onclick="edPropBorder('#e4ddd3')" class="epp-sw" style="background:#e4ddd3" title="Crema borde"></div>
      <div onclick="edPropBorder('#d4cfc6')" class="epp-sw" style="background:#d4cfc6" title="Arena"></div>
      <div onclick="edPropBorder('#2b7d7a')" class="epp-sw" style="background:#2b7d7a" title="Verde TCT"></div>
      <div onclick="edPropBorder('#3d9e9b')" class="epp-sw" style="background:#3d9e9b" title="Verde claro"></div>
      <div onclick="edPropBorder('#b89558')" class="epp-sw" style="background:#b89558" title="Oro TCT"></div>
      <div onclick="edPropBorder('#bf4637')" class="epp-sw" style="background:#bf4637" title="Rojo"></div>
      <div onclick="edPropBorder('#2c5f9e')" class="epp-sw" style="background:#2c5f9e" title="Azul"></div>
      <div onclick="edPropBorder('#1c1814')" class="epp-sw" style="background:#1c1814" title="Negro"></div>
    </div>
    <div class="epp-grid2">
      <div><div class="epp-sub">Grosor</div>
        <select id="prpBdW" onchange="edPropBorderW(this.value)" class="epp-inp">
          <option value="1px">1px</option><option value="2px">2px</option>
          <option value="3px">3px</option><option value="4px">4px</option>
          <option value="6px">6px</option>
        </select></div>
      <div><div class="epp-sub">Estilo</div>
        <select id="prpBdSt" onchange="edPropBorderSt(this.value)" class="epp-inp">
          <option value="solid">S√≥lido</option><option value="dashed">Guiones</option>
          <option value="dotted">Puntos</option><option value="double">Doble</option>
        </select></div>
      <div><div class="epp-sub">Radio (redondeado)</div>
        <input id="prpBR" type="text" placeholder="0px" class="epp-inp" oninput="edPropLive('borderRadius',this.value)"></div>
      <div style="display:flex;flex-direction:column;gap:3px;margin-top:14px">
        <button onclick="edPropQ('borderRadius','8px')" class="epp-chip">8px</button>
        <button onclick="edPropQ('borderRadius','16px')" class="epp-chip">16px</button>
        <button onclick="edPropQ('borderRadius','24px')" class="epp-chip">24px</button>
        <button onclick="edPropQ('borderRadius','50%')" class="epp-chip">50% ‚óè</button>
      </div>
    </div>
  </div>

  <!-- SECCI√ìN: SOMBRA -->
  <div class="epp-sec">
    <div class="epp-lbl">üåë Sombra</div>
    <div style="display:flex;flex-direction:column;gap:3px">
      <button onclick="edPropQ('boxShadow','none')" class="epp-rowbtn">Sin sombra</button>
      <button onclick="edPropQ('boxShadow','0 1px 4px rgba(0,0,0,.06)')" class="epp-rowbtn">Muy sutil</button>
      <button onclick="edPropQ('boxShadow','0 2px 10px rgba(0,0,0,.08)')" class="epp-rowbtn">Sutil</button>
      <button onclick="edPropQ('boxShadow','0 4px 20px rgba(0,0,0,.12)')" class="epp-rowbtn">Media</button>
      <button onclick="edPropQ('boxShadow','0 8px 32px rgba(0,0,0,.18)')" class="epp-rowbtn">Fuerte</button>
      <button onclick="edPropQ('boxShadow','0 16px 48px rgba(0,0,0,.28)')" class="epp-rowbtn">Muy fuerte</button>
      <button onclick="edPropQ('boxShadow','0 8px 32px rgba(43,125,122,.22)')" class="epp-rowbtn" style="color:#3d9e9b">‚ú¶ Sombra verde TCT</button>
      <button onclick="edPropQ('boxShadow','0 8px 32px rgba(184,149,88,.28)')" class="epp-rowbtn" style="color:#b89558">‚ú¶ Sombra oro TCT</button>
      <button onclick="edPropQ('boxShadow','0 8px 32px rgba(191,70,55,.2)')" class="epp-rowbtn" style="color:#bf4637">‚ú¶ Sombra roja</button>
      <button onclick="edPropQ('boxShadow','inset 0 0 40px rgba(0,0,0,.08)')" class="epp-rowbtn">Interna sutil</button>
    </div>
  </div>

  <!-- SECCI√ìN: MARGEN / POSICI√ìN -->
  <div class="epp-sec">
    <div class="epp-lbl">‚Üî Margen externo</div>
    <div class="epp-grid2">
      <div><div class="epp-sub">Top</div><input type="text" placeholder="0" class="epp-inp" oninput="edPropLive('marginTop',this.value)"></div>
      <div><div class="epp-sub">Bottom</div><input type="text" placeholder="0" class="epp-inp" oninput="edPropLive('marginBottom',this.value)"></div>
    </div>
    <div style="margin-top:5px;display:flex;gap:3px;flex-wrap:wrap">
      <button onclick="edPropQ('margin','0 auto')" class="epp-chip" style="color:#3d9e9b">‚Üî Centrar</button>
      <button onclick="edPropQ('marginBottom','24px')" class="epp-chip">‚Üì 24px</button>
      <button onclick="edPropQ('marginBottom','40px')" class="epp-chip">‚Üì 40px</button>
      <button onclick="edPropQ('marginBottom','60px')" class="epp-chip">‚Üì 60px</button>
      <button onclick="edPropQ('marginTop','40px')" class="epp-chip">‚Üë 40px</button>
    </div>
  </div>

  <!-- SECCI√ìN: DISPLAY / FLEX -->
  <div class="epp-sec">
    <div class="epp-lbl">‚äû Display / Layout</div>
    <div style="display:flex;gap:3px;flex-wrap:wrap">
      <button onclick="edPropQ('display','block')" class="epp-chip">Block</button>
      <button onclick="edPropQ('display','flex')" class="epp-chip">Flex</button>
      <button onclick="edPropQ('display','grid')" class="epp-chip">Grid</button>
      <button onclick="edPropQ('display','inline-block')" class="epp-chip">Inline-block</button>
      <button onclick="edPropQ('display','none')" class="epp-chip" style="color:#f08080">Ocultar</button>
    </div>
    <div style="margin-top:5px;display:flex;gap:3px;flex-wrap:wrap">
      <button onclick="edPropQ('alignItems','center')" class="epp-chip">Align: centro</button>
      <button onclick="edPropQ('justifyContent','center')" class="epp-chip">Justify: centro</button>
      <button onclick="edPropQ('flexDirection','column')" class="epp-chip">Col ‚Üì</button>
      <button onclick="edPropQ('flexWrap','wrap')" class="epp-chip">Wrap</button>
      <button onclick="edPropQ('gap','16px')" class="epp-chip">Gap 16px</button>
      <button onclick="edPropQ('gap','24px')" class="epp-chip">Gap 24px</button>
    </div>
  </div>

  <!-- SECCI√ìN: OPACIDAD / OVERFLOW -->
  <div class="epp-sec">
    <div class="epp-lbl">üîÜ Opacidad / Overflow</div>
    <div class="epp-grid2">
      <div><div class="epp-sub">Opacidad (0‚Äì1)</div>
        <input type="range" min="0" max="1" step="0.05" value="1" style="width:100%" oninput="edPropLive('opacity',this.value);this.nextElementSibling.textContent=this.value">
        <span style="font-size:10px;color:rgba(255,255,255,.4)">1</span></div>
      <div><div class="epp-sub">Overflow</div>
        <select onchange="edPropQ('overflow',this.value)" class="epp-inp">
          <option value="">‚Äî</option><option value="visible">Visible</option>
          <option value="hidden">Hidden</option><option value="auto">Auto</option>
          <option value="scroll">Scroll</option>
        </select></div>
    </div>
  </div>

  <!-- SECCI√ìN: CSS DIRECTO -->
  <div class="epp-sec">
    <div class="epp-lbl">üíª CSS directo (style="")</div>
    <textarea id="prpCss" rows="5" class="epp-css" placeholder="padding:32px; background:white; border:1px solid #ccc; ..."></textarea>
    <div style="display:flex;gap:5px;margin-top:5px">
      <button onclick="edPropCssApply()" class="epp-rowbtn" style="flex:1;color:#3d9e9b;border-color:rgba(61,158,155,.3)">‚ñ∂ Aplicar CSS</button>
      <button onclick="edPropCssRead()" class="epp-rowbtn" title="Leer estilos actuales del elemento">‚Üª Leer</button>
    </div>
  </div>

  <!-- ACCIONES R√ÅPIDAS -->
  <div class="epp-sec">
    <div class="epp-lbl">‚ö° Acciones</div>
    <div style="display:flex;flex-direction:column;gap:4px">
      <button onclick="edDuplicate()" class="epp-rowbtn">üìã Duplicar elemento</button>
      <button onclick="edMoveUp()" class="epp-rowbtn">‚¨ÜÔ∏è Mover arriba</button>
      <button onclick="edMoveDown()" class="epp-rowbtn">‚¨áÔ∏è Mover abajo</button>
      <button onclick="edAddLink()" class="epp-rowbtn">üîó A√±adir enlace</button>
      <button onclick="edChangeImage()" class="epp-rowbtn">üñºÔ∏è Cambiar imagen</button>
      <button onclick="edDeleteSelected()" class="epp-rowbtn" style="color:#f08080;border-color:rgba(191,70,55,.25)">üóëÔ∏è Eliminar elemento</button>
    </div>
  </div>
</div>

<!-- CONTEXT MENU -->
<div id="edCtxMenu" style="display: none; position: fixed; z-index: 10001; background: rgb(22, 18, 16); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 10px; padding: 6px; min-width: 188px; box-shadow: rgba(0, 0, 0, 0.6) 0px 8px 32px; font-family: &quot;DM Sans&quot;, sans-serif; left: 1024px; top: 373px;">
  <div id="edCtxTitle" style="font-size:9px;color:rgba(255,255,255,.4);padding:4px 10px 7px;border-bottom:1px solid rgba(255,255,255,.1);margin-bottom:4px;text-transform:uppercase;letter-spacing:.07em">p</div>
  <button onclick="edCtxAction('props')" class="edctx-btn">‚öôÔ∏è Propiedades del bloque</button>
  <button onclick="edCtxAction('editar')" class="edctx-btn">‚úèÔ∏è Editar textos internos</button>
  <button onclick="edCtxAction('link')" class="edctx-btn">üîó A√±adir enlace</button>
  <button onclick="edCtxAction('imagen')" class="edctx-btn">üñºÔ∏è Cambiar imagen</button>
  <button onclick="edCtxAction('duplicar')" class="edctx-btn">üìã Duplicar</button>
  <button onclick="edCtxAction('subir')" class="edctx-btn">‚¨ÜÔ∏è Mover arriba</button>
  <button onclick="edCtxAction('bajar')" class="edctx-btn">‚¨áÔ∏è Mover abajo</button>
  <div style="height:1px;background:rgba(255,255,255,.1);margin:4px 0"></div>
  <button onclick="edCtxAction('eliminar')" class="edctx-btn" style="color:#f08080">üóëÔ∏è Eliminar</button>
  <button onclick="edCtxClose()" class="edctx-btn" style="color:rgba(255,255,255,.35)">‚úï Cerrar men√∫</button>
</div>

<!-- EDITOR PANEL -->
<div id="edPanel" style="display: none; position: fixed; bottom: 0px; left: 0px; right: 0px; z-index: 9998; background: rgb(22, 18, 16); padding: 7px 12px; align-items: center; gap: 6px; flex-wrap: wrap; box-shadow: rgba(0, 0, 0, 0.6) 0px -4px 24px; font-family: &quot;DM Sans&quot;, sans-serif;" data-protonpass-form="">
  <span style="font-size:12px;font-weight:700;color:#3d9e9b;white-space:nowrap">‚ú¶ Editor</span>
  <div class="eds"></div>
  <!-- Historial -->
  <button onclick="edUndo()" id="edUndoBtn" title="Deshacer Ctrl+Z" style="background: rgb(37, 33, 24); color: rgba(255, 255, 255, 0.45); border: 1px solid rgba(255, 255, 255, 0.1); padding: 5px 9px; border-radius: 6px; font-size: 13px; cursor: pointer; opacity: 1;">‚Ü©</button>
  <button onclick="edRedo()" id="edRedoBtn" title="Rehacer Ctrl+Y" style="background: rgb(37, 33, 24); color: rgba(255, 255, 255, 0.45); border: 1px solid rgba(255, 255, 255, 0.1); padding: 5px 9px; border-radius: 6px; font-size: 13px; cursor: pointer; opacity: 0.3;">‚Ü™</button>
  <div class="eds"></div>
  <!-- Modos -->
  <button onclick="edToggleMode()" id="edModeBtn" class="edpb teal" style="background: rgb(184, 149, 88);">üéØ Activo</button>
  <button onclick="edToggleText()" id="edTxtBtn" class="edpb teal" style="background: rgb(43, 125, 122);">‚úèÔ∏è Editar textos</button>
  <div class="eds"></div>
  <!-- Formato r√°pido texto -->
  <div style="display:flex;gap:2px">
    <button onclick="edFmt('bold')" class="efb2" title="Negrita Ctrl+B"><b>B</b></button>
    <button onclick="edFmt('italic')" class="efb2" title="Cursiva Ctrl+I"><i style="font-style:italic">I</i></button>
    <button onclick="edFmt('underline')" class="efb2" title="Subrayado" style="text-decoration:underline">U</button>
    <button onclick="edFmt('strikeThrough')" class="efb2" title="Tachado" style="text-decoration:line-through">S</button>
  </div>
  <div style="display:flex;gap:2px">
    <button onclick="edFmt('justifyLeft')" class="efb2" title="Izquierda">‚¨õ‚óª</button>
    <button onclick="edFmt('justifyCenter')" class="efb2" title="Centro">‚óª‚¨õ‚óª</button>
    <button onclick="edFmt('justifyRight')" class="efb2" title="Derecha">‚óª‚¨õ</button>
  </div>
  <div style="display:flex;gap:2px">
    <button onclick="edFmtBlock('h1')" class="efb2 efb2s">H1</button>
    <button onclick="edFmtBlock('h2')" class="efb2 efb2s">H2</button>
    <button onclick="edFmtBlock('h3')" class="efb2 efb2s">H3</button>
    <button onclick="edFmt('insertUnorderedList')" class="efb2">‚Ä¢‚â°</button>
    <button onclick="edFmt('insertOrderedList')" class="efb2">1.‚â°</button>
  </div>
  <div class="eds"></div>
  <!-- Color texto + fuente + tama√±o -->
  <input type="color" id="edFontColor" value="#1c1814" title="Color texto" style="width:24px;height:24px;border:none;border-radius:4px;cursor:pointer;padding:0;flex-shrink:0" onchange="edApplyFontColor(this.value)">
  <select id="edFont" onchange="edApplyFont(this.value)" style="background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;cursor:pointer;max-width:100px">
    <option value="">Fuente</option>
    <option value="'DM Sans',sans-serif">DM Sans</option>
    <option value="'Cormorant Garamond',serif">Cormorant</option>
    <option value="Georgia,serif">Georgia</option>
    <option value="Arial,sans-serif">Arial</option>
    <option value="'Helvetica Neue',sans-serif">Helvetica</option>
    <option value="'Times New Roman',serif">Times NR</option>
    <option value="'Courier New',monospace">Courier</option>
  </select>
  <div style="display:flex;gap:2px;align-items:center">
    <select id="edFontSize" onchange="if(this.value){edApplyFontSize(this.value);this.value=''}" style="background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 3px;border-radius:5px;font-size:10px;cursor:pointer;max-width:58px">
      <option value="">px</option>
      <option value="11px">11</option><option value="12px">12</option><option value="13px">13</option>
      <option value="14px">14</option><option value="15px">15</option><option value="16px">16</option>
      <option value="18px">18</option><option value="20px">20</option><option value="22px">22</option>
      <option value="24px">24</option><option value="28px">28</option><option value="32px">32</option>
      <option value="36px">36</option><option value="40px">40</option><option value="48px">48</option>
      <option value="56px">56</option><option value="64px">64</option><option value="80px">80</option>
    </select>
    <input id="edFontSzFree" type="number" min="8" max="200" placeholder="px" title="Tama√±o libre ‚Äî Enter para aplicar" style="width:40px;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;outline:none" onkeydown="if(event.key==='Enter'&amp;&amp;this.value){edApplyFontSize(this.value+'px');this.value=''}">
  </div>
  <div class="eds"></div>
  <!-- BG / Borde -->
  <div style="display:flex;align-items:center;gap:2px">
    <span style="font-size:9px;color:rgba(255,255,255,.3)">BG</span>
    <input type="color" id="edBg" value="#f7f5f1" title="Fondo del bloque" style="width:24px;height:24px;border:none;border-radius:4px;cursor:pointer;padding:0" onchange="edApplyBg(this.value)">
    <button onclick="edApplyBg('transparent')" style="background:#252118;color:rgba(255,255,255,.35);border:1px solid rgba(255,255,255,.1);padding:1px 5px;border-radius:4px;font-size:11px;cursor:pointer">‚àÖ</button>
  </div>
  <div style="display:flex;align-items:center;gap:2px">
    <span style="font-size:9px;color:rgba(255,255,255,.3)">BD</span>
    <input type="color" id="edBorderColor" value="#e4ddd3" title="Borde" style="width:24px;height:24px;border:none;border-radius:4px;cursor:pointer;padding:0" onchange="edApplyBorder(this.value)">
    <button onclick="edApplyBorder('none')" style="background:#252118;color:rgba(255,255,255,.35);border:1px solid rgba(255,255,255,.1);padding:1px 5px;border-radius:4px;font-size:11px;cursor:pointer">‚àÖ</button>
  </div>
  <input type="color" id="edBtnColor" value="#2b7d7a" title="Color de bot√≥n" style="width:24px;height:24px;border:none;border-radius:4px;cursor:pointer;padding:0;flex-shrink:0" onchange="edApplyBtn(this.value)">
  <div class="eds"></div>
  <!-- W / H inline -->
  <div style="display:flex;gap:2px;align-items:center">
    <span style="font-size:9px;color:rgba(255,255,255,.3)">W</span>
    <input id="edWInp" type="text" placeholder="auto" title="Ancho: px / % / auto ‚Äî Enter" style="width:52px;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;outline:none" onkeydown="if(event.key==='Enter')edPropLive('width',this.value)">
    <span style="font-size:9px;color:rgba(255,255,255,.3)">H</span>
    <input id="edHInp" type="text" placeholder="auto" title="Alto: px / vh / auto ‚Äî Enter" style="width:52px;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;outline:none" onkeydown="if(event.key==='Enter')edPropLive('height',this.value)">
  </div>
  <select id="edPadding" onchange="edApplyPadding(this.value)" style="background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;cursor:pointer;max-width:80px">
    <option value="">Padding</option>
    <option value="0">0</option><option value="8px">8px</option><option value="12px">12px</option>
    <option value="16px">16px</option><option value="24px">24px</option><option value="32px">32px</option>
    <option value="40px">40px</option><option value="48px">48px</option><option value="64px">64px</option><option value="80px">80px</option>
  </select>
  <div class="eds"></div>
  <!-- Props button -->
  <button onclick="edToggleProps()" id="edPropsBtn" style="background: rgb(37, 33, 24); color: rgb(61, 158, 155); border: 1px solid rgba(61, 158, 155, 0.35); padding: 5px 11px; border-radius: 6px; font-size: 11px; font-weight: 700; cursor: pointer; white-space: nowrap;">‚öô Props ‚Üí</button>
  <div class="eds"></div>
  <!-- A√±adir bloques -->
  <span style="font-size:9px;color:rgba(255,255,255,.3);white-space:nowrap">A√ëADIR:</span>
  <button onclick="edInsert('texto')" class="edba">üìù Texto</button>
  <button onclick="edInsert('tarjeta')" class="edba">üÉè Tarjeta</button>
  <button onclick="edInsert('banner-ancho')" class="edba">üî≤ Banner</button>
  <button onclick="edInsert('banner-peque√±o')" class="edba">‚ñ≠ BannerS</button>
  <button onclick="edInsert('imagen-banner')" class="edba">üñº Img.banner</button>
  <button onclick="edInsert('imagen-peque√±a')" class="edba">üñº Img+txt</button>
  <button onclick="edInsert('boton')" class="edba">üîò Bot√≥n</button>
  <button onclick="edInsert('separador')" class="edba">‚Äî Sep.</button>
  <div class="eds"></div>
  <!-- Acciones -->
  <button onclick="edAddLink()" class="edba">üîó Link</button>
  <button onclick="edChangeImage()" class="edba">üñº Img.</button>
  <button onclick="edDuplicate()" class="edba">üìã Dupl.</button>
  <button onclick="edMoveUp()" class="edba">‚¨Ü</button>
  <button onclick="edMoveDown()" class="edba">‚¨á</button>
  <button onclick="edDeleteSelected()" style="background:#2a1412;color:#f08080;border:1px solid rgba(191,70,55,.2);padding:4px 9px;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;white-space:nowrap">üóë Eliminar</button>
  <div class="eds"></div>
  <!-- Guardar -->
  <button onclick="edSave()" style="background:#b89558;color:white;border:none;padding:7px 15px;border-radius:6px;font-size:12px;font-weight:700;cursor:pointer;white-space:nowrap">üíæ Guardar</button>
  <button onclick="edClose()" style="background:rgba(255,255,255,.06);color:rgba(255,255,255,.45);border:none;padding:6px 10px;border-radius:6px;font-size:12px;cursor:pointer">‚úï</button>
  <span id="edMsg" style="font-size:10px;color:#3d9e9b;margin-left:auto;white-space:nowrap;overflow:hidden;max-width:260px;text-overflow:ellipsis">üóëÔ∏è Eliminado ‚Äî ‚Ü© para deshacer</span>
</div>

<style>
/* ‚îÄ‚îÄ Editor v3 core ‚îÄ‚îÄ */
.eds{width:1px;height:20px;background:rgba(255,255,255,.1);flex-shrink:0}
/* ‚îÄ‚îÄ Accesibilidad: tama√±os de fuente m√°s grandes ‚îÄ‚îÄ */
html { font-size: 17px; }
body { font-size: 1rem; }
/* Escalar textos peque√±os del cuerpo de la p√°gina */
p, li, span, div, td, th, label, input, select, textarea, button {
  font-size: max(var(--fs, inherit), 15px);
}
/* P√°rrafos y texto de contenido */
p { font-size: 1.05rem !important; line-height: 1.75 !important; }
/* Etiquetas peque√±as y metadata ‚Äî nunca menos de 13px */
.week-num, .week-status, .pc-weeks, .pc-tag, .pub-meta,
[style*="font-size: 10px"], [style*="font-size:10px"],
[style*="font-size: 11px"], [style*="font-size:11px"] {
  font-size: 13px !important;
}
/* Texto de tarjetas y descripciones */
[style*="font-size: 12px"], [style*="font-size:12px"] { font-size: 14px !important; }
[style*="font-size: 13px"], [style*="font-size:13px"] { font-size: 15px !important; }
[style*="font-size: 14px"], [style*="font-size:14px"] { font-size: 16px !important; }
[style*="font-size: 15px"], [style*="font-size:15px"] { font-size: 17px !important; }
/* Navegaci√≥n */
nav a, .nav-links a { font-size: 15px !important; }
/* Botones */
button:not(.efb):not([style*="font-size: 1"]):not([style*="font-size:1"]) { font-size: 15px !important; }
/* No escalar elementos del editor UI */
#edPanel *, #edFmtBar *, #edPropsPanel *, #edPwdModal *,
#edImgPanel *, #navMgrPanel *, .ed-ctx-menu * { font-size: revert !important; }
.tradiciones-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:24px;margin-bottom:48px}
@media(max-width:900px){.tradiciones-grid{grid-template-columns:repeat(2,1fr);gap:16px}}
@media(max-width:580px){.tradiciones-grid{grid-template-columns:1fr;gap:14px}.tradiciones-grid>div{padding:24px 20px}}
/* ‚îÄ‚îÄ Mobile general ‚îÄ‚îÄ */
@media(max-width:768px){
  /* Nav */
  nav{padding:0 16px;height:60px}
  .nav-links{display:none}
  .nav-btns .btn-ghost:not(#btnLogin):not(#btnLogout):not(#btnDash){display:none}
  .btn-primary{padding:9px 16px;font-size:14px}
  /* Hero */
  .hero{padding:90px 20px 56px}
  .hero h1{font-size:clamp(30px,8vw,44px)}
  .hero p{font-size:16px}
  .hero-btns{flex-direction:column;align-items:stretch;gap:10px}
  .btn-hero{text-align:center;padding:14px 20px;font-size:15px}
  /* Sections */
  #puertas,#viaje,#tradiciones,#joyas,#testimonios,#pilares-mandala{padding:56px 20px}
  /* Grids */
  .puertas-grid{grid-template-columns:1fr}
  div[style*="gap:80px"]{grid-template-columns:1fr !important;gap:36px !important}
  div[style*="position:sticky"],div[style*="position: sticky"]{position:relative !important;top:auto !important}
  div[style*="grid-template-columns:repeat(auto-fit,minmax(280px"]{grid-template-columns:1fr !important}
  div[style*="grid-template-columns:repeat(auto-fit,minmax(200px"]{grid-template-columns:1fr !important}
  div[style*="grid-template-columns:repeat(auto-fit,minmax(240px"]{grid-template-columns:1fr !important}
  div[style*="grid-template-columns:1fr 1fr 1fr"][style*="height:340px"]{grid-template-columns:1fr;height:auto}
  div[style*="grid-template-columns:1fr 1fr 1fr"][style*="height:340px"]>div{height:200px}
  /* Testimonios */
  div[style*="grid-template-columns:repeat(auto-fit,minmax(280px"]{grid-template-columns:1fr !important}
  /* Puerta cards */
  .pc-inner{padding:28px 20px}
  /* Weeks grid */
  .weeks-grid{grid-template-columns:1fr}
  /* Dashboard */
  .dashboard-grid{grid-template-columns:repeat(2,1fr)}
  .auth-wrap{grid-template-columns:1fr}
  .auth-left{display:none}
  .sidebar{display:none}
  .main-content{margin-left:0}
  /* Joyas */
  div[style*="grid-template-columns:repeat(auto-fit,minmax(200px"]{grid-template-columns:1fr !important}
  /* Mandala ‚Äî reducir tama√±o en mobile */
  #pilares-mandala svg{max-width:90vw}
  /* Editor buttons */
  #edOpenBtn,#navMgrBtn{bottom:20px}
  #navMgrBtn{left:120px}
  /* Viaje section sticky col */
  div[style*="1fr 1fr"][style*="align-items:start"],
  div[style*="1fr 1fr"][style*="align-items: start"]{grid-template-columns:1fr !important;gap:32px !important}
}

@media(max-width:480px){
  .hero h1{font-size:clamp(26px,7vw,36px)}
  nav .nav-logo{font-size:14px}
  .tradiciones-grid{grid-template-columns:1fr !important}
  .dashboard-grid{grid-template-columns:1fr}
  div[style*="grid-template-columns:repeat(3,1fr)"]{grid-template-columns:1fr !important}
  div[style*="grid-template-columns:repeat(2,1fr)"]{grid-template-columns:1fr !important}
  /* Pricing cards */
  div[style*="grid-template-columns:1fr 1fr"]{grid-template-columns:1fr !important;gap:16px !important}
  /* Hero image band hidden on very small */
  div[style*="grid-template-columns:1fr 1fr 1fr"][style*="height:340px"]{display:none}
}
.edpb{border:none;padding:6px 12px;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer;white-space:nowrap}
.edpb.teal{background:#2b7d7a;color:white}
.edba{background:#252118;color:rgba(255,255,255,.65);border:1px solid rgba(255,255,255,.1);padding:4px 8px;border-radius:5px;font-size:10px;font-weight:600;cursor:pointer;white-space:nowrap}
.edba:hover{background:#353028;color:white}
.efb2{background:#252118;color:rgba(255,255,255,.7);border:1px solid rgba(255,255,255,.1);padding:3px 7px;border-radius:5px;font-size:11px;cursor:pointer;min-width:24px;text-align:center}
.efb2:hover,.efb2:active{background:#2b7d7a;color:white;border-color:#2b7d7a}
.efb2s{font-size:9px;font-weight:700}
.edctx-btn{display:block;width:100%;background:none;border:none;color:rgba(255,255,255,.8);padding:7px 12px;text-align:left;font-size:12px;cursor:pointer;border-radius:6px}
.edctx-btn:hover{background:rgba(255,255,255,.07)}
.ed-selected-ring{outline:3px solid #2b7d7a!important;outline-offset:3px!important;box-shadow:0 0 0 6px rgba(43,125,122,.18)!important;position:relative!important}
/* Floating format bar */
.efb{background:#252118;color:rgba(255,255,255,.8);border:1px solid rgba(255,255,255,.12);padding:3px 7px;border-radius:5px;font-size:11px;cursor:pointer;white-space:nowrap;min-width:24px;text-align:center}
.efb:hover{background:#3d9e9b;border-color:#3d9e9b;color:white}
.efbsep{width:1px;height:16px;background:rgba(255,255,255,.12);flex-shrink:0;margin:0 1px}
.efb-lbl{font-size:9px;font-weight:700}
/* Props panel */
.epp-sec{padding:11px 14px;border-bottom:1px solid rgba(255,255,255,.06)}
.epp-lbl{font-size:9px;font-weight:700;color:rgba(255,255,255,.45);text-transform:uppercase;letter-spacing:.08em;margin-bottom:7px}
.epp-sub{font-size:9px;color:rgba(255,255,255,.3);margin-bottom:3px;text-transform:uppercase;letter-spacing:.05em}
.epp-inp{background:#252118;color:white;border:1px solid rgba(255,255,255,.14);padding:5px 7px;border-radius:5px;font-size:11px;font-family:'DM Sans',sans-serif;outline:none;box-sizing:border-box}
.epp-inp:focus{border-color:#3d9e9b}
.epp-grid2{display:grid;grid-template-columns:1fr 1fr;gap:5px}
.epp-xbtn{background:#252118;color:rgba(255,255,255,.45);border:1px solid rgba(255,255,255,.1);padding:3px 7px;border-radius:5px;font-size:12px;cursor:pointer;flex-shrink:0}
.epp-xbtn:hover{background:#353028;color:white}
.epp-sw{width:22px;height:22px;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.1);transition:transform .12s;flex-shrink:0}
.epp-sw:hover{transform:scale(1.2);z-index:1}
.epp-grad{width:34px;height:22px;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.1);transition:transform .12s}
.epp-grad:hover{transform:scale(1.1)}
.epp-chip{background:#252118;color:rgba(255,255,255,.6);border:1px solid rgba(255,255,255,.1);padding:3px 8px;border-radius:4px;font-size:10px;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap}
.epp-chip:hover{background:#2b7d7a;color:white;border-color:#2b7d7a}
.epp-rowbtn{background:#252118;color:rgba(255,255,255,.65);border:1px solid rgba(255,255,255,.1);padding:6px 10px;border-radius:6px;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif;text-align:left;transition:background .12s;width:100%}
.epp-rowbtn:hover{background:#353028;color:white}
.epp-css{width:100%;background:#0a0806;color:#3d9e9b;border:1px solid rgba(255,255,255,.1);border-radius:5px;padding:7px;font-family:monospace;font-size:10px;resize:vertical;outline:none;box-sizing:border-box}
/* Page adjust when panel open */
body.ed-props-open #page-public{margin-right:268px;transition:margin .2s}
</style>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FRECUENCIA INTEGRAL ‚Äî Editor WYSIWYG v3 completo
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var _edOn=false,_edSelMode=false,_edSel=null,_edSelBtn=null,_edPropsOpen=false;
var _edHistory=[],_edFuture=[],_edMaxSnap=30;
var _edBW='1px',_edBS='solid';

// ‚îÄ‚îÄ Snapshot / Historial ‚îÄ‚îÄ
function edSnapshot(){
  var h=document.getElementById('page-public').innerHTML;
  if(_edHistory.length&&_edHistory[_edHistory.length-1]===h)return;
  _edHistory.push(h); if(_edHistory.length>_edMaxSnap)_edHistory.shift();
  _edFuture=[]; edSyncHistBtns();
}
function edUndo(){
  if(_edHistory.length<2){edMsg('‚ö†Ô∏è Nada que deshacer');wixToast('‚ö†Ô∏è Nada que deshacer');return;}
  _edFuture.push(_edHistory.pop());
  document.getElementById('page-public').innerHTML=_edHistory[_edHistory.length-1];
  edMsg('‚Ü© Deshecho'); edSyncHistBtns(); wixToast('‚Ü© Deshecho');
}
function edRedo(){
  if(!_edFuture.length){edMsg('‚ö†Ô∏è Nada que rehacer');wixToast('‚ö†Ô∏è Nada que rehacer');return;}
  var h=_edFuture.pop(); _edHistory.push(h);
  document.getElementById('page-public').innerHTML=h;
  edMsg('‚Ü™ Rehecho'); edSyncHistBtns(); wixToast('‚Ü™ Rehecho');
}
function edSyncHistBtns(){
  var u=document.getElementById('edUndoBtn'),r=document.getElementById('edRedoBtn');
  if(u)u.style.opacity=_edHistory.length>1?'1':'0.3';
  if(r)r.style.opacity=_edFuture.length?'1':'0.3';
}

// ‚îÄ‚îÄ Keyboard shortcuts ‚îÄ‚îÄ
document.addEventListener('keydown',function(e){
  var sb=document.getElementById('wixSideBar');
  var panel=document.getElementById('edPanel');
  var editorActive=(panel&&panel.style.display==='flex')||(sb&&sb.style.display==='flex');
  if(!editorActive)return;
  var cm=e.ctrlKey||e.metaKey;
  if(cm&&e.key==='z'&&!e.shiftKey){e.preventDefault();edUndo();}
  if(cm&&(e.key==='y'||(e.key==='z'&&e.shiftKey))){e.preventDefault();edRedo();}
  if(cm&&e.key==='b'&&_edOn){e.preventDefault();edFmt('bold');}
  if(cm&&e.key==='i'&&_edOn){e.preventDefault();edFmt('italic');}
  if(e.key==='Escape'){
    edCtxClose();
    if(_edSelMode){wix_toggleSel();}  // ESC deactivates selection mode
    edClearSel();
    edFmtBarHide();
    // Close any open sub-panel but keep sidebar open
    if(_wixCurrentPanel) wixPanelClose();
  }
  // Delete key removes selected element (only when not typing)
  if((e.key==='Delete'||e.key==='Backspace')&&_edSel&&!_edOn&&!e.target.closest('input,textarea,select,[contenteditable]')){
    e.preventDefault();
    edDeleteSelected();
  }
});

function edMsg(t){var m=document.getElementById('edMsg');if(m)m.textContent=t;}

// ‚îÄ‚îÄ Abrir / Cerrar ‚îÄ‚îÄ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PROTECCI√ìN POR CONTRASE√ëA DEL EDITOR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚ö†Ô∏è CAMBIA ESTA CONTRASE√ëA POR LA TUYA:
var _edPassword = 'frecuencia2025';
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

var _edUnlocked = false;
var _edSecretClicks = 0;
var _edSecretTimer = null;

function edSecretClick() {
  _edSecretClicks++;
  clearTimeout(_edSecretTimer);
  _edSecretTimer = setTimeout(function(){ _edSecretClicks = 0; }, 800);
  if(_edSecretClicks >= 3) {
    _edSecretClicks = 0;
    if(_edUnlocked) {
      // Ya desbloqueado: mostrar/ocultar botones directamente
      edToggleEditorBtns();
    } else {
      edPwdShow();
    }
  }
}

function edPwdShow() {
  var modal = document.getElementById('edPwdModal');
  modal.style.display = 'flex';
  document.getElementById('edPwdInput').value = '';
  document.getElementById('edPwdErr').style.display = 'none';
  setTimeout(function(){ document.getElementById('edPwdInput').focus(); }, 100);
}

function edPwdCheck() {
  var val = document.getElementById('edPwdInput').value;
  if(val === _edPassword) {
    _edUnlocked = true;
    document.getElementById('edPwdModal').style.display = 'none';
    edShowEditorBtns();
    edMsg && edMsg('üîì Editor desbloqueado ‚Äî bienvenido');
  } else {
    document.getElementById('edPwdErr').style.display = 'block';
    document.getElementById('edPwdInput').value = '';
    document.getElementById('edPwdInput').focus();
    // Shake animation
    var input = document.getElementById('edPwdInput');
    input.style.borderColor = '#bf4637';
    setTimeout(function(){ input.style.borderColor = 'rgba(255,255,255,.2)'; }, 1200);
  }
}

function edPwdCancel() {
  document.getElementById('edPwdModal').style.display = 'none';
  document.getElementById('edPwdInput').value = '';
}

function edShowEditorBtns() {
  // Abre directamente el panel lateral ‚Äî no se necesitan los botones flotantes
  wixSideBarOpen();
}

function edHideEditorBtns() {
  var eb = document.getElementById('edOpenBtn');
  var nb = document.getElementById('navMgrBtn');
  if(eb) eb.style.display = 'none';
  if(nb) nb.style.display = 'none';
  // Close panels if open
  var panel = document.getElementById('edPanel');
  if(panel && panel.style.display === 'flex') edClose();
  var nm = document.getElementById('navMgrPanel');
  if(nm) nm.style.display = 'none';
}

function edToggleEditorBtns() {
  var sb = document.getElementById('wixSideBar');
  // Si el sidebar est√° visible ‚Üí cerrarlo. Si no ‚Üí abrirlo.
  if(sb && sb.style.display === 'flex') {
    wixSideBarClose();
  } else {
    edShowEditorBtns();
  }
}

// Cerrar modal con Escape
document.addEventListener('keydown', function(e) {
  if(e.key === 'Escape' && document.getElementById('edPwdModal').style.display === 'flex') {
    edPwdCancel();
  }
});

function editorOpen(){
  var p=document.getElementById('edPanel');
  var open=p.style.display==='flex';
  p.style.display=open?'none':'flex';
  if(!open&&!_edHistory.length)edSnapshot();
  if(open){
    edCloseProps();edFmtBarHide();
    document.body.style.paddingBottom='';
    // Solo ocultar botones si el sidebar NO est√° activo
    var sb=document.getElementById('wixSideBar');
    if(!sb||sb.style.display==='none'){
      document.getElementById('edOpenBtn').style.display='none';
      document.getElementById('navMgrBtn').style.display='none';
    }
  } else {
    var h=p.offsetHeight||60;
    document.body.style.paddingBottom=(h+16)+'px';
  }
}
function edClose(){
  document.getElementById('edPanel').style.display='none';
  document.body.style.paddingBottom='';
  // Solo gestionar botones si el sidebar NO est√° visible
  var sb=document.getElementById('wixSideBar');
  if(!sb||sb.style.display==='none'){
    document.getElementById('edOpenBtn').style.display='none';
    document.getElementById('navMgrBtn').style.display='none';
  }
  if(_edOn)edToggleText();
  edClearSel(); edCtxClose(); edCloseProps(); edFmtBarHide();
}

// ‚îÄ‚îÄ Props panel ‚îÄ‚îÄ
function edToggleProps(){
  _edPropsOpen=!_edPropsOpen;
  var pp=document.getElementById('edPropsPanel');
  if(pp) pp.style.display=_edPropsOpen?'block':'none';
  var btn=document.getElementById('edPropsBtn');
  if(btn){
    btn.style.background=_edPropsOpen?'#3d9e9b':'#252118';
    btn.style.color=_edPropsOpen?'white':'#3d9e9b';
    btn.textContent=_edPropsOpen?'‚öô Props ‚úï':'‚öô Props ‚Üí';
  }
  document.body.classList.toggle('ed-props-open',_edPropsOpen);
  if(_edPropsOpen&&_edSel) edFillProps(_edSel);
  if(_edPropsOpen&&!_edSel) wixToast('‚ö†Ô∏è Selecciona un elemento (üéØ) para ver sus propiedades CSS');
  else if(_edPropsOpen) wixToast('‚öô Panel de propiedades abierto');
}
function edCloseProps(){
  _edPropsOpen=false;
  var pp=document.getElementById('edPropsPanel');
  if(pp)pp.style.display='none';
  var btn=document.getElementById('edPropsBtn');
  if(btn){btn.style.background='#252118';btn.style.color='#3d9e9b';btn.textContent='‚öô Props ‚Üí';}
  document.body.classList.remove('ed-props-open');
}

// ‚îÄ‚îÄ Sincronizar panel de propiedades con elemento ‚îÄ‚îÄ
function edFillProps(el){
  if(!el)return;
  var s=el.style, cs=window.getComputedStyle(el);
  var tag=document.getElementById('edPropsTag');
  if(tag)tag.textContent='<'+el.tagName.toLowerCase()+(el.id?'#'+el.id:'')+'>';
  function si(id,v){var x=document.getElementById(id);if(x)x.value=v||'';}
  si('prpW',s.width);si('prpH',s.height);si('prpMW',s.maxWidth);si('prpMH',s.minHeight);
  si('prpPT',s.paddingTop);si('prpPB',s.paddingBottom);si('prpPL',s.paddingLeft);si('prpPR',s.paddingRight);
  si('prpFS',s.fontSize);si('prpLH',s.lineHeight);si('prpBR',s.borderRadius);
  // BG
  var bg=s.background||s.backgroundColor||cs.backgroundColor;
  var bgH=rgb2hex(bg);
  si('prpBgHex',bg.indexOf('gradient')>-1?bg:(bgH||bg));
  if(bgH)try{document.getElementById('prpBgPk').value=bgH;}catch(e){}
  // Text color
  var fc=s.color||cs.color; var fcH=rgb2hex(fc);
  si('prpTxtHex',fcH||fc);
  if(fcH)try{document.getElementById('prpTxtPk').value=fcH;}catch(e){}
  // Border
  var bc=s.borderColor||cs.borderColor; var bcH=rgb2hex(bc);
  si('prpBdHex',bcH||'');
  if(bcH)try{document.getElementById('prpBdPk').value=bcH;}catch(e){}
  // CSS
  si('prpCss',el.getAttribute('style')||'');
}

function rgb2hex(c){
  if(!c||c==='transparent')return'';
  if(c.startsWith('#'))return c;
  if(c.indexOf('gradient')>-1)return'';
  var m=c.match(/[\d.]+/g);
  if(!m||m.length<3)return'';
  if(c.indexOf('rgba')>-1&&parseFloat(m[3])===0)return'';
  return'#'+[m[0],m[1],m[2]].map(function(x){return('0'+parseInt(x).toString(16)).slice(-2);}).join('');
}

// ‚îÄ‚îÄ Aplicar propiedad CSS en vivo ‚îÄ‚îÄ
function edPropLive(prop,val){
  if(!_edSel)return;
  _edSel.style[prop]=val;
  // sync W/H toolbar inputs
  var wi=document.getElementById('edWInp'),hi=document.getElementById('edHInp');
  if(prop==='width'&&wi)wi.value=val;
  if(prop==='height'&&hi)hi.value=val;
  edSnapshot();
}
function edPropQ(prop,val){edPropLive(prop,val);edMsg('‚úÖ '+prop+': '+val);}

// ‚îÄ‚îÄ Fondo ‚îÄ‚îÄ
function edPropBg(val){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un bloque primero');return;}
  _edSel.style.background=val;
  var h=rgb2hex(val);
  if(h)try{document.getElementById('prpBgPk').value=h;}catch(e){}
  var hx=document.getElementById('prpBgHex'); if(hx)hx.value=val;
  if(h&&document.getElementById('edBg'))try{document.getElementById('edBg').value=h;}catch(e){}
  edMsg('üé® Fondo: '+val.substring(0,40)); edSnapshot();
}
function edPropBgInput(v){
  if(!_edSel)return;
  if(v.length===7&&v[0]==='#'){edPropBg(v);}
  else if(v==='transparent'||v.indexOf('gradient')>-1){edPropBg(v);}
}
function edBuildGrad(){
  var c1=document.getElementById('prpG1').value;
  var c2=document.getElementById('prpG2').value;
  var dir=document.getElementById('prpGDir').value;
  var g='linear-gradient('+dir+','+c1+','+c2+')';
  var prev=document.getElementById('prpGPreview');
  if(prev)prev.style.background=g;
}
// ‚îÄ‚îÄ Color texto del bloque ‚îÄ‚îÄ
function edPropTxtColor(val){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un bloque');return;}
  _edSel.style.setProperty('color',val,'important');
  _edSel.querySelectorAll('*').forEach(function(n){n.style.color=val;});
  var h=rgb2hex(val);
  if(h)try{document.getElementById('prpTxtPk').value=h;}catch(e){}
  var tx=document.getElementById('prpTxtHex'); if(tx)tx.value=val;
  if(h&&document.getElementById('edFontColor'))try{document.getElementById('edFontColor').value=h;}catch(e){}
  edMsg('‚úçÔ∏è Color texto: '+val); edSnapshot();
}
// ‚îÄ‚îÄ Borde ‚îÄ‚îÄ
function edPropBorder(val){
  if(!_edSel)return;
  if(val==='none'){_edSel.style.border='none';}
  else{_edSel.style.border=_edBW+' '+_edBS+' '+val;}
  var h=rgb2hex(val);
  if(h){try{document.getElementById('prpBdPk').value=h;}catch(e){}
    var bx=document.getElementById('prpBdHex');if(bx)bx.value=val;}
  if(h&&document.getElementById('edBorderColor'))try{document.getElementById('edBorderColor').value=h;}catch(e){}
  edMsg('üî≤ Borde: '+val); edSnapshot();
}
function edPropBorderW(w){_edBW=w;if(_edSel&&_edSel.style.borderColor){_edSel.style.borderWidth=w;edSnapshot();}}
function edPropBorderSt(st){_edBS=st;if(_edSel&&_edSel.style.borderColor){_edSel.style.borderStyle=st;edSnapshot();}}
function edPropCssApply(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  var v=document.getElementById('prpCss').value;
  _edSel.setAttribute('style',v);
  edMsg('üíª CSS aplicado'); edSnapshot();
}
function edPropCssRead(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  var css=document.getElementById('prpCss');
  if(css)css.value=_edSel.getAttribute('style')||'';
  edMsg('‚Üª CSS le√≠do');
}

// ‚îÄ‚îÄ Floating format bar ‚îÄ‚îÄ
function edFmtBarHide(){var b=document.getElementById('edFmtBar');if(b)b.style.display='none';}
document.addEventListener('mouseup',function(e){
  if(!_edOn)return;
  if(e.target.closest('#edFmtBar')||e.target.closest('#edPanel')||e.target.closest('#wixSideBar'))return;
  setTimeout(function(){
    var sel=window.getSelection();
    if(!sel||!sel.rangeCount||!sel.toString().trim()){edFmtBarHide();return;}
    var rect=sel.getRangeAt(0).getBoundingClientRect();
    var bar=document.getElementById('edFmtBar');
    var bx=rect.left+rect.width/2-300;
    bar.style.left=Math.max(6,Math.min(bx,window.innerWidth-610))+'px';
    bar.style.top=(rect.top-58+window.scrollY)+'px';
    bar.style.display='flex';
    // sync color picker with selection
    try{
      var anc=sel.anchorNode;
      var el2=anc.nodeType===3?anc.parentElement:anc;
      var cs2=window.getComputedStyle(el2);
      var fc=cs2.color;
      var fh=rgb2hex(fc);
      if(fh)document.getElementById('efbTxtColor').value=fh;
      // ‚îÄ‚îÄ Font info display ‚îÄ‚îÄ
      var ff=cs2.fontFamily||'';
      // clean up font name
      ff=ff.split(',')[0].replace(/['"]/g,'').trim();
      if(ff.length>14)ff=ff.substring(0,12)+'‚Ä¶';
      var fs=cs2.fontSize||'';
      // convert px to integer for display
      var fsPx=parseFloat(fs);
      var fsDisplay=isNaN(fsPx)?fs:Math.round(fsPx)+'px';
      var fiFamily=document.getElementById('edFontInfoFamily');
      var fiSize=document.getElementById('edFontInfoSize');
      if(fiFamily)fiFamily.textContent=ff||'‚Äî';
      if(fiSize)fiSize.textContent=fsDisplay||'‚Äî';
    }catch(ex){}
  },12);
});
document.addEventListener('mousedown',function(e){if(!e.target.closest('#edFmtBar'))edFmtBarHide();});

// ‚îÄ‚îÄ execCommand format ‚îÄ‚îÄ
function edFmt(cmd){
  if(_edOn){
    document.execCommand(cmd,false,null);
    try{edSnapshot();}catch(e){}
    var labels={'bold':'Negrita','italic':'Cursiva','underline':'Subrayado','strikeThrough':'Tachado',
      'justifyLeft':'Izquierda','justifyCenter':'Centrado','justifyRight':'Derecha','justifyFull':'Justificado',
      'insertUnorderedList':'Lista ‚Ä¢ ','insertOrderedList':'Lista 1.','superscript':'Super√≠ndice','subscript':'Sub√≠ndice'};
    if(labels[cmd]) wixToast('‚úÖ '+labels[cmd]+' aplicado');
  }
  else if(_edSel){
    if(cmd==='justifyLeft'){_edSel.style.textAlign='left';edSnapshot();wixToast('‚¨õ Alineado a la izquierda');}
    else if(cmd==='justifyCenter'){_edSel.style.textAlign='center';edSnapshot();wixToast('‚¨õ Centrado');}
    else if(cmd==='justifyRight'){_edSel.style.textAlign='right';edSnapshot();wixToast('‚¨õ Alineado a la derecha');}
    else if(cmd==='justifyFull'){_edSel.style.textAlign='justify';edSnapshot();wixToast('‚â° Justificado');}
    else{edMsg('‚ö†Ô∏è Activa "Editar textos" para formato de texto'); wixToast('‚ö†Ô∏è Activa primero ¬´Editar texto¬ª para aplicar formato');}
  }
}

function edFmtBlock(tag){
  if(!_edOn){
    wixToast('‚ö†Ô∏è Activa ¬´Editar texto¬ª ‚úçÔ∏è primero, luego coloca el cursor dentro del p√°rrafo a cambiar');
    return;
  }
  try{
    document.execCommand('formatBlock',false,tag);
    try{edSnapshot();}catch(e2){}
    wixToast('‚úÖ Formato '+tag.toUpperCase()+' aplicado al p√°rrafo');
  }catch(e){
    wixToast('‚ö†Ô∏è No se pudo aplicar '+tag+': '+e.message);
  }
}
function edFmtHighlight(color){
  if(!_edOn){return;}
  var sel=window.getSelection();
  if(!sel||!sel.rangeCount||!sel.toString())return;
  try{
    var range=sel.getRangeAt(0);
    var span=document.createElement('span');
    span.style.backgroundColor=color;
    span.appendChild(range.extractContents());
    range.insertNode(span); sel.removeAllRanges();
    edMsg('‚ñì Resaltado aplicado'); edSnapshot();
  }catch(e){}
}

// ‚îÄ‚îÄ Selecci√≥n visual ‚îÄ‚îÄ
function edClearSel(){if(_edSel){_edSel.classList.remove('ed-selected-ring');_edSel=null;}_edSelBtn=null;}
function edSelectEl(el){
  edClearSel(); _edSel=el; el.classList.add('ed-selected-ring');
  var lbl=el.id?'#'+el.id:el.tagName.toLowerCase();
  var txt=el.textContent.trim().substring(0,28);
  edMsg('‚úÖ '+lbl+(txt?': "'+txt+'"':'')+' ‚Äî modifica en la barra o en ‚öô Props');
  // Sync toolbar
  try{
    var cs=window.getComputedStyle(el);
    var bg=el.style.background||el.style.backgroundColor||cs.backgroundColor;
    var bgH=rgb2hex(bg);
    if(bgH)try{document.getElementById('edBg').value=bgH;}catch(e2){}
    var fc=el.style.color||cs.color; var fcH=rgb2hex(fc);
    if(fcH)try{document.getElementById('edFontColor').value=fcH;}catch(e2){}
    var wi=document.getElementById('edWInp'); if(wi)wi.value=el.style.width||'';
    var hi=document.getElementById('edHInp'); if(hi)hi.value=el.style.height||'';
  }catch(e){}
  if(_edPropsOpen)edFillProps(el);
}

// ‚îÄ‚îÄ Modo selecci√≥n ‚îÄ‚îÄ
function edToggleMode(){
  _edSelMode=!_edSelMode;
  var b=document.getElementById('edModeBtn');
  if(b){b.style.background=_edSelMode?'#b89558':'#2b7d7a';b.textContent=_edSelMode?'üéØ Activo':'üñ± Seleccionar';}
  // Update sidebar button visual state
  var sb=document.getElementById('wsb-elementos');
  if(sb){sb.style.background=_edSelMode?'#b89558':'';sb.title=_edSelMode?'Selecci√≥n ACTIVA ‚Äî clic en elemento':'Elementos';}
  edMsg(_edSelMode?'üéØ Clic en cualquier elemento para seleccionar':''); wixToast(_edSelMode?'üéØ Modo selecci√≥n ACTIVO ‚Äî clic en cualquier elemento':'üîì Modo selecci√≥n desactivado');
  if(!_edSelMode)edClearSel();
}

// ‚îÄ‚îÄ Modo edici√≥n textos ‚îÄ‚îÄ
function edToggleText(){
  _edOn=!_edOn;
  var b=document.getElementById('edTxtBtn');
  if(_edOn){
    edSnapshot();
    var BLOCK=['DIV','P','H1','H2','H3','H4','H5','H6','SECTION','ARTICLE','UL','OL','LI','BLOCKQUOTE','PRE','TABLE','TD','TH'];
    var SKIP=['SCRIPT','STYLE','INPUT','SELECT','TEXTAREA','IFRAME','BUTTON','SVG','CANVAS','VIDEO','AUDIO'];
    document.querySelectorAll('.page.active *').forEach(function(el){
      if(el.closest('#edPanel')||el.closest('nav')||el.closest('.modal-overlay')||el.closest('#wixSideBar'))return;
      if(SKIP.indexOf(el.tagName)>-1||el.contentEditable==='true')return;
      var txt=el.textContent.trim();
      if(!txt||txt.length>800)return;
      var bk=0,dt=false;
      el.childNodes.forEach(function(n){
        if(n.nodeType===3&&n.textContent.trim())dt=true;
        if(n.nodeType===1&&BLOCK.indexOf(n.tagName)>-1)bk++;
      });
      if(bk===0||(dt&&bk<=1)){
        el.contentEditable='true';
        el.setAttribute('data-edol',el.style.outline||'');
        el.setAttribute('data-edcu',el.style.cursor||'');
        el.style.setProperty('outline','1px dashed rgba(43,125,122,.5)','important');
        el.style.cursor='text';
      }
    });
    if(b){b.textContent='üîí Fin edici√≥n'; b.style.background='#bf4637';}
    // Visual feedback in sidebar
    var wsbT=document.getElementById('wsb-texto');
    if(wsbT){wsbT.style.background='#bf4637';wsbT.title='Edici√≥n ACTIVA ‚Äî clic para desactivar';}
    edMsg('‚úèÔ∏è Textos activos ‚Äî selecciona texto para barra flotante de formato');
    wixToast('‚úèÔ∏è Edici√≥n de texto ACTIVA ‚Äî clic en cualquier texto');
  }else{
    document.querySelectorAll('[contenteditable="true"]').forEach(function(el){
      el.removeAttribute('contenteditable');
      el.style.outline=el.getAttribute('data-edol')||'';
      el.style.cursor=el.getAttribute('data-edcu')||'';
      el.removeAttribute('data-edol'); el.removeAttribute('data-edcu');
    });
    edFmtBarHide();
    if(b){b.textContent='‚úèÔ∏è Editar textos'; b.style.background='#2b7d7a';}
    var wsbT=document.getElementById('wsb-texto');
    if(wsbT){wsbT.style.background='';wsbT.title='Textos';}
    edMsg(''); edSnapshot();
    wixToast('üîí Edici√≥n de texto desactivada');
  }
}

// ‚îÄ‚îÄ Color texto ‚îÄ‚îÄ
function edApplyFontColor(v){
  var sel=window.getSelection();
  if(_edOn&&sel&&sel.rangeCount>0&&sel.toString().length>0){
    try{
      var range=sel.getRangeAt(0);
      var frag=range.extractContents();
      frag.querySelectorAll('*').forEach(function(n){n.style.color=v;});
      var sp=document.createElement('span');
      sp.style.setProperty('color',v,'important');
      sp.appendChild(frag); range.insertNode(sp); sel.removeAllRanges();
      edMsg('üé® Color texto aplicado'); edSnapshot();
    }catch(e){edMsg('‚ö†Ô∏è '+e.message);}
  }else if(_edSel){
    _edSel.style.setProperty('color',v,'important');
    _edSel.querySelectorAll('*').forEach(function(n){n.style.color=v;});
    edMsg('üé® Color aplicado al elemento'); edSnapshot(); wixToast('üé® Color de texto aplicado');
  }else{edMsg('‚ö†Ô∏è Activa edici√≥n y selecciona texto, o selecciona elemento'); wixToast('‚ö†Ô∏è Activa ¬´Editar texto¬ª y selecciona texto primero');}
}

// ‚îÄ‚îÄ Tipograf√≠a bloque ‚îÄ‚îÄ
function edApplyFont(v){
  if(!v)return;
  if(_edSel){_edSel.style.fontFamily=v;edMsg('üî§ Tipograf√≠a aplicada');edSnapshot();wixToast('üî§ Fuente: '+v.split(',')[0].replace(/'/g,''));}
  else edMsg('‚ö†Ô∏è Selecciona un elemento primero');
  var ef=document.getElementById('edFont'); if(ef)ef.value='';
}
function edApplyFontInline(v){
  if(!v)return;
  if(!_edOn&&!_edSel){wixToast('‚ö†Ô∏è Activa ¬´Editar texto¬ª o selecciona un elemento');return;}
  var sel=window.getSelection();
  if(sel&&sel.rangeCount>0&&sel.toString()){
    try{
      var range=sel.getRangeAt(0);
      var sp=document.createElement('span');
      sp.style.fontFamily=v; sp.appendChild(range.extractContents());
      range.insertNode(sp); sel.removeAllRanges();
      edMsg('üî§ Fuente inline aplicada'); edSnapshot();
    }catch(e){}
  }else if(_edSel){edApplyFont(v);}
}

// ‚îÄ‚îÄ Tama√±o texto ‚îÄ‚îÄ
function edApplyFontSize(v){
  if(!v)return;
  var sel=window.getSelection();
  if(_edOn&&sel&&sel.rangeCount>0&&sel.toString()){
    try{
      var range=sel.getRangeAt(0);
      var frag=range.extractContents();
      var sp=document.createElement('span');
      sp.style.fontSize=v; sp.appendChild(frag);
      range.insertNode(sp); sel.removeAllRanges();
      edMsg('üìê Tama√±o '+v); edSnapshot(); wixToast('üìê Tama√±o '+v+' aplicado'); return;
    }catch(e){}
  }
  if(_edSel){_edSel.style.fontSize=v;edMsg('üìê Tama√±o '+v+' aplicado al bloque');edSnapshot();wixToast('üìê Tama√±o '+v+' al bloque');}
  else edMsg('‚ö†Ô∏è Selecciona texto o elemento');
  var fs=document.getElementById('edFontSize'); if(fs)fs.value='';
}

// ‚îÄ‚îÄ Fondo / Borde / Bot√≥n / Padding ‚îÄ‚îÄ
function edApplyBg(v){
  if(_edSel){_edSel.style.background=v;edMsg('üé® Fondo: '+v);edSnapshot();wixToast('üé® Fondo aplicado');}
  else edMsg('‚ö†Ô∏è Selecciona un bloque primero');
}
function edApplyBorder(v){
  if(_edSel){
    if(v==='none')_edSel.style.border='none';
    else _edSel.style.border=_edBW+' '+_edBS+' '+v;
    edMsg('üî≤ Borde: '+v); edSnapshot();
  }else edMsg('‚ö†Ô∏è Selecciona un elemento');
}
function edApplyBtn(v){
  var t=_edSelBtn||_edSel;
  if(t){
    var btn=t.tagName==='BUTTON'?t:t.querySelector('button, a[href]');
    if(btn){
      btn.style.background=v;
      var r=parseInt(v.slice(1,3),16),g=parseInt(v.slice(3,5),16),b=parseInt(v.slice(5,7),16);
      btn.style.color=(r*299+g*587+b*114)/1000>128?'#1c1814':'white';
      edMsg('üîò Bot√≥n: '+v); edSnapshot();
    }else edMsg('‚ö†Ô∏è No hay bot√≥n en este elemento');
  }else edMsg('‚ö†Ô∏è Selecciona un elemento con bot√≥n');
}
function edApplyPadding(v){
  if(!v)return;
  if(_edSel){_edSel.style.padding=v;edMsg('üìê Padding: '+v);edSnapshot();wixToast('üìê Padding: '+v);}
  else edMsg('‚ö†Ô∏è Selecciona un elemento');
  var ep=document.getElementById('edPadding'); if(ep)ep.value='';
}

// ‚îÄ‚îÄ Enlace ‚îÄ‚îÄ
function edAddLink(){
  var url=prompt('URL del enlace (ej: https://frecuenciaintegral.com):');
  if(!url)return;
  var sel=window.getSelection();
  if(_edOn&&sel&&sel.rangeCount>0&&sel.toString()){
    try{
      var range=sel.getRangeAt(0);
      var a=document.createElement('a');
      a.href=url; a.target='_blank'; a.style.color='inherit'; a.style.textDecoration='underline';
      a.appendChild(range.extractContents()); range.insertNode(a); sel.removeAllRanges();
      edMsg('üîó Enlace a√±adido'); edSnapshot(); return;
    }catch(e){}
  }
  if(_edSel){
    _edSel.style.cursor='pointer';
    _edSel.setAttribute('onclick',"window.open('"+url+"','_blank')");
    edMsg('üîó Enlace a√±adido al elemento'); edSnapshot(); wixToast('üîó Enlace a√±adido');
  }else edMsg('‚ö†Ô∏è Selecciona texto o un elemento');
}

// ‚îÄ‚îÄ Cambiar imagen ‚îÄ‚îÄ
function edChangeImage(){
  edImgPanelOpen();
}
function edImgPanelOpen(){
  var panel=document.getElementById('edImgPanel');
  var hasImg=_edSel&&(_edSel.tagName==='IMG'||_edSel.querySelector('img'));
  document.getElementById('edImgModeLabel').textContent=hasImg?'‚úèÔ∏è Editar imagen seleccionada':'‚ûï Insertar nueva imagen';
  document.getElementById('edImgUrl').value=hasImg?((_edSel.tagName==='IMG'?_edSel:_edSel.querySelector('img')).src||''):'';
  document.getElementById('edImgAlt').value='';
  document.getElementById('edImgW').value='100%';
  document.getElementById('edImgH').value='300px';
  document.getElementById('edImgFit').value='cover';
  document.getElementById('edImgRadius').value='12px';
  document.getElementById('edImgPreviewBox').innerHTML='<span style="color:rgba(255,255,255,.2);font-size:12px">Preview aparecer√° aqu√≠</span>';
  panel.style.display='flex';
}
function edImgPanelClose(){
  document.getElementById('edImgPanel').style.display='none';
}
function edImgPreview(){
  var url=document.getElementById('edImgUrl').value.trim();
  var w=document.getElementById('edImgW').value||'100%';
  var h=document.getElementById('edImgH').value||'300px';
  var fit=document.getElementById('edImgFit').value;
  var r=document.getElementById('edImgRadius').value||'0';
  var box=document.getElementById('edImgPreviewBox');
  if(!url){box.innerHTML='<span style="color:#f08080;font-size:12px">Introduce una URL primero</span>';return;}
  box.innerHTML='<img src="'+url+'" style="width:'+w+';height:'+h+';object-fit:'+fit+';border-radius:'+r+';max-width:100%;display:block" onerror="this.parentNode.innerHTML=\'<span style=color:#f08080;font-size:12px>‚ùå URL inv√°lida</span>\'">';
}
function edImgApply(){
  var url=document.getElementById('edImgUrl').value.trim();
  if(!url){edMsg('‚ö†Ô∏è Introduce una URL de imagen');return;}
  var alt=document.getElementById('edImgAlt').value||'';
  var w=document.getElementById('edImgW').value||'100%';
  var h=document.getElementById('edImgH').value||'300px';
  var fit=document.getElementById('edImgFit').value;
  var r=document.getElementById('edImgRadius').value||'0';
  var posEl=document.querySelector('input[name="edImgPos"]:checked');
  var pos=posEl?posEl.value:'after';
  var css='width:'+w+';height:'+h+';object-fit:'+fit+';border-radius:'+r+';display:block;max-width:100%';
  edSnapshot();
  if(_edSel){
    var existImg=_edSel.tagName==='IMG'?_edSel:_edSel.querySelector('img');
    if(existImg&&pos==='replace'){
      existImg.src=url;existImg.alt=alt;existImg.style.cssText=css;
      edMsg('üñºÔ∏è Imagen actualizada');edImgPanelClose();edSnapshot();return;
    }
  }
  var wrapper=document.createElement('div');
  wrapper.style.cssText='overflow:hidden;border-radius:'+r+';margin:16px 0';
  var img=document.createElement('img');
  img.src=url;img.alt=alt;img.style.cssText=css;
  wrapper.appendChild(img);
  if(_edSel){
    if(pos==='before')_edSel.parentNode.insertBefore(wrapper,_edSel);
    else if(pos==='after')_edSel.parentNode.insertBefore(wrapper,_edSel.nextSibling);
    else if(pos==='inside')_edSel.appendChild(wrapper);
    else if(pos==='replace'){_edSel.parentNode.insertBefore(wrapper,_edSel);_edSel.remove();_edSel=null;}
  } else {
    document.body.appendChild(wrapper);
  }
  edSelectEl(wrapper);
  edMsg('üñºÔ∏è Imagen insertada'); wixToast('üñºÔ∏è Imagen insertada correctamente');
  edImgPanelClose();
  edSnapshot();
}

// ‚îÄ‚îÄ Duplicar / Mover / Eliminar ‚îÄ‚îÄ
function edDuplicate(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  edSnapshot();
  var cl=_edSel.cloneNode(true); cl.classList.remove('ed-selected-ring');
  _edSel.parentNode.insertBefore(cl,_edSel.nextSibling);
  edSelectEl(cl); edMsg('üìã Duplicado'); edSnapshot(); wixToast('üìã Elemento duplicado');
}
function edMoveUp(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  var prev=_edSel.previousElementSibling;
  if(prev){edSnapshot();_edSel.parentNode.insertBefore(_edSel,prev);edMsg('‚¨ÜÔ∏è Movido arriba');}
  else edMsg('‚ö†Ô∏è Ya est√° al principio');
}
function edMoveDown(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  var next=_edSel.nextElementSibling;
  if(next){edSnapshot();_edSel.parentNode.insertBefore(next,_edSel);edMsg('‚¨áÔ∏è Movido abajo');}
  else edMsg('‚ö†Ô∏è Ya est√° al final');
}
function edDeleteSelected(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  if(!confirm('¬øEliminar este elemento? (deshacer con ‚Ü©)'))return;
  edSnapshot(); _edSel.remove(); _edSel=null;
  edMsg('üóëÔ∏è Eliminado ‚Äî ‚Ü© para deshacer'); edSnapshot();
}

// ‚îÄ‚îÄ Men√∫ contextual ‚îÄ‚îÄ
function edCtxClose(){document.getElementById('edCtxMenu').style.display='none';}
function edCtxAction(a){
  edCtxClose();
  if(a==='props'){if(!_edPropsOpen)edToggleProps();else edFillProps(_edSel);}
  else if(a==='editar')edToggleText();
  else if(a==='link')edAddLink();
  else if(a==='imagen')edChangeImage();
  else if(a==='duplicar')edDuplicate();
  else if(a==='subir')edMoveUp();
  else if(a==='bajar')edMoveDown();
  else if(a==='eliminar')edDeleteSelected();
}
document.addEventListener('contextmenu',function(e){
  var sb=document.getElementById('wixSideBar');
  var panel=document.getElementById('edPanel');
  var editorActive=(panel&&panel.style.display==='flex')||(sb&&sb.style.display==='flex');
  if(!editorActive)return;
  if(e.target.closest('#edPanel')||e.target.closest('#edCtxMenu')||e.target.closest('#wixSideBar'))return;
  e.preventDefault();
  var el=e.target.closest('div,section,article,p,h1,h2,h3,img,button,span');
  if(el&&!el.closest('nav')){
    edSelectEl(el);
    var ctx=document.getElementById('edCtxMenu');
    document.getElementById('edCtxTitle').textContent=el.tagName.toLowerCase()+(el.id?'#'+el.id:'');
    ctx.style.display='block';
    ctx.style.left=Math.min(e.clientX,window.innerWidth-200)+'px';
    ctx.style.top=Math.min(e.clientY,window.innerHeight-290)+'px';
  }
});
document.addEventListener('click',function(e){
  if(e.target.closest('#edCtxMenu'))return;
  edCtxClose();
  // Editor active = edPanel visible OR wixSideBar visible
  var sb=document.getElementById('wixSideBar');
  var panel=document.getElementById('edPanel');
  var editorActive=(panel&&panel.style.display==='flex')||(sb&&sb.style.display==='flex');
  if(!editorActive)return;
  if(e.target.closest('#edPanel')||e.target.closest('#edPropsPanel')||e.target.closest('#wixSideBar'))return;
  if(e.target.closest('#navMgrPanel')||e.target.closest('#edImgPanel')||e.target.closest('#edPwdModal'))return;
  if(_edOn)return;
  if(_edSelMode){
    // Walk up from click target to find a meaningful selectable element
    var el2 = e.target;
    // Skip tiny inline elements - walk up to a block/meaningful container
    var skip = ['A','STRONG','EM','B','I','BR','SPAN'];
    while(el2 && skip.indexOf(el2.tagName) > -1) el2 = el2.parentElement;
    // Now find nearest block container
    if(el2) el2 = el2.closest('div,section,article,p,h1,h2,h3,h4,h5,h6,img,figure,blockquote,li,ul,ol,header,footer,main');
    if(el2 && !el2.closest('nav') && !el2.closest('#wixSideBar') && el2 !== document.body && el2 !== document.documentElement){
      e.stopPropagation();
      edSelectEl(el2);
      var label = el2.tagName.toLowerCase() + (el2.id ? '#'+el2.id : '') + (el2.className && typeof el2.className === 'string' ? ' .'+el2.className.trim().split(/\s+/)[0] : '');
      wixToast('‚úÖ '+label+' seleccionado');
    } else {
      wixToast('‚ö†Ô∏è No se encontr√≥ un bloque seleccionable ‚Äî prueba a hacer clic en otro elemento');
    }
    return;
  }
  var btn=e.target.closest('button');
  if(btn&&!btn.closest('#edPanel')&&!btn.closest('#wixSideBar')){_edSelBtn=btn;edSelectEl(btn);return;}
  var sec=e.target.closest('[id],[style*="border-radius"],section');
  if(sec&&!sec.closest('#edPanel')&&!sec.closest('#wixSideBar')&&!sec.closest('nav')&&sec!==document.documentElement&&sec!==document.body)edSelectEl(sec);
});

// ‚îÄ‚îÄ Insertar bloques ‚îÄ‚îÄ
function edInsert(tipo){
  edSnapshot();
  var el,S="font-family:'DM Sans',sans-serif",CG="font-family:'Cormorant Garamond',serif";
  if(tipo==='texto'){
    el=document.createElement('div');
    el.style.cssText='padding:60px 40px;max-width:800px;margin:0 auto;text-align:center';
    el.innerHTML='<h2 style="'+CG+';font-size:36px;font-weight:300;color:#1c1814;margin-bottom:16px">Nuevo t√≠tulo</h2><p style="font-size:15px;color:#7a7168;line-height:1.75;max-width:600px;margin:0 auto">Escribe aqu√≠ el contenido del bloque.</p>';
  }else if(tipo==='tarjeta'){
    var grid=(_edSel&&_edSel.querySelector('[style*="grid"]'))||document.querySelector('#pilares [style*="grid"]');
    if(!grid){edMsg('‚ö†Ô∏è Selecciona primero una secci√≥n con tarjetas');return;}
    el=document.createElement('div');
    el.style.cssText='background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8';
    el.innerHTML='<div style="font-size:32px;margin-bottom:16px">‚ú®</div><div style="'+CG+';font-size:24px;color:#1c1814;margin-bottom:10px">Nueva Tarjeta</div><div style="font-size:13px;color:#5a5248;line-height:1.75">Descripci√≥n de la tarjeta.</div>';
    grid.appendChild(el);edSelectEl(el);edMsg('‚úÖ Tarjeta a√±adida');edSnapshot();return;
  }else if(tipo==='banner-ancho'){
    el=document.createElement('div');
    el.style.cssText='width:100%;padding:80px 40px;background:linear-gradient(135deg,#2b7d7a,#1c5a58);text-align:center';
    el.innerHTML='<h2 style="'+CG+';font-size:clamp(32px,5vw,56px);font-weight:300;color:white;margin-bottom:16px">Banner Principal</h2><p style="font-size:16px;color:rgba(255,255,255,.8);max-width:600px;margin:0 auto 32px;line-height:1.7">Texto del banner.</p><button style="background:white;color:#2b7d7a;border:none;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;'+S+'">Llamada a la acci√≥n</button>';
  }else if(tipo==='banner-peque√±o'){
    el=document.createElement('div');
    el.style.cssText='max-width:900px;margin:40px auto;padding:40px 48px;background:#f0ece4;border-radius:20px;border:1px solid #d9d2c8;display:flex;align-items:center;gap:32px;flex-wrap:wrap';
    el.innerHTML='<div style="flex:1;min-width:200px"><div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.1em;margin-bottom:8px">Etiqueta</div><h3 style="'+CG+';font-size:28px;font-weight:300;color:#1c1814;margin-bottom:8px">T√≠tulo</h3><p style="font-size:14px;color:#7a7168;line-height:1.7">Descripci√≥n del contenido.</p></div><button style="background:#2b7d7a;color:white;border:none;padding:12px 28px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;'+S+';flex-shrink:0">Acci√≥n ‚Üí</button>';
  }else if(tipo==='imagen-banner'){
    var ur=prompt('URL de la imagen:')||'https://via.placeholder.com/1400x500/f0ece4/7a7168?text=Banner';
    el=document.createElement('div');
    el.style.cssText='width:100%;height:450px;overflow:hidden;position:relative';
    el.innerHTML='<img src="'+ur+'" style="width:100%;height:100%;object-fit:cover"><div style="position:absolute;inset:0;background:rgba(28,24,20,.4);display:flex;align-items:center;justify-content:center;text-align:center;padding:40px"><div><h2 style="'+CG+';font-size:clamp(32px,5vw,60px);font-weight:300;color:white;margin-bottom:16px">T√≠tulo</h2><p style="font-size:16px;color:rgba(255,255,255,.85);max-width:500px;margin:0 auto">Subt√≠tulo o descripci√≥n</p></div></div>';
  }else if(tipo==='imagen-peque√±a'){
    var ur2=prompt('URL de la imagen:')||'https://via.placeholder.com/600x400/f0ece4/7a7168?text=Imagen';
    el=document.createElement('div');
    el.style.cssText='max-width:1000px;margin:40px auto;display:grid;grid-template-columns:1fr 1fr;gap:48px;align-items:center;padding:0 32px';
    el.innerHTML='<img src="'+ur2+'" style="width:100%;border-radius:16px;object-fit:cover;height:320px"><div><h3 style="'+CG+';font-size:28px;font-weight:300;color:#1c1814;margin-bottom:12px">T√≠tulo</h3><p style="font-size:14px;color:#7a7168;line-height:1.75">Descripci√≥n.</p></div>';
  }else if(tipo==='boton'){
    el=document.createElement('div');
    el.style.cssText='text-align:center;padding:24px';
    var hr=prompt('URL del enlace (o vac√≠o):')||'#';
    el.innerHTML='<a href="'+hr+'" target="_blank" style="display:inline-block;background:#2b7d7a;color:white;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;'+S+';text-decoration:none">Nuevo Bot√≥n</a>';
  }else if(tipo==='separador'){
    el=document.createElement('div');
    el.style.cssText='max-width:600px;margin:40px auto;display:flex;align-items:center;gap:20px;padding:0 32px';
    el.innerHTML='<div style="flex:1;height:1px;background:#e4ddd3"></div><span style="font-size:12px;color:#b8ad9e;font-weight:600;letter-spacing:.1em">‚Ä¢</span><div style="flex:1;height:1px;background:#e4ddd3"></div>';
  }
  if(el){
    var anchor=_edSel?_edSel:(document.getElementById('joyas')||document.getElementById('pilares'));
    var page=document.getElementById('page-public');
    if(anchor&&anchor.parentNode)anchor.parentNode.insertBefore(el,anchor.nextSibling);
    else page.appendChild(el);
    el.scrollIntoView({behavior:'smooth',block:'center'});
    edSelectEl(el);
    edMsg('‚úÖ Bloque a√±adido ‚Äî activa "Editar textos" para modificarlo'); wixToast('‚úÖ Bloque a√±adido a la p√°gina');
    edSnapshot();
  }
}

// ‚îÄ‚îÄ Guardar ‚îÄ‚îÄ
function edSave(){
  if(_edOn)edToggleText();
  edClearSel(); edCtxClose(); edCloseProps();
  document.querySelectorAll('[contenteditable]').forEach(function(el){
    el.removeAttribute('contenteditable');el.style.outline='';el.style.cursor='';
  });
  var panel=document.getElementById('edPanel');
  if(panel)panel.style.display='none';
  setTimeout(function(){
    // Hide sidebar temporarily for clean snapshot
    var sb=document.getElementById('wixSideBar');
    var sbWas = sb ? sb.style.display : 'none';
    if(sb) sb.style.display='none';
    wixUnpushPage();
    var toast_el=document.getElementById('wixToastEl');
    if(toast_el) toast_el.style.display='none';
    setTimeout(function(){
      // Limpiar scripts inyectados por extensiones del navegador antes de guardar
      var html = '<!DOCTYPE html>' + document.documentElement.outerHTML;
      html = html.replace(/<script\s+src="chrome-extension:\/\/[^"]*"[^>]*><\/script>/g, '');
      html = html.replace(/<script>\(\s*\n?\s*function y\(k\)[\s\S]*?\);\s*\n?\s*<\/script>/g, '');
      html = html.replace(/<style data-merge-styles="true"[^>]*><\/style>/g, '');
      var blob=new Blob([html],{type:'text/html'});
      var a=document.createElement('a');
      a.href=URL.createObjectURL(blob);
      a.download='frecuencia-integral-editada.html';
      document.body.appendChild(a);a.click();document.body.removeChild(a);
      // Restore sidebar
      if(sb) sb.style.display=sbWas;
      if(toast_el) toast_el.style.display='';
      wixPushPage(false);
      wixToast('‚úÖ Guardado ‚Äî renombra a index.html y sube a Vercel');
    },100);
  },100);
}

</script>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- GESTOR DE NAVEGACI√ìN Y P√ÅGINAS                                 -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- Bot√≥n de acceso r√°pido (junto al Editor) -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PANEL LATERAL ESTILO WIX
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="wixSideBar" style="display:none;position:fixed;top:0;left:0;bottom:0;z-index:99990;flex-direction:row;font-family:'DM Sans',sans-serif">

  <!-- Columna de iconos (nivel 1) -->
  <div id="wixIconBar" style="width:56px;height:100%;background:#1c1814;display:flex;flex-direction:column;align-items:center;padding:12px 0;gap:4px;box-shadow:2px 0 12px rgba(0,0,0,.4);flex-shrink:0">
    <div style="font-size:9px;font-weight:700;color:#b89558;text-align:center;margin-bottom:8px;letter-spacing:.06em;line-height:1.2">ED<br>TCT</div>
    <div style="width:32px;height:1px;background:rgba(255,255,255,.08);margin-bottom:4px"></div>
    <button class="wsb-icon" id="wsb-texto"     onclick="wixPanel('texto')"     title="Textos">T</button>
    <button class="wsb-icon" id="wsb-elementos" onclick="wixPanel('elementos')" title="Elementos">‚äû</button>
    <button class="wsb-icon" id="wsb-imagenes"  onclick="wixPanel('imagenes')"  title="Im√°genes">üñº</button>
    <button class="wsb-icon" id="wsb-diseno"    onclick="wixPanel('diseno')"    title="Dise√±o">üé®</button>
    <button class="wsb-icon" id="wsb-nav"       onclick="wixPanel('nav')"       title="Nav & P√°ginas">üìë</button>
    <button class="wsb-icon" id="wsb-acciones"  onclick="wixPanel('acciones')"  title="Acciones">‚ö°</button>
    <div style="flex:1"></div>
    <div style="width:32px;height:1px;background:rgba(255,255,255,.08);margin-bottom:4px"></div>
    <button class="wsb-icon" onclick="edSave()" title="Guardar" style="color:#b89558;border-color:rgba(184,149,88,.3)">üíæ</button>
    <button class="wsb-icon" onclick="wixSideBarClose()" title="Cerrar editor" style="color:#f08080;border-color:rgba(240,128,128,.2);margin-top:4px">‚úï</button>
  </div>

  <!-- Panel secundario (nivel 2) -->
  <div id="wixPanel2" style="display:none;width:260px;height:100%;background:#252118;box-shadow:2px 0 16px rgba(0,0,0,.35);overflow-y:auto;flex-direction:column;flex-shrink:0">
    <div style="display:flex;align-items:center;justify-content:space-between;padding:16px 16px 12px;border-bottom:1px solid rgba(255,255,255,.08);position:sticky;top:0;background:#252118;z-index:2">
      <div id="wixP2Title" style="font-size:13px;font-weight:700;color:white"></div>
      <button onclick="wixPanelClose()" style="background:none;border:none;color:rgba(255,255,255,.3);font-size:16px;cursor:pointer;padding:2px 6px">‚úï</button>
    </div>
    <div id="wixP2Body" style="padding:12px 14px;display:flex;flex-direction:column;gap:6px"></div>
  </div>
</div>

<style>
.wsb-icon{width:40px;height:40px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);border-radius:10px;color:rgba(255,255,255,.65);font-size:15px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s;flex-shrink:0}
.wsb-icon:hover,.wsb-icon.active{background:#2b7d7a;border-color:#2b7d7a;color:white}
.wsb-icon.active{box-shadow:0 0 0 2px rgba(43,125,122,.4)}
.wp2-btn{display:flex;align-items:center;gap:10px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:9px;padding:10px 12px;color:rgba(255,255,255,.8);font-size:13px;cursor:pointer;width:100%;text-align:left;transition:all .15s;font-family:'DM Sans',sans-serif}
.wp2-btn:hover{background:rgba(43,125,122,.15);border-color:rgba(43,125,122,.4);color:white}
.wp2-btn .wp2-ico{font-size:16px;width:22px;text-align:center;flex-shrink:0}
.wp2-btn .wp2-lbl{display:flex;flex-direction:column}
.wp2-btn .wp2-lbl span{font-size:10px;color:rgba(255,255,255,.35);font-weight:400;margin-top:1px}
.wp2-divider{height:1px;background:rgba(255,255,255,.07);margin:8px 0}
.wp2-sec-title{font-size:9px;font-weight:700;color:rgba(255,255,255,.3);text-transform:uppercase;letter-spacing:.1em;padding:8px 2px 5px}
.wp2-color-row{display:flex;align-items:center;gap:8px;padding:8px 10px;background:rgba(255,255,255,.04);border-radius:8px;border:1px solid rgba(255,255,255,.07)}
.wp2-color-row label{font-size:11px;color:rgba(255,255,255,.5);flex:1}
.wp2-color-row input[type=color]{width:28px;height:28px;border:none;border-radius:5px;cursor:pointer;padding:0}
.wp2-select{width:100%;background:#1c1814;color:rgba(255,255,255,.8);border:1px solid rgba(255,255,255,.12);padding:8px 10px;border-radius:8px;font-size:12px;cursor:pointer;font-family:'DM Sans',sans-serif}
.wp2-select:focus{outline:none;border-color:#2b7d7a}
.wp2-info{background:rgba(184,149,88,.08);border:1px solid rgba(184,149,88,.2);border-radius:8px;padding:8px 12px;font-size:11px;color:rgba(184,149,88,.8);line-height:1.5}
#wixPanel2,#wixIconBar{font-size:revert!important}
#wixPanel2 *,#wixIconBar *{font-size:revert!important}
</style>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  WIX SIDE BAR ‚Äî script completamente reescrito y testado
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var _wixCurrentPanel = null;

// ‚îÄ‚îÄ Helpers UI ‚îÄ‚îÄ
function wixToast(msg) {
  var t = document.getElementById('wixToastEl');
  if (!t) {
    t = document.createElement('div');
    t.id = 'wixToastEl';
    t.style.cssText = 'position:fixed;bottom:24px;right:24px;z-index:999999;background:#1c1814;color:white;border:1px solid rgba(184,149,88,.5);padding:11px 18px;border-radius:10px;font-size:13px;font-family:"DM Sans",sans-serif;box-shadow:0 4px 24px rgba(0,0,0,.6);pointer-events:none;opacity:0;transition:opacity .2s;max-width:320px;line-height:1.5';
    document.body.appendChild(t);
  }
  t.textContent = msg;
  t.style.opacity = '1';
  clearTimeout(t._to);
  t._to = setTimeout(function () { t.style.opacity = '0'; }, 2800);
}

function wixNeedSel(action) {
  if (!window._edSel) {
    wixToast('‚ö†Ô∏è Activa ¬´Modo selecci√≥n¬ª (üéØ) y haz clic en un elemento para seleccionarlo primero');
    return false;
  }
  return true;
}

function wixNeedText(action) {
  if (!window._edOn) {
    wixToast('‚ö†Ô∏è Activa primero ¬´Editar texto¬ª (‚úçÔ∏è), luego selecciona el texto a formatear');
    return false;
  }
  return true;
}

// ‚îÄ‚îÄ Page push helpers (Wix-style) ‚îÄ‚îÄ
function wixPushPage(wide) {
  var nav = document.querySelector('nav');
  var page = document.querySelector('.page.active');
  if (wide) {
    if (nav)  { nav.classList.remove('sb-pushed');      nav.classList.add('sb-pushed-wide');  }
    if (page) { page.classList.remove('sb-pushed');     page.classList.add('sb-pushed-wide'); }
  } else {
    if (nav)  { nav.classList.remove('sb-pushed-wide'); nav.classList.add('sb-pushed');       }
    if (page) { page.classList.remove('sb-pushed-wide');page.classList.add('sb-pushed');      }
  }
}
function wixUnpushPage() {
  var nav = document.querySelector('nav');
  var page = document.querySelector('.page.active');
  if (nav)  nav.classList.remove('sb-pushed', 'sb-pushed-wide');
  if (page) page.classList.remove('sb-pushed', 'sb-pushed-wide');
}

// ‚îÄ‚îÄ Open / Close sidebar ‚îÄ‚îÄ
function wixSideBarOpen() {
  document.getElementById('wixSideBar').style.display = 'flex';
  wixPushPage(false);
  // Ocultar botones flotantes y barra inferior ‚Äî todo est√° en el panel lateral
  var eb = document.getElementById('edOpenBtn');
  var nb = document.getElementById('navMgrBtn');
  var ep = document.getElementById('edPanel');
  if (eb) eb.style.display = 'none';
  if (nb) nb.style.display = 'none';
  if (ep) ep.style.display = 'none';
  document.body.style.paddingLeft = '';
  document.body.style.paddingBottom = '';
  wixToast('‚úÖ Editor activo ‚Äî elige una herramienta del panel');
}

function wixSideBarClose() {
  wixPanelClose();
  document.getElementById('wixSideBar').style.display = 'none';
  wixUnpushPage();
  document.querySelectorAll('.wsb-icon').forEach(function (b) { b.classList.remove('active'); });
  _wixCurrentPanel = null;
  // Apagar modos activos
  try { if (window._edOn)      edToggleText();  } catch(e) {}
  try { if (window._edSelMode) edToggleMode();  } catch(e) {}
  try { edClearSel();    } catch(e) {}
  try { edCtxClose();    } catch(e) {}
  try { edFmtBarHide();  } catch(e) {}
  var ep = document.getElementById('edPanel');
  if (ep) ep.style.display = 'none';
  // Mostrar bot√≥n Editor flotante para volver a entrar
  var eb = document.getElementById('edOpenBtn');
  if (eb) eb.style.display = '';
  document.body.style.paddingBottom = '';
}

function wixPanelClose() {
  var p2 = document.getElementById('wixPanel2');
  if (p2) p2.style.display = 'none';
  document.querySelectorAll('.wsb-icon').forEach(function (b) { b.classList.remove('active'); });
  wixPushPage(false);   // volvemos a push estrecho (solo icono bar)
  _wixCurrentPanel = null;
}

function wixPanel(name) {
  // Toggle: si ya est√° abierto, cerrar
  if (_wixCurrentPanel === name) { wixPanelClose(); return; }
  _wixCurrentPanel = name;
  // Highlight icono activo
  document.querySelectorAll('.wsb-icon').forEach(function (b) { b.classList.remove('active'); });
  var ic = document.getElementById('wsb-' + name);
  if (ic) ic.classList.add('active');
  // T√≠tulo
  var titles = {
    texto: '‚úèÔ∏è Textos & Formato', elementos: '‚äû Elementos',
    imagenes: 'üñº Im√°genes', diseno: 'üé® Dise√±o',
    nav: 'üìë Nav & P√°ginas', acciones: '‚ö° Acciones'
  };
  document.getElementById('wixP2Title').textContent = titles[name] || name;
  document.getElementById('wixP2Body').innerHTML = wixBuildPanel(name);
  var p2 = document.getElementById('wixPanel2');
  p2.style.display = 'flex';
  wixPushPage(true);
  // Restore visual state of mode buttons after panel rebuild
  setTimeout(function(){
    ['wp2BtnEditText','wp2BtnEditText2'].forEach(function(id){
      var btn = document.getElementById(id);
      if(!btn) return;
      btn.style.background = window._edOn ? 'rgba(191,70,55,.25)' : '';
      btn.style.borderColor = window._edOn ? 'rgba(191,70,55,.6)' : '';
      var ico = btn.querySelector('.wp2-ico');
      var lbl = btn.querySelector('b');
      if(ico) ico.textContent = window._edOn ? 'üîí' : '‚úçÔ∏è';
      if(lbl) lbl.textContent = window._edOn ? 'Desactivar edici√≥n' : 'Editar texto';
    });
    ['wp2BtnSelMode','wp2BtnSelMode2'].forEach(function(id){
      var btn = document.getElementById(id);
      if(!btn) return;
      btn.style.background = window._edSelMode ? 'rgba(184,149,88,.25)' : '';
      btn.style.borderColor = window._edSelMode ? 'rgba(184,149,88,.6)' : '';
      var ico = btn.querySelector('.wp2-ico');
      var lbl = btn.querySelector('b');
      if(ico) ico.textContent = window._edSelMode ? '‚úÖ' : 'üéØ';
      if(lbl) lbl.textContent = window._edSelMode ? 'Selecci√≥n ACTIVA ‚Äî clic en elemento' : 'Seleccionar elemento';
    });
  }, 20);
}

function wixBuildPanel(n) {
  if (n === 'texto')    return wixPanelTexto();
  if (n === 'elementos') return wixPanelElementos();
  if (n === 'imagenes') return wixPanelImagenes();
  if (n === 'diseno')   return wixPanelDiseno();
  if (n === 'nav')      return wixPanelNav();
  if (n === 'acciones') return wixPanelAcciones();
  return '';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  ACCIONES DIRECTAS ‚Äî wraps seguros para el sidebar
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function wix_toggleText() {
  edToggleText();
  // Update any sidebar buttons that show text-edit mode state
  ['wp2BtnEditText','wp2BtnEditText2'].forEach(function(id){
    var btn = document.getElementById(id);
    if(!btn) return;
    btn.style.background = window._edOn ? 'rgba(191,70,55,.25)' : '';
    btn.style.borderColor = window._edOn ? 'rgba(191,70,55,.6)' : '';
    var ico = btn.querySelector('.wp2-ico');
    var lbl = btn.querySelector('b');
    if(ico) ico.textContent = window._edOn ? 'üîí' : '‚úçÔ∏è';
    if(lbl) lbl.textContent = window._edOn ? 'Desactivar edici√≥n' : 'Editar texto';
  });
}

function wix_toggleSel() {
  edToggleMode();
  // Update any sidebar buttons that show sel mode state (safe - they may not exist)
  ['wp2BtnSelMode','wp2BtnSelMode2'].forEach(function(id){
    var btn = document.getElementById(id);
    if(!btn) return;
    btn.style.background = window._edSelMode ? 'rgba(184,149,88,.25)' : '';
    btn.style.borderColor = window._edSelMode ? 'rgba(184,149,88,.6)' : '';
    var ico = btn.querySelector('.wp2-ico');
    var lbl = btn.querySelector('b');
    if(ico) ico.textContent = window._edSelMode ? '‚úÖ' : 'üéØ';
    if(lbl) lbl.textContent = window._edSelMode ? 'Selecci√≥n ACTIVA ‚Äî clic en elemento' : 'Seleccionar elemento';
  });
}

function wix_applyFont(sel) {
  var v = sel.value; if (!v) return;
  if (!wixNeedSel()) { sel.value = ''; return; }
  edApplyFont(v);
  sel.value = '';
}

function wix_applyFontSize(v) {
  if (!v) return;
  if (!window._edSel && !window._edOn) {
    wixToast('‚ö†Ô∏è Selecciona un elemento (üéØ) o activa edici√≥n de texto (‚úçÔ∏è) primero');
    return;
  }
  edApplyFontSize(v);
}

function wix_applyFontSizeInput() {
  var inp = document.getElementById('wp2FontSzInp');
  if (!inp || !inp.value) { wixToast('‚ö†Ô∏è Introduce un tama√±o en px'); return; }
  wix_applyFontSize(inp.value + 'px');
  inp.value = '';
}

function wix_applyColor(v) {
  if (!v) return;
  if (!window._edSel && !window._edOn) {
    wixToast('‚ö†Ô∏è Selecciona un elemento (üéØ) o activa edici√≥n de texto (‚úçÔ∏è) y selecciona texto');
    return;
  }
  edApplyFontColor(v);
}

function wix_applyBg(v) {
  if (!wixNeedSel()) return;
  edApplyBg(v);
}

function wix_applyDim() {
  if (!wixNeedSel()) return;
  var w = document.getElementById('wp2WidthInp').value;
  var h = document.getElementById('wp2HeightInp').value;
  if (w) window._edSel.style.width = w;
  if (h) window._edSel.style.height = h;
  try { edSnapshot(); } catch(e) {}
  wixToast('‚úÖ Dimensiones aplicadas');
}

function wix_applyPad(v) {
  if (!wixNeedSel()) return;
  window._edSel.style.padding = v;
  try { edSnapshot(); } catch(e) {}
  wixToast('üìê Padding: ' + v);
}

function wix_applyRadius(v) {
  if (!wixNeedSel()) return;
  window._edSel.style.borderRadius = v;
  try { edSnapshot(); } catch(e) {}
  wixToast('üîò Border radius: ' + v);
}

function wix_fmt(cmd) {
  if (!window._edOn && !window._edSel) {
    wixToast('‚ö†Ô∏è Activa ¬´Editar texto¬ª (‚úçÔ∏è) para aplicar formato a texto seleccionado');
    return;
  }
  edFmt(cmd);
}

function wix_fmtBlock(tag) {
  if (!window._edOn) {
    wixToast('‚ö†Ô∏è Activa ¬´Editar texto¬ª (‚úçÔ∏è) primero, luego coloca el cursor en el p√°rrafo');
    return;
  }
  try { edFmtBlock(tag); } catch(e) { wixToast('‚ö†Ô∏è Error: ' + e.message); }
}

function wix_duplicate() {
  if (!wixNeedSel()) return;
  edDuplicate();
}

function wix_moveUp() {
  if (!wixNeedSel()) return;
  edMoveUp();
}

function wix_moveDown() {
  if (!wixNeedSel()) return;
  edMoveDown();
}

function wix_deleteEl() {
  if (!wixNeedSel()) return;
  edDeleteSelected();
}

function wix_addLink() {
  if (!window._edSel && !window._edOn) {
    wixToast('‚ö†Ô∏è Selecciona un elemento (üéØ) o selecciona texto (‚úçÔ∏è) para a√±adir enlace');
    return;
  }
  edAddLink();
}

function wix_changeImage() {
  edImgPanelOpen();
}

function wix_insertImgUrl() {
  var u = document.getElementById('wp2ImgUrl');
  if (!u || !u.value.trim()) { wixToast('‚ö†Ô∏è Introduce una URL de imagen primero'); return; }
  var url = u.value.trim();
  // Pre-fill the image manager URL field
  var target = document.getElementById('edImgUrl');
  if (target) target.value = url;
  edImgPanelOpen();
  // Auto-preview after a short delay
  setTimeout(function(){ try{edImgPreview();}catch(e){} }, 200);
}

function wix_openProps() {
  if (!_edSel) {
    wixToast('‚ö†Ô∏è Activa üéØ Modo selecci√≥n y haz clic en un elemento primero');
    // Still open props panel so user can see it - they can use it once they select
    if(!_edPropsOpen) edToggleProps();
    return;
  }
  edToggleProps();
}

function wix_undo() {
  try { edUndo(); } catch(e) { wixToast('‚ö†Ô∏è Nada que deshacer'); }
}

function wix_redo() {
  try { edRedo(); } catch(e) { wixToast('‚ö†Ô∏è Nada que rehacer'); }
}

function wix_save() {
  edSave();
}

function wix_navOpen() {
  navMgrOpen();
  // Optionally close the secondary panel to give nav manager more room
  // (Nav manager opens as full overlay so no issue)
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  BUILDERS DE PANELES ‚Äî HTML limpio con funciones wix_*
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function wixPanelTexto() {
  var szBtns = ['12','14','16','18','20','24','28','32','40','48','56','64'].map(function(s) {
    return '<button class="wp2-btn" style="padding:5px 6px;font-size:12px;justify-content:center;flex:1;min-width:36px" onclick="wix_applyFontSize(\''+s+'px\')">' + s + '</button>';
  }).join('');
  var colSwatches = ['#1c1814','#ffffff','#b89558','#2b7d7a','#bf4637','#2c5f9e','#7a7168','#f0ece4'].map(function(c) {
    return '<button onclick="wix_applyColor(\''+c+'\')" style="width:30px;height:30px;border-radius:7px;background:'+c+';border:2px solid rgba(255,255,255,.2);cursor:pointer;flex-shrink:0" title="'+c+'"></button>';
  }).join('');

  return [
    /* === INFO === */
    '<div class="wp2-info">',
    '<b>Flujo correcto:</b><br>',
    '1. Clic en ‚úçÔ∏è Editar texto ‚Üí escribe en la web<br>',
    '2. Clic en üéØ Seleccionar ‚Üí clic en un bloque para seleccionarlo',
    '</div>',
    '<div class="wp2-divider"></div>',

    /* === MODOS === */
    '<div class="wp2-sec-title">Modos de edici√≥n</div>',
    '<button class="wp2-btn" id="wp2BtnEditText" onclick="wix_toggleText()">',
    '<span class="wp2-ico">‚úçÔ∏è</span><span class="wp2-lbl"><b>Editar texto</b><span>Activa/desactiva escritura inline</span></span>',
    '</button>',
    '<button class="wp2-btn" id="wp2BtnSelMode" onclick="wix_toggleSel()">',
    '<span class="wp2-ico">üéØ</span><span class="wp2-lbl"><b>Seleccionar elemento</b><span>Luego haz clic en cualquier bloque</span></span>',
    '</button>',
    '<div class="wp2-divider"></div>',

    /* === FORMATO INLINE === */
    '<div class="wp2-sec-title">Formato de texto ‚Äî requiere ‚úçÔ∏è + texto seleccionado</div>',
    '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:5px">',
    '<button class="wp2-btn" style="justify-content:center;padding:10px 4px" onclick="wix_fmt(\'bold\')"><b>B</b></button>',
    '<button class="wp2-btn" style="justify-content:center;padding:10px 4px" onclick="wix_fmt(\'italic\')"><i style="font-style:italic">I</i></button>',
    '<button class="wp2-btn" style="justify-content:center;padding:10px 4px;text-decoration:underline" onclick="wix_fmt(\'underline\')">U</button>',
    '<button class="wp2-btn" style="justify-content:center;padding:10px 4px;text-decoration:line-through" onclick="wix_fmt(\'strikeThrough\')">S</button>',
    '</div>',

    /* === ALINEACI√ìN 4 opciones === */
    '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:5px;margin-top:5px">',
    '<button class="wp2-btn" style="justify-content:center;font-size:11px;padding:8px 3px" onclick="wix_fmt(\'justifyLeft\')">‚¨õ Izq.</button>',
    '<button class="wp2-btn" style="justify-content:center;font-size:11px;padding:8px 3px" onclick="wix_fmt(\'justifyCenter\')">Cent.</button>',
    '<button class="wp2-btn" style="justify-content:center;font-size:11px;padding:8px 3px" onclick="wix_fmt(\'justifyRight\')">Der. ‚¨õ</button>',
    '<button class="wp2-btn" style="justify-content:center;font-size:11px;padding:8px 3px" onclick="wix_fmt(\'justifyFull\')">Justif.</button>',
    '</div>',

    /* === LISTAS === */
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:5px;margin-top:5px">',
    '<button class="wp2-btn" style="justify-content:center;font-size:12px" onclick="wix_fmt(\'insertUnorderedList\')">‚Ä¢ Lista</button>',
    '<button class="wp2-btn" style="justify-content:center;font-size:12px" onclick="wix_fmt(\'insertOrderedList\')">1. Numerada</button>',
    '</div>',
    '<div class="wp2-divider"></div>',

    /* === ENCABEZADOS === */
    '<div class="wp2-sec-title">Encabezados ‚Äî requiere ‚úçÔ∏è, cursor dentro del p√°rrafo</div>',
    '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:5px">',
    '<button class="wp2-btn" style="justify-content:center;font-weight:700;font-size:14px" onclick="wix_fmtBlock(\'h1\')">H1</button>',
    '<button class="wp2-btn" style="justify-content:center;font-weight:700;font-size:13px" onclick="wix_fmtBlock(\'h2\')">H2</button>',
    '<button class="wp2-btn" style="justify-content:center;font-weight:700;font-size:12px" onclick="wix_fmtBlock(\'h3\')">H3</button>',
    '<button class="wp2-btn" style="justify-content:center;font-size:11px" onclick="wix_fmtBlock(\'h4\')">H4</button>',
    '<button class="wp2-btn" style="justify-content:center;font-size:11px" onclick="wix_fmtBlock(\'h5\')">H5</button>',
    '<button class="wp2-btn" style="justify-content:center;font-size:11px" onclick="wix_fmtBlock(\'p\')">¬∂ P</button>',
    '</div>',
    '<div class="wp2-divider"></div>',

    /* === FUENTE BLOQUE === */
    '<div class="wp2-sec-title">Fuente del bloque ‚Äî requiere üéØ seleccionado</div>',
    '<select class="wp2-select" onchange="wix_applyFont(this)" style="margin-bottom:6px">',
    '<option value="">Selecciona fuente‚Ä¶</option>',
    '<option value="\'DM Sans\',sans-serif">DM Sans</option>',
    '<option value="\'Cormorant Garamond\',serif">Cormorant Garamond</option>',
    '<option value="Georgia,serif">Georgia</option>',
    '<option value="Arial,sans-serif">Arial</option>',
    '<option value="\'Helvetica Neue\',sans-serif">Helvetica Neue</option>',
    '<option value="\'Times New Roman\',serif">Times New Roman</option>',
    '<option value="\'Courier New\',monospace">Courier New</option>',
    '</select>',
    '<div class="wp2-divider"></div>',

    /* === TAMA√ëO === */
    '<div class="wp2-sec-title">Tama√±o de texto ‚Äî bloque (üéØ) o inline (‚úçÔ∏è + selecci√≥n)</div>',
    '<div style="display:flex;gap:6px;margin-bottom:8px;align-items:center">',
    '<input type="number" id="wp2FontSzInp" min="8" max="200" placeholder="ej: 18" style="flex:1;background:#1c1814;color:white;border:1px solid rgba(255,255,255,.2);padding:8px 10px;border-radius:8px;font-size:13px;outline:none">',
    '<button class="wp2-btn" style="padding:8px 14px;justify-content:center;flex-shrink:0" onclick="wix_applyFontSizeInput()">‚úì Aplicar</button>',
    '</div>',
    '<div style="display:flex;flex-wrap:wrap;gap:4px">' + szBtns + '</div>',
    '<div class="wp2-divider"></div>',

    /* === COLOR === */
    '<div class="wp2-sec-title">Color de texto</div>',
    '<div class="wp2-color-row" style="margin-bottom:8px"><label>Elige color</label><input type="color" value="#1c1814" onchange="wix_applyColor(this.value)"></div>',
    '<div style="display:flex;flex-wrap:wrap;gap:5px">' + colSwatches + '</div>',
    '<div class="wp2-divider"></div>',

    /* === EXTRAS === */
    '<button class="wp2-btn" onclick="wix_addLink()">',
    '<span class="wp2-ico">üîó</span><span class="wp2-lbl"><b>A√±adir enlace</b><span>Selecciona texto o elemento primero</span></span>',
    '</button>',
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:5px;margin-top:5px">',
    '<button class="wp2-btn" style="justify-content:center;font-size:12px" onclick="wix_fmt(\'superscript\')">X¬≤ Super</button>',
    '<button class="wp2-btn" style="justify-content:center;font-size:12px" onclick="wix_fmt(\'subscript\')">X‚ÇÇ Sub</button>',
    '</div>',
  ].join('
');
}

function wixPanelElementos() {
  return [
    '<div class="wp2-info">Activa üéØ para seleccionar un elemento antes de usar las acciones de abajo.</div>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Insertar bloque en la p√°gina</div>',
    '<button class="wp2-btn" onclick="edInsert(\'texto\')"><span class="wp2-ico">üìù</span><span class="wp2-lbl"><b>Texto</b><span>P√°rrafo editable</span></span></button>',
    '<button class="wp2-btn" onclick="edInsert(\'tarjeta\')"><span class="wp2-ico">üÉè</span><span class="wp2-lbl"><b>Tarjeta</b><span>Bloque con fondo y sombra</span></span></button>',
    '<button class="wp2-btn" onclick="edInsert(\'banner-ancho\')"><span class="wp2-ico">üî≤</span><span class="wp2-lbl"><b>Banner ancho</b><span>Secci√≥n a todo el ancho</span></span></button>',
    '<button class="wp2-btn" onclick="edInsert(\'banner-peque√±o\')"><span class="wp2-ico">‚ñ≠</span><span class="wp2-lbl"><b>Banner peque√±o</b><span>Secci√≥n compacta centrada</span></span></button>',
    '<button class="wp2-btn" onclick="edInsert(\'imagen-banner\')"><span class="wp2-ico">üñº</span><span class="wp2-lbl"><b>Imagen banner</b><span>Imagen a todo el ancho</span></span></button>',
    '<button class="wp2-btn" onclick="edInsert(\'imagen-peque√±a\')"><span class="wp2-ico">üñº</span><span class="wp2-lbl"><b>Imagen + texto</b><span>Imagen con descripci√≥n</span></span></button>',
    '<button class="wp2-btn" onclick="edInsert(\'boton\')"><span class="wp2-ico">üîò</span><span class="wp2-lbl"><b>Bot√≥n</b><span>Llamada a la acci√≥n</span></span></button>',
    '<button class="wp2-btn" onclick="edInsert(\'separador\')"><span class="wp2-ico">‚Äî</span><span class="wp2-lbl"><b>Separador</b><span>L√≠nea divisoria</span></span></button>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Elemento seleccionado (activa üéØ primero)</div>',
    '<button class="wp2-btn" onclick="wix_duplicate()"><span class="wp2-ico">üìã</span><span class="wp2-lbl"><b>Duplicar</b></span></button>',
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:5px">',
    '  <button class="wp2-btn" style="justify-content:center" onclick="wix_moveUp()">‚¨Ü Subir</button>',
    '  <button class="wp2-btn" style="justify-content:center" onclick="wix_moveDown()">‚¨á Bajar</button>',
    '</div>',
    '<button class="wp2-btn" onclick="wix_openProps()" style="border-color:rgba(61,158,155,.35);color:#3d9e9b;margin-top:5px"><span class="wp2-ico">‚öô</span><span class="wp2-lbl"><b>Propiedades CSS</b><span>Padding, sombra, borde, opacidad‚Ä¶</span></span></button>',
    '<button class="wp2-btn" onclick="wix_deleteEl()" style="border-color:rgba(191,70,55,.3);color:#f08080;margin-top:5px"><span class="wp2-ico">üóë</span><span class="wp2-lbl"><b>Eliminar elemento</b></span></button>',
  ].join('\n');
}

function wixPanelImagenes() {
  return [
    '<div class="wp2-info">Selecciona un elemento con imagen (üéØ) o inserta una nueva con el gestor.</div>',
    '<div class="wp2-divider"></div>',
    '<button class="wp2-btn" onclick="wix_changeImage()"><span class="wp2-ico">üñº</span><span class="wp2-lbl"><b>Abrir gestor de imagen</b><span>URL, tama√±o, posici√≥n, ajuste</span></span></button>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">URL directa de imagen</div>',
    '<input id="wp2ImgUrl" type="text" placeholder="https://images.unsplash.com/‚Ä¶" style="width:100%;box-sizing:border-box;background:#1c1814;color:white;border:1px solid rgba(255,255,255,.18);padding:9px 11px;border-radius:8px;font-size:12px;outline:none;margin-bottom:8px">',
    '<button class="wp2-btn" style="justify-content:center" onclick="wix_insertImgUrl()">‚Üí Previsualizar e insertar</button>',
    '<div class="wp2-info" style="margin-top:8px;font-size:11px">Unsplash: https://images.unsplash.com/photo-ID?w=1200&amp;q=80</div>',
  ].join('\n');
}

function wixPanelDiseno() {
  var bgSwatches = ['#ffffff','#f7f5f1','#f0ece4','#1c1814','#252118','#2b7d7a','#b89558','#bf4637','#2c5f9e','transparent'].map(function(c) {
    var bg = c === 'transparent' ? 'repeating-conic-gradient(#ccc 0% 25%,#fff 0% 50%) 0 0/10px 10px' : c;
    return '<button onclick="wix_applyBg(\''+c+'\')" style="width:30px;height:30px;border-radius:7px;background:'+bg+';border:2px solid rgba(255,255,255,.2);cursor:pointer" title="'+c+'"></button>';
  }).join('');
  var padBtns = ['0','8px','12px','16px','20px','24px','32px','40px','48px'].map(function(p) {
    return '<button class="wp2-btn" style="padding:5px 6px;font-size:11px;justify-content:center;flex:1;min-width:44px" onclick="wix_applyPad(\''+p+'\')">' + p + '</button>';
  }).join('');
  var radBtns = ['0','4px','8px','12px','16px','24px','100px','50%'].map(function(r) {
    return '<button class="wp2-btn" style="padding:5px 6px;font-size:11px;justify-content:center;flex:1;min-width:44px" onclick="wix_applyRadius(\''+r+'\')">' + r + '</button>';
  }).join('');

  return [
    '<div class="wp2-info">Activa üéØ y haz clic en un elemento para seleccionarlo antes de aplicar cambios de dise√±o.</div>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Color de fondo</div>',
    '<div class="wp2-color-row" style="margin-bottom:8px">',
    '  <label>Elige color de fondo</label>',
    '  <input type="color" value="#ffffff" onchange="wix_applyBg(this.value)">',
    '</div>',
    '<div style="display:flex;flex-wrap:wrap;gap:5px;margin-bottom:8px">' + bgSwatches + '</div>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Dimensiones</div>',
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px">',
    '  <div>',
    '    <div style="font-size:11px;color:rgba(255,255,255,.4);margin-bottom:4px">Ancho</div>',
    '    <input id="wp2WidthInp" type="text" placeholder="ej: 100% o 400px" style="width:100%;background:#1c1814;color:white;border:1px solid rgba(255,255,255,.18);padding:8px;border-radius:7px;font-size:12px;outline:none;box-sizing:border-box">',
    '  </div>',
    '  <div>',
    '    <div style="font-size:11px;color:rgba(255,255,255,.4);margin-bottom:4px">Alto</div>',
    '    <input id="wp2HeightInp" type="text" placeholder="ej: auto o 300px" style="width:100%;background:#1c1814;color:white;border:1px solid rgba(255,255,255,.18);padding:8px;border-radius:7px;font-size:12px;outline:none;box-sizing:border-box">',
    '  </div>',
    '</div>',
    '<button class="wp2-btn" style="justify-content:center;margin-bottom:8px" onclick="wix_applyDim()">‚úì Aplicar dimensiones</button>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Padding interior</div>',
    '<div style="display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px">' + padBtns + '</div>',
    '<div class="wp2-sec-title">Border radius</div>',
    '<div style="display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px">' + radBtns + '</div>',
    '<div class="wp2-divider"></div>',
    '<button class="wp2-btn" onclick="wix_openProps()" style="border-color:rgba(61,158,155,.35);color:#3d9e9b">',
    '  <span class="wp2-ico">‚öô</span><span class="wp2-lbl"><b>Propiedades CSS avanzadas</b><span>Box-shadow, border, opacity, CSS libre‚Ä¶</span></span>',
    '</button>',
  ].join('\n');
}

function wixPanelNav() {
  return [
    '<div class="wp2-info">Gestiona el men√∫ de navegaci√≥n y las p√°ginas del sitio.</div>',
    '<div class="wp2-divider"></div>',
    '<button class="wp2-btn" onclick="wix_navOpen()"><span class="wp2-ico">üìë</span><span class="wp2-lbl"><b>Abrir Nav & P√°ginas</b><span>Editor completo de men√∫ y p√°ginas</span></span></button>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Ir a p√°gina</div>',
    '<button class="wp2-btn" onclick="goTo(\'public\')"><span class="wp2-ico">üè†</span><span class="wp2-lbl"><b>P√°gina p√∫blica</b><span>Landing page principal</span></span></button>',
    '<button class="wp2-btn" onclick="goTo(\'auth\')"><span class="wp2-ico">üîë</span><span class="wp2-lbl"><b>Login / Registro</b></span></button>',
    '<button class="wp2-btn" onclick="goTo(\'student\')"><span class="wp2-ico">üìö</span><span class="wp2-lbl"><b>Dashboard alumno</b></span></button>',
    '<button class="wp2-btn" onclick="goTo(\'admin\')"><span class="wp2-ico">‚öô</span><span class="wp2-lbl"><b>Panel admin</b></span></button>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Historial de cambios</div>',
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:6px">',
    '  <button class="wp2-btn" style="justify-content:center" onclick="wix_undo()"><span style="font-size:18px">‚Ü©</span> Deshacer</button>',
    '  <button class="wp2-btn" style="justify-content:center" onclick="wix_redo()"><span style="font-size:18px">‚Ü™</span> Rehacer</button>',
    '</div>',
  ].join('\n');
}

function wixPanelAcciones() {
  return [
    '<div class="wp2-info">Acciones globales del editor y sobre el elemento seleccionado.</div>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Modos de edici√≥n</div>',
    '<button class="wp2-btn" id="wp2BtnEditText2" onclick="wix_toggleText()"><span class="wp2-ico">‚úçÔ∏è</span><span class="wp2-lbl"><b>Editar texto</b><span>Activa/desactiva edici√≥n inline</span></span></button>',
    '<button class="wp2-btn" id="wp2BtnSelMode2" onclick="wix_toggleSel()"><span class="wp2-ico">üéØ</span><span class="wp2-lbl"><b>Modo selecci√≥n</b><span>Clic en elemento para seleccionarlo</span></span></button>',
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:6px">',
    '  <button class="wp2-btn" style="justify-content:center" onclick="wix_undo()">‚Ü© Deshacer</button>',
    '  <button class="wp2-btn" style="justify-content:center" onclick="wix_redo()">‚Ü™ Rehacer</button>',
    '</div>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Elemento seleccionado</div>',
    '<button class="wp2-btn" onclick="wix_duplicate()"><span class="wp2-ico">üìã</span><span class="wp2-lbl"><b>Duplicar</b></span></button>',
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:5px">',
    '  <button class="wp2-btn" style="justify-content:center" onclick="wix_moveUp()">‚¨Ü Subir</button>',
    '  <button class="wp2-btn" style="justify-content:center" onclick="wix_moveDown()">‚¨á Bajar</button>',
    '</div>',
    '<button class="wp2-btn" onclick="wix_addLink()" style="margin-top:5px"><span class="wp2-ico">üîó</span><span class="wp2-lbl"><b>A√±adir enlace</b></span></button>',
    '<button class="wp2-btn" onclick="wix_changeImage()" style="margin-top:5px"><span class="wp2-ico">üñº</span><span class="wp2-lbl"><b>Cambiar imagen</b></span></button>',
    '<button class="wp2-btn" onclick="wix_openProps()" style="border-color:rgba(61,158,155,.35);color:#3d9e9b;margin-top:5px"><span class="wp2-ico">‚öô</span><span class="wp2-lbl"><b>Propiedades CSS</b></span></button>',
    '<button class="wp2-btn" onclick="wix_deleteEl()" style="border-color:rgba(191,70,55,.3);color:#f08080;margin-top:5px"><span class="wp2-ico">üóë</span><span class="wp2-lbl"><b>Eliminar elemento</b></span></button>',
    '<div class="wp2-divider"></div>',
    '<div class="wp2-sec-title">Guardar y salir</div>',
    '<button class="wp2-btn" onclick="wix_save()" style="border-color:rgba(184,149,88,.4);color:#b89558">',
    '  <span class="wp2-ico">üíæ</span><span class="wp2-lbl"><b>Guardar y descargar</b><span>Descarga el HTML con todos los cambios</span></span>',
    '</button>',
    '<button class="wp2-btn" onclick="wixSideBarClose()" style="border-color:rgba(240,128,128,.25);color:#f08080;margin-top:5px">',
    '  <span class="wp2-ico">‚úï</span><span class="wp2-lbl"><b>Cerrar editor</b></span>',
    '</button>',
  ].join('\n');
}
</script>

<button onclick="navMgrOpen()" id="navMgrBtn" style="display:none;position: fixed; bottom: 80px; left: 130px; z-index: 99999; background: rgb(28, 24, 20); color: rgb(184, 149, 88); border: 2px solid rgba(184, 149, 88, 0.3); padding: 10px 18px; border-radius: 100px; font-size: 12px; font-weight: 700; cursor: pointer; font-family: &quot;DM Sans&quot;, sans-serif; box-shadow: rgba(0, 0, 0, 0.5) 0px 4px 20px;">üóÇ Nav &amp; P√°ginas</button>

<!-- Panel principal del Gestor -->
<div id="navMgrPanel" style="display: none; position: fixed; inset: 0px; z-index: 100000; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px);">
  <div style="position:absolute;top:0;right:0;bottom:0;width:min(780px,98vw);background:#161210;display:flex;flex-direction:column;box-shadow:-8px 0 40px rgba(0,0,0,.7)">

    <!-- Header del gestor -->
    <div style="display:flex;align-items:center;justify-content:space-between;padding:18px 24px;border-bottom:1px solid rgba(255,255,255,.1);flex-shrink:0;background:#1c1814">
      <div style="display:flex;align-items:center;gap:14px">
        <span style="font-size:20px">üóÇ</span>
        <div>
          <div style="font-size:15px;font-weight:700;color:white;font-family:'DM Sans',sans-serif">Gestor de Navegaci√≥n y P√°ginas</div>
          <div style="font-size:11px;color:rgba(255,255,255,.4);font-family:'DM Sans',sans-serif">Header ¬∑ Categor√≠as ¬∑ P√°ginas Ocultas</div>
        </div>
      </div>
      <button onclick="navMgrClose()" style="background:rgba(255,255,255,.07);border:none;color:rgba(255,255,255,.5);font-size:18px;cursor:pointer;padding:6px 12px;border-radius:8px">‚úï</button>
    </div>

    <!-- Tabs -->
    <div style="display:flex;border-bottom:1px solid rgba(255,255,255,.1);flex-shrink:0;background:#1c1814">
      <button onclick="nmTab('header')" id="nmTab-header" class="nm-tab">üè∑ Header</button>
      <button onclick="nmTab('nav')" id="nmTab-nav" class="nm-tab nm-tab-active">üîó Navegaci√≥n</button>
      <button onclick="nmTab('pages')" id="nmTab-pages" class="nm-tab">üìÑ P√°ginas</button>
      <button onclick="nmTab('cats')" id="nmTab-cats" class="nm-tab">üìÇ Categor√≠as</button>
    </div>

    <!-- Contenido tabs -->
    <div style="flex:1;overflow-y:auto;padding:24px">

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- TAB: HEADER                     -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <div id="nmPane-header" data-protonpass-form="" style="display: none;">
        <h3 class="nm-section-title">üè∑ Editar Header / Logo</h3>

        <div class="nm-card">
          <div class="nm-card-title">Logo / Nombre del sitio</div>
          <div class="nm-form-row">
            <div style="flex:1">
              <div class="nm-label">Nombre principal</div>
              <input id="nmLogoText" type="text" class="nm-inp" placeholder="Frecuencia Integral">
            </div>
            <div style="flex:1">
              <div class="nm-label">Subt√≠tulo / tagline</div>
              <input id="nmLogoSub" type="text" class="nm-inp" placeholder="Academy">
            </div>
          </div>
          <div class="nm-form-row" style="margin-top:10px">
            <div style="flex:1">
              <div class="nm-label">URL del logo (imagen) ‚Äî opcional</div>
              <input id="nmLogoImg" type="text" class="nm-inp" placeholder="https://... (dejar vac√≠o para texto)">
            </div>
            <div style="flex:0 0 80px">
              <div class="nm-label">Alto logo</div>
              <input id="nmLogoH" type="text" value="36px" class="nm-inp">
            </div>
          </div>
          <button onclick="nmApplyLogo()" class="nm-btn-teal" style="margin-top:12px">‚úÖ Aplicar Logo</button>
        </div>

        <div class="nm-card" style="margin-top:16px">
          <div class="nm-card-title">Estilo del header</div>
          <div class="nm-form-row">
            <div style="flex:1">
              <div class="nm-label">Color de fondo</div>
              <div style="display:flex;gap:6px">
                <input type="color" id="nmHdrBg" value="#f7f5f1" style="width:36px;height:36px;border:none;border-radius:6px;cursor:pointer;padding:0">
                <input id="nmHdrBgHex" type="text" value="rgba(247,245,241,.95)" class="nm-inp" style="flex:1">
              </div>
            </div>
            <div style="flex:1">
              <div class="nm-label">Color borde inferior</div>
              <div style="display:flex;gap:6px">
                <input type="color" id="nmHdrBd" value="#e4ddd3" style="width:36px;height:36px;border:none;border-radius:6px;cursor:pointer;padding:0">
                <input id="nmHdrBdHex" type="text" value="#e4ddd3" class="nm-inp" style="flex:1">
              </div>
            </div>
            <div style="flex:0 0 80px">
              <div class="nm-label">Altura</div>
              <input id="nmHdrH" type="text" value="66px" class="nm-inp">
            </div>
          </div>
          <div class="nm-form-row" style="margin-top:10px">
            <div style="flex:1">
              <div class="nm-label">Color links nav</div>
              <div style="display:flex;gap:6px">
                <input type="color" id="nmHdrLinkClr" value="#3d3730" style="width:36px;height:36px;border:none;border-radius:6px;cursor:pointer;padding:0">
                <input type="text" id="nmHdrLinkHex" value="#3d3730" class="nm-inp">
              </div>
            </div>
            <div style="flex:1">
              <div class="nm-label">Color hover links</div>
              <div style="display:flex;gap:6px">
                <input type="color" id="nmHdrHoverClr" value="#2b7d7a" style="width:36px;height:36px;border:none;border-radius:6px;cursor:pointer;padding:0">
                <input type="text" id="nmHdrHoverHex" value="#2b7d7a" class="nm-inp">
              </div>
            </div>
            <div style="flex:1">
              <div class="nm-label">Fijo en scroll</div>
              <select id="nmHdrFixed" class="nm-inp">
                <option value="fixed">S√≠ (fixed)</option>
                <option value="sticky">S√≠ (sticky)</option>
                <option value="relative">No (relativo)</option>
              </select>
            </div>
          </div>
          <button onclick="nmApplyHeaderStyle()" class="nm-btn-teal" style="margin-top:12px">‚úÖ Aplicar Estilo Header</button>
        </div>

        <div class="nm-card" style="margin-top:16px">
          <div class="nm-card-title">Botones del header</div>
          <div id="nmHdrBtnsList" style="display:flex;flex-direction:column;gap:8px"><div style="display:flex;gap:8px;align-items:center;background:rgba(255,255,255,.03);padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.07)"><input type="text" value="Acceso Alumnos" class="nm-inp" style="flex:1" onchange="_nm.hdrBtns[0].text=this.value" placeholder="Texto bot√≥n"><select class="nm-inp" onchange="_nm.hdrBtns[0].type=this.value" style="flex:0 0 110px"><option value="primary">Primario</option><option value="ghost" selected="">Fantasma</option><option value="teal">Verde TCT</option><option value="gold">Dorado</option></select><label style="font-size:11px;color:rgba(255,255,255,.4);cursor:pointer;white-space:nowrap"><input type="checkbox" checked="" onchange="_nm.hdrBtns[0].show=this.checked" style="cursor:pointer"> Visible</label><button onclick="_nm.hdrBtns.splice(0,1);nmRenderHdrBtns()" class="nm-btn-danger" style="flex-shrink:0">‚úï</button></div><div style="display:flex;gap:8px;align-items:center;background:rgba(255,255,255,.03);padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.07)"><input type="text" value="Iniciarse Ahora" class="nm-inp" style="flex:1" onchange="_nm.hdrBtns[1].text=this.value" placeholder="Texto bot√≥n"><select class="nm-inp" onchange="_nm.hdrBtns[1].type=this.value" style="flex:0 0 110px"><option value="primary">Primario</option><option value="ghost" selected="">Fantasma</option><option value="teal">Verde TCT</option><option value="gold">Dorado</option></select><label style="font-size:11px;color:rgba(255,255,255,.4);cursor:pointer;white-space:nowrap"><input type="checkbox" checked="" onchange="_nm.hdrBtns[1].show=this.checked" style="cursor:pointer"> Visible</label><button onclick="_nm.hdrBtns.splice(1,1);nmRenderHdrBtns()" class="nm-btn-danger" style="flex-shrink:0">‚úï</button></div><div style="display:flex;gap:8px;align-items:center;background:rgba(255,255,255,.03);padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.07)"><input type="text" value="Mi Dashboard" class="nm-inp" style="flex:1" onchange="_nm.hdrBtns[2].text=this.value" placeholder="Texto bot√≥n"><select class="nm-inp" onchange="_nm.hdrBtns[2].type=this.value" style="flex:0 0 110px"><option value="primary">Primario</option><option value="ghost" selected="">Fantasma</option><option value="teal">Verde TCT</option><option value="gold">Dorado</option></select><label style="font-size:11px;color:rgba(255,255,255,.4);cursor:pointer;white-space:nowrap"><input type="checkbox" onchange="_nm.hdrBtns[2].show=this.checked" style="cursor:pointer"> Visible</label><button onclick="_nm.hdrBtns.splice(2,1);nmRenderHdrBtns()" class="nm-btn-danger" style="flex-shrink:0">‚úï</button></div><div style="display:flex;gap:8px;align-items:center;background:rgba(255,255,255,.03);padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.07)"><input type="text" value="‚öô Admin" class="nm-inp" style="flex:1" onchange="_nm.hdrBtns[3].text=this.value" placeholder="Texto bot√≥n"><select class="nm-inp" onchange="_nm.hdrBtns[3].type=this.value" style="flex:0 0 110px"><option value="primary">Primario</option><option value="ghost" selected="">Fantasma</option><option value="teal">Verde TCT</option><option value="gold">Dorado</option></select><label style="font-size:11px;color:rgba(255,255,255,.4);cursor:pointer;white-space:nowrap"><input type="checkbox" onchange="_nm.hdrBtns[3].show=this.checked" style="cursor:pointer"> Visible</label><button onclick="_nm.hdrBtns.splice(3,1);nmRenderHdrBtns()" class="nm-btn-danger" style="flex-shrink:0">‚úï</button></div><div style="display:flex;gap:8px;align-items:center;background:rgba(255,255,255,.03);padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.07)"><input type="text" value="Salir" class="nm-inp" style="flex:1" onchange="_nm.hdrBtns[4].text=this.value" placeholder="Texto bot√≥n"><select class="nm-inp" onchange="_nm.hdrBtns[4].type=this.value" style="flex:0 0 110px"><option value="primary">Primario</option><option value="ghost" selected="">Fantasma</option><option value="teal">Verde TCT</option><option value="gold">Dorado</option></select><label style="font-size:11px;color:rgba(255,255,255,.4);cursor:pointer;white-space:nowrap"><input type="checkbox" onchange="_nm.hdrBtns[4].show=this.checked" style="cursor:pointer"> Visible</label><button onclick="_nm.hdrBtns.splice(4,1);nmRenderHdrBtns()" class="nm-btn-danger" style="flex-shrink:0">‚úï</button></div></div>
          <button onclick="nmAddHdrBtn()" class="nm-btn-outline" style="margin-top:10px">+ A√±adir bot√≥n</button>
          <button onclick="nmApplyHdrBtns()" class="nm-btn-teal" style="margin-top:8px">‚úÖ Aplicar Botones</button>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- TAB: NAVEGACI√ìN                 -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <div id="nmPane-nav" style="display: block;">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
          <h3 class="nm-section-title" style="margin:0">üîó Men√∫ de Navegaci√≥n</h3>
          <button onclick="nmAddNavItem(null)" class="nm-btn-teal" style="font-size:11px">+ A√±adir √≠tem nivel 1</button>
        </div>
        <div style="font-size:11px;color:rgba(255,255,255,.35);margin-bottom:14px;background:rgba(255,255,255,.04);padding:10px 14px;border-radius:8px">
          üí° Arrastra para reordenar. Clic en ‚ñ∂ para expandir subcategor√≠as. Hasta 3 niveles de profundidad.
        </div>
        <div id="nmNavTree" style="display:flex;flex-direction:column;gap:4px"><div class="nm-tree-item" id="nmni_nav17716996591321" style="margin-left:0px"><span style="font-size:10px;color:rgba(255,255,255,.2);min-width:14px;text-align:right">‚óè</span><div class="nm-tree-label"><span style="font-weight:600">El Viaje</span><span class="nm-tree-sub"></span></div><div class="nm-tree-actions"><button onclick="nmAddNavItem('nav17716996591321')" class="nm-tree-btn" title="A√±adir sub-√≠tem">+ Sub</button><button onclick="nmEditNavItem('nav17716996591321')" class="nm-tree-btn">‚úèÔ∏è</button><button onclick="nmMoveNavItem('nav17716996591321', -1)" class="nm-tree-btn">‚Üë</button><button onclick="nmMoveNavItem('nav17716996591321', 1)" class="nm-tree-btn">‚Üì</button><button onclick="nmDeleteNavItem('nav17716996591321')" class="nm-btn-danger">‚úï</button></div></div><div class="nm-tree-item" id="nmni_nav17716996591322" style="margin-left:0px"><span style="font-size:10px;color:rgba(255,255,255,.2);min-width:14px;text-align:right">‚óè</span><div class="nm-tree-label"><span style="font-weight:600">Precios</span><span class="nm-tree-sub">#Estructura del Sistema TCT Las Cinco Puertas</span></div><div class="nm-tree-actions"><button onclick="nmAddNavItem('nav17716996591322')" class="nm-tree-btn" title="A√±adir sub-√≠tem">+ Sub</button><button onclick="nmEditNavItem('nav17716996591322')" class="nm-tree-btn">‚úèÔ∏è</button><button onclick="nmMoveNavItem('nav17716996591322', -1)" class="nm-tree-btn">‚Üë</button><button onclick="nmMoveNavItem('nav17716996591322', 1)" class="nm-tree-btn">‚Üì</button><button onclick="nmDeleteNavItem('nav17716996591322')" class="nm-btn-danger">‚úï</button></div></div></div>
        <button onclick="nmApplyNav()" class="nm-btn-teal" style="margin-top:20px;width:100%">‚úÖ Aplicar Navegaci√≥n al Header</button>
      </div>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- TAB: P√ÅGINAS                    -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <div id="nmPane-pages" style="display:none">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
          <h3 class="nm-section-title" style="margin:0">üìÑ P√°ginas del sitio</h3>
          <button onclick="nmNewPage()" class="nm-btn-teal" style="font-size:11px">+ Nueva P√°gina</button>
        </div>
        <div style="font-size:11px;color:rgba(255,255,255,.35);margin-bottom:14px;background:rgba(255,255,255,.04);padding:10px 14px;border-radius:8px">
          üí° <b style="color:rgba(255,255,255,.5)">P√°ginas visibles:</b> aparecen en el men√∫ de navegaci√≥n. <b style="color:rgba(255,255,255,.5)">P√°ginas ocultas (landing):</b> accesibles solo por URL directa, no aparecen en el men√∫.
        </div>
        <div id="nmPagesList" style="display:flex;flex-direction:column;gap:8px"><div style="color:rgba(255,255,255,.3);font-size:12px;padding:30px;text-align:center;border:1px dashed rgba(255,255,255,.08);border-radius:10px">Sin p√°ginas definidas. Crea la primera.</div></div>
      </div>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- TAB: CATEGOR√çAS                 -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <div id="nmPane-cats" style="display:none">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
          <h3 class="nm-section-title" style="margin:0">üìÇ Gesti√≥n de Categor√≠as</h3>
          <button onclick="nmAddCat(null,0)" class="nm-btn-teal" style="font-size:11px">+ Categor√≠a ra√≠z</button>
        </div>
        <div style="font-size:11px;color:rgba(255,255,255,.35);margin-bottom:14px;background:rgba(255,255,255,.04);padding:10px 14px;border-radius:8px">
          üí° Organiza tu contenido en hasta 3 niveles: <b style="color:rgba(255,255,255,.5)">Categor√≠a ‚Üí Subcategor√≠a ‚Üí Sub-subcategor√≠a</b>. Asigna p√°ginas a cualquier nivel.
        </div>
        <div id="nmCatTree" style="display:flex;flex-direction:column;gap:4px"><div style="color:rgba(255,255,255,.3);font-size:12px;padding:30px;text-align:center;border:1px dashed rgba(255,255,255,.08);border-radius:10px">Sin categor√≠as. Crea la primera con el bot√≥n de arriba.</div></div>
        <button onclick="nmApplyCatsToNav()" class="nm-btn-teal" style="margin-top:20px;width:100%">‚úÖ Sincronizar categor√≠as ‚Üí Navegaci√≥n</button>
      </div>

    </div><!-- /content -->

    <!-- Footer del panel -->
    <div style="padding:14px 24px;border-top:1px solid rgba(255,255,255,.08);display:flex;gap:10px;flex-shrink:0;background:#1c1814">
      <button onclick="nmSaveAll()" style="flex:1;background:#b89558;color:white;border:none;padding:10px;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif">üíæ Guardar todo</button>
      <button onclick="nmClose()" style="background:rgba(255,255,255,.07);color:rgba(255,255,255,.5);border:1px solid rgba(255,255,255,.1);padding:10px 18px;border-radius:8px;font-size:13px;cursor:pointer">Cerrar</button>
    </div>
  </div>
</div>

<!-- Modal: Editor de p√°gina -->
<div id="nmPageEditor" style="display:none;position:fixed;inset:0;z-index:100002;background:rgba(0,0,0,.7)">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:min(600px,95vw);background:#1c1814;border-radius:16px;padding:28px;border:1px solid rgba(255,255,255,.12);box-shadow:0 20px 60px rgba(0,0,0,.6)">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:22px">
      <div style="font-size:16px;font-weight:700;color:white;font-family:'DM Sans',sans-serif" id="nmPageEdTitle">Nueva P√°gina</div>
      <button onclick="document.getElementById('nmPageEditor').style.display='none'" style="background:none;border:none;color:rgba(255,255,255,.4);font-size:18px;cursor:pointer">‚úï</button>
    </div>
    <input type="hidden" id="nmPageEdId">
    <div style="display:flex;flex-direction:column;gap:14px">
      <div>
        <div class="nm-label">T√≠tulo de la p√°gina *</div>
        <input id="nmPageEdName" type="text" class="nm-inp" style="width:100%;box-sizing:border-box" placeholder="Ej: Sobre nosotros">
      </div>
      <div class="nm-form-row">
        <div style="flex:1">
          <div class="nm-label">Slug / URL amigable *</div>
          <input id="nmPageEdSlug" type="text" class="nm-inp" style="width:100%;box-sizing:border-box" placeholder="sobre-nosotros">
        </div>
        <div style="flex:0 0 140px">
          <div class="nm-label">Tipo de p√°gina</div>
          <select id="nmPageEdType" class="nm-inp" style="width:100%">
            <option value="visible">üîó Visible en men√∫</option>
            <option value="hidden">üîí Landing oculta</option>
            <option value="redirect">‚Üó Redirecci√≥n</option>
          </select>
        </div>
      </div>
      <div id="nmPageEdRedirectRow" style="display:none">
        <div class="nm-label">URL de destino (redirect)</div>
        <input id="nmPageEdRedirect" type="text" class="nm-inp" style="width:100%;box-sizing:border-box" placeholder="https://...">
      </div>
      <div>
        <div class="nm-label">Descripci√≥n / Notas internas</div>
        <input id="nmPageEdDesc" type="text" class="nm-inp" style="width:100%;box-sizing:border-box" placeholder="Para qu√© sirve esta p√°gina...">
      </div>
      <div class="nm-form-row">
        <div style="flex:1">
          <div class="nm-label">Categor√≠a asignada</div>
          <select id="nmPageEdCat" class="nm-inp" style="width:100%">
            <option value="">‚Äî Sin categor√≠a ‚Äî</option>
          </select>
        </div>
        <div style="flex:1">
          <div class="nm-label">Meta title (SEO)</div>
          <input id="nmPageEdMeta" type="text" class="nm-inp" style="width:100%;box-sizing:border-box" placeholder="T√≠tulo para Google...">
        </div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <label style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:12px;color:rgba(255,255,255,.6);font-family:'DM Sans',sans-serif">
          <input type="checkbox" id="nmPageEdIndex" checked="" style="cursor:pointer">
          Indexable por Google (noindex si desmarcas)
        </label>
        <label style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:12px;color:rgba(255,255,255,.6);font-family:'DM Sans',sans-serif;margin-left:12px">
          <input type="checkbox" id="nmPageEdPwd" style="cursor:pointer">
          Proteger con contrase√±a
        </label>
      </div>
      <div id="nmPageEdPwdRow" style="display:none">
        <div class="nm-label">Contrase√±a de acceso</div>
        <input id="nmPageEdPwdVal" type="text" class="nm-inp" style="width:100%;box-sizing:border-box" placeholder="contrase√±a">
      </div>
    </div>
    <div style="display:flex;gap:10px;margin-top:22px">
      <button onclick="nmSavePage()" class="nm-btn-teal" style="flex:1">üíæ Guardar P√°gina</button>
      <button onclick="nmOpenInEditor()" class="nm-btn-outline" style="flex:1">‚úèÔ∏è Abrir en Editor</button>
      <button onclick="document.getElementById('nmPageEditor').style.display='none'" style="background:rgba(255,255,255,.06);color:rgba(255,255,255,.4);border:1px solid rgba(255,255,255,.1);padding:10px 16px;border-radius:8px;font-size:12px;cursor:pointer">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal: Editor de √≠tem de nav -->
<div id="nmNavItemEditor" style="display: none; position: fixed; inset: 0px; z-index: 100003; background: rgba(0, 0, 0, 0.7);">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:min(520px,95vw);background:#1c1814;border-radius:16px;padding:28px;border:1px solid rgba(255,255,255,.12);box-shadow:0 20px 60px rgba(0,0,0,.6)">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
      <div style="font-size:15px;font-weight:700;color:white;font-family:'DM Sans',sans-serif">Editar √≠tem de navegaci√≥n</div>
      <button onclick="document.getElementById('nmNavItemEditor').style.display='none'" style="background:none;border:none;color:rgba(255,255,255,.4);font-size:18px;cursor:pointer">‚úï</button>
    </div>
    <input type="hidden" id="nmNavEdId" value="nav17716996591322">
    <div style="display:flex;flex-direction:column;gap:12px">
      <div class="nm-form-row">
        <div style="flex:1">
          <div class="nm-label">Etiqueta del men√∫</div>
          <input id="nmNavEdLabel" type="text" class="nm-inp" style="width:100%;box-sizing:border-box" placeholder="Inicio">
        </div>
        <div style="flex:0 0 36px;padding-top:22px">
          <input id="nmNavEdEmoji" type="text" class="nm-inp" style="width:100%;text-align:center" placeholder="üè†">
        </div>
      </div>
      <div>
        <div class="nm-label">Enlace / Acci√≥n</div>
        <select id="nmNavEdLinkType" class="nm-inp" style="width:100%;margin-bottom:6px" onchange="nmNavEdLinkTypeChange()">
          <option value="anchor">‚öì Ancla en la p√°gina (#id)</option>
          <option value="page">üìÑ P√°gina del sitio</option>
          <option value="url">üåê URL externa</option>
          <option value="nolink">‚Äî Solo etiqueta (sin enlace)</option>
        </select>
        <input id="nmNavEdAnchor" type="text" class="nm-inp" style="width: 100%; box-sizing: border-box;" placeholder="#puertas">
        <select id="nmNavEdPage" class="nm-inp" style="width: 100%; display: none;"><option value="">‚Äî Selecciona p√°gina ‚Äî</option></select>
        <input id="nmNavEdUrl" type="text" class="nm-inp" style="display:none;width:100%;box-sizing:border-box" placeholder="https://...">
      </div>
      <div class="nm-form-row">
        <div style="flex:1">
          <div class="nm-label">Color texto (opcional)</div>
          <div style="display:flex;gap:6px">
            <input type="color" id="nmNavEdClr" value="#3d3730" style="width:32px;height:32px;border:none;border-radius:5px;cursor:pointer;padding:0">
            <input type="text" id="nmNavEdClrHex" class="nm-inp" style="flex:1" placeholder="inherit">
          </div>
        </div>
        <div style="flex:1">
          <div class="nm-label">Estilo especial</div>
          <select id="nmNavEdStyle" class="nm-inp" style="width:100%">
            <option value="normal">Normal</option>
            <option value="bold">Negrita</option>
            <option value="btn-teal">Bot√≥n verde</option>
            <option value="btn-gold">Bot√≥n dorado</option>
            <option value="btn-outline">Bot√≥n outline</option>
            <option value="badge-new">Badge "Nuevo"</option>
            <option value="divider-before">Separador antes</option>
          </select>
        </div>
      </div>
      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;font-size:12px;color:rgba(255,255,255,.6);font-family:'DM Sans',sans-serif">
        <input type="checkbox" id="nmNavEdNewTab" style="cursor:pointer">
        Abrir en nueva pesta√±a
      </label>
    </div>
    <div style="display:flex;gap:8px;margin-top:20px">
      <button onclick="nmSaveNavItem()" class="nm-btn-teal" style="flex:1">üíæ Guardar</button>
      <button onclick="document.getElementById('nmNavItemEditor').style.display='none'" style="background:rgba(255,255,255,.06);color:rgba(255,255,255,.4);border:1px solid rgba(255,255,255,.1);padding:10px 16px;border-radius:8px;font-size:12px;cursor:pointer">Cancelar</button>
    </div>
  </div>
</div>

<style>
/* ‚îÄ‚îÄ Nav Manager styles ‚îÄ‚îÄ */
.nm-tab{background:none;border:none;color:rgba(255,255,255,.45);padding:12px 18px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;border-bottom:2px solid transparent;transition:all .15s}
.nm-tab:hover{color:rgba(255,255,255,.7)}
.nm-tab-active{color:#3d9e9b!important;border-bottom-color:#3d9e9b!important}
.nm-section-title{font-size:14px;font-weight:700;color:white;font-family:'DM Sans',sans-serif;margin-bottom:14px}
.nm-card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.09);border-radius:12px;padding:18px}
.nm-card-title{font-size:12px;font-weight:700;color:rgba(255,255,255,.6);text-transform:uppercase;letter-spacing:.07em;margin-bottom:12px}
.nm-label{font-size:10px;color:rgba(255,255,255,.35);text-transform:uppercase;letter-spacing:.06em;margin-bottom:4px;font-family:'DM Sans',sans-serif}
.nm-inp{background:#252118;color:white;border:1px solid rgba(255,255,255,.14);padding:8px 10px;border-radius:7px;font-size:12px;font-family:'DM Sans',sans-serif;outline:none}
.nm-inp:focus{border-color:#3d9e9b}
.nm-form-row{display:flex;gap:10px;align-items:flex-start}
.nm-btn-teal{background:#2b7d7a;color:white;border:none;padding:9px 18px;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;transition:background .15s}
.nm-btn-teal:hover{background:#3d9e9b}
.nm-btn-gold{background:#b89558;color:white;border:none;padding:9px 18px;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif}
.nm-btn-outline{background:rgba(255,255,255,.06);color:rgba(255,255,255,.7);border:1px solid rgba(255,255,255,.15);padding:9px 18px;border-radius:8px;font-size:12px;cursor:pointer;font-family:'DM Sans',sans-serif}
.nm-btn-outline:hover{background:rgba(255,255,255,.1)}
.nm-btn-danger{background:rgba(191,70,55,.15);color:#f08080;border:1px solid rgba(191,70,55,.2);padding:6px 12px;border-radius:6px;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif}
.nm-btn-danger:hover{background:rgba(191,70,55,.3)}

/* Nav tree items */
.nm-tree-item{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:9px;padding:10px 14px;display:flex;align-items:center;gap:8px;transition:border-color .15s}
.nm-tree-item:hover{border-color:rgba(255,255,255,.18)}
.nm-tree-item.nm-l2{margin-left:24px;background:rgba(255,255,255,.03);border-style:dashed}
.nm-tree-item.nm-l3{margin-left:48px;background:rgba(255,255,255,.02);border-style:dashed;border-color:rgba(255,255,255,.06)}
.nm-tree-label{flex:1;font-size:13px;color:white;font-family:'DM Sans',sans-serif}
.nm-tree-sub{font-size:10px;color:rgba(255,255,255,.3);display:block}
.nm-tree-actions{display:flex;gap:4px}
.nm-tree-btn{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);color:rgba(255,255,255,.5);padding:4px 8px;border-radius:5px;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap}
.nm-tree-btn:hover{background:rgba(255,255,255,.12);color:white}
.nm-expand-btn{background:none;border:none;color:rgba(255,255,255,.35);font-size:11px;cursor:pointer;padding:2px 5px;border-radius:4px;flex-shrink:0}
.nm-expand-btn:hover{color:white}

/* Page list items */
.nm-page-item{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:9px;padding:12px 16px;display:flex;align-items:center;gap:10px}
.nm-page-item:hover{border-color:rgba(255,255,255,.16)}
.nm-page-badge{font-size:9px;font-weight:700;padding:3px 8px;border-radius:4px;text-transform:uppercase;letter-spacing:.05em;white-space:nowrap;flex-shrink:0}
.nm-page-badge.visible{background:rgba(43,125,122,.2);color:#3d9e9b}
.nm-page-badge.hidden{background:rgba(184,149,88,.15);color:#b89558}
.nm-page-badge.redirect{background:rgba(44,95,158,.2);color:#7ab3f0}

/* Cat tree */
.nm-cat-item{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:9px;padding:10px 14px;display:flex;align-items:center;gap:8px}
.nm-cat-item.nm-c2{margin-left:20px;background:rgba(255,255,255,.03);border-color:rgba(255,255,255,.06)}
.nm-cat-item.nm-c3{margin-left:40px;background:rgba(255,255,255,.02);border-color:rgba(255,255,255,.05);border-style:dashed}
</style>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAV & PAGE MANAGER ‚Äî Gestor de Navegaci√≥n y P√°ginas
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚îÄ‚îÄ Estado del gestor ‚îÄ‚îÄ
var _nm = {
  nav: [],        // √°rbol de navegaci√≥n
  pages: [],      // p√°ginas del sitio
  cats: [],       // categor√≠as
  hdrBtns: [],    // botones del header
  activeTab: 'header'
};

// ‚îÄ‚îÄ Inicializaci√≥n ‚îÄ‚îÄ
function nmInit() {
  // Leer nav actual del DOM
  var links = document.querySelectorAll('nav .nav-links a');
  if(_nm.nav.length === 0) {
    links.forEach(function(a,i){
      _nm.nav.push({id:'nav'+Date.now()+i, label:a.textContent.trim(), linkType:'anchor', anchor:'', color:'', style:'normal', emoji:'', newTab:false, children:[]});
    });
    // Defaults si no hab√≠a nada
    if(_nm.nav.length === 0) {
      _nm.nav = [
        {id:'nav1',label:'Las Puertas',linkType:'anchor',anchor:'#puertas',color:'',style:'normal',emoji:'',newTab:false,children:[]},
        {id:'nav2',label:'El Viaje',linkType:'anchor',anchor:'#pilares',color:'',style:'normal',emoji:'',newTab:false,children:[]},
        {id:'nav3',label:'Precios',linkType:'anchor',anchor:'#joyas',color:'',style:'normal',emoji:'',newTab:false,children:[]}
      ];
    }
  }
  // Leer logo actual
  var logoEl = document.querySelector('nav .nav-logo');
  if(logoEl) {
    var spanEl = logoEl.querySelector('span');
    document.getElementById('nmLogoText').value = logoEl.childNodes[0] ? logoEl.childNodes[0].textContent.trim() : 'Frecuencia Integral';
    document.getElementById('nmLogoSub').value = spanEl ? spanEl.textContent.trim() : 'Academy';
  }
  // Leer botones header
  if(_nm.hdrBtns.length === 0) {
    document.querySelectorAll('nav .nav-btns button, nav .nav-btns a').forEach(function(b,i){
      _nm.hdrBtns.push({id:'hb'+i, text:b.textContent.trim(), type:'ghost', show:b.style.display!=='none'});
    });
  }
  nmRenderAll();
}

function navMgrOpen() {
  document.getElementById('navMgrPanel').style.display='block';
  nmInit();
}
function navMgrClose(){document.getElementById('navMgrPanel').style.display='none';}
function nmClose(){navMgrClose();}

// ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ
function nmTab(t) {
  _nm.activeTab = t;
  ['header','nav','pages','cats'].forEach(function(tab){
    document.getElementById('nmPane-'+tab).style.display = tab===t ? 'block' : 'none';
    var btn = document.getElementById('nmTab-'+tab);
    btn.className = 'nm-tab' + (tab===t ? ' nm-tab-active' : '');
  });
  if(t==='nav') nmRenderNavTree();
  if(t==='pages') nmRenderPagesList();
  if(t==='cats') nmRenderCatTree();
  if(t==='header') nmRenderHdrBtns();
}

function nmRenderAll(){
  nmRenderNavTree();
  nmRenderPagesList();
  nmRenderCatTree();
  nmRenderHdrBtns();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚îÄ‚îÄ HEADER / LOGO                         ‚îÄ‚îÄ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function nmApplyLogo() {
  var txt = document.getElementById('nmLogoText').value || 'Frecuencia Integral';
  var sub = document.getElementById('nmLogoSub').value;
  var img = document.getElementById('nmLogoImg').value;
  var h = document.getElementById('nmLogoH').value || '36px';
  var logoEl = document.querySelector('nav .nav-logo');
  if(!logoEl) return;
  if(img) {
    logoEl.innerHTML = '<img src="'+img+'" style="height:'+h+';max-width:200px;object-fit:contain;vertical-align:middle" alt="'+txt+'">';
  } else {
    logoEl.innerHTML = txt + (sub ? '<span>'+sub+'</span>' : '');
  }
  edSnapshot && edSnapshot();
  nmToast('‚úÖ Logo actualizado');
}

function nmApplyHeaderStyle() {
  var navEl = document.querySelector('nav');
  if(!navEl) return;
  var bg = document.getElementById('nmHdrBgHex').value || document.getElementById('nmHdrBg').value;
  var bd = document.getElementById('nmHdrBdHex').value || document.getElementById('nmHdrBd').value;
  var h = document.getElementById('nmHdrH').value || '66px';
  var pos = document.getElementById('nmHdrFixed').value;
  navEl.style.background = bg;
  navEl.style.borderBottomColor = bd;
  navEl.style.height = h;
  navEl.style.position = pos;
  // Apply link color via stylesheet injection
  var lc = document.getElementById('nmHdrLinkHex').value || document.getElementById('nmHdrLinkClr').value;
  var hc = document.getElementById('nmHdrHoverHex').value || document.getElementById('nmHdrHoverClr').value;
  var styleEl = document.getElementById('nmDynStyle') || (function(){
    var s=document.createElement('style');s.id='nmDynStyle';document.head.appendChild(s);return s;
  })();
  styleEl.textContent = '.nav-links a{color:'+lc+'!important}.nav-links a:hover{color:'+hc+'!important}';
  edSnapshot && edSnapshot();
  nmToast('‚úÖ Estilo header aplicado');
}

function nmRenderHdrBtns() {
  var c = document.getElementById('nmHdrBtnsList');
  if(!c) return;
  if(_nm.hdrBtns.length === 0) {
    c.innerHTML = '<div style="color:rgba(255,255,255,.3);font-size:12px;padding:10px 0">No hay botones definidos. A√±ade uno.</div>';
    return;
  }
  c.innerHTML = _nm.hdrBtns.map(function(b,i){
    return '<div style="display:flex;gap:8px;align-items:center;background:rgba(255,255,255,.03);padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.07)">'
      +'<input type="text" value="'+b.text+'" class="nm-inp" style="flex:1" onchange="_nm.hdrBtns['+i+'].text=this.value" placeholder="Texto bot√≥n">'
      +'<select class="nm-inp" onchange="_nm.hdrBtns['+i+'].type=this.value" style="flex:0 0 110px">'
      +'<option value="primary"'+(b.type==='primary'?' selected':'')+'>Primario</option>'
      +'<option value="ghost"'+(b.type==='ghost'?' selected':'')+'>Fantasma</option>'
      +'<option value="teal"'+(b.type==='teal'?' selected':'')+'>Verde TCT</option>'
      +'<option value="gold"'+(b.type==='gold'?' selected':'')+'>Dorado</option>'
      +'</select>'
      +'<label style="font-size:11px;color:rgba(255,255,255,.4);cursor:pointer;white-space:nowrap"><input type="checkbox"'+(b.show?' checked':'')+' onchange="_nm.hdrBtns['+i+'].show=this.checked" style="cursor:pointer"> Visible</label>'
      +'<button onclick="_nm.hdrBtns.splice('+i+',1);nmRenderHdrBtns()" class="nm-btn-danger" style="flex-shrink:0">‚úï</button>'
      +'</div>';
  }).join('');
}
function nmAddHdrBtn() {
  _nm.hdrBtns.push({id:'hb'+Date.now(),text:'Nuevo Bot√≥n',type:'ghost',show:true});
  nmRenderHdrBtns();
}
function nmApplyHdrBtns() {
  var btns = document.querySelector('nav .nav-btns');
  if(!btns) return;
  // Keep existing functional buttons (login/dash/admin etc) ‚Äî only update visible text/style for custom ones
  nmToast('‚úÖ Botones actualizados (para botones funcionales usa el Editor de textos)');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚îÄ‚îÄ NAVEGACI√ìN (√°rbol de 3 niveles)       ‚îÄ‚îÄ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function nmGenId(){return 'ni'+Date.now()+Math.random().toString(36).slice(2,6);}

function nmRenderNavTree() {
  var c = document.getElementById('nmNavTree');
  if(!c) return;
  if(_nm.nav.length === 0) {
    c.innerHTML = '<div style="color:rgba(255,255,255,.3);font-size:12px;padding:20px;text-align:center">Sin √≠tems. A√±ade el primero ‚Üí</div>';
    return;
  }
  var html = '';
  _nm.nav.forEach(function(item, i){
    html += nmRenderNavItem(item, i, 0, '');
  });
  c.innerHTML = html;
}

function nmRenderNavItem(item, idx, level, parentPath) {
  var cls = level===0?'nm-tree-item':(level===1?'nm-tree-item nm-l2':'nm-tree-item nm-l3');
  var indent = level * 24;
  var linkInfo = item.linkType==='anchor'?item.anchor : item.linkType==='url'?'‚Üó '+item.url : item.linkType==='page'?'üìÑ pg':'-';
  var hasChildren = item.children && item.children.length > 0;
  var levelLabel = ['', '‚Ü≥ Nivel 2', '‚Ü≥‚Ü≥ Nivel 3'][level];
  var path = parentPath ? parentPath+'.children['+idx+']' : '['+idx+']';
  var canAddChild = level < 2;
  var html = '<div class="'+cls+'" id="nmni_'+item.id+'" style="margin-left:'+indent+'px">'
    +'<span style="font-size:10px;color:rgba(255,255,255,.2);min-width:14px;text-align:right">'+['‚óè','‚óã','‚ó¶'][level]+'</span>'
    +'<div class="nm-tree-label">'
    +(item.emoji?'<span style="margin-right:5px">'+item.emoji+'</span>':'')
    +'<span style="font-weight:600">'+(item.label||'Sin nombre')+'</span>'
    +'<span class="nm-tree-sub">'+linkInfo+(levelLabel?' ¬∑ <span style="color:rgba(61,158,155,.6)">'+levelLabel+'</span>':'')+'</span>'
    +'</div>'
    +'<div class="nm-tree-actions">'
    +(canAddChild?'<button onclick="nmAddNavItem(\''+item.id+'\')" class="nm-tree-btn" title="A√±adir sub-√≠tem">+ Sub</button>':'')
    +'<button onclick="nmEditNavItem(\''+item.id+'\')" class="nm-tree-btn">‚úèÔ∏è</button>'
    +'<button onclick="nmMoveNavItem(\''+item.id+'\', -1)" class="nm-tree-btn">‚Üë</button>'
    +'<button onclick="nmMoveNavItem(\''+item.id+'\', 1)" class="nm-tree-btn">‚Üì</button>'
    +'<button onclick="nmDeleteNavItem(\''+item.id+'\')" class="nm-btn-danger">‚úï</button>'
    +'</div></div>';
  // Render children
  if(hasChildren) {
    item.children.forEach(function(child, ci){
      html += nmRenderNavItem(child, ci, level+1, path);
    });
  }
  return html;
}

// Buscar √≠tem en √°rbol por id
function nmFindNavItem(id, arr, parent) {
  if(!arr) return null;
  for(var i=0;i<arr.length;i++){
    if(arr[i].id===id) return {item:arr[i],arr:arr,idx:i,parent:parent};
    var found = nmFindNavItem(id, arr[i].children, arr[i]);
    if(found) return found;
  }
  return null;
}

function nmAddNavItem(parentId) {
  var newItem = {id:nmGenId(),label:'Nuevo √≠tem',linkType:'anchor',anchor:'',color:'',style:'normal',emoji:'',newTab:false,children:[]};
  if(!parentId) {
    _nm.nav.push(newItem);
  } else {
    var found = nmFindNavItem(parentId, _nm.nav, null);
    if(found && found.item.children) {
      // Check max depth
      var depth = nmGetDepth(found.item);
      if(depth >= 2) { nmToast('‚ö†Ô∏è M√°ximo 3 niveles de profundidad'); return; }
      found.item.children.push(newItem);
    }
  }
  // Open editor for new item
  _editingNavId = newItem.id;
  nmOpenNavEditor(newItem);
}

function nmGetDepth(item) {
  if(!item.children||item.children.length===0) return 0;
  return 1 + Math.max.apply(null, item.children.map(nmGetDepth));
}

function nmEditNavItem(id) {
  var found = nmFindNavItem(id, _nm.nav, null);
  if(found) { _editingNavId = id; nmOpenNavEditor(found.item); }
}

function nmDeleteNavItem(id) {
  if(!confirm('¬øEliminar este √≠tem y sus sub√≠tems?')) return;
  function removeFrom(arr) {
    for(var i=arr.length-1;i>=0;i--){
      if(arr[i].id===id){arr.splice(i,1);return true;}
      if(arr[i].children && removeFrom(arr[i].children)) return true;
    }
    return false;
  }
  removeFrom(_nm.nav);
  nmRenderNavTree();
}

function nmMoveNavItem(id, dir) {
  function moveIn(arr) {
    for(var i=0;i<arr.length;i++){
      if(arr[i].id===id){
        var ni=i+dir;
        if(ni>=0&&ni<arr.length){var tmp=arr[i];arr[i]=arr[ni];arr[ni]=tmp;return true;}
        return false;
      }
      if(arr[i].children && moveIn(arr[i].children)) return true;
    }
    return false;
  }
  moveIn(_nm.nav); nmRenderNavTree();
}

var _editingNavId = null;
function nmOpenNavEditor(item) {
  document.getElementById('nmNavEdId').value = item.id;
  document.getElementById('nmNavEdLabel').value = item.label||'';
  document.getElementById('nmNavEdEmoji').value = item.emoji||'';
  document.getElementById('nmNavEdLinkType').value = item.linkType||'anchor';
  document.getElementById('nmNavEdAnchor').value = item.anchor||'';
  document.getElementById('nmNavEdUrl').value = item.url||'';
  document.getElementById('nmNavEdClr').value = item.color||'#3d3730';
  document.getElementById('nmNavEdClrHex').value = item.color||'';
  document.getElementById('nmNavEdStyle').value = item.style||'normal';
  document.getElementById('nmNavEdNewTab').checked = !!item.newTab;
  // Populate page select
  var pgSel = document.getElementById('nmNavEdPage');
  pgSel.innerHTML = '<option value="">‚Äî Selecciona p√°gina ‚Äî</option>';
  _nm.pages.forEach(function(p){ pgSel.innerHTML += '<option value="'+p.slug+'"'+(item.pageSlug===p.slug?' selected':'')+'>'+p.name+'</option>'; });
  pgSel.value = item.pageSlug||'';
  nmNavEdLinkTypeChange();
  document.getElementById('nmNavItemEditor').style.display='block';
}

function nmNavEdLinkTypeChange() {
  var t = document.getElementById('nmNavEdLinkType').value;
  document.getElementById('nmNavEdAnchor').style.display = t==='anchor'?'':'none';
  document.getElementById('nmNavEdPage').style.display = t==='page'?'':'none';
  document.getElementById('nmNavEdUrl').style.display = t==='url'?'':'none';
}

function nmSaveNavItem() {
  var id = document.getElementById('nmNavEdId').value;
  var found = nmFindNavItem(id, _nm.nav, null);
  if(!found) return;
  var t = document.getElementById('nmNavEdLinkType').value;
  found.item.label = document.getElementById('nmNavEdLabel').value;
  found.item.emoji = document.getElementById('nmNavEdEmoji').value;
  found.item.linkType = t;
  found.item.anchor = document.getElementById('nmNavEdAnchor').value;
  found.item.url = document.getElementById('nmNavEdUrl').value;
  found.item.pageSlug = document.getElementById('nmNavEdPage').value;
  found.item.color = document.getElementById('nmNavEdClrHex').value;
  found.item.style = document.getElementById('nmNavEdStyle').value;
  found.item.newTab = document.getElementById('nmNavEdNewTab').checked;
  document.getElementById('nmNavItemEditor').style.display='none';
  nmRenderNavTree();
  nmToast('‚úÖ √çtem guardado');
}

function nmApplyNav() {
  var linksEl = document.querySelector('nav .nav-links');
  if(!linksEl) return;
  linksEl.innerHTML = '';
  function renderItems(items, container, level) {
    items.forEach(function(item){
      var a = document.createElement('a');
      a.textContent = (item.emoji?item.emoji+' ':'') + item.label;
      if(item.color) a.style.color = item.color;
      if(item.style==='bold') a.style.fontWeight='700';
      if(item.style==='btn-teal') a.style.cssText='background:#2b7d7a;color:white;padding:6px 14px;border-radius:7px;font-weight:600';
      if(item.style==='btn-gold') a.style.cssText='background:#b89558;color:white;padding:6px 14px;border-radius:7px;font-weight:600';
      if(item.style==='btn-outline') a.style.cssText='border:1.5px solid #2b7d7a;color:#2b7d7a;padding:5px 13px;border-radius:7px;font-weight:600';
      if(item.newTab) { a.target='_blank'; }
      // Build onclick
      if(item.linkType==='anchor'&&item.anchor) {
        var anc=item.anchor.replace('#','');
        a.setAttribute('onclick','(function(){var el=document.getElementById("'+anc+'");if(el)el.scrollIntoView({behavior:"smooth"});else window.location.hash="'+item.anchor+'";})()');
        a.href='#';
        a.addEventListener('click',function(e){e.preventDefault();});
      } else if(item.linkType==='url'&&item.url) {
        a.href=item.url;
      } else if(item.linkType==='page'&&item.pageSlug) {
        a.href=item.pageSlug;
      } else if(item.linkType==='nolink') {
        a.style.cursor='default'; a.style.pointerEvents='none';
      }
      // Badge
      if(item.style==='badge-new') {
        var badge=document.createElement('span');
        badge.textContent='New'; badge.style.cssText='background:#bf4637;color:white;font-size:8px;font-weight:700;padding:1px 5px;border-radius:3px;margin-left:4px;vertical-align:middle;letter-spacing:.04em';
        a.appendChild(badge);
      }
      // Divider
      if(item.style==='divider-before') {
        var div=document.createElement('span'); div.style.cssText='width:1px;height:14px;background:rgba(0,0,0,.15);margin:0 4px;display:inline-block;vertical-align:middle';
        container.appendChild(div);
      }
      container.appendChild(a);
      // Sub-items: create a dropdown wrapper if children
      if(item.children&&item.children.length>0&&level===0) {
        a.style.cursor='pointer';
        var wrapper=document.createElement('div');
        wrapper.style.cssText='position:relative;display:inline-block';
        container.removeChild(a); wrapper.appendChild(a);
        var drop=document.createElement('div');
        drop.style.cssText='display:none;position:absolute;top:100%;left:0;background:rgba(247,245,241,.98);border:1px solid #e4ddd3;border-radius:10px;padding:6px;min-width:180px;box-shadow:0 8px 24px rgba(0,0,0,.12);z-index:1000;margin-top:4px';
        renderItems(item.children, drop, level+1);
        wrapper.appendChild(drop);
        a.addEventListener('mouseenter',function(){drop.style.display='block';});
        wrapper.addEventListener('mouseleave',function(){drop.style.display='none';});
        container.appendChild(wrapper);
      }
    });
  }
  renderItems(_nm.nav, linksEl, 0);
  edSnapshot && edSnapshot();
  nmToast('‚úÖ Navegaci√≥n aplicada al header');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚îÄ‚îÄ P√ÅGINAS                               ‚îÄ‚îÄ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function nmRenderPagesList() {
  var c = document.getElementById('nmPagesList');
  if(!c) return;
  if(_nm.pages.length === 0) {
    c.innerHTML = '<div style="color:rgba(255,255,255,.3);font-size:12px;padding:30px;text-align:center;border:1px dashed rgba(255,255,255,.08);border-radius:10px">Sin p√°ginas definidas. Crea la primera.</div>';
    return;
  }
  c.innerHTML = _nm.pages.map(function(p,i){
    var badge = p.type==='hidden'?'<span class="nm-page-badge hidden">üîí Landing oculta</span>':
               p.type==='redirect'?'<span class="nm-page-badge redirect">‚Üó Redirect</span>':
               '<span class="nm-page-badge visible">üîó Visible</span>';
    return '<div class="nm-page-item">'
      +badge
      +'<div style="flex:1">'
      +'<div style="font-size:13px;font-weight:600;color:white;font-family:\'DM Sans\',sans-serif">'+p.name+'</div>'
      +'<div style="font-size:10px;color:rgba(255,255,255,.35);font-family:monospace">/'+p.slug+(p.desc?' ¬∑ '+p.desc:'')+'</div>'
      +'</div>'
      +'<div style="display:flex;gap:5px">'
      +'<button onclick="nmEditPage('+i+')" class="nm-tree-btn">‚úèÔ∏è Editar</button>'
      +'<button onclick="nmOpenInEditorById(\''+p.id+'\')" class="nm-tree-btn" title="Editar contenido">üñä Contenido</button>'
      +'<button onclick="_nm.pages.splice('+i+',1);nmRenderPagesList()" class="nm-btn-danger">‚úï</button>'
      +'</div></div>';
  }).join('');
  // Update page selector in nav editor
  var sel = document.getElementById('nmNavEdPage');
  if(sel) {
    sel.innerHTML = '<option value="">‚Äî Selecciona p√°gina ‚Äî</option>';
    _nm.pages.forEach(function(p){ sel.innerHTML += '<option value="'+p.slug+'">'+p.name+'</option>'; });
  }
  // Update cat page selector
  nmUpdatePageSelectors();
}

function nmNewPage() {
  document.getElementById('nmPageEdId').value = nmGenId();
  document.getElementById('nmPageEdTitle').textContent = 'Nueva P√°gina';
  document.getElementById('nmPageEdName').value = '';
  document.getElementById('nmPageEdSlug').value = '';
  document.getElementById('nmPageEdDesc').value = '';
  document.getElementById('nmPageEdType').value = 'hidden';
  document.getElementById('nmPageEdMeta').value = '';
  document.getElementById('nmPageEdIndex').checked = true;
  document.getElementById('nmPageEdPwd').checked = false;
  document.getElementById('nmPageEdPwdRow').style.display = 'none';
  document.getElementById('nmPageEdRedirectRow').style.display = 'none';
  nmUpdateCatSelector();
  document.getElementById('nmPageEditor').style.display = 'block';
  // Auto-gen slug
  document.getElementById('nmPageEdName').addEventListener('input', function(){
    var slug = this.value.toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9-]/g,'').replace(/-+/g,'-');
    document.getElementById('nmPageEdSlug').value = slug;
    document.getElementById('nmPageEdMeta').value = this.value;
  }, {once:false});
  document.getElementById('nmPageEdPwd').onchange = function(){
    document.getElementById('nmPageEdPwdRow').style.display = this.checked ? '' : 'none';
  };
  document.getElementById('nmPageEdType').onchange = function(){
    document.getElementById('nmPageEdRedirectRow').style.display = this.value==='redirect' ? '' : 'none';
  };
}

function nmEditPage(i) {
  var p = _nm.pages[i];
  document.getElementById('nmPageEdId').value = p.id;
  document.getElementById('nmPageEdTitle').textContent = 'Editar: ' + p.name;
  document.getElementById('nmPageEdName').value = p.name||'';
  document.getElementById('nmPageEdSlug').value = p.slug||'';
  document.getElementById('nmPageEdDesc').value = p.desc||'';
  document.getElementById('nmPageEdType').value = p.type||'hidden';
  document.getElementById('nmPageEdMeta').value = p.meta||'';
  document.getElementById('nmPageEdIndex').checked = p.index!==false;
  document.getElementById('nmPageEdPwd').checked = !!p.pwd;
  document.getElementById('nmPageEdPwdRow').style.display = p.pwd ? '' : 'none';
  document.getElementById('nmPageEdPwdVal').value = p.pwd||'';
  document.getElementById('nmPageEdRedirect').value = p.redirect||'';
  document.getElementById('nmPageEdRedirectRow').style.display = p.type==='redirect' ? '' : 'none';
  nmUpdateCatSelector(p.catId);
  document.getElementById('nmPageEditor').style.display = 'block';
}

function nmSavePage() {
  var id = document.getElementById('nmPageEdId').value;
  var name = document.getElementById('nmPageEdName').value.trim();
  var slug = document.getElementById('nmPageEdSlug').value.trim();
  if(!name){alert('El t√≠tulo es obligatorio');return;}
  if(!slug){alert('El slug es obligatorio');return;}
  var page = {
    id: id, name: name, slug: slug,
    type: document.getElementById('nmPageEdType').value,
    desc: document.getElementById('nmPageEdDesc').value,
    meta: document.getElementById('nmPageEdMeta').value,
    index: document.getElementById('nmPageEdIndex').checked,
    pwd: document.getElementById('nmPageEdPwd').checked ? document.getElementById('nmPageEdPwdVal').value : '',
    redirect: document.getElementById('nmPageEdRedirect').value,
    catId: document.getElementById('nmPageEdCat').value,
    html: ''
  };
  var existing = _nm.pages.findIndex(function(p){return p.id===id;});
  if(existing>-1) _nm.pages[existing] = Object.assign(_nm.pages[existing], page);
  else _nm.pages.push(page);
  document.getElementById('nmPageEditor').style.display = 'none';
  nmRenderPagesList();
  nmToast('‚úÖ P√°gina "'+name+'" guardada');
  if(page.type==='visible') {
    if(confirm('¬øA√±adir "'+name+'" al men√∫ de navegaci√≥n?')) {
      _nm.nav.push({id:nmGenId(),label:name,linkType:'page',pageSlug:slug,color:'',style:'normal',emoji:'',newTab:false,children:[]});
      nmRenderNavTree();
    }
  }
}

function nmOpenInEditor() {
  var name = document.getElementById('nmPageEdName').value;
  nmSavePage();
  nmToast('üí° Usa el Editor WYSIWYG para editar el contenido de la p√°gina en el canvas.');
  navMgrClose();
}

function nmOpenInEditorById(id) {
  nmToast('üí° Selecciona el contenido de la p√°gina en el canvas y edita con el Editor WYSIWYG.');
  navMgrClose();
}

function nmUpdateCatSelector(selId) {
  var sel = document.getElementById('nmPageEdCat');
  if(!sel) return;
  sel.innerHTML = '<option value="">‚Äî Sin categor√≠a ‚Äî</option>';
  function addOpts(cats, prefix) {
    cats.forEach(function(c){
      sel.innerHTML += '<option value="'+c.id+'"'+(selId===c.id?' selected':'')+'>'+prefix+c.name+'</option>';
      if(c.children) addOpts(c.children, prefix+'‚Ü≥ ');
    });
  }
  addOpts(_nm.cats, '');
}

function nmUpdatePageSelectors() {
  nmUpdateCatSelector();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚îÄ‚îÄ CATEGOR√çAS (√°rbol 3 niveles)          ‚îÄ‚îÄ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function nmRenderCatTree() {
  var c = document.getElementById('nmCatTree');
  if(!c) return;
  if(_nm.cats.length === 0) {
    c.innerHTML = '<div style="color:rgba(255,255,255,.3);font-size:12px;padding:30px;text-align:center;border:1px dashed rgba(255,255,255,.08);border-radius:10px">Sin categor√≠as. Crea la primera con el bot√≥n de arriba.</div>';
    return;
  }
  c.innerHTML = renderCatItems(_nm.cats, 0);
}

function renderCatItems(items, level) {
  if(level > 2) return '';
  var html = '';
  items.forEach(function(c,i){
    var cls = ['nm-cat-item','nm-cat-item nm-c2','nm-cat-item nm-c3'][level];
    var icon = ['üìÅ','üìÇ','üìå'][level];
    var pages = _nm.pages.filter(function(p){return p.catId===c.id;});
    var canAddChild = level < 2;
    html += '<div class="'+cls+'">'
      +'<span>'+icon+'</span>'
      +'<div style="flex:1">'
      +'<div style="font-size:13px;font-weight:600;color:white;font-family:\'DM Sans\',sans-serif">'+c.name+'</div>'
      +'<div style="font-size:10px;color:rgba(255,255,255,.35)">'+['Categor√≠a','Subcategor√≠a','Sub-sub'][level]
      +(pages.length?' ¬∑ '+pages.length+' p√°gina'+(pages.length>1?'s':''):'')
      +(c.slug?' ¬∑ /'+c.slug:'')+'</div>'
      +'</div>'
      +'<div style="display:flex;gap:4px">'
      +(canAddChild?'<button onclick="nmAddCat(\''+c.id+'\','+level+')" class="nm-tree-btn">+ Sub</button>':'')
      +'<button onclick="nmEditCat(\''+c.id+'\')" class="nm-tree-btn">‚úèÔ∏è</button>'
      +'<button onclick="nmMoveCat(\''+c.id+'\', -1)" class="nm-tree-btn">‚Üë</button>'
      +'<button onclick="nmMoveCat(\''+c.id+'\', 1)" class="nm-tree-btn">‚Üì</button>'
      +'<button onclick="nmDeleteCat(\''+c.id+'\')" class="nm-btn-danger">‚úï</button>'
      +'</div></div>';
    if(c.children&&c.children.length>0) {
      html += renderCatItems(c.children, level+1);
    }
  });
  return html;
}

function nmFindCat(id, arr) {
  for(var i=0;i<arr.length;i++){
    if(arr[i].id===id) return {cat:arr[i],arr:arr,idx:i};
    if(arr[i].children){var f=nmFindCat(id,arr[i].children);if(f)return f;}
  }
  return null;
}

function nmAddCat(parentId, parentLevel) {
  var name = prompt('Nombre de la '+(parentLevel===0?'sub':'sub-sub')+'categor√≠a:');
  if(!name) return;
  var slug = name.toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9-]/g,'');
  var newCat = {id:'cat'+Date.now(),name:name,slug:slug,desc:'',children:[]};
  if(!parentId) {
    _nm.cats.push(newCat);
  } else {
    var found = nmFindCat(parentId, _nm.cats);
    if(found && found.cat.children) found.cat.children.push(newCat);
  }
  nmRenderCatTree(); nmUpdateCatSelector();
  nmToast('‚úÖ Categor√≠a "'+name+'" creada');
}

function nmEditCat(id) {
  var found = nmFindCat(id, _nm.cats);
  if(!found) return;
  var c = found.cat;
  var name = prompt('Nombre:', c.name);
  if(name===null) return;
  var slug = prompt('Slug (URL):', c.slug||name.toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9-]/g,''));
  if(slug===null) return;
  c.name = name; c.slug = slug;
  nmRenderCatTree(); nmUpdateCatSelector();
  nmToast('‚úÖ Categor√≠a actualizada');
}

function nmDeleteCat(id) {
  if(!confirm('¬øEliminar esta categor√≠a y sus subcategor√≠as?')) return;
  function removeFrom(arr) {
    for(var i=arr.length-1;i>=0;i--){
      if(arr[i].id===id){arr.splice(i,1);return true;}
      if(arr[i].children&&removeFrom(arr[i].children))return true;
    }
    return false;
  }
  removeFrom(_nm.cats);
  // Remove cat assignment from pages
  _nm.pages.forEach(function(p){if(p.catId===id)p.catId='';});
  nmRenderCatTree(); nmUpdateCatSelector(); nmRenderPagesList();
}

function nmMoveCat(id, dir) {
  function moveIn(arr){
    for(var i=0;i<arr.length;i++){
      if(arr[i].id===id){var ni=i+dir;if(ni>=0&&ni<arr.length){var t=arr[i];arr[i]=arr[ni];arr[ni]=t;return true;}return false;}
      if(arr[i].children&&moveIn(arr[i].children))return true;
    }
    return false;
  }
  moveIn(_nm.cats); nmRenderCatTree();
}

function nmApplyCatsToNav() {
  // Build nav items from categories (top-level only ‚Üí with children as sub-items)
  if(!confirm('Esto a√±adir√° las categor√≠as al men√∫ de navegaci√≥n. ¬øContinuar?')) return;
  _nm.cats.forEach(function(cat){
    var existing = _nm.nav.find(function(n){return n.label===cat.name;});
    if(!existing){
      var navItem = {id:nmGenId(),label:cat.name,linkType:'anchor',anchor:'#'+cat.slug,color:'',style:'normal',emoji:'üìÇ',newTab:false,children:[]};
      if(cat.children){
        cat.children.forEach(function(sub){
          var pages = _nm.pages.filter(function(p){return p.catId===sub.id;});
          navItem.children.push({id:nmGenId(),label:sub.name,linkType:'anchor',anchor:'#'+sub.slug,color:'',style:'normal',emoji:'',newTab:false,children:sub.children?sub.children.map(function(ss){
            return {id:nmGenId(),label:ss.name,linkType:'anchor',anchor:'#'+ss.slug,color:'',style:'normal',emoji:'',newTab:false,children:[]};
          }):[]});
        });
      }
      _nm.nav.push(navItem);
    }
  });
  nmRenderNavTree();
  nmTab('nav');
  nmToast('‚úÖ Categor√≠as sincronizadas en navegaci√≥n');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚îÄ‚îÄ GUARDAR TODO                          ‚îÄ‚îÄ
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function nmSaveAll() {
  nmApplyNav();
  // Save state to a data attribute on body for persistence
  try {
    document.body.setAttribute('data-nm-state', JSON.stringify({nav:_nm.nav,pages:_nm.pages,cats:_nm.cats}));
  } catch(e){}
  edSnapshot && edSnapshot();
  nmToast('‚úÖ Todo guardado. Usa "üíæ Guardar" en el Editor para exportar el HTML.');
}

// ‚îÄ‚îÄ Restaurar estado guardado ‚îÄ‚îÄ
(function(){
  var saved = document.body.getAttribute('data-nm-state');
  if(saved){
    try{
      var d=JSON.parse(saved);
      if(d.nav)_nm.nav=d.nav;
      if(d.pages)_nm.pages=d.pages;
      if(d.cats)_nm.cats=d.cats;
    }catch(e){}
  }
})();

// ‚îÄ‚îÄ Toast notifications ‚îÄ‚îÄ
function nmToast(msg){
  var t=document.createElement('div');
  t.style.cssText='position:fixed;bottom:140px;left:50%;transform:translateX(-50%);background:#1c1814;color:#3d9e9b;border:1px solid rgba(61,158,155,.3);padding:10px 22px;border-radius:20px;font-size:12px;font-weight:600;z-index:200000;font-family:\'DM Sans\',sans-serif;box-shadow:0 4px 16px rgba(0,0,0,.4);pointer-events:none';
  t.textContent=msg; document.body.appendChild(t);
  setTimeout(function(){if(t.parentNode)t.parentNode.removeChild(t);},3000);
}
</script>
<deepl-input-controller translate="no"></deepl-input-controller>



<!-- ‚îÄ‚îÄ Panel Gestor de Im√°genes ‚îÄ‚îÄ -->
<div id="edImgPanel" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;z-index:99999;background:rgba(0,0,0,.75);backdrop-filter:blur(4px);align-items:center;justify-content:center;font-family:'DM Sans',sans-serif">
  <div style="background:#1c1814;border-radius:16px;padding:28px;width:520px;max-width:95vw;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.7);border:1px solid rgba(255,255,255,.1)">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
      <div id="edImgModeLabel" style="font-size:14px;font-weight:700;color:white">üñºÔ∏è Gestionar Imagen</div>
      <button onclick="edImgPanelClose()" style="background:none;border:none;color:rgba(255,255,255,.4);font-size:20px;cursor:pointer">‚úï</button>
    </div>
    <div style="margin-bottom:14px">
      <label style="font-size:11px;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.08em;display:block;margin-bottom:6px">URL de la imagen</label>
      <div style="display:flex;gap:6px">
        <input id="edImgUrl" type="text" placeholder="https://images.unsplash.com/..." style="flex:1;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:8px 12px;border-radius:8px;font-size:12px;outline:none" oninput="clearTimeout(window._imgPrevT);window._imgPrevT=setTimeout(edImgPreview,600)">
        <button onclick="edImgPreview()" style="background:#2b7d7a;color:white;border:none;padding:8px 14px;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;white-space:nowrap">üëÅ Preview</button>
      </div>
      <div style="font-size:10px;color:rgba(255,255,255,.25);margin-top:4px">Unsplash: https://images.unsplash.com/photo-ID?w=1200&amp;q=80</div>
    </div>
    <div id="edImgPreviewBox" style="background:#111;border-radius:10px;min-height:80px;margin-bottom:14px;display:flex;align-items:center;justify-content:center;overflow:hidden;border:1px solid rgba(255,255,255,.06)">
      <span style="color:rgba(255,255,255,.2);font-size:12px">Preview aparecer√° aqu√≠</span>
    </div>
    <div style="margin-bottom:14px">
      <label style="font-size:11px;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.08em;display:block;margin-bottom:6px">Texto alternativo (Alt)</label>
      <input id="edImgAlt" type="text" placeholder="Descripci√≥n de la imagen" style="width:100%;box-sizing:border-box;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:8px 12px;border-radius:8px;font-size:12px;outline:none">
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px">
      <div>
        <label style="font-size:11px;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.08em;display:block;margin-bottom:6px">Ancho</label>
        <select id="edImgW" style="width:100%;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:7px 10px;border-radius:8px;font-size:12px;cursor:pointer" onchange="edImgPreview()">
          <option value="100%">100% (completo)</option>
          <option value="75%">75%</option>
          <option value="50%">50%</option>
          <option value="33%">33%</option>
          <option value="400px">400px</option>
          <option value="600px">600px</option>
          <option value="800px">800px</option>
          <option value="1200px">1200px</option>
        </select>
      </div>
      <div>
        <label style="font-size:11px;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.08em;display:block;margin-bottom:6px">Alto</label>
        <select id="edImgH" style="width:100%;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:7px 10px;border-radius:8px;font-size:12px;cursor:pointer" onchange="edImgPreview()">
          <option value="300px">300px</option>
          <option value="200px">200px</option>
          <option value="400px">400px</option>
          <option value="500px">500px</option>
          <option value="600px">600px</option>
          <option value="100vh">100vh (pantalla completa)</option>
          <option value="60vh">60vh</option>
          <option value="auto">auto (proporcional)</option>
        </select>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px">
      <div>
        <label style="font-size:11px;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.08em;display:block;margin-bottom:6px">Ajuste (object-fit)</label>
        <select id="edImgFit" style="width:100%;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:7px 10px;border-radius:8px;font-size:12px;cursor:pointer" onchange="edImgPreview()">
          <option value="cover">cover (recortar y llenar)</option>
          <option value="contain">contain (ver todo)</option>
          <option value="fill">fill (estirar)</option>
          <option value="none">none (tama√±o original)</option>
        </select>
      </div>
      <div>
        <label style="font-size:11px;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.08em;display:block;margin-bottom:6px">Bordes redondeados</label>
        <select id="edImgRadius" style="width:100%;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:7px 10px;border-radius:8px;font-size:12px;cursor:pointer" onchange="edImgPreview()">
          <option value="0">Sin redondeo</option>
          <option value="8px">8px ‚Äî sutil</option>
          <option value="12px" selected>12px ‚Äî suave</option>
          <option value="20px">20px ‚Äî redondeado</option>
          <option value="50%">50% ‚Äî circular</option>
        </select>
      </div>
    </div>
    <div style="margin-bottom:20px">
      <label style="font-size:11px;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.08em;display:block;margin-bottom:8px">¬øD√≥nde poner la imagen?</label>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px">
        <label style="display:flex;align-items:center;gap:8px;background:#252118;border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:8px 12px;cursor:pointer;font-size:12px;color:rgba(255,255,255,.7)"><input type="radio" name="edImgPos" value="after" checked style="accent-color:#3d9e9b"> Despu√©s del seleccionado</label>
        <label style="display:flex;align-items:center;gap:8px;background:#252118;border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:8px 12px;cursor:pointer;font-size:12px;color:rgba(255,255,255,.7)"><input type="radio" name="edImgPos" value="before" style="accent-color:#3d9e9b"> Antes del seleccionado</label>
        <label style="display:flex;align-items:center;gap:8px;background:#252118;border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:8px 12px;cursor:pointer;font-size:12px;color:rgba(255,255,255,.7)"><input type="radio" name="edImgPos" value="inside" style="accent-color:#3d9e9b"> Dentro del seleccionado</label>
        <label style="display:flex;align-items:center;gap:8px;background:#252118;border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:8px 12px;cursor:pointer;font-size:12px;color:rgba(255,255,255,.7)"><input type="radio" name="edImgPos" value="replace" style="accent-color:#3d9e9b"> Reemplazar imagen existente</label>
      </div>
    </div>
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button onclick="edImgPanelClose()" style="background:rgba(255,255,255,.06);color:rgba(255,255,255,.5);border:none;padding:10px 20px;border-radius:8px;font-size:13px;cursor:pointer">Cancelar</button>
      <button onclick="edImgApply()" style="background:#2b7d7a;color:white;border:none;padding:10px 24px;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">‚úì Aplicar imagen</button>
    </div>
  </div>
</div>

<protonpass-root-fbbb data-protonpass-role="root" data-protonpass-theme="os"></protonpass-root-fbbb></body></html>
