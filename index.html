<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frecuencia Integral Academy</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:#f7f5f1;color:#1c1814}

/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(247,245,241,.95);backdrop-filter:blur(12px);border-bottom:1px solid #e4ddd3;height:66px;display:flex;align-items:center;padding:0 32px;justify-content:space-between}
.nav-logo{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:400}
.nav-logo span{font-size:11px;display:block;color:#7a7168;letter-spacing:.1em;text-transform:uppercase}
.nav-links{display:flex;gap:28px}
.nav-links a{font-size:13px;color:#3d3730;text-decoration:none;cursor:pointer}
.nav-links a:hover{color:#2b7d7a}
.nav-btns{display:flex;gap:10px;align-items:center}
.btn-ghost{background:none;border:1px solid #d1c8bc;padding:8px 18px;border-radius:8px;font-size:13px;cursor:pointer;color:#3d3730;font-family:'DM Sans',sans-serif}
.btn-ghost:hover{background:#f0ece4}
.btn-primary{background:#2b7d7a;color:white;border:none;padding:9px 20px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif}
.btn-primary:hover{background:#3d9e9b}

/* PAGES */
.page{display:none}
.page.active{display:block}

/* PUBLIC PAGE */
.hero{min-height:100vh;display:flex;align-items:center;justify-content:center;text-align:center;padding:100px 32px 60px;background:linear-gradient(135deg,#f7f5f1 0%,#f0ece4 100%)}
.hero h1{font-family:'Cormorant Garamond',serif;font-size:clamp(42px,6vw,80px);font-weight:300;line-height:1.1;margin-bottom:24px}
.hero h1 em{font-style:italic;color:#2b7d7a}
.hero p{font-size:16px;color:#7a7168;max-width:560px;margin:0 auto 36px;line-height:1.7}
.hero-btns{display:flex;gap:14px;justify-content:center;flex-wrap:wrap}
.btn-hero{padding:14px 32px;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif}
.btn-hero-main{background:#2b7d7a;color:white;border:none}
.btn-hero-main:hover{background:#3d9e9b}
.btn-hero-sec{background:none;border:2px solid #2b7d7a;color:#2b7d7a}
.btn-hero-sec:hover{background:#e8f4f3}

.section{padding:80px 32px;max-width:1100px;margin:0 auto}
.s-tag{font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.15em;margin-bottom:12px}
.s-title{font-family:'Cormorant Garamond',serif;font-size:clamp(32px,4vw,52px);font-weight:300;margin-bottom:16px}
.s-sub{font-size:15px;color:#7a7168;line-height:1.7;max-width:900px}

.puertas-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;margin-top:48px}
.puerta-card{background:white;border-radius:16px;overflow:hidden;border:1px solid #e4ddd3;transition:transform .2s,box-shadow .2s}
.puerta-card:hover{transform:translateY(-4px);box-shadow:0 12px 40px rgba(0,0,0,.08)}
.pc-head{padding:28px 24px 20px;color:white}
.pc-blanca{background:linear-gradient(135deg,#b8ad9e,#8a8078)}
.pc-roja{background:linear-gradient(135deg,#bf4637,#8b2d22)}
.pc-azul{background:linear-gradient(135deg,#2c5f9e,#1a3d6e)}
.pc-arcoiris{background:linear-gradient(135deg,#b8935a,#8a6a35)}
.pc-icon{font-size:28px;margin-bottom:10px}
.pc-name{font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:300;margin-bottom:4px}
.pc-weeks{font-size:11px;opacity:.75}
.pc-body{padding:20px 24px}
.pc-price{font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:4px}
.pc-billing{font-size:12px;color:#7a7168;margin-bottom:16px}
.btn-puerta{width:100%;padding:11px;border-radius:8px;border:none;font-size:13px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;background:#2b7d7a;color:white;transition:background .2s}
.btn-puerta:hover{background:#3d9e9b}

/* AUTH PAGE */
.auth-wrap{min-height:100vh;display:grid;grid-template-columns:1fr 1fr;padding-top:66px}
.auth-left{background:linear-gradient(145deg,#1c1814,#2a241e);padding:60px 48px;display:flex;flex-direction:column;justify-content:center}
.auth-left h2{font-family:'Cormorant Garamond',serif;font-size:42px;font-weight:300;color:white;line-height:1.2;margin-bottom:16px}
.auth-left h2 em{color:#3d9e9b;font-style:italic}
.auth-left p{font-size:14px;color:rgba(255,255,255,.55);line-height:1.7;margin-bottom:32px}
.auth-perks{list-style:none}
.auth-perks li{font-size:13px;color:rgba(255,255,255,.65);padding:6px 0;display:flex;align-items:center;gap:10px}
.auth-perks li::before{content:'‚ú¶';color:#b89558;font-size:9px}
.auth-right{background:#f7f5f1;display:flex;align-items:center;justify-content:center;padding:48px}
.auth-box{width:100%;max-width:400px;background:white;border-radius:20px;padding:40px;border:1px solid #e4ddd3;box-shadow:0 4px 24px rgba(0,0,0,.06)}
.auth-box h3{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:400;margin-bottom:6px}
.auth-box .sub{font-size:13px;color:#7a7168;margin-bottom:28px}
.auth-tabs{display:flex;border-radius:8px;overflow:hidden;border:1.5px solid #e4ddd3;margin-bottom:24px}
.auth-tab{flex:1;padding:10px;background:none;border:none;font-size:13px;font-weight:500;color:#7a7168;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all .2s}
.auth-tab.active{background:#2b7d7a;color:white}
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px}
.form-group input{width:100%;padding:11px 14px;border:1.5px solid #e4ddd3;border-radius:8px;font-size:14px;font-family:'DM Sans',sans-serif;background:#faf8f5;transition:border-color .2s;outline:none}
.form-group input:focus{border-color:#2b7d7a;background:white}
.btn-login{width:100%;padding:13px;background:#2b7d7a;color:white;border:none;border-radius:9px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;transition:background .2s;margin-top:8px}
.btn-login:hover{background:#3d9e9b}
.btn-login:disabled{background:#a89e93;cursor:not-allowed}
.demo-hint{margin-top:14px;padding:12px;background:#f0ece4;border-radius:8px;font-size:12px;color:#7a7168;text-align:center}
.back-link{display:block;text-align:center;margin-top:16px;font-size:12px;color:#7a7168;cursor:pointer;text-decoration:underline}

/* STUDENT AREA */
.student-wrap{display:flex;min-height:100vh;padding-top:66px}
.sidebar{width:260px;background:#1c1814;position:fixed;top:66px;left:0;bottom:0;overflow-y:auto;padding:24px 0}
.sidebar-user{padding:20px 24px;border-bottom:1px solid rgba(255,255,255,.08);margin-bottom:8px}
.sidebar-name{font-size:15px;font-weight:600;color:white;margin-bottom:4px}
.sidebar-email{font-size:11px;color:rgba(255,255,255,.4)}
.sidebar-badge{display:inline-block;margin-top:8px;background:#b89558;color:white;font-size:10px;font-weight:700;padding:3px 10px;border-radius:100px;text-transform:uppercase;letter-spacing:.06em}
.sidebar-nav{padding:8px 12px}
.nav-item{display:flex;align-items:center;gap:12px;padding:11px 14px;border-radius:9px;font-size:13px;color:rgba(255,255,255,.6);cursor:pointer;transition:all .2s;border:none;background:none;width:100%;text-align:left;font-family:'DM Sans',sans-serif}
.nav-item:hover{background:rgba(255,255,255,.07);color:white}
.nav-item.active{background:rgba(43,125,122,.2);color:#3d9e9b}
.nav-item-icon{font-size:16px;width:20px;text-align:center}
.main-content{margin-left:260px;flex:1;padding:36px;min-height:calc(100vh - 66px)}

.dashboard-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:32px}
.stat-card{background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3}
.stat-label{font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:8px}
.stat-value{font-family:'Cormorant Garamond',serif;font-size:36px;font-weight:300;color:#1c1814}
.stat-sub{font-size:12px;color:#a89e93;margin-top:4px}

.weeks-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-top:24px}
.week-card{background:white;border-radius:12px;padding:16px;border:1px solid #e4ddd3;cursor:pointer;transition:all .2s}
.week-card:hover{border-color:#2b7d7a;box-shadow:0 4px 16px rgba(43,125,122,.1)}
.week-card.completed{background:#e8f4f3;border-color:#7fbfbd}
.week-card.in-progress{border-color:#b89558;background:#fdf6ec}
.week-num{font-size:10px;font-weight:700;color:#a89e93;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px}
.week-title{font-size:12px;font-weight:500;color:#1c1814;line-height:1.4}
.week-status{font-size:11px;margin-top:8px}

/* MODAL */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(28,24,20,.7);backdrop-filter:blur(6px);z-index:400;align-items:center;justify-content:center;padding:0}
.modal-overlay.open{display:flex}
.modal{background:white;width:100%;height:100vh;max-width:100%;overflow:hidden;display:flex;flex-direction:column}
.modal-header{padding:20px 40px;border-bottom:1px solid #e4ddd3;display:flex;align-items:center;justify-content:space-between;background:white;flex-shrink:0}
.modal-header-left{display:flex;align-items:center;gap:20px}
.modal-week-badge{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.modal-title{font-family:'Cormorant Garamond',serif;font-size:26px;font-weight:400;line-height:1.2}
.modal-puerta-tag{font-size:11px;color:#7a7168;margin-top:3px;letter-spacing:.04em}
.modal-close{background:#f7f5f1;border:none;width:36px;height:36px;border-radius:50%;font-size:16px;cursor:pointer;color:#7a7168;display:flex;align-items:center;justify-content:center;transition:background .2s;flex-shrink:0}
.modal-close:hover{background:#e4ddd3;color:#1c1814}
.modal-layout{display:flex;flex:1;overflow:hidden}
.modal-sidebar{width:200px;background:#1c1814;flex-shrink:0;padding:24px 0;display:flex;flex-direction:column;gap:4px}
.modal-nav-btn{display:flex;align-items:center;gap:10px;padding:12px 20px;background:none;border:none;font-size:13px;color:rgba(255,255,255,.55);cursor:pointer;font-family:'DM Sans',sans-serif;text-align:left;width:100%;transition:all .2s;border-left:3px solid transparent}
.modal-nav-btn:hover{background:rgba(255,255,255,.07);color:white}
.modal-nav-btn.active{background:rgba(43,125,122,.2);color:#3d9e9b;border-left-color:#3d9e9b}
.modal-nav-icon{font-size:16px;width:20px;text-align:center}
.modal-body{padding:40px 48px;overflow-y:auto;flex:1;background:#f7f5f1}
.modal-tabs{display:none}
.tab-content{display:none}
.tab-content.active{display:block}
.exercise-step{display:flex;gap:14px;padding:16px;background:white;border-radius:12px;margin-bottom:12px;align-items:flex-start;border:1px solid #e4ddd3}
.step-num{min-width:32px;height:32px;background:#2b7d7a;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:white;flex-shrink:0}
.step-text{font-size:14px;line-height:1.75;color:#3d3730;padding-top:4px}
.concept-card{background:white;border-radius:12px;padding:18px 20px;margin-bottom:12px;border-left:4px solid #2b7d7a;border:1px solid #e4ddd3;border-left:4px solid #2b7d7a}
.concept-name{font-weight:600;font-size:14px;margin-bottom:6px;color:#1c1814}
.concept-desc{font-size:13px;color:#7a7168;line-height:1.7}
.material-item{display:flex;align-items:center;gap:12px;padding:12px 14px;background:white;border-radius:10px;margin-bottom:8px;border:1px solid #e4ddd3}
.material-icon{font-size:18px}
.material-name{flex:1;font-size:13px;color:#3d3730}
.btn-sm{font-size:11px;font-weight:600;color:#2b7d7a;background:#e8f4f3;border:none;padding:5px 12px;border-radius:6px;cursor:pointer}
.task-item{display:flex;align-items:center;gap:12px;padding:14px 16px;background:white;border-radius:10px;margin-bottom:8px;cursor:pointer;transition:background .2s;border:1px solid #e4ddd3}
.task-item:hover{background:#e8f4f3;border-color:#7fbfbd}
.task-item.done{background:#e8f4f3;border-color:#7fbfbd}
.task-item.done .task-cb{background:#2b7d7a;border-color:#2b7d7a}
.task-item.done .task-cb::after{content:'‚úì';color:white;font-size:10px;font-weight:700}
.task-cb{width:20px;height:20px;border-radius:5px;border:2px solid #d1c8bc;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .2s}
.task-text{font-size:14px;color:#3d3730;line-height:1.5}
.btn-complete{width:100%;padding:16px;background:#2b7d7a;color:white;border:none;border-radius:12px;font-size:15px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;margin-top:24px;transition:background .2s}
.btn-complete:hover{background:#3d9e9b}
.btn-complete:disabled{background:#d1c8bc;cursor:not-allowed}

/* TOAST */
.toast{position:fixed;bottom:24px;right:24px;z-index:999;background:#1c1814;color:white;padding:12px 20px;border-radius:10px;font-size:13px;opacity:0;transition:opacity .3s;pointer-events:none}
.toast.show{opacity:1}


/* FILTER */
.filter-bar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:24px}
.filter-btn{padding:7px 16px;border-radius:100px;border:1.5px solid #d1c8bc;background:none;font-size:12px;font-weight:600;cursor:pointer;color:#7a7168;font-family:'DM Sans',sans-serif;transition:all .2s}
.filter-btn.active{background:#2b7d7a;border-color:#2b7d7a;color:white}

/* ADMIN PANEL */
.admin-wrap{min-height:100vh;padding-top:66px;background:#f7f5f1}
.admin-header{background:#1c1814;padding:32px 40px;display:flex;align-items:center;justify-content:space-between}
.admin-header h1{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:300;color:white}
.admin-header h1 span{color:#3d9e9b;font-style:italic}
.admin-body{padding:32px 40px;max-width:1300px;margin:0 auto}
.admin-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:32px}
.admin-stat{background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3;text-align:center}
.admin-stat-val{font-family:'Cormorant Garamond',serif;font-size:40px;font-weight:300;color:#1c1814}
.admin-stat-label{font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-top:4px}
.admin-table-wrap{background:white;border-radius:16px;border:1px solid #e4ddd3;overflow:hidden}
.admin-table-header{padding:20px 24px;border-bottom:1px solid #e4ddd3;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px}
.admin-table-title{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:400}
.admin-search{padding:8px 14px;border:1.5px solid #e4ddd3;border-radius:8px;font-size:13px;font-family:'DM Sans',sans-serif;outline:none;width:220px}
.admin-search:focus{border-color:#2b7d7a}
.admin-table{width:100%;border-collapse:collapse}
.admin-table th{font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;padding:12px 16px;text-align:left;background:#faf8f5;border-bottom:1px solid #e4ddd3}
.admin-table td{padding:14px 16px;font-size:13px;color:#3d3730;border-bottom:1px solid #f0ece4;vertical-align:middle}
.admin-table tr:last-child td{border-bottom:none}
.admin-table tr:hover td{background:#faf8f5}
.admin-badge{display:inline-block;padding:3px 10px;border-radius:100px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.06em}
.badge-blanca{background:#f0ede8;color:#8a8078}
.badge-roja{background:#fdecea;color:#bf4637}
.badge-azul{background:#e8eef8;color:#2c5f9e}
.badge-arcoiris{background:#f3edf8;color:#7b4fa6}
.badge-oro{background:#fdf5e6;color:#b89558}
.admin-progress-bar{height:6px;background:#e4ddd3;border-radius:3px;width:100px;overflow:hidden}
.admin-progress-fill{height:100%;background:#2b7d7a;border-radius:3px;transition:width .3s}
.admin-empty{text-align:center;padding:60px;color:#a89e93;font-size:14px}
.btn-admin-nav{background:#b89558;color:white;border:none;padding:9px 18px;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;letter-spacing:.04em}
.btn-admin-nav:hover{background:#c9a86c}
.admin-refresh{background:#e8f4f3;color:#2b7d7a;border:none;padding:8px 16px;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif}
.admin-refresh:hover{background:#d0eae9}

/* PDF FULLSCREEN MODAL */
.pdf-modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:9000;flex-direction:column}
.pdf-modal-overlay.open{display:flex}
.pdf-modal-topbar{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;background:#1c1814;flex-shrink:0}
.pdf-modal-topbar-name{font-size:13px;font-weight:600;color:white;max-width:70%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pdf-modal-topbar-actions{display:flex;gap:10px;align-items:center}
.btn-pdf-fullscreen-dl{background:#2b7d7a;color:white;border:none;padding:8px 16px;border-radius:7px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;text-decoration:none}
.btn-pdf-fullscreen-close{background:rgba(255,255,255,.1);color:white;border:none;padding:8px 14px;border-radius:7px;font-size:13px;cursor:pointer;font-family:'DM Sans',sans-serif}
.pdf-modal-topbar .btn-pdf-fullscreen-close:hover{background:rgba(255,255,255,.2)}
.pdf-modal-frame{flex:1;width:100%;border:none;background:#525659}

/* MATERIALES PDF */
.materiales-puerta{margin-bottom:36px}
.materiales-puerta-title{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:400;margin-bottom:16px;display:flex;align-items:center;gap:10px;padding-bottom:10px;border-bottom:1px solid #e4ddd3}
.pdf-card{background:white;border-radius:14px;border:1px solid #e4ddd3;overflow:hidden;margin-bottom:14px;transition:box-shadow .2s}
.pdf-card:hover{box-shadow:0 4px 20px rgba(0,0,0,.07)}
.pdf-card-header{display:flex;align-items:center;gap:14px;padding:16px 20px;cursor:pointer}
.pdf-icon{width:40px;height:48px;background:linear-gradient(135deg,#e8f4f3,#d0eae9);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.pdf-info{flex:1}
.pdf-name{font-size:14px;font-weight:500;color:#1c1814;margin-bottom:3px}
.pdf-meta{font-size:11px;color:#a89e93}
.pdf-actions{display:flex;gap:8px;align-items:center}
.btn-pdf-view{background:#e8f4f3;color:#2b7d7a;border:none;padding:7px 14px;border-radius:7px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;transition:background .2s}
.btn-pdf-view:hover{background:#d0eae9}
.btn-pdf-dl{background:#f7f5f1;color:#3d3730;border:1px solid #d1c8bc;padding:7px 14px;border-radius:7px;font-size:12px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;text-decoration:none;transition:background .2s}
.btn-pdf-dl:hover{background:#f0ece4}
.pdf-viewer-wrap{display:none;border-top:1px solid #e4ddd3;background:#f7f5f1}
.pdf-viewer-wrap.open{display:block}
.pdf-viewer-wrap iframe{width:100%;height:520px;border:none;display:block}
.pdf-viewer-bar{display:flex;align-items:center;justify-content:space-between;padding:10px 20px;background:#1c1814}
.pdf-viewer-bar span{font-size:12px;color:rgba(255,255,255,.6)}
.btn-pdf-close{background:none;border:none;color:rgba(255,255,255,.6);font-size:18px;cursor:pointer;padding:0 4px}

@media(max-width:768px){
  .auth-wrap{grid-template-columns:1fr}
  .auth-left{display:none}
  .sidebar{display:none}
  .main-content{margin-left:0}
  .nav-links{display:none}
}
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="nav-logo">Frecuencia Integral <span>Academy</span></div>
  <div class="nav-links">
    <a onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})">Las Puertas</a>
    <a onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})">El Viaje</a>
    <a onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})">Precios</a>
  </div>
  <div class="nav-btns">
    <button class="btn-ghost" id="btnLogin" onclick="goTo('auth')">Acceso Alumnos</button>
    <button class="btn-primary" id="btnInscribirse" onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})">Iniciarse Ahora</button>
    <button class="btn-ghost" id="btnDash" style="display:none" onclick="goTo('student')">Mi Dashboard</button>
    <button class="btn-admin-nav" id="btnAdmin" style="display:none" onclick="goTo('admin')">‚öô Admin</button>
    <button class="btn-ghost" id="btnLogout" style="display:none" onclick="doLogout()">Salir</button>
  </div>
</nav>

<!-- PAGE: PUBLIC -->
<div class="page active" id="page-public">

  <!-- HERO -->
  <div class="hero">
    <div>
      <div class="s-tag">Sistema TCT ¬∑ 48 Semanas</div>
      <h1>La Frecuencia que<br><em>Transforma</em> tu Realidad</h1>
      <p>Descubre el Sistema TCT, una integraci√≥n √∫nica de Dzogchen, Cuarto Camino y UCDM con tecnolog√≠a vibracional mediante cuencos tibetanos para transformar el cuerpo, la energ√≠a y la mente..</p>
      <div class="hero-btns">
        <button class="btn-hero btn-hero-main" onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})">Explorar las Puertas ‚Üí</button>
        <button class="btn-hero btn-hero-sec" onclick="goTo('auth')">Acceso Alumnos</button>
      </div>
    </div>
  </div>

  <!-- LAS PUERTAS -->
  <div id="puertas" style="background:white;padding:80px 32px">
    <div class="section" style="padding:0">
      <div class="s-tag">Estructura del Sistema TCT</div>
      <h2 class="s-title">Las Cinco Puertas</h2>
      <p class="s-sub">Un recorrido progresivo de 48 semanas hacia la maestr√≠a del ser.</p>
      <div class="puertas-grid">
        <div class="puerta-card">
          <div class="pc-head pc-blanca">
            <div class="pc-icon">üåø</div>
            <div class="pc-name">Puerta Blanca</div>
            <div class="pc-weeks">Semanas 1‚Äì12 ¬∑ Cimentaci√≥n</div>
          </div>
          <div class="pc-body">
            <div class="pc-price">‚Ç¨95<span style="font-size:14px;color:#7a7168">/mes</span></div>
            <div class="pc-billing">3 meses ¬∑ ‚Ç¨285 total</div>
            <button class="btn-puerta" onclick="handlePurchase('puerta_blanca')">Seleccionar</button>
          </div>
        </div>
        <div class="puerta-card">
          <div class="pc-head pc-roja">
            <div class="pc-icon">üî•</div>
            <div class="pc-name">Puerta Roja</div>
            <div class="pc-weeks">Semanas 13‚Äì24 ¬∑ Purificaci√≥n</div>
          </div>
          <div class="pc-body">
            <div class="pc-price">‚Ç¨95<span style="font-size:14px;color:#7a7168">/mes</span></div>
            <div class="pc-billing">Requiere Puerta Blanca</div>
            <button class="btn-puerta" onclick="handlePurchase('puerta_roja')">Seleccionar</button>
          </div>
        </div>
        <div class="puerta-card">
          <div class="pc-head pc-azul">
            <div class="pc-icon">üîµ</div>
            <div class="pc-name">Puerta Azul</div>
            <div class="pc-weeks">Semanas 25‚Äì36 ¬∑ Maestr√≠a</div>
          </div>
          <div class="pc-body">
            <div class="pc-price">‚Ç¨95<span style="font-size:14px;color:#7a7168">/mes</span></div>
            <div class="pc-billing">Requiere Puerta Roja</div>
            <button class="btn-puerta" onclick="handlePurchase('puerta_azul')">Seleccionar</button>
          </div>
        </div>
        <div class="puerta-card">
          <div class="pc-head" style="background:linear-gradient(135deg,#7b4fa6,#5a3080)">
            <div class="pc-icon">üåà</div>
            <div class="pc-name">Puerta Arcoiris</div>
            <div class="pc-weeks">Transformaci√≥n Avanzada</div>
          </div>
          <div class="pc-body">
            <div class="pc-price">‚Ç¨95<span style="font-size:14px;color:#7a7168">/mes</span></div>
            <div class="pc-billing">Requiere las 3 puertas</div>
            <button class="btn-puerta" onclick="handlePurchase('puerta_arcoiris')">Seleccionar</button>
          </div>
        </div>
        <div class="puerta-card" style="border-color:#b89558">
          <div class="pc-head pc-arcoiris">
            <div class="pc-icon">‚ú®</div>
            <div class="pc-name">Puerta Oro</div>
            <div class="pc-weeks">Todo el programa ¬∑ Pago √∫nico</div>
          </div>
          <div class="pc-body">
            <div class="pc-price">‚Ç¨890</div>
            <div class="pc-billing">Acceso completo 24 meses</div>
            <button class="btn-puerta" style="background:#b89558" onclick="handlePurchase('puerta_oro')">Seleccionar</button>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- EL VIAJE -->
  <div id="viaje" style="padding:80px 32px;background:#f7f5f1">
    <div style="max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr;gap:80px;align-items:start">
      <div style="position:sticky;top:100px">
        <div style="display:inline-block;background:#e8f4f3;color:#2b7d7a;font-size:11px;font-weight:700;letter-spacing:.12em;text-transform:uppercase;padding:6px 14px;border-radius:100px;margin-bottom:20px">El Viaje de Transformaci√≥n</div>
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:clamp(36px,4vw,56px);font-weight:300;line-height:1.1;margin-bottom:20px">48 Semanas que<br>Cambian tu Vida</h2>
        <p style="font-size:15px;color:#7a7168;line-height:1.75;margin-bottom:32px">Un camino progresivo desde el enraizamiento f√≠sico hasta la maestr√≠a espiritual ‚Äî 36 semanas de pr√°ctica guiada y 12 semanas de integraci√≥n.</p>
        <button onclick="document.getElementById('puertas').scrollIntoView({behavior:'smooth'})" style="background:#2b7d7a;color:white;border:none;padding:14px 28px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif">Comenzar el Viaje ‚Üí</button>
      </div>
      <div style="display:flex;flex-direction:column;gap:0">
        <div style="display:flex;gap:20px;padding:28px 0;border-bottom:1px solid #e4ddd3">
          <div style="width:44px;height:44px;border-radius:50%;background:#b8ad9e20;border:2px solid #b8ad9e;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">üåø</div>
          <div>
            <div style="font-size:11px;font-weight:700;color:#b8ad9e;letter-spacing:.1em;text-transform:uppercase;margin-bottom:6px">Semanas 1‚Äì12</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:400;color:#b8ad9e;margin-bottom:8px">Puerta Blanca ‚Äî Enraizamiento</div>
            <div style="font-size:13px;color:#7a7168;line-height:1.7;margin-bottom:12px">Cuerpo y presencia f√≠sica a trav√©s del Cuarto Camino y El Deportista Consciente.</div>
            <div style="display:flex;gap:6px;flex-wrap:wrap">
              <span style="background:#f0ece4;color:#7a7168;font-size:11px;padding:4px 10px;border-radius:100px">Cuarto Camino</span>
              <span style="background:#f0ece4;color:#7a7168;font-size:11px;padding:4px 10px;border-radius:100px">El Deportista Consciente</span>
              <span style="background:#f0ece4;color:#7a7168;font-size:11px;padding:4px 10px;border-radius:100px">Cuencos I ¬∑ Fundamentos</span>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:20px;padding:28px 0;border-bottom:1px solid #e4ddd3">
          <div style="width:44px;height:44px;border-radius:50%;background:#bf463720;border:2px solid #bf4637;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">üî•</div>
          <div>
            <div style="font-size:11px;font-weight:700;color:#bf4637;letter-spacing:.1em;text-transform:uppercase;margin-bottom:6px">Semanas 13‚Äì24</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:400;color:#bf4637;margin-bottom:8px">Puerta Roja ‚Äî Purificaci√≥n</div>
            <div style="font-size:13px;color:#7a7168;line-height:1.7;margin-bottom:12px">Transformaci√≥n emocional y purificaci√≥n energ√©tica a trav√©s de UCDM y el Cuarto Camino emocional.</div>
            <div style="display:flex;gap:6px;flex-wrap:wrap">
              <span style="background:#fdf0ee;color:#bf4637;font-size:11px;padding:4px 10px;border-radius:100px">UCDM: El Perd√≥n</span>
              <span style="background:#fdf0ee;color:#bf4637;font-size:11px;padding:4px 10px;border-radius:100px">Cuencos II ¬∑ Terap√©utico</span>
              <span style="background:#fdf0ee;color:#bf4637;font-size:11px;padding:4px 10px;border-radius:100px">Mantras Sagrados</span>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:20px;padding:28px 0;border-bottom:1px solid #e4ddd3">
          <div style="width:44px;height:44px;border-radius:50%;background:#2c5f9e20;border:2px solid #2c5f9e;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">üîµ</div>
          <div>
            <div style="font-size:11px;font-weight:700;color:#2c5f9e;letter-spacing:.1em;text-transform:uppercase;margin-bottom:6px">Semanas 25‚Äì36</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:400;color:#2c5f9e;margin-bottom:8px">Puerta Azul ‚Äî Maestr√≠a</div>
            <div style="font-size:13px;color:#7a7168;line-height:1.7;margin-bottom:12px">Expansi√≥n mental y maestr√≠a espiritual a trav√©s del Dzogchen y El Ser Consciente.</div>
            <div style="display:flex;gap:6px;flex-wrap:wrap">
              <span style="background:#eef3fb;color:#2c5f9e;font-size:11px;padding:4px 10px;border-radius:100px">Dzogchen ¬∑ Rigpa</span>
              <span style="background:#eef3fb;color:#2c5f9e;font-size:11px;padding:4px 10px;border-radius:100px">Cuencos III + Anexos</span>
              <span style="background:#eef3fb;color:#2c5f9e;font-size:11px;padding:4px 10px;border-radius:100px">El Ser Consciente</span>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:20px;padding:28px 0">
          <div style="width:44px;height:44px;border-radius:50%;background:#7b4fa620;border:2px solid #7b4fa6;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">üåà</div>
          <div>
            <div style="font-size:11px;font-weight:700;color:#7b4fa6;letter-spacing:.1em;text-transform:uppercase;margin-bottom:6px">Semanas 37‚Äì48</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:400;color:#7b4fa6;margin-bottom:8px">Puerta de Integraci√≥n ‚Äî Retiro</div>
            <div style="font-size:13px;color:#7a7168;line-height:1.7;margin-bottom:12px">S√≠ntesis de las tres puertas. Vivir desde la coherencia, el prop√≥sito y la conexi√≥n.</div>
            <div style="display:flex;gap:6px;flex-wrap:wrap">
              <span style="background:#f5f0fb;color:#7b4fa6;font-size:11px;padding:4px 10px;border-radius:100px">Integraci√≥n Total</span>
              <span style="background:#f5f0fb;color:#7b4fa6;font-size:11px;padding:4px 10px;border-radius:100px">Diarios de Pr√°ctica</span>
              <span style="background:#f5f0fb;color:#7b4fa6;font-size:11px;padding:4px 10px;border-radius:100px">Maestr√≠a Cotidiana</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>



  <!-- PILARES -->
  <div id="pilares" style="padding:80px 32px;background:#f0ece4">
    <div style="max-width:1100px;margin:0 auto">
      <div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.15em;margin-bottom:12px;text-align:center">Los Pilares del Sistema TCT</div>
      <h2 style="font-family:'Cormorant Garamond',serif;font-size:clamp(32px,4vw,52px);font-weight:300;color:#1c1814;text-align:center;margin-bottom:16px">Tres Tradiciones. Una Transformaci√≥n.</h2>
      <p style="font-size:15px;color:#7a7168;line-height:1.7;max-width:680px;margin:0 auto 60px;text-align:center">El Sistema TCT integra las tradiciones m√°s profundas de la humanidad con herramientas vibracionales √∫nicas para crear un camino completo de despertar consciente.</p>

      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;margin-bottom:48px">

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size:32px;margin-bottom:16px">üèîÔ∏è</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:24px;color:#1c1814;margin-bottom:10px">Dzogchen</div>
          <div style="font-size:13px;color:#5a5248;line-height:1.75;margin-bottom:16px">La tradici√≥n tibetana m√°s elevada. Nos revela la naturaleza primordial de la mente ‚Äî <em style="color:#2b7d7a;font-style:italic">Rigpa</em> ‚Äî la consciencia pura, abierta y luminosa que ya est√° presente. No hay nada que alcanzar, solo reconocer lo que somos.</div>
          <div style="background:#f0ece4;border-radius:10px;padding:14px;font-size:12px;color:#7a7168">
            <div style="font-weight:700;color:#3d3730;margin-bottom:6px">Presente en</div>
            üîµ Puerta Azul ¬∑ üåà Integraci√≥n
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size:32px;margin-bottom:16px">‚öôÔ∏è</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:24px;color:#1c1814;margin-bottom:10px">El Cuarto Camino ¬∑ Gurdjieff</div>
          <div style="font-size:13px;color:#5a5248;line-height:1.75;margin-bottom:16px">El despertar en la vida cotidiana. A trav√©s del <em style="color:#2b7d7a;font-style:italic">recuerdo de s√≠</em>, la auto-observaci√≥n y el trabajo sobre los tres centros (f√≠sico, emocional, intelectual), aprendemos a salir del sue√±o autom√°tico y vivir con presencia real.</div>
          <div style="background:#f0ece4;border-radius:10px;padding:14px;font-size:12px;color:#7a7168">
            <div style="font-weight:700;color:#3d3730;margin-bottom:6px">Presente en</div>
            üåø Puerta Blanca ¬∑ üî• Puerta Roja
          </div>
        </div>

        <div style="background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8">
          <div style="font-size:32px;margin-bottom:16px">üíõ</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:24px;color:#1c1814;margin-bottom:10px">Un Curso de Milagros</div>
          <div style="font-size:13px;color:#5a5248;line-height:1.75;margin-bottom:16px">La v√≠a directa para la sanaci√≥n de la mente. UCDM nos gu√≠a para deshacer el sistema del ego basado en el miedo y elegir el sistema del amor y la unidad. El <em style="color:#2b7d7a;font-style:italic">perd√≥n real</em> como herramienta de liberaci√≥n.</div>
          <div style="background:#f0ece4;border-radius:10px;padding:14px;font-size:12px;color:#7a7168">
            <div style="font-weight:700;color:#3d3730;margin-bottom:6px">Presente en</div>
            üî• Puerta Roja ¬∑ üîµ Puerta Azul
          </div>
        </div>
      </div>

      <!-- Los libros/herramientas -->
      <div style="border-top:1px solid #d9d2c8;padding-top:48px">
        <div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.15em;margin-bottom:32px;text-align:center">Las Herramientas del Camino</div>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px">

          <div style="background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3;text-align:center">
            <div style="font-size:24px;margin-bottom:10px">üåø</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:16px;color:#1c1814;margin-bottom:6px">Cuencos TCT I</div>
            <div style="font-size:12px;color:#7a7168;line-height:1.5">Fundamentos vibracionales. Iniciaci√≥n al sonido sagrado y la presencia corporal.</div>
            <div style="margin-top:10px;font-size:10px;color:#b8ad9e;font-weight:600">PUERTA BLANCA</div>
          </div>

          <div style="background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3;text-align:center">
            <div style="font-size:24px;margin-bottom:10px">üî•</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:16px;color:#1c1814;margin-bottom:6px">Cuencos TCT II</div>
            <div style="font-size:12px;color:#7a7168;line-height:1.5">Nivel terap√©utico. Purificaci√≥n emocional y liberaci√≥n de bloqueos energ√©ticos.</div>
            <div style="margin-top:10px;font-size:10px;color:#bf4637;font-weight:600">PUERTA ROJA</div>
          </div>

          <div style="background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3;text-align:center">
            <div style="font-size:24px;margin-bottom:10px">üîµ</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:16px;color:#1c1814;margin-bottom:6px">Cuencos TCT III</div>
            <div style="font-size:12px;color:#7a7168;line-height:1.5">Nivel espiritual avanzado. Apertura de la consciencia y conexi√≥n con Rigpa.</div>
            <div style="margin-top:10px;font-size:10px;color:#2c5f9e;font-weight:600">PUERTA AZUL</div>
          </div>

          <div style="background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3;text-align:center">
            <div style="font-size:24px;margin-bottom:10px">üåà</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:16px;color:#1c1814;margin-bottom:6px">Cuencos TCT IV</div>
            <div style="font-size:12px;color:#7a7168;line-height:1.5">Protocolos para transformar la mente. Integraci√≥n de las tres frecuencias para la transformaci√≥n completa.</div>
            <div style="margin-top:10px;font-size:10px;color:#7b4fa6;font-weight:600">PUERTA AZUL</div>
          </div>

          <div style="background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3;text-align:center">
            <div style="font-size:24px;margin-bottom:10px">üèÉ</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:16px;color:#1c1814;margin-bottom:6px">El Deportista Consciente.</div>
            <div style="font-size:12px;color:#7a7168;line-height:1.5">Presencia en la acci√≥n. El cuerpo como templo y el rendimiento desde la consciencia. El sentido m√°s all√° del √©xito y el fracaso</div>
            <div style="margin-top:10px;font-size:10px;color:#b8ad9e;font-weight:600">PUERTA BLANCA</div>
          </div>

          <div style="background:white;border-radius:14px;padding:20px;border:1px solid #e4ddd3;text-align:center">
            <div style="font-size:24px;margin-bottom:10px">üßò</div>
            <div style="font-family:'Cormorant Garamond',serif;font-size:16px;color:#1c1814;margin-bottom:6px">El Ser Consciente</div>
            <div style="font-size:12px;color:#7a7168;line-height:1.5">Vivir con presencia total. La integraci√≥n cuerpo-mente-consciencia en lo cotidiano.</div>
            <div style="margin-top:10px;font-size:10px;font-weight:600"><span style="color:#bf4637">PUERTA ROJA</span> ¬∑ <span style="color:#2c5f9e">PUERTA AZUL</span></div>
          </div>

        </div>
      </div>

      <div style="text-align:center;margin-top:48px">
        <button onclick="goTo('auth')" style="background:#2b7d7a;color:white;border:none;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif">Comenzar mi Transformaci√≥n ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- JOYAS -->
  <div id="joyas" style="padding:80px 32px;background:white">
    <div style="max-width:1100px;margin:0 auto">
      <div style="font-size:11px;font-weight:700;color:#b89558;text-transform:uppercase;letter-spacing:.15em;margin-bottom:12px">Las Joyas del Sistema</div>
      <h2 style="font-family:'Cormorant Garamond',serif;font-size:clamp(32px,4vw,52px);font-weight:300;margin-bottom:16px">Tu Joya Personal</h2>
      <p style="font-size:15px;color:#7a7168;line-height:1.7;max-width:600px;margin-bottom:48px">Cada alumno recibe una joya sagrada personalizada seg√∫n su camino. Las joyas son herramientas vibracionales que amplifican y anclan la frecuencia de cada Puerta.</p>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px">
        <div style="background:#f5f2ec;border-radius:16px;padding:28px;text-align:center;border:1px solid #d9d2c8">
          <div style="font-size:36px;margin-bottom:12px">üåø</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:20px;color:#8a8078;margin-bottom:8px">Joya Blanca</div>
          <div style="font-size:13px;color:#7a7168;line-height:1.6">Cuarzo blanco o selenita. Purifica y ancla la presencia en el cuerpo.</div>
        </div>
        <div style="background:#fdf0ee;border-radius:16px;padding:28px;text-align:center;border:1px solid #e8c4be">
          <div style="font-size:36px;margin-bottom:12px">üî•</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:20px;color:#bf4637;margin-bottom:8px">Joya Roja</div>
          <div style="font-size:13px;color:#7a7168;line-height:1.6">Granate o cornalina. Transforma la energ√≠a emocional y activa el coraz√≥n.</div>
        </div>
        <div style="background:#eef3fb;border-radius:16px;padding:28px;text-align:center;border:1px solid #bacde8">
          <div style="font-size:36px;margin-bottom:12px">üîµ</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:20px;color:#2c5f9e;margin-bottom:8px">Joya Azul</div>
          <div style="font-size:13px;color:#7a7168;line-height:1.6">Lapisl√°zuli o aguamarina. Abre la mente y conecta con la sabidur√≠a.</div>
        </div>
        <div style="background:#f5f0fb;border-radius:16px;padding:28px;text-align:center;border:1px solid #cbbde8">
          <div style="font-size:36px;margin-bottom:12px">üåà</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:20px;color:#7b4fa6;margin-bottom:8px">Joya Arcoiris</div>
          <div style="font-size:13px;color:#7a7168;line-height:1.6">Amatista o turmalina. Integra las tres puertas y eleva la vibraci√≥n.</div>
        </div>
        <div style="background:linear-gradient(135deg,#fdf6ec,#f5eedd);border-radius:16px;padding:28px;text-align:center;border:1px solid #d4b87a">
          <div style="font-size:36px;margin-bottom:12px">‚ú®</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:20px;color:#b89558;margin-bottom:8px">Joya Oro</div>
          <div style="font-size:13px;color:#7a7168;line-height:1.6">Citrina o pirita dorada. La joya de la maestr√≠a total y la abundancia.</div>
        </div>
      </div>
      <div style="margin-top:40px;text-align:center">
        <button onclick="goTo('auth')" style="background:#b89558;color:white;border:none;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif" onclick="goTo('auth')">‚ú¶ Descubrir mi Joya Personal</button>
      </div>
    </div>
  </div>

  <!-- TESTIMONIOS -->
  <div id="testimonios" style="background:#f0ece4;padding:80px 32px">
    <div style="max-width:1100px;margin:0 auto">
      <div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.15em;margin-bottom:12px;text-align:center">Testimonios</div>
      <h2 style="font-family:'Cormorant Garamond',serif;font-size:42px;font-weight:300;color:#1c1814;text-align:center;margin-bottom:48px">Lo que dicen nuestros alumnos</h2>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px">
        <div style="background:white;border-radius:16px;padding:28px;border:1px solid #e4ddd3">
          <div style="font-size:14px;color:#3d3730;line-height:1.8;margin-bottom:20px;font-style:italic">"El Sistema TCT ha transformado completamente mi relaci√≥n con el cuerpo y la mente. Nunca pens√© que podr√≠a experimentar tanta paz interior en mi vida cotidiana."</div>
          <div style="font-weight:600;color:#1c1814;font-size:13px">Mar√≠a G.</div>
          <div style="font-size:12px;color:#7a7168">Puerta Azul completada</div>
        </div>
        <div style="background:white;border-radius:16px;padding:28px;border:1px solid #e4ddd3">
          <div style="font-size:14px;color:#3d3730;line-height:1.8;margin-bottom:20px;font-style:italic">"Los cuencos tibetanos y los protocolos de sonido cambiaron mi forma de gestionar el estr√©s. Es una herramienta incomparable para el bienestar."</div>
          <div style="font-weight:600;color:#1c1814;font-size:13px">Carlos M.</div>
          <div style="font-size:12px;color:#7a7168">Puerta Oro ¬∑ Programa completo</div>
        </div>
        <div style="background:white;border-radius:16px;padding:28px;border:1px solid #e4ddd3">
          <div style="font-size:14px;color:#3d3730;line-height:1.8;margin-bottom:20px;font-style:italic">"Marga tiene un don especial para transmitir el conocimiento espiritual de forma pr√°ctica y accesible. Las canalizaciones son un regalo."</div>
          <div style="font-weight:600;color:#1c1814;font-size:13px">Laura P.</div>
          <div style="font-size:12px;color:#7a7168">Puerta Arcoiris completada</div>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer style="background:#111;padding:40px 32px;text-align:center">
    <div style="font-family:'Cormorant Garamond',serif;font-size:20px;color:white;margin-bottom:8px">Frecuencia Integral Academy</div>
    <div style="font-size:12px;color:#7a7168;margin-bottom:20px">Sistema TCT ¬∑ Transformaci√≥n Consciente Trascendental</div>
    <button onclick="goTo('auth')" style="background:#2b7d7a;color:white;border:none;padding:12px 28px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer">Comenzar mi Transformaci√≥n ‚Üí</button>
    <div style="margin-top:28px;font-size:11px;color:rgba(255,255,255,.25)">¬© 2026 Frecuencia Integral Academy ¬∑ Todos los derechos reservados</div>
  </footer>


  
</div><!-- /page-public -->

<!-- PAGE: AUTH -->
<div class="page" id="page-auth">
  <div class="auth-wrap">
    <div class="auth-left">
      <h2>Entra en tu<br>espacio de<br><em>transformaci√≥n</em></h2>
      <p>Accede a tus semanas de formaci√≥n, ejercicios detallados, audios de cuencos tibetanos y tu joya personalizada.</p>
      <ul class="auth-perks">
        <li>48 semanas de contenido estructurado</li>
        <li>73+ ejercicios con instrucciones paso a paso</li>
        <li>Canalizaciones de Marga Barcel√≥</li>
        <li>Frecuencias 432Hz, 528Hz, 963Hz</li>
        <li>Test de Joya Personalizada</li>
        <li>Progreso guardado en tiempo real</li>
      </ul>
    </div>
    <div class="auth-right">
      <div class="auth-box">
        <h3>Bienvenido</h3>
        <p class="sub">Accede a tu √°rea de alumnos</p>
        <div class="auth-tabs">
          <button class="auth-tab active" id="tab-login" onclick="switchTab('login')">Iniciar Sesi√≥n</button>
          <button class="auth-tab" id="tab-register" onclick="switchTab('register')">Registrarse</button>
        </div>

        <div id="form-login">
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="inp-email" value="test@frecuenciaintegral.com">
          </div>
          <div class="form-group">
            <label>Contrase√±a</label>
            <input type="password" id="inp-pass" value="TestUser2026!">
          </div>
          <button class="btn-login" id="btn-login" onclick="doLogin()">Entrar al √Årea de Alumnos</button>
          <div class="demo-hint">üîë Demo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ec98899f98ac8a9e898f9989828f858d858298898b9e8d80c28f8381">[email&#160;protected]</a> / TestUser2026!</div>
        </div>

        <div id="form-register" style="display:none">
          <div class="form-group">
            <label>Nombre</label>
            <input type="text" id="inp-name" placeholder="Tu nombre completo">
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="inp-reg-email" placeholder="tu@email.com">
          </div>
          <div class="form-group">
            <label>Contrase√±a</label>
            <input type="password" id="inp-reg-pass" placeholder="M√≠nimo 8 caracteres">
          </div>
          <button class="btn-login" id="btn-register" onclick="doRegister()">Crear Cuenta</button>
        </div>

        <a class="back-link" onclick="goTo('public')">‚Üê Volver a la web</a>
      </div>
    </div>
  </div>
</div><!-- /page-auth -->

<!-- PAGE: STUDENT -->
<div class="page" id="page-student">
  <div class="student-wrap">

    <!-- SIDEBAR -->
    <div class="sidebar">
      <div class="sidebar-user">
        <div class="sidebar-name" id="sb-name">Alumno TCT</div>
        <div class="sidebar-email" id="sb-email">‚Äî</div>
        <div class="sidebar-badge" id="sb-plan">Puerta Oro</div>
      </div>
      <div class="sidebar-nav">
        <button class="nav-item active" onclick="showView('dashboard')"><span class="nav-item-icon">üè†</span>Dashboard</button>
        <button class="nav-item" onclick="showView('formaciones')"><span class="nav-item-icon">üìö</span>Formaciones</button>
        <button class="nav-item" onclick="showView('multimedia')"><span class="nav-item-icon">üéµ</span>Multimedia</button>
        <button class="nav-item" onclick="showView('materiales')"><span class="nav-item-icon">üìÑ</span>Materiales PDF</button>
        <button class="nav-item" onclick="showView('progreso')"><span class="nav-item-icon">üìä</span>Mi Progreso</button>
        <button class="nav-item" style="margin-top:auto;color:rgba(255,255,255,.4)" onclick="doLogout()"><span class="nav-item-icon">üö™</span>Cerrar Sesi√≥n</button>
      </div>
    </div>

    <!-- MAIN -->
    <div class="main-content">

      <!-- DASHBOARD VIEW -->
      <div id="view-dashboard">
        <h1 style="font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:300;margin-bottom:8px">Bienvenido, <span id="dash-name">Alumno</span> ‚ú¶</h1>
        <p style="color:#7a7168;font-size:14px;margin-bottom:28px">Sistema TCT ‚Äî Tu camino de transformaci√≥n</p>
        <div class="dashboard-grid">
          <div class="stat-card">
            <div class="stat-label">Progreso General</div>
            <div class="stat-value" id="stat-progreso">0%</div>
            <div class="stat-sub" id="stat-sub-progreso">0 de 48 semanas</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Semana Actual</div>
            <div class="stat-value" id="stat-semana">1</div>
            <div class="stat-sub">En curso</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Puerta Actual</div>
            <div class="stat-value" style="font-size:28px" id="stat-puerta">üåø Blanca</div>
            <div class="stat-sub">Cimentaci√≥n</div>
          </div>
        </div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <button class="btn-primary" onclick="showView('formaciones')">Ver Formaciones ‚Üí</button>
          <button class="btn-ghost" onclick="showView('multimedia')">Biblioteca Multimedia</button>
        </div>
      </div>

      <!-- FORMACIONES VIEW -->
      <div id="view-formaciones" style="display:none">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:20px">Las 48 Semanas</h2>
        <div class="filter-bar">
          <button class="filter-btn active" onclick="filterWeeks('all',this)">Todas</button>
          <button class="filter-btn" onclick="filterWeeks('Blanca',this)">üåø Blanca</button>
          <button class="filter-btn" onclick="filterWeeks('Roja',this)">üî• Roja</button>
          <button class="filter-btn" onclick="filterWeeks('Azul',this)">üîµ Azul</button>
          <button class="filter-btn" onclick="filterWeeks('Arcoiris',this)">üåà Arcoiris</button>
        </div>
        <div class="weeks-grid" id="weeks-grid"></div>
      </div>

      <!-- MULTIMEDIA VIEW -->
      <div id="view-multimedia" style="display:none">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:20px">Biblioteca Multimedia</h2>
        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px" id="media-grid"></div>
      </div>

      <!-- MATERIALES VIEW -->
      <div id="view-materiales" style="display:none">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:8px">Materiales PDF</h2>
        <p style="color:#7a7168;font-size:14px;margin-bottom:28px">Descarga o visualiza los libros y documentos de tu programa</p>
        <div id="materiales-content"></div>
      </div>

      <!-- PROGRESO VIEW -->
      <div id="view-progreso" style="display:none">
        <h2 style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300;margin-bottom:20px">Mi Progreso</h2>
        <div id="progreso-list"></div>
      </div>

    </div>
  </div>
</div><!-- /page-student -->

<!-- MODAL SEMANA -->
<div class="modal-overlay" id="week-modal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-header-left">
        <div class="modal-week-badge" id="modal-badge">üìö</div>
        <div>
          <div class="modal-title" id="modal-title">Semana</div>
          <div class="modal-puerta-tag" id="modal-puerta"></div>
        </div>
      </div>
      <button class="modal-close" onclick="closeModal()">‚úï</button>
    </div>
    <div class="modal-layout">
      <!-- Sidebar navegaci√≥n -->
      <div class="modal-sidebar">
        <button class="modal-nav-btn active" onclick="switchModalTab(0,this)" data-tab="0">
          <span class="modal-nav-icon">üìñ</span>Descripci√≥n
        </button>
        <button class="modal-nav-btn" onclick="switchModalTab(1,this)" data-tab="1">
          <span class="modal-nav-icon">üí°</span>Conceptos
        </button>
        <button class="modal-nav-btn" onclick="switchModalTab(2,this)" data-tab="2">
          <span class="modal-nav-icon">üßò</span>Ejercicio
        </button>
        <button class="modal-nav-btn" onclick="switchModalTab(3,this)" data-tab="3">
          <span class="modal-nav-icon">üìÑ</span>Materiales
        </button>
        <button class="modal-nav-btn" onclick="switchModalTab(4,this)" data-tab="4">
          <span class="modal-nav-icon">‚úÖ</span>Completar
        </button>
      </div>
      <!-- Contenido -->
      <div class="modal-body">
        <div id="modal-content"></div>
      </div>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
// ‚îÄ‚îÄ CONFIG SUPABASE ‚îÄ‚îÄ
const SB_URL  = 'https://jtwbbyjspanirbsuoipa.supabase.co';
const SB_ANON = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0d2JieWpzcGFuaXJic3VvaXBhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1MjcwMTMsImV4cCI6MjA4NzEwMzAxM30.EnKFo0Hedbhja3Lgy0FR99U9FACY6ZyoadnteoyONns';

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
let sb = null;
let user = null;
let completedWeeks = [];
let currentWeek = 1;
let currentFilter = 'all';
let weekData = {};

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
window.addEventListener('DOMContentLoaded', function() {
  // Init Supabase
  if (window.supabase) {
    sb = window.supabase.createClient(SB_URL, SB_ANON);
    sb.auth.onAuthStateChange(function(event, session) {
      if (event === 'SIGNED_IN' && session) onLogin(session.user);
      if (event === 'SIGNED_OUT') onLogout();
    });
    sb.auth.getSession().then(function(r) {
      if (r.data.session) onLogin(r.data.session.user);
    });
  }
  renderWeeks();
  renderMedia();
});

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ
function goTo(page) {
  document.querySelectorAll('.page').forEach(function(p){ p.classList.remove('active'); });
  document.getElementById('page-' + page).classList.add('active');
  window.scrollTo(0,0);
  if (page === 'student') refreshDashboard();
}

function showView(view) {
  ['dashboard','formaciones','multimedia','materiales','progreso'].forEach(function(v){
    document.getElementById('view-' + v).style.display = v === view ? 'block' : 'none';
  });
  document.querySelectorAll('.nav-item').forEach(function(btn){
    btn.classList.remove('active');
  });
  event.currentTarget.classList.add('active');
  if (view === 'progreso') renderProgreso();
  if (view === 'materiales') renderMateriales();
}

// ‚îÄ‚îÄ AUTH ‚îÄ‚îÄ
function switchTab(tab) {
  document.getElementById('form-login').style.display = tab === 'login' ? 'block' : 'none';
  document.getElementById('form-register').style.display = tab === 'register' ? 'block' : 'none';
  document.getElementById('tab-login').classList.toggle('active', tab === 'login');
  document.getElementById('tab-register').classList.toggle('active', tab === 'register');
}

async function doLogin() {
  const email = document.getElementById('inp-email').value.trim();
  const pass  = document.getElementById('inp-pass').value;
  if (!email || !pass) { toast('Completa email y contrase√±a'); return; }

  const btn = document.getElementById('btn-login');
  btn.textContent = 'Conectando...';
  btn.disabled = true;

  try {
    if (sb) {
      const { data, error } = await sb.auth.signInWithPassword({ email, password: pass });
      if (error) throw error;
    } else {
      // Demo fallback
      if (email !== 'test@frecuenciaintegral.com') throw new Error('Email incorrecto');
      if (pass !== 'TestUser2026!') throw new Error('Contrase√±a incorrecta');
      user = { id: 'demo', email, user_metadata: { full_name: 'Alumno TCT' } };
      onLogin(user);
    }
  } catch(e) {
    // Fallback demo
    if (email === 'test@frecuenciaintegral.com' && pass === 'TestUser2026!') {
      user = { id: 'demo', email, user_metadata: { full_name: 'Alumno TCT' } };
      onLogin(user);
    } else {
      toast('Error: ' + e.message);
    }
  }

  btn.textContent = 'Entrar al √Årea de Alumnos';
  btn.disabled = false;
}

async function doRegister() {
  const name  = document.getElementById('inp-name').value.trim();
  const email = document.getElementById('inp-reg-email').value.trim();
  const pass  = document.getElementById('inp-reg-pass').value;
  if (!name || !email || !pass) { toast('Completa todos los campos'); return; }
  if (pass.length < 8) { toast('Contrase√±a m√≠nimo 8 caracteres'); return; }

  const btn = document.getElementById('btn-register');
  btn.textContent = 'Creando cuenta...';
  btn.disabled = true;

  try {
    if (sb) {
      const { error } = await sb.auth.signUp({ email, password: pass, options: { data: { full_name: name } } });
      if (error) throw error;
      toast('Revisa tu email para confirmar la cuenta ‚úâÔ∏è');
    }
  } catch(e) {
    toast('Error: ' + e.message);
  }

  btn.textContent = 'Crear Cuenta';
  btn.disabled = false;
}

// ‚îÄ‚îÄ ADMIN EMAILS (solo administradores reales) ‚îÄ‚îÄ
const ADMIN_EMAILS = ['quico@frecuenciaintegral.com', 'admin@frecuenciaintegral.com'];

async function onLogin(u) {
  user = u;
  const name = u.user_metadata?.full_name || u.email.split('@')[0];

  // Cargar perfil completo (role + plan)
  let userRole = 'alumno';
  let userPlan = 'Blanca';
  if (sb && u.id !== 'demo') {
    try {
      const { data: profile } = await sb.from('profiles').select('role, plan').eq('id', u.id).single();
      if (profile) {
        userRole = profile.role || 'alumno';
        userPlan = profile.plan || 'Blanca';
      }
    } catch(e) { console.log('No profile yet'); }
  }

  const isAdmin = userRole === 'admin' || ADMIN_EMAILS.includes(u.email);

  // Cargar progreso
  if (sb && u.id !== 'demo') {
    try {
      const { data } = await sb.from('user_progress').select('week_number,status').eq('user_id', u.id);
      if (data) {
        completedWeeks = data.filter(function(p){ return p.status === 'completed'; }).map(function(p){ return p.week_number; });
        const inProg = data.find(function(p){ return p.status === 'in_progress'; });
        currentWeek = inProg ? inProg.week_number : (completedWeeks.length + 1);
      }
    } catch(e) { console.log('No progress table yet'); }
  }

  // Guardar plan en estado global
  user._plan = userPlan;
  user._role = userRole;

  // Actualizar sidebar
  document.getElementById('sb-name').textContent = name;
  document.getElementById('sb-email').textContent = u.email;
  document.getElementById('sb-plan').textContent = '‚ú® Puerta ' + userPlan;
  document.getElementById('sb-plan').style.background = 
    userPlan === 'Oro' ? '#b89558' :
    userPlan === 'Arcoiris' ? '#7b4fa6' :
    userPlan === 'Azul' ? '#2c5f9e' :
    userPlan === 'Roja' ? '#bf4637' : '#8a8078';

  document.getElementById('btnLogin').style.display = 'none';
  document.getElementById('btnInscribirse').style.display = 'none';
  document.getElementById('btnDash').style.display = '';
  document.getElementById('btnLogout').style.display = '';
  document.getElementById('btnAdmin').style.display = isAdmin ? '' : 'none';

  goTo('student');
  toast('Bienvenido/a, ' + name + '! ‚ú®');
}

function onLogout() {
  user = null;
  completedWeeks = [];
  currentWeek = 1;
  document.getElementById('btnLogin').style.display = '';
  document.getElementById('btnInscribirse').style.display = '';
  document.getElementById('btnDash').style.display = 'none';
  document.getElementById('btnLogout').style.display = 'none';
  document.getElementById('btnAdmin').style.display = 'none';
}

async function doLogout() {
  if (sb) await sb.auth.signOut();
  onLogout();
  goTo('public');
  toast('Sesi√≥n cerrada');
}

// ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ
function refreshDashboard() {
  const name = user ? (user.user_metadata?.full_name || user.email.split('@')[0]) : 'Alumno';
  document.getElementById('dash-name').textContent = name;
  const pct = Math.round((completedWeeks.length / 48) * 100);
  document.getElementById('stat-progreso').textContent = pct + '%';
  document.getElementById('stat-sub-progreso').textContent = completedWeeks.length + ' de 48 semanas';
  document.getElementById('stat-semana').textContent = currentWeek;
  const puerta = currentWeek <= 12 ? 'üåø Blanca' : currentWeek <= 24 ? 'üî• Roja' : currentWeek <= 36 ? 'üîµ Azul' : 'üåà Arcoiris';
  document.getElementById('stat-puerta').textContent = puerta;
  renderWeeks();
}

// ‚îÄ‚îÄ WEEKS ‚îÄ‚îÄ
const WEEKS_DATA = [
  {w:1,p:'Blanca',t:'El Precio Oculto de Vivir Acelerados'},
  {w:2,p:'Blanca',t:'Cuando Ganar Ya No Es Suficiente'},
  {w:3,p:'Blanca',t:'Cuerpo, Mente y Consciencia: Una Sola Unidad'},
  {w:4,p:'Blanca',t:'El Ego en la Vida Cotidiana'},
  {w:5,p:'Blanca',t:'La Emoci√≥n, el Error y la Presi√≥n como Camino'},
  {w:6,p:'Blanca',t:'El Entrenamiento como V√≠a de Despertar'},
  {w:7,p:'Blanca',t:'El Campo de Consciencia Compartido'},
  {w:8,p:'Blanca',t:'Sonido, Vibraci√≥n y Armonizaci√≥n del Sistema'},
  {w:9,p:'Blanca',t:'Cuando el Sistema No Sostiene lo que Promete'},
  {w:10,p:'Blanca',t:'El L√≠mite como Punto de Despertar'},
  {w:11,p:'Blanca',t:'M√°s All√° del Resultado: El Sentido del Camino'},
  {w:12,p:'Blanca',t:'Integraci√≥n de la Puerta Blanca'},
  {w:13,p:'Roja',t:'Introducci√≥n a la Puerta Roja y la Energ√≠a'},
  {w:14,p:'Roja',t:'El Sonido Primordial y los Mantras'},
  {w:15,p:'Roja',t:'Los 6 Reinos del Samsara y la Gesti√≥n Emocional'},
  {w:16,p:'Roja',t:'El Cuarto Camino - Recuerdo de S√≠ y Observaci√≥n'},
  {w:17,p:'Roja',t:'El Cuarto Camino - Trabajo sobre los Centros'},
  {w:18,p:'Roja',t:'UCDM - La Paradoja de la Felicidad y el Perd√≥n'},
  {w:19,p:'Roja',t:'UCDM - Gesti√≥n Emocional y el Instante Santo'},
  {w:20,p:'Roja',t:'Protocolos de Sonido - Purificar el Samsara'},
  {w:21,p:'Roja',t:'Protocolos de Sonido - El Pilar del Medio'},
  {w:22,p:'Roja',t:'Alquimia de la Energ√≠a - La Cruz Cabal√≠stica'},
  {w:23,p:'Roja',t:'La F√≥rmula de la Felicidad - Aceptaci√≥n'},
  {w:24,p:'Roja',t:'Integraci√≥n de la Puerta Roja'},
  {w:25,p:'Azul',t:'Introducci√≥n a la Puerta Azul y la Mente'},
  {w:26,p:'Azul',t:'La Mente seg√∫n Diversas Tradiciones'},
  {w:27,p:'Azul',t:'Dzogchen - La Mente Natural (Rigpa)'},
  {w:28,p:'Azul',t:'La Met√°fora del Espejo y la Visi√≥n No-Dual'},
  {w:29,p:'Azul',t:'UCDM en la Puerta Azul - El Testigo Santo'},
  {w:30,p:'Azul',t:'El Ser Consciente - Vivir con Presencia'},
  {w:31,p:'Azul',t:'Protocolos de Sonido - Desintoxicaci√≥n'},
  {w:32,p:'Azul',t:'Objetos Sagrados y el Proceso de Liberaci√≥n'},
  {w:33,p:'Azul',t:'Manifestar la Fuerza Interior'},
  {w:34,p:'Azul',t:'Transformaci√≥n de la Mente para la Felicidad'},
  {w:35,p:'Azul',t:'La Noche Oscura del Alma'},
  {w:36,p:'Azul',t:'Integraci√≥n de la Puerta Azul'},
  {w:37,p:'Arcoiris',t:'S√≠ntesis del M√©todo TCT - Las Tres Puertas'},
  {w:38,p:'Arcoiris',t:'La Alquimia del Ser'},
  {w:39,p:'Arcoiris',t:'El Campo Invisible que Todos Sostenemos'},
  {w:40,p:'Arcoiris',t:'Pr√°ctica Integrada - El Diario del Cuarto Camino'},
  {w:41,p:'Arcoiris',t:'Pr√°ctica Integrada - El Diario del Perd√≥n'},
  {w:42,p:'Arcoiris',t:'Pr√°ctica Integrada - El Diario de la Mente Feliz'},
  {w:43,p:'Arcoiris',t:'El Arte de la No-Interferencia'},
  {w:44,p:'Arcoiris',t:'El Legado Invisible - La Vida como Servicio'},
  {w:45,p:'Arcoiris',t:'La Comunicaci√≥n desde la Fuente'},
  {w:46,p:'Arcoiris',t:'Maestr√≠a en la Vida Cotidiana'},
  {w:47,p:'Arcoiris',t:'El Ciclo Permanente - La Espiral de Transformaci√≥n'},
  {w:48,p:'Arcoiris',t:'Cierre y Continuaci√≥n del Camino'}
];

function renderWeeks() {
  const grid = document.getElementById('weeks-grid');
  if (!grid) return;
  const filtered = currentFilter === 'all' ? WEEKS_DATA : WEEKS_DATA.filter(function(w){ return w.p === currentFilter; });
  grid.innerHTML = filtered.map(function(w) {
    const done = completedWeeks.includes(w.w);
    const cur  = w.w === currentWeek;
    const icon = done ? '‚úÖ' : cur ? '‚ñ∂' : '‚óã';
    const cls  = done ? 'week-card completed' : cur ? 'week-card in-progress' : 'week-card';
    return '<div class="' + cls + '" onclick="openWeekModal(' + w.w + ')">' +
      '<div class="week-num">Semana ' + w.w + ' ¬∑ ' + icon + '</div>' +
      '<div class="week-title">' + w.t + '</div>' +
      '<div class="week-status" style="color:' + (done?'#2b7d7a':cur?'#b89558':'#a89e93') + '">' +
      (done ? 'Completada' : cur ? 'En curso' : 'Pendiente') + '</div>' +
    '</div>';
  }).join('');
}

function filterWeeks(puerta, btn) {
  currentFilter = puerta;
  document.querySelectorAll('.filter-btn').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
  renderWeeks();
}

// ‚îÄ‚îÄ WEEK MODAL ‚îÄ‚îÄ
let currentModalWeek = null;

function openWeekModal(weekNum) {
  currentModalWeek = weekNum;
  const w = WEEKS_DATA.find(function(x){ return x.x === weekNum; }) || WEEKS_DATA[weekNum-1];
  const done = completedWeeks.includes(weekNum);
  const colors = {Blanca:'#b8ad9e',Roja:'#bf4637',Azul:'#2c5f9e',Arcoiris:'#7b4fa6'};
  const color = colors[w.p] || '#2b7d7a';

  document.getElementById('modal-title').textContent = 'Semana ' + weekNum + ': ' + w.t;
  document.getElementById('modal-puerta').textContent = '‚ú¶ Puerta ' + w.p + (done ? ' ¬∑ ‚úÖ Completada' : '');

  // Get exercise data from global if available
  const d = (typeof WD !== 'undefined') ? WD[weekNum] : null;

  const tabs = [
    // Tab 0: Descripci√≥n
    '<div style="background:#f7f5f1;border-radius:12px;padding:20px;border-left:3px solid ' + color + '">' +
    '<div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:10px">Material de Estudio</div>' +
    '<p style="font-size:14px;line-height:1.75;color:#3d3730">' + (d ? d.m : 'Contenido de la semana ' + weekNum + '.') + '</p></div>',

    // Tab 1: Conceptos
    d && d.c && d.c.length > 0
      ? d.c.map(function(c){ return '<div class="concept-card" style="border-color:' + color + '"><div class="concept-name">' + c[0] + '</div><div class="concept-desc">' + c[1] + '</div></div>'; }).join('')
      : '<p style="color:#7a7168;font-size:14px">Conceptos clave de la semana ' + weekNum + '.</p>',

    // Tab 2: Ejercicio
    (function() {
      if (!d || !d.et) return '<p style="color:#7a7168;font-size:14px">Ejercicio pr√°ctico de la semana ' + weekNum + '.</p>';
      return '<div style="background:linear-gradient(135deg,' + color + '18,' + color + '08);border:1px solid ' + color + '30;border-radius:14px;padding:20px;margin-bottom:20px">' +
        '<div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:8px">‚ú¶ Ejercicio Pr√°ctico</div>' +
        '<div style="font-family:\'Cormorant Garamond\',serif;font-size:18px;font-weight:400;margin-bottom:10px">' + d.et + '</div>' +
        (d.eo ? '<div style="font-size:13px;color:#3d3730;font-style:italic">Objetivo: ' + d.eo + '</div>' : '') +
        (d.er ? '<div style="font-size:11px;color:#a89e93;margin-top:8px">üìö ' + d.er + '</div>' : '') +
        '</div>' +
        (d.ep && d.ep.length > 0 ? '<div>' + d.ep.map(function(p,i){ return '<div class="exercise-step"><div class="step-num">' + (i+1) + '</div><div class="step-text">' + p + '</div></div>'; }).join('') + '</div>' : '');
    })(),

    // Tab 3: Materiales PDF
    (function() {
      var pdfs = MATERIALES[w.p] ? MATERIALES[w.p].pdfs : [];
      if (pdfs.length === 0) return '<p style="color:#7a7168;font-size:14px">No hay materiales para esta puerta.</p>';
      var mcolor = MATERIALES[w.p] ? MATERIALES[w.p].color : '#2b7d7a';
      return '<div style="margin-bottom:12px;font-size:12px;color:#7a7168">Materiales de la <strong>Puerta ' + w.p + '</strong></div>' +
        pdfs.map(function(pdf, i) {
          var mid = 'modal-pdf-' + weekNum + '-' + i;
          return '<div class="pdf-card">' +
            '<div class="pdf-card-header" onclick="togglePdfViewer(\'' + mid + '\')">' +
              '<div class="pdf-icon">üìÑ</div>' +
              '<div class="pdf-info"><div class="pdf-name" style="font-size:13px">' + pdf.name + '</div><div class="pdf-meta">PDF ¬∑ Haz clic para ver</div></div>' +
              '<div class="pdf-actions">' +
                '<button class="btn-pdf-view" onclick="event.stopPropagation();togglePdfViewer(\'' + mid + '\')">üëÅ Ver</button>' +
                '<a class="btn-pdf-dl" href="' + pdf.url + '" download target="_blank" onclick="event.stopPropagation()">‚¨á</a>' +
              '</div>' +
            '</div>' +
            '<div class="pdf-viewer-wrap" id="' + mid + '">' +
              '<div class="pdf-viewer-bar"><span>' + pdf.name + '</span><button class="btn-pdf-close" onclick="togglePdfViewer(\'' + mid + '\')">‚úï</button></div>' +
              '<iframe src="" data-src="' + pdf.url + '" loading="lazy"></iframe>' +
            '</div>' +
          '</div>';
        }).join('');
    })(),

    // Tab 4: Completar
    '<div>' +
    ['He le√≠do el material de estudio','He realizado el ejercicio pr√°ctico','He escuchado el audio de la semana','He anotado mis reflexiones'].map(function(t,i){
      return '<div class="task-item" id="task-' + weekNum + '-' + i + '" onclick="toggleTask(' + weekNum + ',' + i + ')"><div class="task-cb"></div><div class="task-text">' + t + '</div></div>';
    }).join('') +
    '<button class="btn-complete" onclick="markComplete(' + weekNum + ')" ' + (done ? 'disabled style="background:#d1c8bc"' : '') + '>' +
    (done ? '‚úÖ Semana Completada' : '‚ú¶ Marcar como Completada') + '</button></div>'
  ];

  document.getElementById('modal-content').innerHTML =
    tabs.map(function(content, i){ return '<div class="tab-content ' + (i===0?'active':'') + '" id="modal-tab-' + i + '">' + content + '</div>'; }).join('');

  // Set badge icon
  const icons = {Blanca:'üåø', Roja:'üî•', Azul:'üîµ', Arcoiris:'üåà'};
  const badgeColors = {Blanca:'#f0ede8', Roja:'#fdecea', Azul:'#e8eef8', Arcoiris:'#f3edf8'};
  document.getElementById('modal-badge').textContent = icons[w.p] || 'üìö';
  document.getElementById('modal-badge').style.background = badgeColors[w.p] || '#e8f4f3';

  // Reset sidebar nav
  document.querySelectorAll('.modal-nav-btn').forEach(function(t,i){ t.classList.toggle('active', i===0); });
  document.getElementById('week-modal').classList.add('open');
}

function closeModal() {
  document.getElementById('week-modal').classList.remove('open');
}

function switchModalTab(idx, btn) {
  document.querySelectorAll('.tab-content').forEach(function(t){ t.classList.remove('active'); });
  document.getElementById('modal-tab-' + idx).classList.add('active');
  document.querySelectorAll('.modal-nav-btn').forEach(function(t){ t.classList.remove('active'); });
  btn.classList.add('active');
}

function toggleTask(weekNum, idx) {
  document.getElementById('task-' + weekNum + '-' + idx).classList.toggle('done');
}

async function markComplete(weekNum) {
  const w = WEEKS_DATA[weekNum-1];
  if (sb && user && user.id !== 'demo') {
    try {
      await sb.from('user_progress').upsert({
        user_id: user.id, week_number: weekNum,
        puerta: w.p, status: 'completed',
        completion_percentage: 100,
        completed_at: new Date().toISOString()
      }, { onConflict: 'user_id,week_number' });
      if (weekNum < 48) {
        await sb.from('user_progress').upsert({
          user_id: user.id, week_number: weekNum+1,
          puerta: WEEKS_DATA[weekNum].p, status: 'in_progress',
          completion_percentage: 0
        }, { onConflict: 'user_id,week_number' });
      }
    } catch(e) { console.log('Error saving:', e); }
  }
  if (!completedWeeks.includes(weekNum)) completedWeeks.push(weekNum);
  if (weekNum === currentWeek && currentWeek < 48) currentWeek++;
  closeModal();
  refreshDashboard();
  toast('Semana ' + weekNum + ' completada! üéâ');
}

// ‚îÄ‚îÄ MATERIALES PDF ‚îÄ‚îÄ
const MATERIALES = {
  'Blanca': {
    icon: 'üåø', color: '#b8ad9e',
    pdfs: [
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20%20BLANCA/El-deportista-consciente-Mas-alla-del-resultado.pdf' },
      { name: 'TCT-I ‚Äî Puerta Blanca', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20%20BLANCA/TCT-I-PUERTA-BLANCA.pdf' }
    ]
  },
  'Roja': {
    icon: 'üî•', color: '#bf4637',
    pdfs: [
      { name: 'TCT-II ‚Äî Puerta Roja', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ROJA/TCT-II-PUERTA-ROJA.pdf' },
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ROJA/El-deportista-consciente-Mas-alla-del-resultado.pdf' },
      { name: 'El Ser Consciente ‚Äî M√°s all√° de la acci√≥n', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ROJA/El-Ser-Consciente-Mas-alla-de-la-accion-Vivir-con-presencia-en-la-vida-cotidiana.pdf' }
    ]
  },
  'Azul': {
    icon: 'üîµ', color: '#2c5f9e',
    pdfs: [
      { name: 'TCT-III ‚Äî Puerta Azul', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20AZUL/TCT-III-PUERTA-AZUL.pdf' },
      { name: 'TCT-IV ‚Äî Anexos', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20AZUL/TCT-IV-PUERTA-ANEXOS.pdf' },
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20AZUL/El-deportista-consciente-Mas-alla-del-resultado.pdf' },
      { name: 'El Ser Consciente ‚Äî M√°s all√° de la acci√≥n', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20AZUL/El-Ser-Consciente-Mas-alla-de-la-accion-Vivir-con-presencia-en-la-vida-cotidiana.pdf' }
    ]
  },
  'Arcoiris': {
    icon: 'üåà', color: '#7b4fa6',
    pdfs: [
      { name: 'TCT-I ‚Äî Puerta Blanca', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-I-PUERTA-BLANCA.pdf' },
      { name: 'TCT-II ‚Äî Puerta Roja', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-II-PUERTA-ROJA.pdf' },
      { name: 'TCT-III ‚Äî Puerta Azul', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-III-PUERTA-AZUL.pdf' },
      { name: 'TCT-IV ‚Äî Anexos', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-IV-PUERTA-ANEXOS.pdf' },
      { name: 'El Ser Consciente ‚Äî M√°s all√° de la acci√≥n', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/El-Ser-Consciente-Mas-alla-de-la-accion-Vivir-con-presencia-en-la-vida-cotidiana.pdf' },
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/El-deportista-consciente-Mas-alla-del-resultado.pdf' }
    ]
  },
  'Oro': {
    icon: '‚ú®', color: '#b89558',
    pdfs: [
      { name: 'TCT-I ‚Äî Puerta Blanca', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-I-PUERTA-BLANCA.pdf' },
      { name: 'TCT-II ‚Äî Puerta Roja', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-II-PUERTA-ROJA.pdf' },
      { name: 'TCT-III ‚Äî Puerta Azul', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-III-PUERTA-AZUL.pdf' },
      { name: 'TCT-IV ‚Äî Anexos', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/TCT-IV-PUERTA-ANEXOS.pdf' },
      { name: 'El Ser Consciente ‚Äî M√°s all√° de la acci√≥n', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/El-Ser-Consciente-Mas-alla-de-la-accion-Vivir-con-presencia-en-la-vida-cotidiana.pdf' },
      { name: 'El Deportista Consciente ‚Äî M√°s all√° del resultado', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ARCOIRIS/El-deportista-consciente-Mas-alla-del-resultado.pdf' },
      { name: 'Presentaci√≥n PDL ‚Äî Arte y Espiritualidad', url: 'https://jtwbbyjspanirbsuoipa.supabase.co/storage/v1/object/public/materiales/PUERTA%20ORO/PRESENTACION-PDL-ARTE-Y-ESPIRITUALIDAD.pdf' }
    ]
  }
};

var _pdfViewerOpen = {};

function renderMateriales() {
  var puertaActual = currentWeek <= 12 ? 'Blanca' : currentWeek <= 24 ? 'Roja' : currentWeek <= 36 ? 'Azul' : 'Arcoiris';
  var puertas = ['Blanca','Roja','Azul','Arcoiris','Oro'];
  var html = '';
  puertas.forEach(function(p) {
    var m = MATERIALES[p];
    var pdfsHtml = m.pdfs.map(function(pdf, i) {
      var id = 'pdf-' + p + '-' + i;
      var shortName = pdf.name.length > 50 ? pdf.name.substring(0,48)+'‚Ä¶' : pdf.name;
      return '<div class="pdf-card">' +
        '<div class="pdf-card-header" onclick="togglePdfViewer(\'' + id + '\')">' +
          '<div class="pdf-icon">üìÑ</div>' +
          '<div class="pdf-info"><div class="pdf-name">' + shortName + '</div><div class="pdf-meta">PDF ¬∑ Haz clic para ver</div></div>' +
          '<div class="pdf-actions">' +
            '<button class="btn-pdf-view" onclick="event.stopPropagation();togglePdfViewer(\'' + id + '\')">üëÅ Ver</button>' +
            '<a class="btn-pdf-dl" href="' + pdf.url + '" download target="_blank" onclick="event.stopPropagation()">‚¨á Descargar</a>' +
          '</div>' +
        '</div>' +
        '<div class="pdf-viewer-wrap" id="' + id + '">' +
          '<div class="pdf-viewer-bar"><span>' + pdf.name + '</span><button class="btn-pdf-close" onclick="togglePdfViewer(\'' + id + '\')">‚úï</button></div>' +
          '<iframe src="" data-src="' + pdf.url + '" loading="lazy"></iframe>' +
        '</div>' +
      '</div>';
    }).join('');
    html += '<div class="materiales-puerta">' +
      '<div class="materiales-puerta-title" style="color:' + m.color + '">' +
        '<span style="font-size:22px">' + m.icon + '</span> Puerta ' + p +
      '</div>' +
      pdfsHtml +
    '</div>';
  });
  document.getElementById('materiales-content').innerHTML = html;
}

function togglePdfViewer(id) {
  // Find the iframe data-src from the inline viewer (kept in DOM but hidden)
  var wrap = document.getElementById(id);
  var iframe = wrap ? wrap.querySelector('iframe') : null;
  var url = iframe ? iframe.getAttribute('data-src') : null;
  // Find name from the card
  var card = wrap ? wrap.closest('.pdf-card') : null;
  var name = card ? card.querySelector('.pdf-name').textContent : 'Documento PDF';
  if (url) openPdfFullscreen(url, name);
}

function openPdfFullscreen(url, name) {
  document.getElementById('pdf-fullscreen-name').textContent = name;
  document.getElementById('pdf-fullscreen-frame').src = url;
  document.getElementById('pdf-fullscreen-dl').href = url;
  document.getElementById('pdf-fullscreen-modal').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closePdfFullscreen() {
  document.getElementById('pdf-fullscreen-modal').classList.remove('open');
  document.getElementById('pdf-fullscreen-frame').src = '';
  document.body.style.overflow = '';
}

// Close on Escape key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') closePdfFullscreen();
});

// ‚îÄ‚îÄ MULTIMEDIA ‚îÄ‚îÄ
function renderMedia() {
  const items = [
    {icon:'üéµ',title:'Cuencos Tibetanos ‚Äî Fundamentos',cat:'Cuencos',dur:'32 min',bg:'#f5f2ec'},
    {icon:'üå∏',title:'Canalizaci√≥n Marga ‚Äî Puerta Blanca',cat:'Canalizaci√≥n',dur:'18 min',bg:'#fdf0ee'},
    {icon:'üßò',title:'Meditaci√≥n de Presencia Corporal',cat:'Meditaci√≥n',dur:'15 min',bg:'#eef3fb'},
    {icon:'üåø',title:'Frecuencia 432Hz ‚Äî Armon√≠a Natural',cat:'Frecuencia',dur:'40 min',bg:'#f5f2ec'},
    {icon:'üî•',title:'Cuencos ‚Äî Nivel Terap√©utico',cat:'Cuencos',dur:'45 min',bg:'#fdf0ee'},
    {icon:'üí´',title:'UCDM ‚Äî Introducci√≥n al Perd√≥n',cat:'Teor√≠a',dur:'28 min',bg:'#fdf6ec'},
    {icon:'üîµ',title:'Dzogchen ‚Äî Introducci√≥n a Rigpa',cat:'Teor√≠a',dur:'35 min',bg:'#eef3fb'},
    {icon:'‚ú®',title:'Frecuencia 963Hz ‚Äî La Luz',cat:'Frecuencia',dur:'48 min',bg:'#eef3fb'},
  ];
  const grid = document.getElementById('media-grid');
  if (!grid) return;
  grid.innerHTML = items.map(function(m){
    return '<div style="background:white;border-radius:14px;overflow:hidden;border:1px solid #e4ddd3;cursor:pointer;transition:transform .2s,box-shadow .2s" onmouseover="this.style.transform=\'translateY(-3px)\';this.style.boxShadow=\'0 8px 24px rgba(0,0,0,.08)\'" onmouseout="this.style.transform=\'\';this.style.boxShadow=\'\'" onclick="toast(\'Reproduciendo: ' + m.title + ' üéµ\')">' +
      '<div style="background:' + m.bg + ';height:100px;display:flex;align-items:center;justify-content:center;font-size:36px">' + m.icon + '</div>' +
      '<div style="padding:14px 16px"><div style="font-size:10px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">' + m.cat + ' ¬∑ ' + m.dur + '</div>' +
      '<div style="font-size:13px;font-weight:500;color:#1c1814;line-height:1.4">' + m.title + '</div></div></div>';
  }).join('');
}

// ‚îÄ‚îÄ PROGRESO ‚îÄ‚îÄ
function renderProgreso() {
  const puertas = [
    {name:'Blanca',icon:'üåø',color:'#b8ad9e',weeks:[1,2,3,4,5,6,7,8,9,10,11,12]},
    {name:'Roja',icon:'üî•',color:'#bf4637',weeks:[13,14,15,16,17,18,19,20,21,22,23,24]},
    {name:'Azul',icon:'üîµ',color:'#2c5f9e',weeks:[25,26,27,28,29,30,31,32,33,34,35,36]},
    {name:'Arcoiris',icon:'üåà',color:'#7b4fa6',weeks:[37,38,39,40,41,42,43,44,45,46,47,48]},
  ];
  document.getElementById('progreso-list').innerHTML = puertas.map(function(p){
    const done = p.weeks.filter(function(w){ return completedWeeks.includes(w); }).length;
    const pct = Math.round((done/12)*100);
    return '<div style="background:white;border-radius:14px;padding:20px;margin-bottom:16px;border:1px solid #e4ddd3">' +
      '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">' +
      '<div style="display:flex;align-items:center;gap:10px"><span style="font-size:22px">' + p.icon + '</span>' +
      '<div><div style="font-weight:600;font-size:15px">Puerta ' + p.name + '</div>' +
      '<div style="font-size:12px;color:#7a7168">' + done + ' de 12 semanas completadas</div></div></div>' +
      '<div style="font-family:\'Cormorant Garamond\',serif;font-size:32px;font-weight:300">' + pct + '%</div></div>' +
      '<div style="background:#f0ece4;border-radius:100px;height:6px;overflow:hidden">' +
      '<div style="background:' + p.color + ';height:100%;width:' + pct + '%;border-radius:100px;transition:width .5s"></div></div>' +
      '</div>';
  }).join('');
}

// ‚îÄ‚îÄ STRIPE ‚îÄ‚îÄ
async function handlePurchase(planId) {
  if (!user) { goTo('auth'); return; }
  toast('Preparando pago...');
  try {
    const { data: { session } } = await sb.auth.getSession();
    const res = await fetch('https://jtwbbyjspanirbsuoipa.supabase.co/functions/v1/create-checkout', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + session.access_token },
      body: JSON.stringify({ plan_id: planId, success_url: location.href + '?paid=ok', cancel_url: location.href })
    });
    const d = await res.json();
    if (d.checkout_url) window.location.href = d.checkout_url;
    else toast('Error: ' + (d.error || 'Int√©ntalo de nuevo'));
  } catch(e) {
    toast('Configura Stripe para activar pagos');
  }
}

// Check stripe return
(function(){
  const p = new URLSearchParams(location.search);
  if (p.get('paid') === 'ok') setTimeout(function(){ toast('Pago completado! Acceso activado üéâ'); }, 500);
})();

// ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ
function toast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  setTimeout(function(){ el.classList.remove('show'); }, 3000);
}

var WD = {};
WD[1]={m:'Esta semana exploramos el estado de "sue√±o en movimiento" en el que vive la mayor√≠a de la gente, un estado de acci√≥n constante pero sin presencia real. Analizamos c√≥mo esta forma de vida conduce a la fragmentaci√≥n del yo, donde la identidad se construye alrededor de roles y funciones, y el "hacer" sustituye al "ser".',c:[['El Sue√±o en Movimiento','Actuar de forma autom√°tica, con la mente saltando de una cosa a otra, perdiendo la experiencia directa.'],['La Fragmentaci√≥n del Yo','La divisi√≥n interna en m√∫ltiples "yoes" (el yo del trabajo, el yo social, etc.) y la creencia de que somos uno de esos roles.'],['El Cuerpo como Espejo','El cuerpo no miente. Tensiones, dolores y fatiga son a menudo reflejos de una desalineaci√≥n interna y una falta de presencia.'],['El Ego como Guardi√°n','El ego protege una identidad construida y fr√°gil. No hay que combatirlo, sino observarlo para que pierda su rigidez.']],et:'Primer Reconocimiento de la Presencia',eo:'Realizar una pausa consciente para reconocer la presencia que ya est√° aqu√≠, sin fabricarla.',er:'"El Deportista Consciente", Cap. 1.9.',ep:['En alg√∫n momento del d√≠a, detente por unos instantes. No intentes relajarte ni concentrarte.','Simplemente observa: la respiraci√≥n tal como es, las sensaciones del cuerpo, los pensamientos que aparecen y se van.','Reconoce, sin buscarlo, que hay una  consciencia  que est√° percibiendo todo eso. No la analices.','Permanece unos segundos sin hacer nada con ello. Un instante de presencia real transforma m√°s que horas de acci√≥n inconsciente.']};
WD[2]={m:'Exploramos el "instante despu√©s" del logro, ese momento de vac√≠o que revela que el resultado externo no puede sostener el sentido de la vida de forma duradera. Analizamos la espiral de la "b√∫squeda que no descansa" (logro ‚Üí alivio ‚Üí vac√≠o ‚Üí nueva b√∫squeda) y el cansancio del sentido que esto genera.',c:[['El Instante Despu√©s','El vac√≠o que sigue al √©xito y que ense√±a sobre la naturaleza impermanente de lo condicionado.'],['El Yo que Nunca se Sacia','La identidad construida sobre el "hacer" siempre necesita m√°s para sentirse completa.'],['Del Logro a la Presencia','El giro radical donde el sentido deja de buscarse en el resultado y comienza a encontrarse en la calidad de presencia de la acci√≥n'],['La Verdadera Competici√≥n','No es contra otros, sino contra nuestros propios automatismos y el olvido de la presencia.']],et:'Habitar la Acci√≥n sin Buscar Completarte',eo:'Realizar una acci√≥n importante desde la presencia, sin pedirle que defina tu identidad.',er:'"El Deportista Consciente", Cap. 2.12.',ep:['Antes de una acci√≥n importante del d√≠a (una reuni√≥n, una conversaci√≥n, una decisi√≥n), detente unos instantes.','Reconoce el deseo de hacerlo bien y, si aparece, el miedo a fallar.','Preg√∫ntate en silencio: "¬øPuedo estar plenamente aqu√≠, aunque el resultado sea incierto?".','Siente el cuerpo. Siente la respiraci√≥n.','Permite que la acci√≥n ocurra sin pedirle que te defina. Un solo gesto vivido desde la presencia vale m√°s que mil acciones hechas desde la carencia.']};
WD[3]={m:'Esta semana abordamos la ilusi√≥n de la separaci√≥n entre cuerpo, mente y consciencia. Comprendemos que no son partes que deban coordinarse, sino una sola realidad que se manifiesta de diferentes formas. Cuando esta unidad se fragmenta, el rendimiento se resiente y aparece el desgaste.',c:[['La Ilusi√≥n de la Separaci√≥n','Vivir fragmentados (pensar una cosa, sentir otra, hacer una tercera) es la fuente de gran parte del malestar cotidiano.'],['El Cuerpo como Expresi√≥n de la Totalidad','Cada gesto y postura manifiesta el estado interior completo. Escuchar el cuerpo es habitarlo.'],['La Mente como Herramienta, no como Tirana','El problema no es pensar, sino vivir dominados por el pensamiento, perdiendo la experiencia directa.'],['Consciencia','El Elemento Olvidado:  Es el espacio vivo en el que todo ocurre. Recordarla no a√±ade nada, sino que despierta la experiencia.']],et:'Habitar la Unidad en el Movimiento',eo:'Realizar una acci√≥n sencilla permitiendo que la unidad cuerpo-mente-consciencia se manifieste naturalmente.',er:'"El Ser Consciente", Cap. 3.7.',ep:['Elige una acci√≥n sencilla del d√≠a: caminar, escribir, lavar los platos.','Antes de empezar, siente el cuerpo completo, reconoce la respiraci√≥n y observa la mente sin intervenir.','Realiza la acci√≥n sin a√±adir nada. No busques hacerlo mejor, permite hacerlo presente.','Observa si la calidad del gesto cambia, si el cuerpo se organiza solo, si el esfuerzo disminuye.']};
WD[4]={m:'El ego no es un enemigo, es una estructura necesaria. El conflicto surge de la identificaci√≥n con √©l. Esta semana, aprendemos a observar el ego sin juicio, reconociendo sus patrones y miedos. La presi√≥n del d√≠a a d√≠a es un campo privilegiado para esta observaci√≥n, ya que hace visible lo que normalmente se oculta.',c:[['Identificaci√≥n','El Verdadero Problema:  Creer que somos nuestros pensamientos, emociones o historia personal. Esto vuelve la vida fr√°gil y defensi'],['El Ego y el Miedo','El ego vive del miedo (a fallar, a no ser reconocido, a perder el control), que a menudo se disfraza de autoexigencia o necesidad '],['El Ego bajo Presi√≥n','La presi√≥n no crea el ego, lo muestra. Por eso es un campo de observaci√≥n tan valioso.'],['El Ego Observado desde la Presencia','Cuando el ego es observado, pierde rigidez. Entre el impulso y la reacci√≥n aparece un espacio de libertad.']],et:'Observar el Patr√≥n sin Nombrarlo',eo:'Observar una reacci√≥n egoica despu√©s de que ocurra, sin juicio ni an√°lisis, para debilitar el automatismo.',er:'"El Ser Consciente", Cap. 4.7.',ep:['Despu√©s de una situaci√≥n que te haya activado (una discusi√≥n, una cr√≠tica, un conflicto), recuerda el momento.','Observa la reacci√≥n interna: la direcci√≥n de la energ√≠a, la necesidad que apareci√≥ (controlar, defenderte, retirarte).','No le pongas nombre. No intentes corregirlo. No lo justifiques.','Simplemente permite que la memoria de la reacci√≥n est√© ah√≠, sin convertirla en tu identidad. Lo que se observa sin juicio, pierde poder.']};
WD[5]={m:'Cambiamos la mirada sobre la emoci√≥n, el error y la presi√≥n. En lugar de verlos como obst√°culos a evitar o controlar, los reconocemos como manifestaciones naturales de la experiencia y como portales hacia una mayor presencia. El sufrimiento no nace de estas experiencias, sino de la forma en que nos relacionamos con ellas.',c:[['La Emoci√≥n como Energ√≠a en Movimiento','El problema no es sentir, sino identificarse. Cuando una emoci√≥n es reconocida sin interferencia, se completa y se disuelve.'],['El Error como Colapso de la Ilusi√≥n de Control','El error interrumpe la narrativa del control y abre una puerta a la presencia desnuda, si no se vive desde la culpa o la defensa.'],['No-Rechazo y Autoliberaci√≥n','Rechazar la experiencia la fija. Reconocerla sin lucha permite que se libere por s√≠ misma.']],et:'Reconocer y Auto-liberar la Emoci√≥n',eo:'Permitir que una emoci√≥n intensa se mueva y se disuelva sin interferencia mental.',er:'"El Ser Consciente", Cap. 5.7.',ep:['La pr√≥xima vez que aparezca una emoci√≥n intensa, detente un instante.','No la nombres ni la expliques. Simplemente siente su energ√≠a en el cuerpo. Observa d√≥nde se manifiesta.','Reconoce el espacio de consciencia en el que esa emoci√≥n est√° apareciendo.','No hagas nada con ella. Permite que se mueva, cambie o se disuelva por s√≠ sola.']};
WD[6]={m:'La vida cotidiana, con su repetici√≥n, es el espejo m√°s preciso de nuestra forma de estar en el mundo. El entrenamiento diario, ya sea f√≠sico, profesional o personal, se convierte en una pr√°ctica consciente. La disciplina deja de ser rigidez y se transforma en un compromiso con la presencia.',c:[['La Repetici√≥n como Espejo','Lo que hacemos cada d√≠a revela nuestros automatismos, resistencias y zonas de ausencia.'],['Entrenar sin Estar Presente','El "hacer mec√°nico" produce resultados, pero tambi√©n desgaste y desconexi√≥n.'],['La Disciplina Consciente','No es una imposici√≥n externa, sino una alineaci√≥n interna. No te obligas, te recuerdas.'],['El Cansancio como Se√±al','A menudo no indica falta de descanso, sino desconexi√≥n prolongada.']],et:'Entrenar como si Fuera la Primera Vez',eo:'Romper el automatismo en una actividad habitual a trav√©s de la atenci√≥n plena.',er:'"El Deportista Consciente", Cap. 7.7.',ep:['Elige una actividad habitual que suelas hacer en autom√°tico (conducir, ducharte, una tarea repetitiva del trabajo).','Durante un d√≠a, decide hacerla con una atenci√≥n deliberada.','Real√≠zala un poco m√°s despacio. Observa cada gesto, cada sensaci√≥n.','Permanece curioso, como si fuera la primera vez que lo haces. No busques cambiarla, solo obs√©rvala. La frescura no est√° en lo nuevo, sino en la atenci√≥n.']};
WD[7]={m:'Nadie vive ni despierta aislado. La consciencia es relacional. Nuestras relaciones (familia, equipo, trabajo) son el camino, no un obst√°culo. Cada persona influye en el "campo invisible" del grupo con su estado interno. La presencia no es solo un acto interior, es un acto relacional.',c:[['El Mito del Individuo Aislado','La vida siempre ocurre en relaci√≥n. Pensamientos y emociones se contagian y amplifican en el campo colectivo.'],['El Ego Colectivo','Grupos, familias e ideolog√≠as construyen identidades compartidas ("nosotros" vs. "ellos") que ofrecen seguridad pero tambi√©n rigid'],['La Comunicaci√≥n como Pr√°ctica de Consciencia','Escuchar sin preparar respuesta, permitir silencios, hablar desde lo verdadero. La comunicaci√≥n consciente busca contacto, no conv']],et:'Habitar el Campo Colectivo con Presencia',eo:'Observar tu influencia en el campo relacional y practicar la presencia no impositiva.',er:'"El Ser Consciente", Cap. 8.11.',ep:['En tu pr√≥xima interacci√≥n grupal (una reuni√≥n de trabajo, una cena familiar), toma un momento para observar el "clima" del encuentro.','Reconoce tu propio estado interno (¬øtensi√≥n, apertura, defensa?).','Nota c√≥mo tu estado influye en el ambiente y c√≥mo el ambiente influye en ti.','No intentes cambiar a nadie ni dirigir la situaci√≥n. Simplemente, elige estar presente. Escucha m√°s. Habla menos. La presencia es contagiosa cuando no intenta imponerse.']};
WD[8]={m:'El ser humano es un campo vibracional. El sonido act√∫a directamente sobre este campo, ordenando desde la vibraci√≥n lo que la mente no puede corregir. Los cuencos tibetanos son herramientas de armonizaci√≥n profunda que facilitan la descarga de tensiones y el reordenamiento natural del sistema.',c:[['El Sonido como V√≠a Directa a la Presencia','El sonido rompe la continuidad del di√°logo interno y devuelve la atenci√≥n al presente sin necesidad de interpretaci√≥n.'],['Vibraci√≥n y Coherencia','El sonido influye en la respiraci√≥n, el tono corporal y la regulaci√≥n emocional, restableciendo la coherencia del sistema nervioso'],['El Sonido como Pr√°ctica de No-Hacer','Escuchar profundamente es una forma de no-hacer. La mente deja de intervenir y la consciencia se ampl√≠a.']],et:'Equilibrar la Energ√≠a con Cuencos',eo:'Utilizar el sonido de un cuenco para armonizar el campo energ√©tico.',er:'"TCT Puerta Blanca-Roja", p√°g. 51.',ep:['Si√©ntate o t√∫mbate en una posici√≥n c√≥moda.','Toma un cuenco tibetano. Si no tienes, puedes usar una grabaci√≥n de alta calidad.','Percute o fricciona el cuenco suavemente. Cierra los ojos.','En lugar de "escuchar" con los o√≠dos, siente la vibraci√≥n en tu cuerpo. Imagina que el sonido lava y limpia tu campo energ√©tico.','Sigue el sonido hasta que se desvanezca por completo en el silencio. Permanece en ese silencio unos instantes.']};
WD[9]={m:'A veces, la herida no es personal, sino sist√©mica. Exploramos la "herida invisible" que se genera cuando un sistema (laboral, familiar, social) promete algo que no sostiene, creando una incoherencia que afecta a la identidad y la confianza del individuo.',c:[['La Promesa como Acto de Poder','Las promesas organizan la conducta, pero cuando no se sostienen en la realidad, generan p√©rdida de confianza.'],['La Herida Invisible','Sensaci√≥n persistente de no ser suficiente, miedo a fallar, desconfianza. La persona internaliza como culpa lo que es un fallo est'],['Transformar la Herida sin Negarla','Sanar no es borrar, es integrar. La herida reconocida puede volverse sensibilidad y comprensi√≥n.']],et:'Distinguir el Hecho de la Herida',eo:'Separar un evento objetivo de la interpretaci√≥n identitaria y la herida emocional que gener√≥.',er:'"El Deportista Consciente", Cap. 10.11.',ep:['Piensa en una situaci√≥n en la que te sentiste decepcionado o traicionado por un sistema o una persona.','Escribe, de la forma m√°s objetiva y concreta posible, el  hecho: qu√© se dijo, qu√© ocurri√≥. (Sin adjetivos, sin juicios, sin "porqu√©s").','A continuaci√≥n, escribe qu√© apareci√≥ en ti a partir de ese hecho: las  emociones  (rabia, tristeza), los  pensamientos  ("no soy v√°lido", "no se puede confiar en nadie"), las  reacciones corporales.','Observa la diferencia entre el hecho externo y tu reacci√≥n interna. Reconoce que la herida no es el hecho en s√≠, sino la historia que te cuentas sobre √©l. Esto crea un espacio para no identificarte con la herida.']};
WD[10]={m:'El l√≠mite (agotamiento, enfermedad, bloqueo) no es un fracaso, es una se√±al y una puerta. Interrumpe la inercia y obliga a detenerse. La pausa impuesta, si se acepta conscientemente, se transforma en una pr√°ctica de escucha profunda que reordena todo el sistema.',c:[['El L√≠mite como Interrupci√≥n del Automatismo','Detiene lo que no pod√≠a detenerse voluntariamente.'],['Cuando el Cuerpo Toma la Palabra','La lesi√≥n o enfermedad no es castigo, es comunicaci√≥n. Expresa lo que la mente no ha querido escuchar.'],['La Pausa como Pr√°ctica Consciente','La pausa no es tiempo perdido, es espacio para sentir, escuchar y reorganizar.'],['Volver sin Regresar al Mismo Lugar','Tras un l√≠mite, no se vuelve al punto anterior. Se vuelve distinto. El l√≠mite transforma.']],et:'Escuchar el L√≠mite sin Intentar Corregirlo',eo:'Practicar la aceptaci√≥n y la escucha frente a una limitaci√≥n f√≠sica o mental.',er:'"El Ser Consciente", Cap. 11.8.',ep:['Busca un momento de quietud. Lleva la atenci√≥n al cuerpo o a la zona donde sientas el l√≠mite (un dolor, cansancio, bloqueo mental).','No intentes cambiar nada. No lo analices. No luches contra la sensaci√≥n.','En lugar de eso, "esc√∫chala". Pregunta internamente: "¬øQu√© est√° pidiendo ser escuchado aqu√≠?".','Permanece con la sensaci√≥n, ofreci√©ndole un espacio de presencia sin juicio. Escuchar es ya una forma de cuidado.']};
WD[11]={m:'El camino aut√©ntico conduce m√°s all√° del resultado. El resultado es una experiencia, no una identidad. El sentido no se construye, se reconoce en la coherencia, en la presencia y en la simplicidad de estar. El "fracaso" se integra como parte del camino y el "√©xito" se vive sin apego.',c:[['El Resultado como Experiencia, no Identidad','Cuando el resultado define qui√©nes somos, la vida se vuelve fr√°gil. Cuando se vive como experiencia, informa, ense√±a y pasa.'],['El Sentido se Reconoce, no se Construye','Aparece cuando dejamos de huir de lo que est√° ocurriendo y vivimos desde la presencia.'],['El Legado Invisible','A menudo, el legado m√°s duradero no son los logros, sino la forma en que escuchamos, atravesamos la dificultad y ofrecimos presenc']],et:'Recordar sin Buscar',eo:'Experimentar la simplicidad de la presencia sin intenci√≥n de lograr o mejorar nada.',er:'"El Ser Consciente", Cap. 12.7.',ep:['No hagas nada especial. Si√©ntate o permanece de pie unos instantes.','Siente el cuerpo. La respiraci√≥n. El espacio que te rodea.','No busques un estado de presencia. No intentes comprender nada.','Simplemente permite que lo que ya est√° aqu√≠ se reconozca solo.','Reconoce que ya est√°s aqu√≠. Eso es suficiente.']};
WD[12]={m:'Esta semana la dedicamos a integrar los aprendizajes de la Puerta Blanca. Repasamos los conceptos clave: la diferencia entre acci√≥n mec√°nica y acci√≥n consciente, la observaci√≥n del ego sin identificaci√≥n, y el habitar el cuerpo como ancla de la presencia. El objetivo es consolidar la pr√°ctica de la "pausa consciente" como herramienta fundamental para la vida diaria. Reflexi√≥n Final de la Puerta Bl',c:[],et:'de Integraci√≥n: El D√≠a Consciente',eo:'Aplicar las herramientas de la Puerta Blanca de forma integrada a lo largo de un d√≠a.',er:'',ep:['Al Despertar:  Antes de levantarte, dedica un minuto a "habitar tu cuerpo". Siente el contacto con la cama, la respiraci√≥n, la energ√≠a presente.','Durante una Tarea Rutinaria:  Elige una tarea (ej. lavarte los dientes) y real√≠zala con plena atenci√≥n, como si fuera la primera vez (Ejercicio Semana 6).','En una Interacci√≥n Social:  Practica la escucha sin preparar respuesta (Ejercicio Semana 7). Observa tu campo emocional y el del grupo.','Cuando Surja una Emoci√≥n Fuerte:  Haz una pausa y reconoce la emoci√≥n en el cuerpo sin juzgarla (Ejercicio Semana 5).','Antes de Dormir:  Dedica un minuto a "recordar sin buscar" (Ejercicio Semana 11). Simplemente, reconoce que est√°s aqu√≠, concluyendo el d√≠a. Anota en un diario cualquier descubrimiento o dificultad. La clave no es la perfecci√≥n, sino la intenci√≥n de recordar. Puerta Roja: Purificaci√≥n (Semanas 13-24)']};
WD[13]={m:'La Puerta Roja se asocia con la "voz-energ√≠a", el centro energ√©tico de la garganta (chakra Vishuddha), simbolizado por la s√≠laba "A" y el color rojo. Comprendemos que todo es vibraci√≥n, sonido y frecuencia. Los bloqueos energ√©ticos, originados en el transgeneracional, el proyecto sentido o nuestra vida cronol√≥gica, se manifiestan como desequilibrios en nuestro campo energ√©tico antes de afectar al ',c:[['La Puerta de la Voz-Energ√≠a','El centro de la garganta como portal para la expresi√≥n y transformaci√≥n de la energ√≠a.'],['Vibraci√≥n, Sonido y Frecuencia','Entender que somos seres vibracionales y que el sonido es una herramienta poderosa para la armonizaci√≥n.'],['El Origen de los Bloqueos','Introducci√≥n a los conceptos de transgeneracional, proyecto sentido y bioshock como fuentes de desequilibrios energ√©ticos.'],['Un Sonido Relajado, una Mente Libre','La conexi√≥n directa entre nuestro estado vibracional interno y nuestra paz mental.']],et:'Sentir la Vibraci√≥n de la Voz',eo:'Conectar con el centro energ√©tico de la garganta a trav√©s de la propia voz.',er:'',ep:['Si√©ntate c√≥modamente con la espalda recta. Cierra los ojos y realiza tres respiraciones profundas.','Coloca suavemente las yemas de los dedos en tu garganta.','Toma una inhalaci√≥n profunda y, al exhalar, emite un sonido "Aaaaaaah" largo y sostenido, en un tono que te resulte c√≥modo y natural.','Conc√©ntrate en la vibraci√≥n que sientes bajo tus dedos. Siente c√≥mo el sonido se origina y se expande desde ese centro.','Repite varias veces, explorando diferentes tonos y vol√∫menes. Observa c√≥mo cambia la sensaci√≥n.','Finaliza permaneciendo en silencio, sintiendo la resonancia que queda en tu cuerpo.']};
WD[14]={m:'Los mantras son "tecnolog√≠as de la mente" dise√±adas para liberar la mente del pensamiento discursivo a trav√©s de la vibraci√≥n. Estudiamos la diferencia entre mantra y afirmaci√≥n, y exploramos mantras de diversas tradiciones (budista, cham√°nica, cabal√≠stica) como herramientas para elevar nuestra frecuencia vibratoria y enfocar la intenci√≥n.',c:[['Mantra','Del s√°nscrito "man" (mente) y "tra" (liberar). Sonidos que crean altas vibraciones para enfocar la mente y catalizar cambios.'],['Sonido Primordial (OM/A)','El sonido del cual emergen todas las dem√°s vibraciones. La s√≠laba "A" es fundamental en la Puerta Roja.'],['Mantras y Deidades','Muchos mantras son invocaciones que nos conectan con arquetipos o cualidades energ√©ticas espec√≠ficas (compasi√≥n, sanaci√≥n, prosper'],['Transmisi√≥n Energ√©tica','En algunas tradiciones, la plena activaci√≥n de un mantra requiere una transmisi√≥n de un maestro que ya lo ha realizado.']],et:'Meditaci√≥n con el Mantra "Om Mani Padme Hum"',eo:'Cultivar la compasi√≥n y purificar la mente a trav√©s del mantra de Avalokiteshvara.',er:'"TCT Puerta Blanca-Roja", p√°g. 111.',ep:['Si√©ntate en una postura de meditaci√≥n c√≥moda.','Comienza con unas respiraciones conscientes para calmar la mente.','Empieza a recitar el mantra "Om Mani Padme Hum", ya sea en voz alta o mentalmente.','Mientras lo recitas, puedes visualizar una luz blanca y pura que emana de tu coraz√≥n y se expande, llenando todo tu ser y extendi√©ndose a todos los seres sintientes, dese√°ndoles paz y liberaci√≥n del sufrimiento.','No te preocupes por la pronunciaci√≥n perfecta. La intenci√≥n y la repetici√≥n son lo m√°s importante.']};
WD[15]={m:'Desde la cosmolog√≠a budista, exploramos los 6 Reinos o "Lokas" como representaciones de estados mentales dominados por una emoci√≥n espec√≠fica (orgullo, celos, deseo, ignorancia, apego, ira). Comprendemos que, aunque vivimos en el reino humano, transitamos por estos estados constantemente. La purificaci√≥n consiste en reconocer estas emociones en nosotros y, a trav√©s de la pr√°ctica, disminuir su pod',c:[['Samsara','El ciclo de existencia condicionada, caracterizado por el sufrimiento y la impermanencia.'],['Los 6 Reinos','Dioses (Orgullo), Semi-dioses (Celos), Humanos (Deseo), Animales (Ignorancia), Pretas/Esp√≠ritus hambrientos (Apego), Infiernos (Ir'],['La Preciada Vida Humana','El reino humano es el √∫nico desde el cual es posible alcanzar la iluminaci√≥n, ya que equilibra el placer y el sufrimiento, permiti'],['Purificaci√≥n de los Lokas','El objetivo no es eliminar los reinos, sino dejar de ser arrastrados por las emociones que los gobiernan.']],et:'Meditaci√≥n de los 6 Reinos con Soporte',eo:'Observar y comenzar a purificar la influencia de una de las emociones de los 6 reinos.',er:'"TCT Puerta Blanca-Roja", p√°g. 77-79.',ep:['Elige uno de los 6 reinos para trabajar durante esta sesi√≥n (ej. Reino de los Pretas - Apego).','Si√©ntate frente a una vela. Percute un cuenco tibetano tres veces y realiza tres respiraciones profundas.','Paso B (5 min):  Con los ojos abiertos, enfoca tu atenci√≥n en la llama de la vela. Deja que tu mente se calme.','Paso C (5 min):  Cierra los ojos. Dirige tu mirada interna hacia la localizaci√≥n corporal del reino elegido (Pretas: zona del abdomen/plexo solar). Respira hacia esa zona y simplemente observa la emoci√≥n del apego en tu vida. ¬øA qu√© te aferras? ¬øQu√© miedos surgen al pensar en soltar? Observa sin jui','Paso D (5 min):  Abre los ojos y vuelve a enfocar la atenci√≥n en la vela, pero ahora manteniendo la consciencia de lo que has observado en el paso C. Observa qu√© cambia en tu percepci√≥n.']};
WD[16]={m:'Profundizamos en las herramientas pr√°cticas del Cuarto Camino. El ser humano es una "m√°quina" que funciona con patrones autom√°ticos. El trabajo consiste en despertar de este automatismo a trav√©s de la "auto-observaci√≥n sin juicio" y el "recuerdo de s√≠".',c:[['La M√°quina Humana','Nuestros pensamientos, emociones y acciones son mayormente reacciones mec√°nicas a est√≠mulos internos y externos.'],['Auto-observaci√≥n sin Juicio','La pr√°ctica de observar nuestros patrones (posturas, gestos, tonos de voz, pensamientos recurrentes) sin intentar cambiarlos, just'],['Recuerdo de S√≠','El acto de ser consciente de uno mismo ("Yo soy") y de lo que se est√° haciendo al mismo tiempo. Es una atenci√≥n dividida que rompe'],['Choques Conscientes','Interrupciones deliberadas del automatismo para crear una "chispa" de consciencia (ej. cambiar de mano para hacer una tarea, hacer']],et:'Pausas de Consciencia',eo:'Introducir "choques conscientes" en la rutina diaria para romper el automatismo.',er:'Anexo VI de "TCT Puerta Azul", Semana 1.',ep:['Programa una alarma en tu tel√©fono para que suene 3 veces a lo largo del d√≠a en momentos inesperados.','Cuando suene la alarma, det√©n lo que est√°s haciendo por 30 segundos.','Preg√∫ntate: "¬øD√≥nde estoy? ¬øQu√© estoy haciendo? ¬øCu√°l es mi estado interno (pensamiento, emoci√≥n, sensaci√≥n corporal)?".','Observa sin juzgar. No necesitas cambiar nada.','Despu√©s de los 30 segundos, contin√∫a con tu actividad. El objetivo es simplemente crear una breve interrupci√≥n en el "sue√±o despierto".']};
WD[17]={m:'Gurdjieff describe al ser humano como un carruaje con tres centros principales: Intelectual (la mente pensante), Emocional (sentimientos y reacciones afectivas) y Motor-Instintivo (cuerpo y funciones autom√°ticas). Normalmente, estos centros trabajan de forma desequilibrada. El trabajo consiste en observarlos y armonizarlos.',c:[['Centro Intelectual','Su trabajo correcto es pensar, analizar y planificar. Su trabajo incorrecto es el parloteo mental incesante, la preocupaci√≥n y la '],['Centro Emocional','Su trabajo correcto es sentir emociones superiores (compasi√≥n, alegr√≠a). Su trabajo incorrecto es la reactividad de las emociones '],['Armonizaci√≥n de los Centros','La pr√°ctica de observar qu√© centro est√° activo en cada momento y evitar que un centro haga el trabajo de otro (ej. "pensar" una em']],et:'Transformaci√≥n Emocional',eo:'Observar una emoci√≥n negativa sin identificarse y negarse a expresarla mec√°nicamente.',er:'Anexo VI de "TCT Puerta Azul", Semana 6.',ep:['La pr√≥xima vez que sientas una emoci√≥n negativa (irritaci√≥n, impaciencia, tristeza), haz una pausa.','Reconoce  la emoci√≥n internamente: "Estoy sintiendo irritaci√≥n".','No te identifiques:  Recuerda que "t√∫" no eres la irritaci√≥n; eres la consciencia que la observa.','No la expreses mec√°nicamente:  Toma la decisi√≥n consciente de no actuar desde esa emoci√≥n (no levantar la voz, no hacer un gesto brusco).','Observa la energ√≠a:  Siente la energ√≠a de la emoci√≥n en tu cuerpo sin hacer nada con ella. Observa c√≥mo, al no ser alimentada por la reacci√≥n, pierde fuerza y se transforma.']};
WD[18]={m:'Iniciamos la integraci√≥n de Un Curso de Milagros. La felicidad, seg√∫n UCDM, no se encuentra en el mundo, que es una proyecci√≥n de nuestro pensamiento de separaci√≥n. La verdadera felicidad es nuestro estado natural en Dios, y se recupera deshaciendo la culpa a trav√©s del perd√≥n. El perd√≥n no es condonar un acto, sino reconocer que lo que cre√≠amos que nos hicieron nunca ocurri√≥ realmente en el nivel',c:[['La Paradoja de la Felicidad seg√∫n UCDM','Buscamos la felicidad donde no se puede encontrar (en el mundo de la percepci√≥n). La verdadera felicidad es un recuerdo de nuestra'],['El Perd√≥n como Clave de la Felicidad','El perd√≥n es la herramienta para liberar la mente de la culpa y el resentimiento, que son los √∫nicos obst√°culos para la paz.'],['Nivel 1','El Testigo Santo:  Invitar al Esp√≠ritu Santo a observar nuestros pensamientos de juicio y ataque sin condenarlos.'],['Nivel 2','El Perd√≥n como Camino Directo:  Aplicar la f√≥rmula del perd√≥n a cualquier situaci√≥n que nos perturbe la paz.']],et:'El Diario del Perd√≥n',eo:'Aplicar el proceso de perd√≥n de UCDM a una situaci√≥n espec√≠fica.',er:'Anexo V de "TCT Puerta Azul".',ep:['Elige una persona o situaci√≥n que te cause resentimiento o malestar.','Escribe en un diario: "Me siento [emoci√≥n] por [situaci√≥n/persona] porque creo que [juicio/ataque]".','Reconoce que estos pensamientos son del ego y te est√°n robando la paz.','Di (mental o en voz alta): "Esp√≠ritu Santo, veo esto de otra manera. Elijo la paz en lugar de este conflicto. Te entrego estos pensamientos de juicio para que sean corregidos".','Visualiza a la persona (y a ti mismo) envuelta en una luz sanadora, reconociendo la inocencia que ambos compart√≠s como Hijos de Dios.']};
WD[19]={m:'UCDM ense√±a que todo dolor emocional proviene de un pensamiento de ataque o separaci√≥n. La gesti√≥n emocional no consiste en analizar la emoci√≥n, sino en llevar el pensamiento que la caus√≥ a la correcci√≥n del Esp√≠ritu Santo. El "Instante Santo" es la pr√°ctica de retirar nuestra atenci√≥n del pasado y el futuro para abrir un momento presente al Amor de Dios.',c:[['El Proceso UCDM para Emociones','Cuando surge el dolor, reconocer que es una se√±al de que hemos elegido al ego como maestro. El √∫nico remedio es cambiar de maestro'],['Meditaci√≥n "El Instante Santo"','Una pr√°ctica para aquietar la mente y unirse al Esp√≠ritu Santo en el ahora, donde no hay problemas.'],['Elecci√≥n sobre Circunstancia','La clave de la felicidad constante es recordar que siempre podemos elegir la paz, sin importar las circunstancias externas.'],['Amor sobre Miedo','Cada momento es una elecci√≥n entre dos sistemas de pensamiento: el del ego (miedo) o el del Esp√≠ritu Santo (amor).']],et:'Meditaci√≥n "El Instante Santo"',eo:'Experimentar un momento de paz y conexi√≥n m√°s all√° del tiempo.',er:'Anexo V de "TCT Puerta Azul".',ep:['Busca un lugar tranquilo donde no te interrumpan por 5-10 minutos.','Cierra los ojos y di: "Tengo la voluntad de dejar a un lado todos mis problemas, planes y juicios por un momento. Deseo experimentar este Instante Santo contigo, Esp√≠ritu Santo".','No intentes vaciar tu mente. Simplemente, retira tu inter√©s de los pensamientos que surjan. D√©jalos pasar sin engancharte.','Enfoca tu atenci√≥n en la sensaci√≥n de paz o quietud que pueda surgir, por sutil que sea.','Descansa en este espacio, sabiendo que en este instante no te falta nada y est√°s perfectamente a salvo en el Amor de Dios.']};
WD[20]={m:'Volvemos a los protocolos de sonido, esta vez con una comprensi√≥n m√°s profunda de la energ√≠a emocional. El protocolo "Purificar la Rueda del Samsara" utiliza los cuencos tibetanos para trabajar directamente sobre los centros energ√©ticos asociados a los 6 Reinos, ayudando a liberar las emociones negativas estancadas.',c:[['Masaje Vibracional','El uso de cuencos directamente sobre el cuerpo o en su campo energ√©tico para inducir una relajaci√≥n profunda y un reequilibrio vib'],['Fase 1 (Percusi√≥n)','Utiliza golpes continuos para "despertar" y "romper" los bloqueos energ√©ticos en cada centro.'],['Fase 2 (Fricci√≥n)','Utiliza un sonido sostenido para "limpiar" y "armonizar" la energ√≠a liberada.'],['Intenci√≥n Consciente','El terapeuta y el receptor mantienen una intenci√≥n clara de purificaci√≥n durante toda la sesi√≥n.']],et:'Autotratamiento con un Cuenco',eo:'Utilizar un cuenco para limpiar el propio campo energ√©tico.',er:'Adaptado del protocolo "Rueda del Samsara".',ep:['Si√©ntate c√≥modamente. Coloca un cuenco tibetano en la palma de tu mano izquierda.','Comienza a friccionar el cuenco con la baqueta en tu mano derecha, generando un sonido continuo.','Lentamente, mueve el cuenco alrededor de tu cuerpo, a unos 10-15 cm de distancia. Comienza por la cabeza y desciende lentamente hacia los pies.','Presta especial atenci√≥n a las zonas donde sientas tensi√≥n o pesadez. Permanece en esas √°reas un poco m√°s, permitiendo que la vibraci√≥n disuelva el bloqueo.','Visualiza que cualquier energ√≠a densa se desprende de tu cuerpo y es absorbida por la tierra.','Termina colocando el cuenco sobre tu coraz√≥n y percuti√©ndolo suavemente tres veces.']};
WD[21]={m:'Integramos la sabidur√≠a de la C√°bala con el sonido. El "Pilar del Medio" es el eje energ√©tico central del √Årbol de la Vida, que corresponde a nuestra columna vertebral y a los chakras principales. Este protocolo utiliza cuencos afinados con notas espec√≠ficas para activar y equilibrar cada uno de los centros (Sefirot) de este pilar, promoviendo la alineaci√≥n entre el cielo y la tierra dentro de nos',c:[['El Pilar del Medio','El eje central de energ√≠a que conecta la consciencia c√≥smica (Keter) con la manifestaci√≥n terrenal (Malkuth).'],['Sefirot','Emanaciones o atributos divinos en el √Årbol de la Vida, que tambi√©n son centros de consciencia en el ser humano.'],['Correspondencia Nota-Centro','Cada Sefira del Pilar del Medio resuena con una nota musical espec√≠fica, que se utiliza para activarla.'],['Nombres de Poder','La recitaci√≥n de los nombres divinos asociados a cada Sefira potencia el efecto de la vibraci√≥n sonora.']],et:'Meditaci√≥n del Pilar del Medio',eo:'Activar y equilibrar el eje energ√©tico central a trav√©s de la visualizaci√≥n y el sonido (mantra).',er:'"TCT Puerta Blanca-Roja", p√°g. 135-137.',ep:['Ponte de pie, con los pies separados a la anchura de los hombros. Cierra los ojos.','Visualiza una esfera de luz blanca brillante por encima de tu cabeza (Keter). Vibra el nombre  "E-HE-IEH"  (pronunciado "Ejei√©"). Siente c√≥mo la luz desciende a tu cabeza.','Visualiza la luz descendiendo hasta tu garganta (Daat). Vibra el nombre  "YEHOVA-ELOHIM".','Visualiza la luz descendiendo a tu coraz√≥n (Tiferet). Vibra el nombre  "YEHOVA-ELOAH-VA-DAATH". Siente c√≥mo la luz se expande desde tu coraz√≥n.','Visualiza la luz descendiendo a tu zona genital/base de la columna (Yesod). Vibra el nombre  "SHADDAI-EL-CHAI".']};
WD[22]={m:'La Cruz Cabal√≠stica es un ritual que establece un espacio sagrado y equilibra el microcosmos (el ser humano) con el macrocosmos (el universo). A trav√©s de la visualizaci√≥n de la luz y la vibraci√≥n de nombres de poder, se traza una cruz de luz en el campo energ√©tico, anclando las energ√≠as divinas y creando un centro de poder y equilibrio.',c:[['ATAH (A Ti)','Se traza la luz desde arriba hasta el pecho, reconociendo la Fuente Divina.'],['MALKUTH (El Reino)','Se baja la luz hasta los pies, anclando la divinidad en la tierra.'],['VE-GEVURAH (Y el Poder)','Se traza la luz hasta el hombro derecho, invocando la fuerza y el rigor.'],['VE-GEDULAH (Y la Gloria)','Se traza la luz hasta el hombro izquierdo, invocando la misericordia y la expansi√≥n.']],et:'Realizar la Cruz Cabal√≠stica',eo:'Centrar y proteger el campo energ√©tico.',er:'"TCT Puerta Blanca-Roja", p√°g. 138-140.',ep:['Ponte de pie mirando al Este. Realiza varias respiraciones profundas.','Visualiza una luz brillante sobre tu cabeza. Con tu dedo √≠ndice derecho, toca tu frente y vibra  "ATAH".','Baja la mano hasta tu pecho, visualizando el rayo de luz descendiendo. Vibra  "MALKUTH".','Toca tu hombro derecho, visualizando un rayo de luz desde el centro del pecho. Vibra  "VE-GEVURAH".','Toca tu hombro izquierdo, visualizando el rayo de luz cruzando tu pecho. Vibra  "VE-GEDULAH".']};
WD[23]={m:'Sintetizamos los aprendizajes de las Puertas Blanca y Roja en la "F√≥rmula Esencial de la Felicidad". La felicidad no es una meta, sino la resonancia de un ser en equilibrio. Esta semana nos enfocamos en los dos primeros componentes: Aceptaci√≥n (el fruto de la Puerta Blanca) y Prop√≥sito (el fruto de la Puerta Roja).',c:[['Aceptaci√≥n','Es la cimentaci√≥n f√≠sica y la presencia en el ahora. Es la paz que surge de aceptar lo que es, sin resistencia. Es el resultado de'],['Prop√≥sito','Es la purificaci√≥n de la energ√≠a y la acci√≥n consciente. Surge cuando nuestra energ√≠a emocional ya no est√° atrapada en el pasado (']],et:'Clarificando el Prop√≥sito',eo:'Conectar con un sentido de prop√≥sito que vaya m√°s all√° de las metas del ego.',er:'',ep:['Dedica 15 minutos a una escritura reflexiva.','Preg√∫ntate: "Si el miedo y la necesidad de aprobaci√≥n no fueran un factor, ¬øa qu√© dedicar√≠a mi energ√≠a?".','Escribe sobre las actividades que te hacen sentir vivo, conectado y expansivo.','Reflexiona: "¬øC√≥mo puedo traer m√°s de esta energ√≠a a mi vida diaria, incluso en peque√±os actos?".','El prop√≥sito no tiene que ser una gran misi√≥n. Puede ser tan simple como "ser un espacio de paz para los dem√°s" o "crear belleza en mi entorno".']};
WD[24]={m:'Esta semana consolidamos las pr√°cticas de purificaci√≥n emocional. Repasamos la transformaci√≥n de las emociones a trav√©s de la observaci√≥n (Cuarto Camino), el perd√≥n (UCDM) y la vibraci√≥n (Sonido). El objetivo es desarrollar una maestr√≠a emocional que no se basa en el control, sino en la capacidad de permitir que la energ√≠a fluya sin que nos secuestre. Reflexi√≥n Final de la Puerta Roja: La purifica',c:[],et:'de Integraci√≥n: El Alquimista Emocional',eo:'Utilizar una herramienta diferente para cada tipo de perturbaci√≥n emocional.',er:'',ep:['Para la Irritaci√≥n o la Ira (Cuarto Camino):  La pr√≥xima vez que te sientas irritado, practica la "no-expresi√≥n mec√°nica". Reconoce la energ√≠a, pero elige no actuarla. Obs√©rvala hasta que se transforme.','Para el Resentimiento o la Culpa (UCDM):  Si un pensamiento sobre el pasado te perturba, realiza el "Diario del Perd√≥n". Entrega el juicio al Esp√≠ritu Santo y elige la paz.','Para la Ansiedad o el Estr√©s General (Sonido):  Cuando te sientas abrumado, dedica 5 minutos a escuchar un cuenco tibetano o a cantar un mantra (como "OM"). Permite que la vibraci√≥n re-sintonice tu sistema nervioso. La pr√°ctica consiste en reconocer qu√© herramienta es m√°s adecuada para cada momento,']};
WD[25]={m:'La Puerta Azul corresponde al centro del coraz√≥n, simbolizado por la s√≠laba "HUM" y el color azul. Aqu√≠, "mente" no se refiere a la mente ordinaria (pensamientos, intelecto), sino a la naturaleza real de la mente: un estado que nunca fue creado, que est√° m√°s all√° de todas las creencias y filosof√≠as. El objetivo es aprender a "estar relajado y reposar en nuestra condici√≥n natural".',c:[['La Puerta de la Mente (Coraz√≥n)','El centro del coraz√≥n como sede de la mente no-dual o Rigpa.'],['Visi√≥n Dualista vs. Visi√≥n Total 360¬∞','Pasar de una percepci√≥n unidireccional (sujeto-objeto) a una visi√≥n panor√°mica y no-dual donde todo est√° interconectado.'],['Ma-rigpa vs. Rigpa','Ma-rigpa es la ignorancia o el no-reconocimiento de nuestra verdadera condici√≥n. Rigpa es el conocimiento directo, la sabidur√≠a pr'],['Visi√≥n Circular','Todos los conceptos y pr√°cticas de las tres puertas est√°n interconectados. La Puerta Azul integra y culmina las dos anteriores.']],et:'La Pregunta "¬øQui√©n Soy?"',eo:'Utilizar la autoindagaci√≥n para ir m√°s all√° de las identificaciones superficiales.',er:'"TCT Puerta Azul Anexos", p√°g. 99.',ep:['Si√©ntate en silencio por unos minutos.','Preg√∫ntate internamente: "¬øQui√©n soy yo?".','Observa las respuestas que surgen autom√°ticamente: "Soy [tu nombre]", "Soy [tu profesi√≥n]", "Soy un padre/madre", "Soy mis pensamientos", "Soy mis emociones".','A cada respuesta, reconoce: "Tengo este rol/pensamiento/cuerpo, pero no soy solo esto".','Contin√∫a preguntando: "¬øQui√©n soy yo m√°s all√° de todo eso? ¬øQui√©n es el que observa todo esto?".']};
WD[26]={m:'Para comprender la naturaleza de la mente, primero debemos entender c√≥mo la hemos conceptualizado. Esta semana exploramos diferentes perspectivas sobre la mente: desde la psicolog√≠a convencional y transpersonal hasta las visiones radicales del hinduismo y los fil√≥sofos Jiddu y U.G. Krishnamurti. Esto nos ayuda a ver que nuestras ideas sobre la mente son construcciones, no la realidad √∫ltima.',c:[['Psicolog√≠a Convencional','La mente como producto del cerebro, un conjunto de procesos cognitivos (percepci√≥n, memoria, pensamiento).'],['Psicolog√≠a Transpersonal','La mente como algo que trasciende el ego, con niveles pre-egoicos, egoicos y transpersonales.'],['Hinduismo','La mente con sus diferentes niveles (Manas, Buddhi, Ahamkara, Chitta) que deben ser purificados para realizar el Atman (el verdade'],['Jiddu Krishnamurti','La mente est√° condicionada por el pasado. El verdadero problema es la mente misma, no los problemas que crea. Buscar la verdad a t']],et:'Observando el Condicionamiento',eo:'Tomar consciencia de c√≥mo la mente est√° condicionada por el pasado.',er:'',ep:['Elige una opini√≥n o creencia fuerte que tengas (pol√≠tica, social, personal).','Si√©ntate en silencio y rastrea el origen de esa creencia. ¬øDe d√≥nde vino? ¬øLa aprendiste de tu familia, de la escuela, de la cultura?','Observa las emociones que est√°n asociadas a esa creencia. ¬øQu√© sientes cuando alguien la desaf√≠a?','Preg√∫ntate: "¬øQui√©n ser√≠a yo sin esta creencia?".','El objetivo no es cambiar la creencia, sino ver que es algo adquirido, una construcci√≥n del pasado, no una verdad absoluta sobre qui√©n eres.']};
WD[27]={m:'El Dzogchen ofrece una visi√≥n radical: la mente en su estado natural (Rigpa) es ya pura, l√∫cida y libre. No es algo que se deba crear o alcanzar, sino reconocer. La "mente ordinaria" no es la mente conceptual y ocupada, sino este estado primordial que est√° siempre presente, como un cielo claro detr√°s de las nubes de pensamientos y emociones.',c:[['Mente Ordinaria/Natural (Rigpa)','La conciencia primordial, pura, luminosa, espont√°nea y no-conceptual. Es innata e inmutable.'],['Obst√°culos a la Mente Natural','Los conceptos, las emociones negativas y los apegos oscurecen el reconocimiento de Rigpa, pero no pueden manchar su naturaleza.'],['La Iluminaci√≥n como Reconocimiento','La iluminaci√≥n no es un estado futuro, sino la realizaci√≥n de nuestra verdadera naturaleza, que es la mente natural, aqu√≠ y ahora.']],et:'Descansar en la Conciencia',eo:'Tener un atisbo de la mente natural m√°s all√° de los pensamientos.',er:'Adaptado de las ense√±anzas de Dzogchen.',ep:['Si√©ntate c√≥modamente y cierra los ojos.','Permite que tus pensamientos vengan y vayan sin prestarles atenci√≥n. No los sigas, no los rechaces.','Lleva tu atenci√≥n no a los pensamientos, sino al  espacio  en el que los pensamientos aparecen.','Date cuenta de que hay una conciencia silenciosa y espaciosa que es consciente de los pensamientos, pero que no es los pensamientos.','Descansa en esa conciencia abierta y receptiva. No intentes "hacer" nada. Simplemente, s√© esa conciencia que observa.']};
WD[28]={m:'La met√°fora del espejo es central en el Dzogchen para explicar la naturaleza de la mente. La mente natural es como un espejo: claro, puro y capaz de reflejar cualquier cosa sin ser afectado por los reflejos. Los pensamientos, emociones y percepciones son los reflejos. El error (ma-rigpa) es olvidarse de que somos el espejo e identificarnos con los reflejos.',c:[['El Espejo','Representa la mente natural, pura e inmutable.'],['Los Reflejos','Simbolizan los pensamientos, emociones y percepciones, que son impermanentes y cambiantes.'],['La Pr√°ctica','Consiste en "limpiar el espejo" (eliminar los oscurecimientos de la ignorancia y el apego) para reconocer su claridad inherente.'],['Beneficios','Comprender esta analog√≠a nos ayuda a observar nuestros pensamientos sin identificarnos con ellos, reduciendo el sufrimiento.']],et:'Ser el Espejo',eo:'Experimentar la des-identificaci√≥n de los pensamientos usando la met√°fora del espejo.',er:'',ep:['Si√©ntate en meditaci√≥n.','Visualiza tu mente como un espejo perfectamente limpio y brillante.','Observa c√≥mo los pensamientos, las im√°genes y las sensaciones aparecen como reflejos en la superficie del espejo.','Nota que el espejo no juzga los reflejos. No se aferra a los "buenos" ni rechaza los "malos". Simplemente, refleja.','Cuando aparezca un pensamiento, n√≥mbralo internamente como "reflejo" y d√©jalo pasar.','Identif√≠cate con el espejo, no con los reflejos. Siente la cualidad de calma, claridad e imperturbabilidad del espejo mismo.']};
WD[29]={m:'Llevamos los principios de UCDM a su nivel m√°s profundo. El "Testigo Santo" es la perspectiva del Esp√≠ritu Santo en nuestra mente, que observa el mundo del ego sin juicio y con compasi√≥n. El objetivo final es trascender la observaci√≥n y recordar nuestra Unidad con Dios y con toda la Creaci√≥n. La felicidad no es aceptar "lo que es" en el mundo de la ilusi√≥n, sino recordar "lo que siempre ha sido" e',c:[['Nivel 3','Unidad (Recordar Qui√©n Soy):  Trascender la dualidad de observador y observado. La pr√°ctica es descansar en la afirmaci√≥n "Soy tal'],['Correcci√≥n de Distorsiones','UCDM corrige las distorsiones cognitivas no reemplazando un pensamiento por otro, sino reconociendo que solo el Amor es real.'],['Meditaci√≥n "Solo el Amor es Real"','Una pr√°ctica para retirar la creencia en la realidad del miedo, el ataque y el sufrimiento.'],['Unidad sobre Separaci√≥n','La clave de la maestr√≠a es aplicar consistentemente el principio de que la separaci√≥n es una ilusi√≥n y que solo la unidad es verda']],et:'Meditaci√≥n "Solo el Amor es Real"',eo:'Retirar la fe en el sistema de pensamiento del ego y descansar en la certeza del Amor.',er:'Anexo V de "TCT Puerta Azul".',ep:['Si√©ntate en silencio y trae a la mente una situaci√≥n de miedo o conflicto.','Observa los pensamientos y emociones asociados a ella.','Ahora, afirma con convicci√≥n: "Esto no es real. Es una sombra del pasado. Solo el Amor es real".','Visualiza una luz dorada que representa el Amor de Dios disolviendo la situaci√≥n de miedo.','Repite la lecci√≥n de UCDM: "Puedo elegir la paz en lugar de esto".','Descansa en la sensaci√≥n de paz que surge al soltar la creencia en el miedo.']};
WD[30]={m:'Esta semana nos sumergimos en la esencia del libro "El Ser Consciente". La verdadera pr√°ctica espiritual no ocurre en el retiro, sino en medio de la vida real: en el trabajo, en las relaciones, en la dificultad. La presencia no es algo que se a√±ade, sino que se recuerda. El objetivo es habitar la vida sin huir de ella ni idealizarla, encontrando el despertar en lo ordinario.',c:[['Presencia en la Acci√≥n','El sentido se encuentra en la calidad de presencia con la que se vive cada acci√≥n, no en el resultado.'],['Flow y Acci√≥n sin Esfuerzo','Cuando dejamos de interferir con el control mental, la acci√≥n se ordena sola y surge desde una inteligencia m√°s profunda.'],['El Esfuerzo como Se√±al de Desalineaci√≥n','El esfuerzo psicol√≥gico excesivo es una se√±al de lucha interna y olvido de la presencia.'],['La Vida como Pr√°ctica Consciente','Cada gesto, conversaci√≥n y decisi√≥n es una oportunidad para recordar.']],et:'Una Sola Cosa a la Vez',eo:'Combatir la multitarea y la fragmentaci√≥n de la atenci√≥n, cultivando la presencia en una sola acci√≥n.',er:'Anexo II de "El Ser Consciente".',ep:['Elige una actividad para los pr√≥ximos 15 minutos (responder un correo, leer un informe, preparar una comida).','Comprom√©tete a hacer  solo eso  durante ese tiempo.','Si tu mente divaga o sientes el impulso de hacer otra cosa (revisar el tel√©fono, pensar en la siguiente tarea), n√≥talo amablemente y trae tu atenci√≥n de vuelta a la √∫nica tarea presente.','No lo hagas con tensi√≥n, sino con una elecci√≥n calmada y deliberada.','Observa c√≥mo la simplicidad de hacer una sola cosa ordena la mente y profundiza la calidad de la acci√≥n.']};
WD[31]={m:'Aplicamos los protocolos de sonido m√°s avanzados para la Puerta Azul. El "Masaje Vibracional de Desintoxicaci√≥n" es un protocolo exhaustivo para limpiar el cuerpo f√≠sico y energ√©tico a trav√©s de la percusi√≥n y fricci√≥n sistem√°tica. El "Masaje para Despertar la Memoria Ancestral" utiliza notas y mantras espec√≠ficos para conectar con la sabidur√≠a profunda que reside en nuestro ADN espiritual.',c:[['Desintoxicaci√≥n Vibracional','El sonido como medio para liberar toxinas f√≠sicas y energ√©ticas acumuladas en los tejidos y el campo √°urico.'],['Memoria Ancestral','La idea de que llevamos en nosotros una sabidur√≠a innata y una conexi√≥n con nuestro linaje espiritual, que puede ser despertada a '],['Sincronizaci√≥n de Sonido y Mantra','La combinaci√≥n de la vibraci√≥n del cuenco con la recitaci√≥n interna de mantras ("Me Veo", "Me Reconozco", "Me Perdono", "Me Amo") ']],et:'Despertar la Memoria Ancestral (Adaptado)',eo:'Realizar una meditaci√≥n de autosanaci√≥n y conexi√≥n con la sabidur√≠a interna.',er:'"TCT Puerta Azul Anexos", p√°g. 80-83.',ep:['Si√©ntate o t√∫mbate. Coloca tus manos sobre tu coraz√≥n.','Respira profundamente y, con cada exhalaci√≥n, repite internamente el mantra:  "Me Veo". Siente que te ves a ti mismo con compasi√≥n.','Contin√∫a respirando y cambia el mantra a:  "Me Reconozco". Reconoce tu luz, tu fuerza y tu divinidad.','Cambia el mantra a:  "Me Perdono". Perd√≥nate por cualquier juicio o error, liberando toda culpa.','Finalmente, cambia el mantra a:  "Me Amo". Siente un amor incondicional que nace desde tu coraz√≥n y se expande por todo tu ser.']};
WD[32]={m:'Los objetos sagrados (cuencos, mandalas, cristales, estatuillas) act√∫an como puentes para conectar con estados superiores de conciencia. El Tagdrol ("liberaci√≥n a trav√©s del contacto") es un m√©todo del budismo tibetano que utiliza estos objetos como catalizadores para despertar recuerdos del alma y liberar bloqueos k√°rmicos. El poder no est√° en el objeto, sino en nuestra capacidad de resonar con l',c:[['Tagdrol','Liberaci√≥n a trav√©s del contacto, la visi√≥n o el sonido de objetos sagrados.'],['El Proceso de 5 Fases','Reconocimiento, Consagraci√≥n, Comunicaci√≥n Sagrada, Liberaci√≥n e Integraci√≥n.'],['Mecanismos de Sanaci√≥n','Los objetos act√∫an a nivel psicol√≥gico (proyecciones del inconsciente), energ√©tico (reequilibrio de chakras) y espiritual (reconex'],['Creaci√≥n de un Altar Personal','Un altar es un espacio f√≠sico dedicado a anclar nuestra intenci√≥n espiritual y a trabajar con nuestros objetos sagrados.']],et:'El Di√°logo con el Objeto Sagrado',eo:'Establecer una comunicaci√≥n intuitiva con un objeto personal para recibir gu√≠a.',er:'Anexo III de "TCT Puerta Azul", p√°g. 132.',ep:['Elige un objeto que tenga un significado especial para ti (un cristal, una joya, una foto, una figura).','Limpia energ√©ticamente el objeto (puedes pasarlo por el humo de incienso o salvia, o usar el sonido de un cuenco).','Si√©ntate en silencio, sost√©n el objeto en tus manos y cierra los ojos.','Sincroniza tu respiraci√≥n con el objeto, imaginando que inhalas su esencia y exhalas tu energ√≠a hacia √©l.','Pregunta mentalmente: "¬øQu√© mensaje tienes para m√≠ en este momento de mi vida?".']};
WD[33]={m:'El verdadero poder no es el control externo, sino la maestr√≠a interior que surge de la conexi√≥n con nuestra fuente. Esta fuerza se manifiesta como calma en el caos, decisiones claras y creatividad espont√°nea. Las pr√°cticas de esta semana se centran en disolver los obst√°culos (identificaci√≥n con el ego, creencias limitantes) y anclarnos en el poder del ahora.',c:[['Poder Aut√©ntico','No es dominio, sino maestr√≠a interior. Surge del autoconocimiento y la conciencia expandida.'],['Las Tres Fuentes del Poder','Presencia Consciente, Intuici√≥n Profunda y Coherencia Interna (alineaci√≥n de pensamiento, emoci√≥n y acci√≥n).'],['Anclaje en el Poder Presencial','Desarrollar una estabilidad interna que no depende de las circunstancias externas.']],et:'Expansi√≥n de Conciencia "El C√≠rculo del Yo Soy"',eo:'Experimentar la sensaci√≥n de unidad con toda la existencia, disolviendo los l√≠mites del ego.',er:'Anexo II de "TCT Puerta Azul", p√°g. 124.',ep:['Si√©ntate en meditaci√≥n y visualiza un punto de luz brillante en el centro de tu coraz√≥n.','Con cada respiraci√≥n, permite que esa luz se expanda, llenando primero todo tu cuerpo.','Contin√∫a expandiendo la luz m√°s all√° de tu cuerpo, hasta que llene la habitaci√≥n, luego el edificio, la ciudad...','Sigue expandiendo tu conciencia hasta que abarque todo el planeta, el sistema solar y finalmente, el cosmos entero.','Permanece en esta sensaci√≥n de ser el espacio vasto y silencioso que contiene todo el universo.']};
WD[34]={m:'La felicidad no es algo que se obtiene, sino algo que se reconoce cuando la mente deja de obstaculizarla. Esta semana integramos pr√°cticas espec√≠ficas para reestructurar la mente y cultivar las virtudes que generan felicidad de forma natural: gratitud, perd√≥n, aceptaci√≥n y presencia.',c:[['La Paradoja de la Felicidad','La felicidad es el estado natural de una mente en calma, no el resultado de condiciones externas.'],['El Proceso RAIN (Tara Brach)','Una t√©cnica para gestionar emociones: Reconocer, Aceptar, Investigar, No-identificaci√≥n.'],['Tonglen (Dar y Recibir)','Pr√°ctica tibetana para transformar el sufrimiento en compasi√≥n, inspirando el dolor y exhalando paz.'],['F√≥rmula Esencial','Felicidad = Aceptaci√≥n + Prop√≥sito + Conexi√≥n.']],et:'El Proceso RAIN para una Emoci√≥n Dif√≠cil',eo:'Aplicar un m√©todo mindfulness para relacionarse con una emoci√≥n dif√≠cil de forma compasiva.',er:'Anexo IV de "TCT Puerta Azul", p√°g. 146.',ep:['Cuando surja una emoci√≥n dif√≠cil (miedo, enfado, tristeza), haz una pausa.','R - Reconocer:  Nombra la emoci√≥n para tus adentros: "Ah, esto es ansiedad" o "Estoy sintiendo tristeza".','A - Aceptar:  Permite que la emoci√≥n est√© ah√≠, sin luchar contra ella ni juzgarte por sentirla. Puedes decirte: "Est√° bien sentir esto".','I - Investigar:  Con una curiosidad amable, explora c√≥mo se siente la emoci√≥n en tu cuerpo. ¬øD√≥nde est√°? ¬øEs caliente, fr√≠a, tensa, vibrante? ¬øQu√© creencia est√° detr√°s de esta emoci√≥n? ¬øQu√© necesita esta parte herida de ti?','N - No-identificaci√≥n:  Date cuenta de que t√∫ no eres la emoci√≥n. Eres la conciencia espaciosa en la que la emoci√≥n est√° ocurriendo. Descansa en esta conciencia m√°s amplia, viendo la emoci√≥n como una nube pasajera.']};
WD[35]={m:'El camino del guerrero espiritual implica transitar por la "noche oscura del alma", un viaje a las profundidades del ser para enfrentar a nuestros demonios internos (el ego, la sombra). Es en esta aparente oscuridad donde se produce la purificaci√≥n m√°s profunda y donde la luz de la consciencia puede brillar sin impedimentos. Este proceso requiere la fusi√≥n perfecta de las tres puertas: un cuerpo p',c:[['La Noche Oscura del Alma','Un per√≠odo de desolaci√≥n espiritual y desidentificaci√≥n de las viejas estructuras del ego, que precede a una profunda transformaci'],['Vencerse a Uno Mismo','La verdadera batalla no es externa, sino contra nuestros propios automatismos y la identificaci√≥n con el ego.'],['La Fusi√≥n de las Tres Puertas','La maestr√≠a se alcanza cuando el movimiento del cuerpo, la vibraci√≥n de la energ√≠a y la creaci√≥n de la mente surgen de una √∫nica f']],et:'Contemplaci√≥n del Proceso Espiritual',eo:'Reflexionar sobre el propio viaje espiritual utilizando el esquema simb√≥lico presentado.',er:'"TCT Puerta Azul Anexos", p√°g. 53-68.',ep:['Observa la secuencia de im√°genes que describen el proceso espiritual, desde el espacio vac√≠o hasta la realizaci√≥n del cuerpo de arco iris.','Reflexiona sobre en qu√© punto del camino te sientes. ¬øEst√°s en la fase de la mente dualista, empezando a purificar la visi√≥n, o has tenido atisbos del estado de Rigpa?','Contempla la imagen del "viaje del guerrero" y la interacci√≥n de las tres puertas (Cuerpo-Movimiento, Voz-Vibraci√≥n, Mente-Creaci√≥n).','No se trata de juzgar tu progreso, sino de tomar consciencia de tu proceso con honestidad y compasi√≥n. Reconoce que cada paso, incluso los dif√≠ciles, forma parte del camino de regreso a casa.']};
WD[36]={m:'La integraci√≥n de la Puerta Azul es la encarnaci√≥n de la visi√≥n no-dual en la vida diaria. Es dejar de "hacer" las pr√°cticas para "ser" la pr√°ctica. Es vivir como el espejo: reflejando la vida tal como es, con sus alegr√≠as y dolores, sin ser manchado ni definido por ella. La maestr√≠a no es la ausencia de reflejos (pensamientos, emociones), sino el reconocimiento ininterrumpido de nuestra naturalez',c:[],et:'de Integraci√≥n: Vivir el D√≠a como el Espejo',eo:'Mantener el reconocimiento de la mente-espejo durante las actividades cotidianas.',er:'',ep:['Comienza el d√≠a con la intenci√≥n: "Hoy, recuerdo que soy el espejo, no los reflejos".','Durante el d√≠a, cuando surja una situaci√≥n (agradable o desagradable), un pensamiento o una emoci√≥n, n√≥talo y di internamente: "Un reflejo".','Observa la tendencia de la mente a identificarse, a reaccionar, a aferrarse o a rechazar el reflejo.','Amablemente, una y otra vez, trae tu identidad de vuelta al espejo: a la conciencia silenciosa, clara y espaciosa que simplemente observa.','Presta especial atenci√≥n a los momentos de interacci√≥n. ¬øPuedes ver a la otra persona como un reflejo en tu espejo, sin juicio? ¬øPuedes ver tus propias reacciones como reflejos tambi√©n?','Al final del d√≠a, reflexiona: ¬øEn qu√© momentos fue m√°s f√°cil recordar que eres el espejo? ¬øEn qu√© momentos te identificaste m√°s con los reflejos? No hay juicio, solo observaci√≥n para la pr√≥xima pr√°ctica. Puerta Integraci√≥n (Semanas 37-48) Tema Central:  S√≠ntesis y Encarnaci√≥n. Fuentes Principales:  ']};
WD[37]={m:'Repasamos el viaje completo, viendo c√≥mo cada puerta construye sobre la anterior. La Puerta Blanca nos dio el  suelo  (el cuerpo presente). La Puerta Roja nos dio el  coraz√≥n  (la energ√≠a purificada). La Puerta Azul nos dio el  cielo  (la mente espaciosa). Ahora, en la Puerta de Integraci√≥n, aprendemos a vivir simult√°neamente en el suelo, el coraz√≥n y el cielo. Son tres dimensiones de una √∫nica Re',c:[],et:'Meditaci√≥n de las Tres Puertas',eo:'Unificar la conciencia de los tres centros en una sola meditaci√≥n.',er:'',ep:['Si√©ntate en una postura c√≥moda.','Puerta Blanca (5 min):  Lleva tu atenci√≥n a tu cuerpo. Siente el contacto con el suelo, el peso, la postura. Habita tu cuerpo f√≠sico plenamente. Siente la presencia s√≥lida y cimentada.','Puerta Roja (5 min):  Lleva tu atenci√≥n a tu centro energ√©tico, al √°rea del coraz√≥n y la garganta. Siente la energ√≠a vital que pulsa en ti. Con cada respiraci√≥n, siente c√≥mo esta energ√≠a se purifica y se vuelve m√°s sutil y amorosa.','Puerta Azul (5 min):  Expande tu atenci√≥n para incluir el espacio de la mente. Observa los pensamientos como nubes en un cielo vasto y claro. Descansa en la conciencia espaciosa y no-dual.','Integraci√≥n (5 min):  Mant√©n simult√°neamente la conciencia del cuerpo (suelo), la energ√≠a (coraz√≥n) y la mente (cielo). Siente c√≥mo eres las tres cosas a la vez: anclado, vibrante y espacioso.']};
WD[38]={m:'Profundizamos en la "F√≥rmula Esencial de la Felicidad" como el mapa para la integraci√≥n. La felicidad no es una emoci√≥n pasajera, sino la resonancia de un ser en equilibrio. Este equilibrio se sostiene sobre tres pilares que hemos cultivado a lo largo del viaje: Aceptaci√≥n (Puerta Blanca):  La paz que viene de estar presente en el ahora y aceptar la realidad tal como es, comenzando por nuestro pro',c:[],et:'Reflexi√≥n sobre los Tres Pilares',eo:'Evaluar c√≥mo se manifiestan los tres pilares de la felicidad en tu vida actual.',er:'',ep:['Aceptaci√≥n:  ¬øEn qu√© √°reas de mi vida estoy practicando la aceptaci√≥n? ¬øEn qu√© √°reas todav√≠a hay resistencia y lucha? ¬øC√≥mo es mi relaci√≥n con mi cuerpo en este momento?','Prop√≥sito:  ¬øQu√© actividades o acciones me dan un sentido de prop√≥sito? ¬øMis acciones diarias est√°n alineadas con mis valores m√°s profundos? ¬øC√≥mo puedo expresar mi prop√≥sito de formas peque√±as hoy?','Conexi√≥n:  ¬øCu√°ndo me siento m√°s conectado conmigo mismo, con los dem√°s y con la vida? ¬øQu√© h√°bitos o patrones de pensamiento me hacen sentir separado? ¬øC√≥mo puedo cultivar una mayor sensaci√≥n de conexi√≥n?']};
WD[39]={m:'La maestr√≠a no es un logro individualista. Recordamos que cada uno de nosotros, con nuestro estado de conciencia, contribuye al "campo invisible" de la humanidad. Una sociedad consciente no es una utop√≠a, sino el resultado de individuos que asumen la responsabilidad de su propia presencia. El gesto m√°s pol√≠tico y transformador es, a menudo, el m√°s silencioso: escuchar de verdad, no reaccionar auto',c:[],et:'Ofrecer Presencia',eo:'Practicar la contribuci√≥n consciente al campo colectivo.',er:'',ep:['Elige una interacci√≥n del d√≠a (con un familiar, un colega, un dependiente en una tienda).','Antes de la interacci√≥n, toma un momento para centrarte. Conecta con tu cuerpo y tu respiraci√≥n. Establece la intenci√≥n de "ofrecer presencia".','Durante la interacci√≥n, tu √∫nico objetivo es estar plenamente presente. Escucha sin interrumpir. Mira a la persona a los ojos. Siente el campo emocional entre vosotros.','No intentes arreglar, aconsejar o cambiar nada. Tu √∫nica ofrenda es tu atenci√≥n plena y tu presencia no-reactiva.','Observa el efecto que este simple acto tiene en la interacci√≥n y en tu propio estado interno.']};
WD[40]={m:'Retomamos la herramienta del diario desde la perspectiva del Cuarto Camino, pero ahora con la visi√≥n integrada de las tres puertas. El diario se convierte en un laboratorio para la auto-observaci√≥n de los tres centros en acci√≥n y para registrar los momentos de "recuerdo de s√≠" y de "identificaci√≥n". Estructura del Diario Integrado: Observaci√≥n de los Centros:  Al final del d√≠a, anota una situaci√≥n',c:[],et:'Mantener el Diario del Cuarto Camino',eo:'Utilizar la escritura como una herramienta sistem√°tica para aumentar la autoconciencia.',er:'',ep:[]};
WD[41]={m:'La pr√°ctica del perd√≥n de UCDM es el coraz√≥n de la purificaci√≥n de la Puerta Roja y la maestr√≠a de la Puerta Azul. Esta semana, nos comprometemos a hacer del perd√≥n una pr√°ctica diaria y sistem√°tica, utilizando el diario como una herramienta para no dejar que ning√∫n resentimiento o juicio se arraigue en la mente. Estructura del Diario del Perd√≥n: Ma√±ana:  Establece el prop√≥sito del d√≠a: "Por encim',c:[],et:'Mantener el Diario del Perd√≥n',eo:'Hacer del perd√≥n una respuesta autom√°tica a cualquier forma de conflicto.',er:'',ep:[]};
WD[42]={m:'Desde la perspectiva del Dzogchen, la felicidad es nuestro estado natural. El diario se convierte en una herramienta no para "lograr" la felicidad, sino para registrar los momentos en que recordamos nuestra naturaleza de espejo y para observar los patrones que oscurecen esa felicidad. Estructura del Diario de la Mente Feliz: Momentos de "Espejo":  Anota cualquier momento en que te sentiste como el',c:[],et:'Mantener el Diario de la Mente Feliz',eo:'Estabilizar el reconocimiento de la mente natural.',er:'',ep:[]};
WD[43]={m:'La culminaci√≥n de la pr√°ctica es la "acci√≥n sin esfuerzo" o Wu Wei. No significa pasividad, sino actuar en perfecta armon√≠a con el fluir de la vida. Esto solo es posible cuando el ego, con su necesidad de controlar, planificar y forzar, se ha relajado. La no-interferencia es confiar en la inteligencia m√°s profunda del Ser, que sabe qu√© hacer y cu√°ndo hacerlo sin necesidad de la deliberaci√≥n consta',c:[],et:'La Danza del No-Esfuerzo',eo:'Practicar la acci√≥n que surge de la quietud en lugar de la urgencia del ego.',er:'Anexo II de "TCT Puerta Azul", p√°g. 124.',ep:['Establece la intenci√≥n para el d√≠a: "Hoy permitir√© que la vida fluya a trav√©s de m√≠".','Ante cada decisi√≥n o acci√≥n, especialmente si sientes urgencia o ansiedad, haz una pausa.','Respira y conecta con la quietud de tu centro.','Preg√∫ntate: "¬øEsta acci√≥n surge del miedo y la necesidad de controlar, o del flujo natural y la respuesta intuitiva?".','Act√∫a solo cuando la respuesta venga de la quietud. Si no hay claridad, espera. La inacci√≥n consciente es a menudo la acci√≥n m√°s poderosa.']};
WD[44]={m:'Cuando la b√∫squeda del ego para "conseguir algo" se disuelve, emerge una nueva motivaci√≥n: el servicio. El servicio no es necesariamente una acci√≥n grandiosa, sino la expresi√≥n natural de un coraz√≥n abierto. Es el reconocimiento de que nuestra paz y nuestra felicidad son inseparables de la paz y la felicidad de todos. Nuestro legado m√°s importante no es lo que logramos, sino la calidad de presenci',c:[],et:'Un Acto de Servicio An√≥nimo',eo:'Experimentar la alegr√≠a de dar sin ninguna expectativa de reconocimiento.',er:'',ep:['Busca una oportunidad para realizar un peque√±o acto de servicio o bondad de forma an√≥nima.','Puede ser algo simple: dejar una nota amable, hacer una peque√±a donaci√≥n, limpiar un espacio compartido sin que nadie te vea, enviar un pensamiento de amor a alguien con quien tienes dificultades.','El √∫nico requisito es que nadie sepa que lo hiciste t√∫.','Observa la sensaci√≥n que surge. La alegr√≠a del servicio puro no viene de la gratitud externa, sino de la alineaci√≥n interna con el flujo del amor.']};
WD[45]={m:'La comunicaci√≥n se convierte en una de las pr√°cticas de maestr√≠a m√°s importantes. La comunicaci√≥n del ego busca tener raz√≥n, defenderse o manipular. La comunicaci√≥n desde la Fuente busca la conexi√≥n y la verdad. Implica escuchar desde el silencio, hablar desde el coraz√≥n y reconocer al Ser en la otra persona, m√°s all√° de su personalidad. Concepto Clave: Escuchar para Conectar, no para Responder La',c:[],et:'La Conversaci√≥n Consciente',eo:'Transformar una conversaci√≥n ordinaria en una pr√°ctica de presencia.',er:'Anexo II de "TCT Puerta Azul", p√°g. 125.',ep:['Elige una conversaci√≥n que tendr√°s hoy.','Antes de empezar, establece la intenci√≥n de escuchar para conectar, no para ganar.','Durante la conversaci√≥n, mant√©n una parte de tu atenci√≥n en tu propio estado interno. ¬øEst√°s presente? ¬øEst√°s reaccionando?','Cuando la otra persona hable, escucha con todo tu ser. Intenta sentir lo que hay detr√°s de sus palabras.','Cuando sea tu turno de hablar, haz una pausa. Permite que tus palabras surjan de la quietud y la honestidad, no de la reacci√≥n.']};
WD[46]={m:'La maestr√≠a no es un estado est√°tico, sino una cualidad de serenidad radiante que impregna todas nuestras actividades. Es la capacidad de permanecer centrado y en paz en medio del caos del mundo. No es una paz pasiva, sino una calma activa y din√°mica que surge de la confianza inquebrantable en la Realidad. Es el fruto de la integraci√≥n de las tres puertas: un cuerpo relajado, un coraz√≥n abierto y ',c:[],et:'Anclar la Serenidad',eo:'Cultivar la serenidad como estado de fondo a lo largo del d√≠a.',er:'',ep:['Comienza el d√≠a con 5 minutos de silencio, conectando con la sensaci√≥n de paz interior.','A lo largo del d√≠a, utiliza un "ancla" para volver a esa sensaci√≥n. Puede ser una palabra ("Paz"), una imagen (un lago en calma) o una sensaci√≥n f√≠sica (el contacto de tus pies con el suelo).','Cada vez que te sientas arrastrado por el estr√©s o el drama, utiliza tu ancla para hacer una pausa y reconectar con la serenidad que est√° siempre disponible debajo del ruido de la superficie.','La pr√°ctica es volver, una y otra vez, a este centro de calma, hasta que se convierta en tu forma natural de estar en el mundo.']};
WD[47]={m:'El camino espiritual no es una l√≠nea recta, sino una espiral. Volveremos a enfrentar los mismos temas (el ego, el miedo, el perd√≥n), pero cada vez desde un nivel de conciencia m√°s elevado. La integraci√≥n no es un final, sino el comienzo de un trabajo continuo, donde cada vuelta de la espiral profundiza nuestra comprensi√≥n y encarnaci√≥n. Concepto Clave: No hay Regresi√≥n, solo Profundizaci√≥n Cuando ',c:[],et:'Revisi√≥n en Espiral',eo:'Reconocer el progreso en espiral en tu propio camino.',er:'',ep:['Reflexiona sobre un desaf√≠o o patr√≥n con el que has trabajado durante este curso.','Recuerda c√≥mo te relacionabas con √©l al principio (Puerta Blanca). ¬øC√≥mo lo abordaste durante la Puerta Roja? ¬øY desde la perspectiva de la Puerta Azul?','Observa c√≥mo tu comprensi√≥n y tu capacidad para manejarlo han cambiado, aunque el tema central sea el mismo.','Reconoce y honra tu progreso. Si el patr√≥n sigue apareciendo, dale la bienvenida como una oportunidad para una sanaci√≥n a√∫n m√°s profunda, en la siguiente vuelta de la espiral.']};
WD[48]={m:'El viaje de 48 semanas llega a su fin, pero el verdadero Camino apenas comienza. Hemos recibido un mapa y un conjunto de herramientas, pero ahora nos corresponde caminar. El cierre no es una graduaci√≥n, sino un compromiso renovado con la pr√°ctica de la presencia en cada momento de la vida. Reflexi√≥n Final del M√©todo TCT: El objetivo del M√©todo TCT nunca fue convertirte en alguien diferente. Fue ay',c:[],et:'Final: La Promesa a Ti Mismo',eo:'Sellar el compromiso con tu propio despertar.',er:'',ep:['Busca un momento y un lugar tranquilos.','Escribe una carta a tu Ser futuro (el que leer√° esto en un a√±o).','En la carta, describe los aprendizajes m√°s importantes de este viaje. ¬øQu√© has descubierto sobre ti mismo? ¬øQu√© pr√°cticas te han servido m√°s?','Hazte una promesa. No una promesa de "ser perfecto" o "no volver a caer", sino una promesa de "recordar". Prom√©tete que seguir√°s practicando la pausa, que ser√°s amable contigo mismo, que seguir√°s eligiendo la paz.','Guarda la carta en un lugar seguro y pon un recordatorio en tu calendario para leerla dentro de un a√±o. Ser√° un poderoso recordatorio de tu compromiso y un testimonio de tu continuo viaje en la espiral. "Sigue tu camino, con tu propio ritmo, vive en paz, con amor... vive. ¬°S√© la frecuencia del unive']};



// ‚îÄ‚îÄ ADMIN PANEL ‚îÄ‚îÄ
var _adminData = [];

async function loadAdminData() {
  if (!sb) { toast('Sin conexi√≥n a Supabase'); return; }
  const tbody = document.getElementById('admin-tbody');
  tbody.innerHTML = '<tr><td colspan="7" class="admin-empty">‚è≥ Cargando datos...</td></tr>';

  try {
    // Load all users from auth (via user_progress table + auth.users view if available)
    const { data: profiles, error: pe } = await sb.from('user_progress')
      .select('user_id, week_number, status, puerta, completed_at')
      .order('user_id');

    // Try to get user emails from a profiles/users table if it exists
    let usersMap = {};
    try {
      const { data: users } = await sb.from('profiles').select('id, email, full_name, created_at, plan');
      if (users) users.forEach(function(u){ usersMap[u.id] = u; });
    } catch(e) {
      // profiles table may not exist yet ‚Äî that's ok
    }

    if (!profiles || profiles.length === 0) {
      tbody.innerHTML = '<tr><td colspan="7" class="admin-empty">No hay datos de progreso a√∫n. Los alumnos aparecer√°n aqu√≠ cuando inicien su formaci√≥n.</td></tr>';
      document.getElementById('admin-total').textContent = '0';
      document.getElementById('admin-activos').textContent = '0';
      document.getElementById('admin-semana-media').textContent = '‚Äî';
      document.getElementById('admin-completadas').textContent = '0';
      return;
    }

    // Agregate by user
    var byUser = {};
    profiles.forEach(function(p) {
      if (!byUser[p.user_id]) byUser[p.user_id] = { user_id: p.user_id, completed: [], current: 1, puerta: 'Blanca' };
      if (p.status === 'completed') byUser[p.user_id].completed.push(p.week_number);
      if (p.status === 'in_progress') byUser[p.user_id].current = p.week_number;
      if (p.puerta) byUser[p.user_id].puerta = p.puerta;
    });

    _adminData = Object.values(byUser);
    renderAdminTable(_adminData, usersMap);

    // Stats
    var total = _adminData.length;
    var activos = _adminData.filter(function(u){ return u.completed.length > 0; }).length;
    var totalCompleted = _adminData.reduce(function(acc, u){ return acc + u.completed.length; }, 0);
    var semanaMedia = total > 0 ? Math.round(_adminData.reduce(function(acc,u){ return acc + u.current; },0) / total) : 0;
    document.getElementById('admin-total').textContent = total;
    document.getElementById('admin-activos').textContent = activos;
    document.getElementById('admin-semana-media').textContent = semanaMedia;
    document.getElementById('admin-completadas').textContent = totalCompleted;

  } catch(e) {
    tbody.innerHTML = '<tr><td colspan="7" class="admin-empty">Error cargando datos: ' + e.message + '</td></tr>';
    console.error('Admin error:', e);
  }
}

function renderAdminTable(data, usersMap) {
  var tbody = document.getElementById('admin-tbody');
  if (!data || data.length === 0) {
    tbody.innerHTML = '<tr><td colspan="7" class="admin-empty">No se encontraron alumnos.</td></tr>';
    return;
  }
  var badgeClass = { Blanca:'badge-blanca', Roja:'badge-roja', Azul:'badge-azul', Arcoiris:'badge-arcoiris', Oro:'badge-oro' };
  var puertas = { Blanca:'üåø Blanca', Roja:'üî• Roja', Azul:'üîµ Azul', Arcoiris:'üåà Arcoiris', Oro:'‚ú® Oro' };
  tbody.innerHTML = data.map(function(u) {
    var profile = usersMap[u.user_id] || {};
    var name = profile.full_name || '‚Äî';
    var email = profile.email || u.user_id.substring(0,8) + '...';
    var plan = profile.plan || u.puerta || 'Blanca';
    var pct = Math.round((u.completed.length / 48) * 100);
    var fecha = profile.created_at ? new Date(profile.created_at).toLocaleDateString('es-ES') : '‚Äî';
    return '<tr>' +
      '<td><strong style="font-size:13px">' + name + '</strong></td>' +
      '<td style="color:#7a7168">' + email + '</td>' +
      '<td><span class="admin-badge ' + (badgeClass[plan]||'badge-blanca') + '">' + (puertas[plan]||plan) + '</span></td>' +
      '<td style="font-weight:600">Sem. ' + u.current + '</td>' +
      '<td><div style="display:flex;align-items:center;gap:8px"><div class="admin-progress-bar"><div class="admin-progress-fill" style="width:' + pct + '%"></div></div><span style="font-size:11px;color:#7a7168">' + pct + '%</span></div></td>' +
      '<td>' + u.completed.length + ' / 48</td>' +
      '<td style="color:#a89e93;font-size:12px">' + fecha + '</td>' +
    '</tr>';
  }).join('');
}

function filterAdminTable(query) {
  var q = query.toLowerCase();
  var filtered = _adminData.filter(function(u){
    return (u.user_id||'').toLowerCase().includes(q) ||
           (u.puerta||'').toLowerCase().includes(q);
  });
  renderAdminTable(filtered, {});
}

// Override goTo to load admin data when navigating to admin
var _originalGoTo = goTo;
function goTo(page) {
  document.querySelectorAll('.page').forEach(function(p){ p.classList.remove('active'); });
  document.getElementById('page-' + page).classList.add('active');
  window.scrollTo(0,0);
  if (page === 'student') refreshDashboard();
  if (page === 'admin') loadAdminData();
}

// Close modal on outside click
document.getElementById('week-modal').addEventListener('click', function(e){
  if (e.target === this) closeModal();
});
</script>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>





<!-- PAGE: ADMIN -->
<div class="page" id="page-admin">
  <div class="admin-wrap">
    <div class="admin-header">
      <h1>Panel <span>Admin</span> ‚Äî Frecuencia Integral Academy</h1>
      <div style="display:flex;gap:10px">
        <button class="admin-refresh" onclick="loadAdminData()">‚Üª Actualizar</button>
        <button class="btn-ghost" style="color:white;border-color:rgba(255,255,255,.2)" onclick="goTo('student')">‚Üê Volver al Dashboard</button>
      </div>
    </div>
    <div class="admin-body">
      <!-- Stats -->
      <div class="admin-stats">
        <div class="admin-stat">
          <div class="admin-stat-val" id="admin-total">‚Äî</div>
          <div class="admin-stat-label">Alumnos Totales</div>
        </div>
        <div class="admin-stat">
          <div class="admin-stat-val" id="admin-activos">‚Äî</div>
          <div class="admin-stat-label">Con Progreso</div>
        </div>
        <div class="admin-stat">
          <div class="admin-stat-val" id="admin-semana-media">‚Äî</div>
          <div class="admin-stat-label">Semana Media</div>
        </div>
        <div class="admin-stat">
          <div class="admin-stat-val" id="admin-completadas">‚Äî</div>
          <div class="admin-stat-label">Semanas Completadas</div>
        </div>
      </div>
      <!-- Table -->
      <div class="admin-table-wrap">
        <div class="admin-table-header">
          <div class="admin-table-title">Alumnos Registrados</div>
          <input class="admin-search" id="admin-search" type="text" placeholder="üîç Buscar alumno..." oninput="filterAdminTable(this.value)">
        </div>
        <div style="overflow-x:auto">
          <table class="admin-table" id="admin-table">
            <thead>
              <tr>
                <th>Alumno</th>
                <th>Email</th>
                <th>Plan / Puerta</th>
                <th>Semana Actual</th>
                <th>Progreso</th>
                <th>Completadas</th>
                <th>Registro</th>
              </tr>
            </thead>
            <tbody id="admin-tbody">
              <tr><td colspan="7" class="admin-empty">Cargando alumnos...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div><!-- /page-admin -->

<!-- PDF FULLSCREEN MODAL -->
<div class="pdf-modal-overlay" id="pdf-fullscreen-modal">
  <div class="pdf-modal-topbar">
    <div class="pdf-modal-topbar-name" id="pdf-fullscreen-name"></div>
    <div class="pdf-modal-topbar-actions">
      <a class="btn-pdf-fullscreen-dl" id="pdf-fullscreen-dl" href="#" download target="_blank">‚¨á Descargar</a>
      <button class="btn-pdf-fullscreen-close" onclick="closePdfFullscreen()">‚úï Cerrar</button>
    </div>
  </div>
  <iframe class="pdf-modal-frame" id="pdf-fullscreen-frame" src=""></iframe>
</div>

<!-- EDITOR BUTTON -->
<button onclick="editorOpen()" id="edOpenBtn" style="position:fixed;bottom:80px;left:24px;z-index:99999;background:#1c1814;color:white;border:2px solid rgba(255,255,255,.2);padding:10px 18px;border-radius:100px;font-size:12px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;box-shadow:0 4px 20px rgba(0,0,0,.5)">‚úèÔ∏è Editor</button>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- BARRA FLOTANTE DE FORMATO (aparece al selec. texto) -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="edFmtBar" style="display:none;position:fixed;z-index:10003;background:#161210;border:1px solid rgba(255,255,255,.18);border-radius:10px;padding:5px 7px;gap:2px;align-items:center;box-shadow:0 6px 28px rgba(0,0,0,.7);flex-wrap:wrap;max-width:600px">
  <!-- Formato b√°sico -->
  <button onclick="edFmt('bold')" class="efb" title="Negrita Ctrl+B"><b>B</b></button>
  <button onclick="edFmt('italic')" class="efb" title="Cursiva Ctrl+I"><i style="font-style:italic">I</i></button>
  <button onclick="edFmt('underline')" class="efb" title="Subrayado" style="text-decoration:underline">U</button>
  <button onclick="edFmt('strikeThrough')" class="efb" title="Tachado" style="text-decoration:line-through">S</button>
  <div class="efbsep"></div>
  <!-- Alineaci√≥n -->
  <button onclick="edFmt('justifyLeft')" class="efb" title="Izquierda">‚â°‚¨õ</button>
  <button onclick="edFmt('justifyCenter')" class="efb" title="Centrar">‚¨õ‚â°</button>
  <button onclick="edFmt('justifyRight')" class="efb" title="Derecha">‚â°‚¨õ</button>
  <div class="efbsep"></div>
  <!-- Encabezados -->
  <button onclick="edFmtBlock('h1')" class="efb efb-lbl" title="T√≠tulo H1">H1</button>
  <button onclick="edFmtBlock('h2')" class="efb efb-lbl" title="T√≠tulo H2">H2</button>
  <button onclick="edFmtBlock('h3')" class="efb efb-lbl" title="T√≠tulo H3">H3</button>
  <button onclick="edFmtBlock('p')"  class="efb efb-lbl" title="P√°rrafo">P</button>
  <div class="efbsep"></div>
  <!-- Listas -->
  <button onclick="edFmt('insertUnorderedList')" class="efb" title="Lista vi√±etas">‚Ä¢‚â°</button>
  <button onclick="edFmt('insertOrderedList')"   class="efb" title="Lista numerada">1.‚â°</button>
  <div class="efbsep"></div>
  <!-- Color texto inline -->
  <div style="display:flex;align-items:center;gap:3px">
    <span style="font-size:9px;color:rgba(255,255,255,.4)">A</span>
    <input type="color" id="efbTxtColor" value="#1c1814" style="width:22px;height:22px;border:none;border-radius:3px;cursor:pointer;padding:0" onchange="edApplyFontColor(this.value)" title="Color texto">
  </div>
  <!-- Resaltar -->
  <div style="display:flex;align-items:center;gap:3px">
    <span style="font-size:9px;color:rgba(255,255,255,.4)">‚ñì</span>
    <input type="color" id="efbHlColor" value="#fff9c4" style="width:22px;height:22px;border:none;border-radius:3px;cursor:pointer;padding:0" onchange="edFmtHighlight(this.value)" title="Resaltar texto">
  </div>
  <div class="efbsep"></div>
  <!-- Tama√±o inline -->
  <select onchange="if(this.value){edApplyFontSize(this.value);this.value=''}" style="background:#2a2420;color:white;border:1px solid rgba(255,255,255,.15);padding:2px 3px;border-radius:5px;font-size:10px;cursor:pointer;max-width:52px" title="Tama√±o texto">
    <option value="">px</option>
    <option value="10px">10</option><option value="11px">11</option><option value="12px">12</option>
    <option value="13px">13</option><option value="14px">14</option><option value="15px">15</option>
    <option value="16px">16</option><option value="18px">18</option><option value="20px">20</option>
    <option value="22px">22</option><option value="24px">24</option><option value="28px">28</option>
    <option value="32px">32</option><option value="36px">36</option><option value="40px">40</option>
    <option value="48px">48</option><option value="56px">56</option><option value="64px">64</option>
    <option value="72px">72</option><option value="80px">80</option><option value="96px">96</option>
  </select>
  <input type="number" min="8" max="200" placeholder="px" title="Tam. libre" style="width:38px;background:#2a2420;color:white;border:1px solid rgba(255,255,255,.15);padding:2px 4px;border-radius:5px;font-size:10px;outline:none" onkeydown="if(event.key==='Enter'&&this.value){edApplyFontSize(this.value+'px');this.value=''}">
  <div class="efbsep"></div>
  <!-- Tipograf√≠a inline -->
  <select onchange="if(this.value){edApplyFontInline(this.value);this.value=''}" style="background:#2a2420;color:white;border:1px solid rgba(255,255,255,.15);padding:2px 3px;border-radius:5px;font-size:10px;cursor:pointer;max-width:80px">
    <option value="">Font</option>
    <option value="'DM Sans',sans-serif">DM Sans</option>
    <option value="'Cormorant Garamond',serif">Cormorant</option>
    <option value="Georgia,serif">Georgia</option>
    <option value="Arial,sans-serif">Arial</option>
    <option value="'Helvetica Neue',sans-serif">Helvetica</option>
    <option value="'Times New Roman',serif">Times NR</option>
    <option value="'Courier New',monospace">Courier</option>
  </select>
  <div class="efbsep"></div>
  <!-- Superscript / Subscript -->
  <button onclick="edFmt('superscript')" class="efb" title="Super√≠ndice" style="font-size:9px">X¬≤</button>
  <button onclick="edFmt('subscript')" class="efb" title="Sub√≠ndice" style="font-size:9px">X‚ÇÇ</button>
  <!-- Link -->
  <button onclick="edAddLink()" class="efb" title="Enlace">üîó</button>
  <!-- Cerrar -->
  <button onclick="edFmtBarHide()" style="background:none;border:none;color:rgba(255,255,255,.3);font-size:13px;cursor:pointer;padding:1px 5px;margin-left:2px;line-height:1">‚úï</button>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- PANEL LATERAL DE PROPIEDADES                       -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="edPropsPanel" style="display:none;position:fixed;right:0;top:0;bottom:0;z-index:9996;width:268px;background:#161210;border-left:1px solid rgba(255,255,255,.1);overflow-y:auto;font-family:'DM Sans',sans-serif;padding-bottom:120px">

  <!-- Header -->
  <div style="position:sticky;top:0;z-index:2;background:#161210;padding:10px 14px 8px;border-bottom:1px solid rgba(255,255,255,.1);display:flex;align-items:center;justify-content:space-between">
    <span style="font-size:11px;font-weight:700;color:#3d9e9b;letter-spacing:.08em">‚öô PROPIEDADES</span>
    <div style="display:flex;align-items:center;gap:6px">
      <code id="edPropsTag" style="font-size:9px;color:rgba(255,255,255,.3);background:rgba(255,255,255,.06);padding:2px 5px;border-radius:3px"></code>
      <button onclick="edCloseProps()" style="background:none;border:none;color:rgba(255,255,255,.3);font-size:14px;cursor:pointer;padding:0 2px">‚úï</button>
    </div>
  </div>

  <!-- SECCI√ìN: TAMA√ëO -->
  <div class="epp-sec">
    <div class="epp-lbl">üìê Tama√±o del contenedor</div>
    <div class="epp-grid2">
      <div><div class="epp-sub">Ancho (W)</div>
        <input id="prpW" type="text" placeholder="auto" class="epp-inp" oninput="edPropLive('width',this.value)" title="px / % / auto / vw"></div>
      <div><div class="epp-sub">Alto (H)</div>
        <input id="prpH" type="text" placeholder="auto" class="epp-inp" oninput="edPropLive('height',this.value)" title="px / vh / auto"></div>
      <div><div class="epp-sub">M√°x. ancho</div>
        <input id="prpMW" type="text" placeholder="none" class="epp-inp" oninput="edPropLive('maxWidth',this.value)"></div>
      <div><div class="epp-sub">M√≠n. alto</div>
        <input id="prpMH" type="text" placeholder="auto" class="epp-inp" oninput="edPropLive('minHeight',this.value)"></div>
    </div>
    <!-- Presets ancho r√°pido -->
    <div style="display:flex;gap:3px;flex-wrap:wrap;margin-top:5px">
      <button onclick="edPropQ('width','100%')" class="epp-chip">100%</button>
      <button onclick="edPropQ('maxWidth','1200px')" class="epp-chip">1200px</button>
      <button onclick="edPropQ('maxWidth','900px')" class="epp-chip">900px</button>
      <button onclick="edPropQ('maxWidth','700px')" class="epp-chip">700px</button>
      <button onclick="edPropQ('maxWidth','500px')" class="epp-chip">500px</button>
      <button onclick="edPropQ('margin','0 auto')" class="epp-chip" style="color:#3d9e9b">‚Üî Centrar</button>
    </div>
  </div>

  <!-- SECCI√ìN: PADDING -->
  <div class="epp-sec">
    <div class="epp-lbl">‚Üî Espaciado interno (padding)</div>
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:4px;margin-bottom:6px">
      <div><div class="epp-sub">‚Üë Top</div><input id="prpPT" type="text" placeholder="0" class="epp-inp" oninput="edPropLive('paddingTop',this.value)"></div>
      <div><div class="epp-sub">‚Üì Bot</div><input id="prpPB" type="text" placeholder="0" class="epp-inp" oninput="edPropLive('paddingBottom',this.value)"></div>
      <div><div class="epp-sub">‚Üê Izq</div><input id="prpPL" type="text" placeholder="0" class="epp-inp" oninput="edPropLive('paddingLeft',this.value)"></div>
      <div><div class="epp-sub">‚Üí Der</div><input id="prpPR" type="text" placeholder="0" class="epp-inp" oninput="edPropLive('paddingRight',this.value)"></div>
    </div>
    <div style="display:flex;gap:3px;flex-wrap:wrap">
      <button onclick="edPropQ('padding','8px')" class="epp-chip">8px</button>
      <button onclick="edPropQ('padding','16px')" class="epp-chip">16px</button>
      <button onclick="edPropQ('padding','24px')" class="epp-chip">24px</button>
      <button onclick="edPropQ('padding','32px')" class="epp-chip">32px</button>
      <button onclick="edPropQ('padding','40px')" class="epp-chip">40px</button>
      <button onclick="edPropQ('padding','48px 64px')" class="epp-chip">48√ó64</button>
      <button onclick="edPropQ('padding','80px 40px')" class="epp-chip">80√ó40</button>
    </div>
  </div>

  <!-- SECCI√ìN: FONDO -->
  <div class="epp-sec">
    <div class="epp-lbl">üé® Color de fondo</div>
    <!-- Picker + hex -->
    <div style="display:flex;gap:6px;align-items:center;margin-bottom:8px">
      <input type="color" id="prpBgPk" value="#f7f5f1" style="width:36px;height:36px;border:none;border-radius:6px;cursor:pointer;padding:0;flex-shrink:0" onchange="edPropBg(this.value)">
      <input id="prpBgHex" type="text" placeholder="#rrggbb / transparent" class="epp-inp" style="flex:1" onchange="edPropBg(this.value)" oninput="edPropBgInput(this.value)">
      <button onclick="edPropBg('transparent')" class="epp-xbtn" title="Sin fondo">‚àÖ</button>
    </div>
    <!-- Paleta r√°pida -->
    <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:6px">
      <div onclick="edPropBg('#ffffff')" class="epp-sw" style="background:#fff;border-color:#ccc" title="Blanco"></div>
      <div onclick="edPropBg('#f7f5f1')" class="epp-sw" style="background:#f7f5f1" title="Crema claro"></div>
      <div onclick="edPropBg('#f0ece4')" class="epp-sw" style="background:#f0ece4" title="Crema"></div>
      <div onclick="edPropBg('#e8e3d8')" class="epp-sw" style="background:#e8e3d8" title="Arena"></div>
      <div onclick="edPropBg('#d4cfc6')" class="epp-sw" style="background:#d4cfc6" title="Gris arena"></div>
      <div onclick="edPropBg('#1c1814')" class="epp-sw" style="background:#1c1814" title="Negro TCT"></div>
      <div onclick="edPropBg('#2a241e')" class="epp-sw" style="background:#2a241e" title="Oscuro"></div>
      <div onclick="edPropBg('#3d3028')" class="epp-sw" style="background:#3d3028" title="Marr√≥n oscuro"></div>
      <div onclick="edPropBg('#2b7d7a')" class="epp-sw" style="background:#2b7d7a" title="Verde TCT"></div>
      <div onclick="edPropBg('#3d9e9b')" class="epp-sw" style="background:#3d9e9b" title="Verde claro"></div>
      <div onclick="edPropBg('#e8f4f3')" class="epp-sw" style="background:#e8f4f3" title="Verde muy claro"></div>
      <div onclick="edPropBg('#1c5a58')" class="epp-sw" style="background:#1c5a58" title="Verde oscuro"></div>
      <div onclick="edPropBg('#b89558')" class="epp-sw" style="background:#b89558" title="Oro TCT"></div>
      <div onclick="edPropBg('#d4b878')" class="epp-sw" style="background:#d4b878" title="Oro claro"></div>
      <div onclick="edPropBg('#fdf6e3')" class="epp-sw" style="background:#fdf6e3" title="Oro muy claro"></div>
      <div onclick="edPropBg('#bf4637')" class="epp-sw" style="background:#bf4637" title="Rojo Puerta"></div>
      <div onclick="edPropBg('#fdecea')" class="epp-sw" style="background:#fdecea" title="Rojo muy claro"></div>
      <div onclick="edPropBg('#2c5f9e')" class="epp-sw" style="background:#2c5f9e" title="Azul Puerta"></div>
      <div onclick="edPropBg('#e8eef7')" class="epp-sw" style="background:#e8eef7" title="Azul muy claro"></div>
      <div onclick="edPropBg('#7b4fa6')" class="epp-sw" style="background:#7b4fa6" title="Violeta"></div>
    </div>
    <!-- Gradientes predefinidos -->
    <div class="epp-sub" style="margin-bottom:4px">Gradientes r√°pidos</div>
    <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:6px">
      <div onclick="edPropBg('linear-gradient(135deg,#f7f5f1,#e8e3d8)')" class="epp-grad" style="background:linear-gradient(135deg,#f7f5f1,#e8e3d8)" title="Crema"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#2b7d7a,#1c5a58)')" class="epp-grad" style="background:linear-gradient(135deg,#2b7d7a,#1c5a58)" title="Verde"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#1c1814,#3d3028)')" class="epp-grad" style="background:linear-gradient(135deg,#1c1814,#3d3028)" title="Oscuro"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#b89558,#8a6a35)')" class="epp-grad" style="background:linear-gradient(135deg,#b89558,#8a6a35)" title="Oro"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#2c5f9e,#1a3d6e)')" class="epp-grad" style="background:linear-gradient(135deg,#2c5f9e,#1a3d6e)" title="Azul"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#bf4637,#8b2d22)')" class="epp-grad" style="background:linear-gradient(135deg,#bf4637,#8b2d22)" title="Rojo"></div>
      <div onclick="edPropBg('linear-gradient(135deg,#7b4fa6,#4a2d6e)')" class="epp-grad" style="background:linear-gradient(135deg,#7b4fa6,#4a2d6e)" title="Violeta"></div>
      <div onclick="edPropBg('linear-gradient(160deg,#2b7d7a 0%,#1c1814 100%)')" class="epp-grad" style="background:linear-gradient(160deg,#2b7d7a,#1c1814)" title="Verde ‚Üí Negro"></div>
    </div>
    <!-- Gradiente personalizado -->
    <div class="epp-sub" style="margin-bottom:4px">Crear gradiente</div>
    <div style="display:flex;gap:5px;align-items:center">
      <input type="color" id="prpG1" value="#2b7d7a" style="width:28px;height:28px;border:none;border-radius:5px;cursor:pointer;padding:0" onchange="edBuildGrad()">
      <input type="color" id="prpG2" value="#f0ece4" style="width:28px;height:28px;border:none;border-radius:5px;cursor:pointer;padding:0" onchange="edBuildGrad()">
      <select id="prpGDir" onchange="edBuildGrad()" style="flex:1;background:#2a2420;color:white;border:1px solid rgba(255,255,255,.15);padding:3px;border-radius:5px;font-size:10px">
        <option value="135deg">‚Üò Diagonal</option><option value="to right">‚Üí Horizontal</option>
        <option value="to bottom">‚Üì Vertical</option><option value="45deg">‚Üó Diagonal 2</option>
        <option value="180deg">‚Üë Vertical inv.</option>
      </select>
      <div id="prpGPreview" style="width:36px;height:28px;border-radius:5px;border:1px solid rgba(255,255,255,.1);background:linear-gradient(135deg,#2b7d7a,#f0ece4);cursor:pointer" onclick="edBuildGrad(true)" title="Aplicar"></div>
    </div>
  </div>

  <!-- SECCI√ìN: COLOR TEXTO -->
  <div class="epp-sec">
    <div class="epp-lbl">‚úçÔ∏è Color de texto del bloque</div>
    <div style="display:flex;gap:6px;align-items:center;margin-bottom:8px">
      <input type="color" id="prpTxtPk" value="#1c1814" style="width:36px;height:36px;border:none;border-radius:6px;cursor:pointer;padding:0;flex-shrink:0" onchange="edPropTxtColor(this.value)">
      <input id="prpTxtHex" type="text" placeholder="#1c1814" class="epp-inp" style="flex:1" onchange="edPropTxtColor(this.value)">
    </div>
    <div style="display:flex;gap:4px;flex-wrap:wrap">
      <div onclick="edPropTxtColor('#1c1814')" class="epp-sw" style="background:#1c1814" title="Negro TCT"></div>
      <div onclick="edPropTxtColor('#ffffff')" class="epp-sw" style="background:#fff;border-color:#ccc" title="Blanco"></div>
      <div onclick="edPropTxtColor('#7a7168')" class="epp-sw" style="background:#7a7168" title="Gris TCT"></div>
      <div onclick="edPropTxtColor('#5a5248')" class="epp-sw" style="background:#5a5248" title="Gris oscuro"></div>
      <div onclick="edPropTxtColor('#2b7d7a')" class="epp-sw" style="background:#2b7d7a" title="Verde TCT"></div>
      <div onclick="edPropTxtColor('#3d9e9b')" class="epp-sw" style="background:#3d9e9b" title="Verde claro"></div>
      <div onclick="edPropTxtColor('#b89558')" class="epp-sw" style="background:#b89558" title="Oro TCT"></div>
      <div onclick="edPropTxtColor('#bf4637')" class="epp-sw" style="background:#bf4637" title="Rojo Puerta"></div>
      <div onclick="edPropTxtColor('#2c5f9e')" class="epp-sw" style="background:#2c5f9e" title="Azul Puerta"></div>
      <div onclick="edPropTxtColor('#7b4fa6')" class="epp-sw" style="background:#7b4fa6" title="Violeta"></div>
    </div>
  </div>

  <!-- SECCI√ìN: TIPOGRAF√çA DEL BLOQUE -->
  <div class="epp-sec">
    <div class="epp-lbl">üî§ Tipograf√≠a del bloque</div>
    <select onchange="if(this.value){edPropQ('fontFamily',this.value);this.value=''}" class="epp-inp" style="width:100%;margin-bottom:6px">
      <option value="">‚Äî Fuente del contenedor ‚Äî</option>
      <option value="'DM Sans',sans-serif">DM Sans (principal)</option>
      <option value="'Cormorant Garamond',serif">Cormorant Garamond (t√≠tulos)</option>
      <option value="Georgia,serif">Georgia</option>
      <option value="Arial,sans-serif">Arial</option>
      <option value="'Helvetica Neue',sans-serif">Helvetica Neue</option>
      <option value="'Times New Roman',serif">Times New Roman</option>
      <option value="'Courier New',monospace">Courier New</option>
    </select>
    <div class="epp-grid2">
      <div><div class="epp-sub">Tama√±o</div>
        <input id="prpFS" type="text" placeholder="16px" class="epp-inp" oninput="edPropLive('fontSize',this.value)"></div>
      <div><div class="epp-sub">Grosor</div>
        <select onchange="edPropQ('fontWeight',this.value)" class="epp-inp">
          <option value="">‚Äî</option>
          <option value="300">300 Fino</option><option value="400">400 Normal</option>
          <option value="500">500 Medio</option><option value="600">600 Semi</option>
          <option value="700">700 Bold</option><option value="800">800 Extra</option>
        </select></div>
      <div><div class="epp-sub">Interlineado</div>
        <input id="prpLH" type="text" placeholder="1.6" class="epp-inp" oninput="edPropLive('lineHeight',this.value)"></div>
      <div><div class="epp-sub">Alineaci√≥n</div>
        <select onchange="edPropQ('textAlign',this.value)" class="epp-inp">
          <option value="">‚Äî</option><option value="left">Izquierda</option>
          <option value="center">Centro</option><option value="right">Derecha</option>
          <option value="justify">Justificado</option>
        </select></div>
      <div><div class="epp-sub">Letra espac.</div>
        <input type="text" placeholder="0em" class="epp-inp" oninput="edPropLive('letterSpacing',this.value)"></div>
      <div><div class="epp-sub">Transformar</div>
        <select onchange="edPropQ('textTransform',this.value)" class="epp-inp">
          <option value="">‚Äî</option><option value="uppercase">MAY√öS</option>
          <option value="lowercase">min√∫s</option><option value="capitalize">Primer</option>
          <option value="none">Normal</option>
        </select></div>
    </div>
  </div>

  <!-- SECCI√ìN: BORDE -->
  <div class="epp-sec">
    <div class="epp-lbl">üî≤ Borde</div>
    <div style="display:flex;gap:5px;align-items:center;margin-bottom:7px">
      <input type="color" id="prpBdPk" value="#e4ddd3" style="width:30px;height:30px;border:none;border-radius:5px;cursor:pointer;padding:0;flex-shrink:0" onchange="edPropBorder(this.value)">
      <input id="prpBdHex" type="text" placeholder="#e4ddd3" class="epp-inp" style="flex:1" onchange="edPropBorder(this.value)">
      <button onclick="edPropQ('border','none')" class="epp-xbtn" title="Sin borde">‚àÖ</button>
    </div>
    <!-- Paleta borde -->
    <div style="display:flex;gap:3px;flex-wrap:wrap;margin-bottom:7px">
      <div onclick="edPropBorder('#e4ddd3')" class="epp-sw" style="background:#e4ddd3" title="Crema borde"></div>
      <div onclick="edPropBorder('#d4cfc6')" class="epp-sw" style="background:#d4cfc6" title="Arena"></div>
      <div onclick="edPropBorder('#2b7d7a')" class="epp-sw" style="background:#2b7d7a" title="Verde TCT"></div>
      <div onclick="edPropBorder('#3d9e9b')" class="epp-sw" style="background:#3d9e9b" title="Verde claro"></div>
      <div onclick="edPropBorder('#b89558')" class="epp-sw" style="background:#b89558" title="Oro TCT"></div>
      <div onclick="edPropBorder('#bf4637')" class="epp-sw" style="background:#bf4637" title="Rojo"></div>
      <div onclick="edPropBorder('#2c5f9e')" class="epp-sw" style="background:#2c5f9e" title="Azul"></div>
      <div onclick="edPropBorder('#1c1814')" class="epp-sw" style="background:#1c1814" title="Negro"></div>
    </div>
    <div class="epp-grid2">
      <div><div class="epp-sub">Grosor</div>
        <select id="prpBdW" onchange="edPropBorderW(this.value)" class="epp-inp">
          <option value="1px">1px</option><option value="2px">2px</option>
          <option value="3px">3px</option><option value="4px">4px</option>
          <option value="6px">6px</option>
        </select></div>
      <div><div class="epp-sub">Estilo</div>
        <select id="prpBdSt" onchange="edPropBorderSt(this.value)" class="epp-inp">
          <option value="solid">S√≥lido</option><option value="dashed">Guiones</option>
          <option value="dotted">Puntos</option><option value="double">Doble</option>
        </select></div>
      <div><div class="epp-sub">Radio (redondeado)</div>
        <input id="prpBR" type="text" placeholder="0px" class="epp-inp" oninput="edPropLive('borderRadius',this.value)"></div>
      <div style="display:flex;flex-direction:column;gap:3px;margin-top:14px">
        <button onclick="edPropQ('borderRadius','8px')" class="epp-chip">8px</button>
        <button onclick="edPropQ('borderRadius','16px')" class="epp-chip">16px</button>
        <button onclick="edPropQ('borderRadius','24px')" class="epp-chip">24px</button>
        <button onclick="edPropQ('borderRadius','50%')" class="epp-chip">50% ‚óè</button>
      </div>
    </div>
  </div>

  <!-- SECCI√ìN: SOMBRA -->
  <div class="epp-sec">
    <div class="epp-lbl">üåë Sombra</div>
    <div style="display:flex;flex-direction:column;gap:3px">
      <button onclick="edPropQ('boxShadow','none')" class="epp-rowbtn">Sin sombra</button>
      <button onclick="edPropQ('boxShadow','0 1px 4px rgba(0,0,0,.06)')" class="epp-rowbtn">Muy sutil</button>
      <button onclick="edPropQ('boxShadow','0 2px 10px rgba(0,0,0,.08)')" class="epp-rowbtn">Sutil</button>
      <button onclick="edPropQ('boxShadow','0 4px 20px rgba(0,0,0,.12)')" class="epp-rowbtn">Media</button>
      <button onclick="edPropQ('boxShadow','0 8px 32px rgba(0,0,0,.18)')" class="epp-rowbtn">Fuerte</button>
      <button onclick="edPropQ('boxShadow','0 16px 48px rgba(0,0,0,.28)')" class="epp-rowbtn">Muy fuerte</button>
      <button onclick="edPropQ('boxShadow','0 8px 32px rgba(43,125,122,.22)')" class="epp-rowbtn" style="color:#3d9e9b">‚ú¶ Sombra verde TCT</button>
      <button onclick="edPropQ('boxShadow','0 8px 32px rgba(184,149,88,.28)')" class="epp-rowbtn" style="color:#b89558">‚ú¶ Sombra oro TCT</button>
      <button onclick="edPropQ('boxShadow','0 8px 32px rgba(191,70,55,.2)')" class="epp-rowbtn" style="color:#bf4637">‚ú¶ Sombra roja</button>
      <button onclick="edPropQ('boxShadow','inset 0 0 40px rgba(0,0,0,.08)')" class="epp-rowbtn">Interna sutil</button>
    </div>
  </div>

  <!-- SECCI√ìN: MARGEN / POSICI√ìN -->
  <div class="epp-sec">
    <div class="epp-lbl">‚Üî Margen externo</div>
    <div class="epp-grid2">
      <div><div class="epp-sub">Top</div><input type="text" placeholder="0" class="epp-inp" oninput="edPropLive('marginTop',this.value)"></div>
      <div><div class="epp-sub">Bottom</div><input type="text" placeholder="0" class="epp-inp" oninput="edPropLive('marginBottom',this.value)"></div>
    </div>
    <div style="margin-top:5px;display:flex;gap:3px;flex-wrap:wrap">
      <button onclick="edPropQ('margin','0 auto')" class="epp-chip" style="color:#3d9e9b">‚Üî Centrar</button>
      <button onclick="edPropQ('marginBottom','24px')" class="epp-chip">‚Üì 24px</button>
      <button onclick="edPropQ('marginBottom','40px')" class="epp-chip">‚Üì 40px</button>
      <button onclick="edPropQ('marginBottom','60px')" class="epp-chip">‚Üì 60px</button>
      <button onclick="edPropQ('marginTop','40px')" class="epp-chip">‚Üë 40px</button>
    </div>
  </div>

  <!-- SECCI√ìN: DISPLAY / FLEX -->
  <div class="epp-sec">
    <div class="epp-lbl">‚äû Display / Layout</div>
    <div style="display:flex;gap:3px;flex-wrap:wrap">
      <button onclick="edPropQ('display','block')" class="epp-chip">Block</button>
      <button onclick="edPropQ('display','flex')" class="epp-chip">Flex</button>
      <button onclick="edPropQ('display','grid')" class="epp-chip">Grid</button>
      <button onclick="edPropQ('display','inline-block')" class="epp-chip">Inline-block</button>
      <button onclick="edPropQ('display','none')" class="epp-chip" style="color:#f08080">Ocultar</button>
    </div>
    <div style="margin-top:5px;display:flex;gap:3px;flex-wrap:wrap">
      <button onclick="edPropQ('alignItems','center')" class="epp-chip">Align: centro</button>
      <button onclick="edPropQ('justifyContent','center')" class="epp-chip">Justify: centro</button>
      <button onclick="edPropQ('flexDirection','column')" class="epp-chip">Col ‚Üì</button>
      <button onclick="edPropQ('flexWrap','wrap')" class="epp-chip">Wrap</button>
      <button onclick="edPropQ('gap','16px')" class="epp-chip">Gap 16px</button>
      <button onclick="edPropQ('gap','24px')" class="epp-chip">Gap 24px</button>
    </div>
  </div>

  <!-- SECCI√ìN: OPACIDAD / OVERFLOW -->
  <div class="epp-sec">
    <div class="epp-lbl">üîÜ Opacidad / Overflow</div>
    <div class="epp-grid2">
      <div><div class="epp-sub">Opacidad (0‚Äì1)</div>
        <input type="range" min="0" max="1" step="0.05" value="1" style="width:100%" oninput="edPropLive('opacity',this.value);this.nextElementSibling.textContent=this.value">
        <span style="font-size:10px;color:rgba(255,255,255,.4)">1</span></div>
      <div><div class="epp-sub">Overflow</div>
        <select onchange="edPropQ('overflow',this.value)" class="epp-inp">
          <option value="">‚Äî</option><option value="visible">Visible</option>
          <option value="hidden">Hidden</option><option value="auto">Auto</option>
          <option value="scroll">Scroll</option>
        </select></div>
    </div>
  </div>

  <!-- SECCI√ìN: CSS DIRECTO -->
  <div class="epp-sec">
    <div class="epp-lbl">üíª CSS directo (style="")</div>
    <textarea id="prpCss" rows="5" class="epp-css" placeholder="padding:32px; background:white; border:1px solid #ccc; ..."></textarea>
    <div style="display:flex;gap:5px;margin-top:5px">
      <button onclick="edPropCssApply()" class="epp-rowbtn" style="flex:1;color:#3d9e9b;border-color:rgba(61,158,155,.3)">‚ñ∂ Aplicar CSS</button>
      <button onclick="edPropCssRead()" class="epp-rowbtn" title="Leer estilos actuales del elemento">‚Üª Leer</button>
    </div>
  </div>

  <!-- ACCIONES R√ÅPIDAS -->
  <div class="epp-sec">
    <div class="epp-lbl">‚ö° Acciones</div>
    <div style="display:flex;flex-direction:column;gap:4px">
      <button onclick="edDuplicate()" class="epp-rowbtn">üìã Duplicar elemento</button>
      <button onclick="edMoveUp()" class="epp-rowbtn">‚¨ÜÔ∏è Mover arriba</button>
      <button onclick="edMoveDown()" class="epp-rowbtn">‚¨áÔ∏è Mover abajo</button>
      <button onclick="edAddLink()" class="epp-rowbtn">üîó A√±adir enlace</button>
      <button onclick="edChangeImage()" class="epp-rowbtn">üñºÔ∏è Cambiar imagen</button>
      <button onclick="edDeleteSelected()" class="epp-rowbtn" style="color:#f08080;border-color:rgba(191,70,55,.25)">üóëÔ∏è Eliminar elemento</button>
    </div>
  </div>
</div>

<!-- CONTEXT MENU -->
<div id="edCtxMenu" style="display:none;position:fixed;z-index:10001;background:#161210;border:1px solid rgba(255,255,255,.15);border-radius:10px;padding:6px;min-width:188px;box-shadow:0 8px 32px rgba(0,0,0,.6);font-family:'DM Sans',sans-serif">
  <div id="edCtxTitle" style="font-size:9px;color:rgba(255,255,255,.4);padding:4px 10px 7px;border-bottom:1px solid rgba(255,255,255,.1);margin-bottom:4px;text-transform:uppercase;letter-spacing:.07em">Elemento</div>
  <button onclick="edCtxAction('props')" class="edctx-btn">‚öôÔ∏è Propiedades del bloque</button>
  <button onclick="edCtxAction('editar')" class="edctx-btn">‚úèÔ∏è Editar textos internos</button>
  <button onclick="edCtxAction('link')" class="edctx-btn">üîó A√±adir enlace</button>
  <button onclick="edCtxAction('imagen')" class="edctx-btn">üñºÔ∏è Cambiar imagen</button>
  <button onclick="edCtxAction('duplicar')" class="edctx-btn">üìã Duplicar</button>
  <button onclick="edCtxAction('subir')" class="edctx-btn">‚¨ÜÔ∏è Mover arriba</button>
  <button onclick="edCtxAction('bajar')" class="edctx-btn">‚¨áÔ∏è Mover abajo</button>
  <div style="height:1px;background:rgba(255,255,255,.1);margin:4px 0"></div>
  <button onclick="edCtxAction('eliminar')" class="edctx-btn" style="color:#f08080">üóëÔ∏è Eliminar</button>
  <button onclick="edCtxClose()" class="edctx-btn" style="color:rgba(255,255,255,.35)">‚úï Cerrar men√∫</button>
</div>

<!-- EDITOR PANEL -->
<div id="edPanel" style="display:none;position:fixed;bottom:0;left:0;right:0;z-index:9998;background:#161210;padding:7px 12px;align-items:center;gap:6px;flex-wrap:wrap;box-shadow:0 -4px 24px rgba(0,0,0,.6);font-family:'DM Sans',sans-serif">
  <span style="font-size:12px;font-weight:700;color:#3d9e9b;white-space:nowrap">‚ú¶ Editor</span>
  <div class="eds"></div>
  <!-- Historial -->
  <button onclick="edUndo()" id="edUndoBtn" title="Deshacer Ctrl+Z" style="background:#252118;color:rgba(255,255,255,.45);border:1px solid rgba(255,255,255,.1);padding:5px 9px;border-radius:6px;font-size:13px;cursor:pointer;opacity:.4">‚Ü©</button>
  <button onclick="edRedo()" id="edRedoBtn" title="Rehacer Ctrl+Y" style="background:#252118;color:rgba(255,255,255,.45);border:1px solid rgba(255,255,255,.1);padding:5px 9px;border-radius:6px;font-size:13px;cursor:pointer;opacity:.3">‚Ü™</button>
  <div class="eds"></div>
  <!-- Modos -->
  <button onclick="edToggleMode()" id="edModeBtn" class="edpb teal">üñ± Seleccionar</button>
  <button onclick="edToggleText()" id="edTxtBtn" class="edpb teal">‚úèÔ∏è Editar textos</button>
  <div class="eds"></div>
  <!-- Formato r√°pido texto -->
  <div style="display:flex;gap:2px">
    <button onclick="edFmt('bold')" class="efb2" title="Negrita Ctrl+B"><b>B</b></button>
    <button onclick="edFmt('italic')" class="efb2" title="Cursiva Ctrl+I"><i style="font-style:italic">I</i></button>
    <button onclick="edFmt('underline')" class="efb2" title="Subrayado" style="text-decoration:underline">U</button>
    <button onclick="edFmt('strikeThrough')" class="efb2" title="Tachado" style="text-decoration:line-through">S</button>
  </div>
  <div style="display:flex;gap:2px">
    <button onclick="edFmt('justifyLeft')" class="efb2" title="Izquierda">‚¨õ‚óª</button>
    <button onclick="edFmt('justifyCenter')" class="efb2" title="Centro">‚óª‚¨õ‚óª</button>
    <button onclick="edFmt('justifyRight')" class="efb2" title="Derecha">‚óª‚¨õ</button>
  </div>
  <div style="display:flex;gap:2px">
    <button onclick="edFmtBlock('h1')" class="efb2 efb2s">H1</button>
    <button onclick="edFmtBlock('h2')" class="efb2 efb2s">H2</button>
    <button onclick="edFmtBlock('h3')" class="efb2 efb2s">H3</button>
    <button onclick="edFmt('insertUnorderedList')" class="efb2">‚Ä¢‚â°</button>
    <button onclick="edFmt('insertOrderedList')" class="efb2">1.‚â°</button>
  </div>
  <div class="eds"></div>
  <!-- Color texto + fuente + tama√±o -->
  <input type="color" id="edFontColor" value="#1c1814" title="Color texto" style="width:24px;height:24px;border:none;border-radius:4px;cursor:pointer;padding:0;flex-shrink:0" onchange="edApplyFontColor(this.value)">
  <select id="edFont" onchange="edApplyFont(this.value)" style="background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;cursor:pointer;max-width:100px">
    <option value="">Fuente</option>
    <option value="'DM Sans',sans-serif">DM Sans</option>
    <option value="'Cormorant Garamond',serif">Cormorant</option>
    <option value="Georgia,serif">Georgia</option>
    <option value="Arial,sans-serif">Arial</option>
    <option value="'Helvetica Neue',sans-serif">Helvetica</option>
    <option value="'Times New Roman',serif">Times NR</option>
    <option value="'Courier New',monospace">Courier</option>
  </select>
  <div style="display:flex;gap:2px;align-items:center">
    <select id="edFontSize" onchange="if(this.value){edApplyFontSize(this.value);this.value=''}" style="background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 3px;border-radius:5px;font-size:10px;cursor:pointer;max-width:58px">
      <option value="">px</option>
      <option value="11px">11</option><option value="12px">12</option><option value="13px">13</option>
      <option value="14px">14</option><option value="15px">15</option><option value="16px">16</option>
      <option value="18px">18</option><option value="20px">20</option><option value="22px">22</option>
      <option value="24px">24</option><option value="28px">28</option><option value="32px">32</option>
      <option value="36px">36</option><option value="40px">40</option><option value="48px">48</option>
      <option value="56px">56</option><option value="64px">64</option><option value="80px">80</option>
    </select>
    <input id="edFontSzFree" type="number" min="8" max="200" placeholder="px" title="Tama√±o libre ‚Äî Enter para aplicar" style="width:40px;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;outline:none" onkeydown="if(event.key==='Enter'&&this.value){edApplyFontSize(this.value+'px');this.value=''}">
  </div>
  <div class="eds"></div>
  <!-- BG / Borde -->
  <div style="display:flex;align-items:center;gap:2px">
    <span style="font-size:9px;color:rgba(255,255,255,.3)">BG</span>
    <input type="color" id="edBg" value="#f7f5f1" title="Fondo del bloque" style="width:24px;height:24px;border:none;border-radius:4px;cursor:pointer;padding:0" onchange="edApplyBg(this.value)">
    <button onclick="edApplyBg('transparent')" style="background:#252118;color:rgba(255,255,255,.35);border:1px solid rgba(255,255,255,.1);padding:1px 5px;border-radius:4px;font-size:11px;cursor:pointer">‚àÖ</button>
  </div>
  <div style="display:flex;align-items:center;gap:2px">
    <span style="font-size:9px;color:rgba(255,255,255,.3)">BD</span>
    <input type="color" id="edBorderColor" value="#e4ddd3" title="Borde" style="width:24px;height:24px;border:none;border-radius:4px;cursor:pointer;padding:0" onchange="edApplyBorder(this.value)">
    <button onclick="edApplyBorder('none')" style="background:#252118;color:rgba(255,255,255,.35);border:1px solid rgba(255,255,255,.1);padding:1px 5px;border-radius:4px;font-size:11px;cursor:pointer">‚àÖ</button>
  </div>
  <input type="color" id="edBtnColor" value="#2b7d7a" title="Color de bot√≥n" style="width:24px;height:24px;border:none;border-radius:4px;cursor:pointer;padding:0;flex-shrink:0" onchange="edApplyBtn(this.value)">
  <div class="eds"></div>
  <!-- W / H inline -->
  <div style="display:flex;gap:2px;align-items:center">
    <span style="font-size:9px;color:rgba(255,255,255,.3)">W</span>
    <input id="edWInp" type="text" placeholder="auto" title="Ancho: px / % / auto ‚Äî Enter" style="width:52px;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;outline:none" onkeydown="if(event.key==='Enter')edPropLive('width',this.value)">
    <span style="font-size:9px;color:rgba(255,255,255,.3)">H</span>
    <input id="edHInp" type="text" placeholder="auto" title="Alto: px / vh / auto ‚Äî Enter" style="width:52px;background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;outline:none" onkeydown="if(event.key==='Enter')edPropLive('height',this.value)">
  </div>
  <select id="edPadding" onchange="edApplyPadding(this.value)" style="background:#252118;color:white;border:1px solid rgba(255,255,255,.15);padding:3px 4px;border-radius:5px;font-size:10px;cursor:pointer;max-width:80px">
    <option value="">Padding</option>
    <option value="0">0</option><option value="8px">8px</option><option value="12px">12px</option>
    <option value="16px">16px</option><option value="24px">24px</option><option value="32px">32px</option>
    <option value="40px">40px</option><option value="48px">48px</option><option value="64px">64px</option><option value="80px">80px</option>
  </select>
  <div class="eds"></div>
  <!-- Props button -->
  <button onclick="edToggleProps()" id="edPropsBtn" style="background:#252118;color:#3d9e9b;border:1px solid rgba(61,158,155,.35);padding:5px 11px;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer;white-space:nowrap">‚öô Props ‚Üí</button>
  <div class="eds"></div>
  <!-- A√±adir bloques -->
  <span style="font-size:9px;color:rgba(255,255,255,.3);white-space:nowrap">A√ëADIR:</span>
  <button onclick="edInsert('texto')" class="edba">üìù Texto</button>
  <button onclick="edInsert('tarjeta')" class="edba">üÉè Tarjeta</button>
  <button onclick="edInsert('banner-ancho')" class="edba">üî≤ Banner</button>
  <button onclick="edInsert('banner-peque√±o')" class="edba">‚ñ≠ BannerS</button>
  <button onclick="edInsert('imagen-banner')" class="edba">üñº Img.banner</button>
  <button onclick="edInsert('imagen-peque√±a')" class="edba">üñº Img+txt</button>
  <button onclick="edInsert('boton')" class="edba">üîò Bot√≥n</button>
  <button onclick="edInsert('separador')" class="edba">‚Äî Sep.</button>
  <div class="eds"></div>
  <!-- Acciones -->
  <button onclick="edAddLink()" class="edba">üîó Link</button>
  <button onclick="edChangeImage()" class="edba">üñº Img.</button>
  <button onclick="edDuplicate()" class="edba">üìã Dupl.</button>
  <button onclick="edMoveUp()" class="edba">‚¨Ü</button>
  <button onclick="edMoveDown()" class="edba">‚¨á</button>
  <button onclick="edDeleteSelected()" style="background:#2a1412;color:#f08080;border:1px solid rgba(191,70,55,.2);padding:4px 9px;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;white-space:nowrap">üóë Eliminar</button>
  <div class="eds"></div>
  <!-- Guardar -->
  <button onclick="edSave()" style="background:#b89558;color:white;border:none;padding:7px 15px;border-radius:6px;font-size:12px;font-weight:700;cursor:pointer;white-space:nowrap">üíæ Guardar</button>
  <button onclick="edClose()" style="background:rgba(255,255,255,.06);color:rgba(255,255,255,.45);border:none;padding:6px 10px;border-radius:6px;font-size:12px;cursor:pointer">‚úï</button>
  <span id="edMsg" style="font-size:10px;color:#3d9e9b;margin-left:auto;white-space:nowrap;overflow:hidden;max-width:260px;text-overflow:ellipsis"></span>
</div>

<style>
/* ‚îÄ‚îÄ Editor v3 core ‚îÄ‚îÄ */
.eds{width:1px;height:20px;background:rgba(255,255,255,.1);flex-shrink:0}
.edpb{border:none;padding:6px 12px;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer;white-space:nowrap}
.edpb.teal{background:#2b7d7a;color:white}
.edba{background:#252118;color:rgba(255,255,255,.65);border:1px solid rgba(255,255,255,.1);padding:4px 8px;border-radius:5px;font-size:10px;font-weight:600;cursor:pointer;white-space:nowrap}
.edba:hover{background:#353028;color:white}
.efb2{background:#252118;color:rgba(255,255,255,.7);border:1px solid rgba(255,255,255,.1);padding:3px 7px;border-radius:5px;font-size:11px;cursor:pointer;min-width:24px;text-align:center}
.efb2:hover,.efb2:active{background:#2b7d7a;color:white;border-color:#2b7d7a}
.efb2s{font-size:9px;font-weight:700}
.edctx-btn{display:block;width:100%;background:none;border:none;color:rgba(255,255,255,.8);padding:7px 12px;text-align:left;font-size:12px;cursor:pointer;border-radius:6px}
.edctx-btn:hover{background:rgba(255,255,255,.07)}
.ed-selected-ring{outline:2px solid #3d9e9b !important;outline-offset:2px}
/* Floating format bar */
.efb{background:#252118;color:rgba(255,255,255,.8);border:1px solid rgba(255,255,255,.12);padding:3px 7px;border-radius:5px;font-size:11px;cursor:pointer;white-space:nowrap;min-width:24px;text-align:center}
.efb:hover{background:#3d9e9b;border-color:#3d9e9b;color:white}
.efbsep{width:1px;height:16px;background:rgba(255,255,255,.12);flex-shrink:0;margin:0 1px}
.efb-lbl{font-size:9px;font-weight:700}
/* Props panel */
.epp-sec{padding:11px 14px;border-bottom:1px solid rgba(255,255,255,.06)}
.epp-lbl{font-size:9px;font-weight:700;color:rgba(255,255,255,.45);text-transform:uppercase;letter-spacing:.08em;margin-bottom:7px}
.epp-sub{font-size:9px;color:rgba(255,255,255,.3);margin-bottom:3px;text-transform:uppercase;letter-spacing:.05em}
.epp-inp{background:#252118;color:white;border:1px solid rgba(255,255,255,.14);padding:5px 7px;border-radius:5px;font-size:11px;font-family:'DM Sans',sans-serif;outline:none;box-sizing:border-box}
.epp-inp:focus{border-color:#3d9e9b}
.epp-grid2{display:grid;grid-template-columns:1fr 1fr;gap:5px}
.epp-xbtn{background:#252118;color:rgba(255,255,255,.45);border:1px solid rgba(255,255,255,.1);padding:3px 7px;border-radius:5px;font-size:12px;cursor:pointer;flex-shrink:0}
.epp-xbtn:hover{background:#353028;color:white}
.epp-sw{width:22px;height:22px;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.1);transition:transform .12s;flex-shrink:0}
.epp-sw:hover{transform:scale(1.2);z-index:1}
.epp-grad{width:34px;height:22px;border-radius:4px;cursor:pointer;border:1px solid rgba(255,255,255,.1);transition:transform .12s}
.epp-grad:hover{transform:scale(1.1)}
.epp-chip{background:#252118;color:rgba(255,255,255,.6);border:1px solid rgba(255,255,255,.1);padding:3px 8px;border-radius:4px;font-size:10px;cursor:pointer;font-family:'DM Sans',sans-serif;white-space:nowrap}
.epp-chip:hover{background:#2b7d7a;color:white;border-color:#2b7d7a}
.epp-rowbtn{background:#252118;color:rgba(255,255,255,.65);border:1px solid rgba(255,255,255,.1);padding:6px 10px;border-radius:6px;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif;text-align:left;transition:background .12s;width:100%}
.epp-rowbtn:hover{background:#353028;color:white}
.epp-css{width:100%;background:#0a0806;color:#3d9e9b;border:1px solid rgba(255,255,255,.1);border-radius:5px;padding:7px;font-family:monospace;font-size:10px;resize:vertical;outline:none;box-sizing:border-box}
/* Page adjust when panel open */
body.ed-props-open #page-public{margin-right:268px;transition:margin .2s}
</style>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FRECUENCIA INTEGRAL ‚Äî Editor WYSIWYG v3 completo
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var _edOn=false,_edSelMode=false,_edSel=null,_edSelBtn=null,_edPropsOpen=false;
var _edHistory=[],_edFuture=[],_edMaxSnap=30;
var _edBW='1px',_edBS='solid';

// ‚îÄ‚îÄ Snapshot / Historial ‚îÄ‚îÄ
function edSnapshot(){
  var h=document.getElementById('page-public').innerHTML;
  if(_edHistory.length&&_edHistory[_edHistory.length-1]===h)return;
  _edHistory.push(h); if(_edHistory.length>_edMaxSnap)_edHistory.shift();
  _edFuture=[]; edSyncHistBtns();
}
function edUndo(){
  if(_edHistory.length<2){edMsg('‚ö†Ô∏è Nada que deshacer');return;}
  _edFuture.push(_edHistory.pop());
  document.getElementById('page-public').innerHTML=_edHistory[_edHistory.length-1];
  edMsg('‚Ü© Deshecho'); edSyncHistBtns();
}
function edRedo(){
  if(!_edFuture.length){edMsg('‚ö†Ô∏è Nada que rehacer');return;}
  var h=_edFuture.pop(); _edHistory.push(h);
  document.getElementById('page-public').innerHTML=h;
  edMsg('‚Ü™ Rehecho'); edSyncHistBtns();
}
function edSyncHistBtns(){
  var u=document.getElementById('edUndoBtn'),r=document.getElementById('edRedoBtn');
  if(u)u.style.opacity=_edHistory.length>1?'1':'0.3';
  if(r)r.style.opacity=_edFuture.length?'1':'0.3';
}

// ‚îÄ‚îÄ Keyboard shortcuts ‚îÄ‚îÄ
document.addEventListener('keydown',function(e){
  var panel=document.getElementById('edPanel');
  if(!panel||panel.style.display!=='flex')return;
  var cm=e.ctrlKey||e.metaKey;
  if(cm&&e.key==='z'&&!e.shiftKey){e.preventDefault();edUndo();}
  if(cm&&(e.key==='y'||(e.key==='z'&&e.shiftKey))){e.preventDefault();edRedo();}
  if(cm&&e.key==='b'&&_edOn){e.preventDefault();edFmt('bold');}
  if(cm&&e.key==='i'&&_edOn){e.preventDefault();edFmt('italic');}
  if(e.key==='Escape'){edCtxClose();edClearSel();edFmtBarHide();}
  if((e.key==='Delete'||e.key==='Backspace')&&_edSel&&!_edOn){e.preventDefault();edDeleteSelected();}
});

function edMsg(t){var m=document.getElementById('edMsg');if(m)m.textContent=t;}

// ‚îÄ‚îÄ Abrir / Cerrar ‚îÄ‚îÄ
function editorOpen(){
  var p=document.getElementById('edPanel');
  var open=p.style.display==='flex';
  p.style.display=open?'none':'flex';
  if(!open&&!_edHistory.length)edSnapshot();
  if(open){edCloseProps();edFmtBarHide();}
}
function edClose(){
  document.getElementById('edPanel').style.display='none';
  if(_edOn)edToggleText();
  edClearSel(); edCtxClose(); edCloseProps(); edFmtBarHide();
}

// ‚îÄ‚îÄ Props panel ‚îÄ‚îÄ
function edToggleProps(){
  _edPropsOpen=!_edPropsOpen;
  var pp=document.getElementById('edPropsPanel');
  var btn=document.getElementById('edPropsBtn');
  pp.style.display=_edPropsOpen?'block':'none';
  btn.style.background=_edPropsOpen?'#3d9e9b':'#252118';
  btn.style.color=_edPropsOpen?'white':'#3d9e9b';
  btn.textContent=_edPropsOpen?'‚öô Props ‚úï':'‚öô Props ‚Üí';
  document.body.classList.toggle('ed-props-open',_edPropsOpen);
  if(_edPropsOpen&&_edSel)edFillProps(_edSel);
}
function edCloseProps(){
  _edPropsOpen=false;
  var pp=document.getElementById('edPropsPanel');
  if(pp)pp.style.display='none';
  var btn=document.getElementById('edPropsBtn');
  if(btn){btn.style.background='#252118';btn.style.color='#3d9e9b';btn.textContent='‚öô Props ‚Üí';}
  document.body.classList.remove('ed-props-open');
}

// ‚îÄ‚îÄ Sincronizar panel de propiedades con elemento ‚îÄ‚îÄ
function edFillProps(el){
  if(!el)return;
  var s=el.style, cs=window.getComputedStyle(el);
  var tag=document.getElementById('edPropsTag');
  if(tag)tag.textContent='<'+el.tagName.toLowerCase()+(el.id?'#'+el.id:'')+'>';
  function si(id,v){var x=document.getElementById(id);if(x)x.value=v||'';}
  si('prpW',s.width);si('prpH',s.height);si('prpMW',s.maxWidth);si('prpMH',s.minHeight);
  si('prpPT',s.paddingTop);si('prpPB',s.paddingBottom);si('prpPL',s.paddingLeft);si('prpPR',s.paddingRight);
  si('prpFS',s.fontSize);si('prpLH',s.lineHeight);si('prpBR',s.borderRadius);
  // BG
  var bg=s.background||s.backgroundColor||cs.backgroundColor;
  var bgH=rgb2hex(bg);
  si('prpBgHex',bg.indexOf('gradient')>-1?bg:(bgH||bg));
  if(bgH)try{document.getElementById('prpBgPk').value=bgH;}catch(e){}
  // Text color
  var fc=s.color||cs.color; var fcH=rgb2hex(fc);
  si('prpTxtHex',fcH||fc);
  if(fcH)try{document.getElementById('prpTxtPk').value=fcH;}catch(e){}
  // Border
  var bc=s.borderColor||cs.borderColor; var bcH=rgb2hex(bc);
  si('prpBdHex',bcH||'');
  if(bcH)try{document.getElementById('prpBdPk').value=bcH;}catch(e){}
  // CSS
  si('prpCss',el.getAttribute('style')||'');
}

function rgb2hex(c){
  if(!c||c==='transparent')return'';
  if(c.startsWith('#'))return c;
  if(c.indexOf('gradient')>-1)return'';
  var m=c.match(/[\d.]+/g);
  if(!m||m.length<3)return'';
  if(c.indexOf('rgba')>-1&&parseFloat(m[3])===0)return'';
  return'#'+[m[0],m[1],m[2]].map(function(x){return('0'+parseInt(x).toString(16)).slice(-2);}).join('');
}

// ‚îÄ‚îÄ Aplicar propiedad CSS en vivo ‚îÄ‚îÄ
function edPropLive(prop,val){
  if(!_edSel)return;
  _edSel.style[prop]=val;
  // sync W/H toolbar inputs
  var wi=document.getElementById('edWInp'),hi=document.getElementById('edHInp');
  if(prop==='width'&&wi)wi.value=val;
  if(prop==='height'&&hi)hi.value=val;
  edSnapshot();
}
function edPropQ(prop,val){edPropLive(prop,val);edMsg('‚úÖ '+prop+': '+val);}

// ‚îÄ‚îÄ Fondo ‚îÄ‚îÄ
function edPropBg(val){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un bloque primero');return;}
  _edSel.style.background=val;
  var h=rgb2hex(val);
  if(h)try{document.getElementById('prpBgPk').value=h;}catch(e){}
  var hx=document.getElementById('prpBgHex'); if(hx)hx.value=val;
  if(h&&document.getElementById('edBg'))try{document.getElementById('edBg').value=h;}catch(e){}
  edMsg('üé® Fondo: '+val.substring(0,40)); edSnapshot();
}
function edPropBgInput(v){
  if(!_edSel)return;
  if(v.length===7&&v[0]==='#'){edPropBg(v);}
  else if(v==='transparent'||v.indexOf('gradient')>-1){edPropBg(v);}
}
function edBuildGrad(){
  var c1=document.getElementById('prpG1').value;
  var c2=document.getElementById('prpG2').value;
  var dir=document.getElementById('prpGDir').value;
  var g='linear-gradient('+dir+','+c1+','+c2+')';
  var prev=document.getElementById('prpGPreview');
  if(prev)prev.style.background=g;
}
// ‚îÄ‚îÄ Color texto del bloque ‚îÄ‚îÄ
function edPropTxtColor(val){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un bloque');return;}
  _edSel.style.setProperty('color',val,'important');
  _edSel.querySelectorAll('*').forEach(function(n){n.style.color=val;});
  var h=rgb2hex(val);
  if(h)try{document.getElementById('prpTxtPk').value=h;}catch(e){}
  var tx=document.getElementById('prpTxtHex'); if(tx)tx.value=val;
  if(h&&document.getElementById('edFontColor'))try{document.getElementById('edFontColor').value=h;}catch(e){}
  edMsg('‚úçÔ∏è Color texto: '+val); edSnapshot();
}
// ‚îÄ‚îÄ Borde ‚îÄ‚îÄ
function edPropBorder(val){
  if(!_edSel)return;
  if(val==='none'){_edSel.style.border='none';}
  else{_edSel.style.border=_edBW+' '+_edBS+' '+val;}
  var h=rgb2hex(val);
  if(h){try{document.getElementById('prpBdPk').value=h;}catch(e){}
    var bx=document.getElementById('prpBdHex');if(bx)bx.value=val;}
  if(h&&document.getElementById('edBorderColor'))try{document.getElementById('edBorderColor').value=h;}catch(e){}
  edMsg('üî≤ Borde: '+val); edSnapshot();
}
function edPropBorderW(w){_edBW=w;if(_edSel&&_edSel.style.borderColor){_edSel.style.borderWidth=w;edSnapshot();}}
function edPropBorderSt(st){_edBS=st;if(_edSel&&_edSel.style.borderColor){_edSel.style.borderStyle=st;edSnapshot();}}
function edPropCssApply(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  var v=document.getElementById('prpCss').value;
  _edSel.setAttribute('style',v);
  edMsg('üíª CSS aplicado'); edSnapshot();
}
function edPropCssRead(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  var css=document.getElementById('prpCss');
  if(css)css.value=_edSel.getAttribute('style')||'';
  edMsg('‚Üª CSS le√≠do');
}

// ‚îÄ‚îÄ Floating format bar ‚îÄ‚îÄ
function edFmtBarHide(){var b=document.getElementById('edFmtBar');if(b)b.style.display='none';}
document.addEventListener('mouseup',function(e){
  if(!_edOn)return;
  if(e.target.closest('#edFmtBar')||e.target.closest('#edPanel'))return;
  setTimeout(function(){
    var sel=window.getSelection();
    if(!sel||!sel.rangeCount||!sel.toString().trim()){edFmtBarHide();return;}
    var rect=sel.getRangeAt(0).getBoundingClientRect();
    var bar=document.getElementById('edFmtBar');
    var bx=rect.left+rect.width/2-300;
    bar.style.left=Math.max(6,Math.min(bx,window.innerWidth-610))+'px';
    bar.style.top=(rect.top-58+window.scrollY)+'px';
    bar.style.display='flex';
    // sync color picker with selection
    try{
      var anc=sel.anchorNode;
      var el2=anc.nodeType===3?anc.parentElement:anc;
      var fc=window.getComputedStyle(el2).color;
      var fh=rgb2hex(fc);
      if(fh)document.getElementById('efbTxtColor').value=fh;
    }catch(ex){}
  },12);
});
document.addEventListener('mousedown',function(e){if(!e.target.closest('#edFmtBar'))edFmtBarHide();});

// ‚îÄ‚îÄ execCommand format ‚îÄ‚îÄ
function edFmt(cmd){
  if(_edOn){document.execCommand(cmd,false,null);edSnapshot();}
  else if(_edSel){
    if(cmd==='justifyLeft'){_edSel.style.textAlign='left';edSnapshot();}
    else if(cmd==='justifyCenter'){_edSel.style.textAlign='center';edSnapshot();}
    else if(cmd==='justifyRight'){_edSel.style.textAlign='right';edSnapshot();}
    else edMsg('‚ö†Ô∏è Activa "Editar textos" para formato de texto');
  }
}
function edFmtBlock(tag){
  if(!_edOn){edMsg('‚ö†Ô∏è Activa "Editar textos" primero');return;}
  document.execCommand('formatBlock',false,tag);
  edSnapshot(); edMsg('‚úÖ '+tag.toUpperCase()+' aplicado');
}
function edFmtHighlight(color){
  if(!_edOn){return;}
  var sel=window.getSelection();
  if(!sel||!sel.rangeCount||!sel.toString())return;
  try{
    var range=sel.getRangeAt(0);
    var span=document.createElement('span');
    span.style.backgroundColor=color;
    span.appendChild(range.extractContents());
    range.insertNode(span); sel.removeAllRanges();
    edMsg('‚ñì Resaltado aplicado'); edSnapshot();
  }catch(e){}
}

// ‚îÄ‚îÄ Selecci√≥n visual ‚îÄ‚îÄ
function edClearSel(){if(_edSel){_edSel.classList.remove('ed-selected-ring');_edSel=null;}_edSelBtn=null;}
function edSelectEl(el){
  edClearSel(); _edSel=el; el.classList.add('ed-selected-ring');
  var lbl=el.id?'#'+el.id:el.tagName.toLowerCase();
  var txt=el.textContent.trim().substring(0,28);
  edMsg('‚úÖ '+lbl+(txt?': "'+txt+'"':'')+' ‚Äî modifica en la barra o en ‚öô Props');
  // Sync toolbar
  try{
    var cs=window.getComputedStyle(el);
    var bg=el.style.background||el.style.backgroundColor||cs.backgroundColor;
    var bgH=rgb2hex(bg);
    if(bgH)try{document.getElementById('edBg').value=bgH;}catch(e2){}
    var fc=el.style.color||cs.color; var fcH=rgb2hex(fc);
    if(fcH)try{document.getElementById('edFontColor').value=fcH;}catch(e2){}
    var wi=document.getElementById('edWInp'); if(wi)wi.value=el.style.width||'';
    var hi=document.getElementById('edHInp'); if(hi)hi.value=el.style.height||'';
  }catch(e){}
  if(_edPropsOpen)edFillProps(el);
}

// ‚îÄ‚îÄ Modo selecci√≥n ‚îÄ‚îÄ
function edToggleMode(){
  _edSelMode=!_edSelMode;
  var b=document.getElementById('edModeBtn');
  b.style.background=_edSelMode?'#b89558':'#2b7d7a';
  b.textContent=_edSelMode?'üéØ Activo':'üñ± Seleccionar';
  edMsg(_edSelMode?'üéØ Clic en cualquier elemento para seleccionar':'');
  if(!_edSelMode)edClearSel();
}

// ‚îÄ‚îÄ Modo edici√≥n textos ‚îÄ‚îÄ
function edToggleText(){
  _edOn=!_edOn;
  var b=document.getElementById('edTxtBtn');
  if(_edOn){
    edSnapshot();
    var BLOCK=['DIV','P','H1','H2','H3','H4','H5','H6','SECTION','ARTICLE','UL','OL','LI','BLOCKQUOTE','PRE','TABLE','TD','TH'];
    var SKIP=['SCRIPT','STYLE','INPUT','SELECT','TEXTAREA','IFRAME','BUTTON','SVG','CANVAS','VIDEO','AUDIO'];
    document.querySelectorAll('#page-public *').forEach(function(el){
      if(el.closest('#edPanel')||el.closest('nav')||el.closest('.modal-overlay'))return;
      if(SKIP.indexOf(el.tagName)>-1||el.contentEditable==='true')return;
      var txt=el.textContent.trim();
      if(!txt||txt.length>800)return;
      var bk=0,dt=false;
      el.childNodes.forEach(function(n){
        if(n.nodeType===3&&n.textContent.trim())dt=true;
        if(n.nodeType===1&&BLOCK.indexOf(n.tagName)>-1)bk++;
      });
      if(bk===0||(dt&&bk<=1)){
        el.contentEditable='true';
        el.setAttribute('data-edol',el.style.outline||'');
        el.setAttribute('data-edcu',el.style.cursor||'');
        el.style.setProperty('outline','1px dashed rgba(43,125,122,.5)','important');
        el.style.cursor='text';
      }
    });
    b.textContent='üîí Fin edici√≥n'; b.style.background='#bf4637';
    edMsg('‚úèÔ∏è Textos activos ‚Äî selecciona texto para barra flotante de formato');
  }else{
    document.querySelectorAll('[contenteditable="true"]').forEach(function(el){
      el.removeAttribute('contenteditable');
      el.style.outline=el.getAttribute('data-edol')||'';
      el.style.cursor=el.getAttribute('data-edcu')||'';
      el.removeAttribute('data-edol'); el.removeAttribute('data-edcu');
    });
    edFmtBarHide();
    b.textContent='‚úèÔ∏è Editar textos'; b.style.background='#2b7d7a';
    edMsg(''); edSnapshot();
  }
}

// ‚îÄ‚îÄ Color texto ‚îÄ‚îÄ
function edApplyFontColor(v){
  var sel=window.getSelection();
  if(_edOn&&sel&&sel.rangeCount>0&&sel.toString().length>0){
    try{
      var range=sel.getRangeAt(0);
      var frag=range.extractContents();
      frag.querySelectorAll('*').forEach(function(n){n.style.color=v;});
      var sp=document.createElement('span');
      sp.style.setProperty('color',v,'important');
      sp.appendChild(frag); range.insertNode(sp); sel.removeAllRanges();
      edMsg('üé® Color texto aplicado'); edSnapshot();
    }catch(e){edMsg('‚ö†Ô∏è '+e.message);}
  }else if(_edSel){
    _edSel.style.setProperty('color',v,'important');
    _edSel.querySelectorAll('*').forEach(function(n){n.style.color=v;});
    edMsg('üé® Color aplicado al elemento'); edSnapshot();
  }else edMsg('‚ö†Ô∏è Activa edici√≥n y selecciona texto, o selecciona elemento');
}

// ‚îÄ‚îÄ Tipograf√≠a bloque ‚îÄ‚îÄ
function edApplyFont(v){
  if(!v)return;
  if(_edSel){_edSel.style.fontFamily=v;edMsg('üî§ Tipograf√≠a aplicada');edSnapshot();}
  else edMsg('‚ö†Ô∏è Selecciona un elemento');
  document.getElementById('edFont').value='';
}
function edApplyFontInline(v){
  if(!v||!_edOn)return;
  var sel=window.getSelection();
  if(sel&&sel.rangeCount>0&&sel.toString()){
    try{
      var range=sel.getRangeAt(0);
      var sp=document.createElement('span');
      sp.style.fontFamily=v; sp.appendChild(range.extractContents());
      range.insertNode(sp); sel.removeAllRanges();
      edMsg('üî§ Fuente inline aplicada'); edSnapshot();
    }catch(e){}
  }else if(_edSel){edApplyFont(v);}
}

// ‚îÄ‚îÄ Tama√±o texto ‚îÄ‚îÄ
function edApplyFontSize(v){
  if(!v)return;
  var sel=window.getSelection();
  if(_edOn&&sel&&sel.rangeCount>0&&sel.toString()){
    try{
      var range=sel.getRangeAt(0);
      var frag=range.extractContents();
      var sp=document.createElement('span');
      sp.style.fontSize=v; sp.appendChild(frag);
      range.insertNode(sp); sel.removeAllRanges();
      edMsg('üìê Tama√±o '+v); edSnapshot(); return;
    }catch(e){}
  }
  if(_edSel){_edSel.style.fontSize=v;edMsg('üìê Tama√±o '+v+' aplicado al bloque');edSnapshot();}
  else edMsg('‚ö†Ô∏è Selecciona texto o elemento');
  var fs=document.getElementById('edFontSize'); if(fs)fs.value='';
}

// ‚îÄ‚îÄ Fondo / Borde / Bot√≥n / Padding ‚îÄ‚îÄ
function edApplyBg(v){
  if(_edSel){_edSel.style.background=v;edMsg('üé® Fondo: '+v);edSnapshot();}
  else edMsg('‚ö†Ô∏è Selecciona un bloque primero');
}
function edApplyBorder(v){
  if(_edSel){
    if(v==='none')_edSel.style.border='none';
    else _edSel.style.border=_edBW+' '+_edBS+' '+v;
    edMsg('üî≤ Borde: '+v); edSnapshot();
  }else edMsg('‚ö†Ô∏è Selecciona un elemento');
}
function edApplyBtn(v){
  var t=_edSelBtn||_edSel;
  if(t){
    var btn=t.tagName==='BUTTON'?t:t.querySelector('button, a[href]');
    if(btn){
      btn.style.background=v;
      var r=parseInt(v.slice(1,3),16),g=parseInt(v.slice(3,5),16),b=parseInt(v.slice(5,7),16);
      btn.style.color=(r*299+g*587+b*114)/1000>128?'#1c1814':'white';
      edMsg('üîò Bot√≥n: '+v); edSnapshot();
    }else edMsg('‚ö†Ô∏è No hay bot√≥n en este elemento');
  }else edMsg('‚ö†Ô∏è Selecciona un elemento con bot√≥n');
}
function edApplyPadding(v){
  if(!v)return;
  if(_edSel){_edSel.style.padding=v;edMsg('üìê Padding: '+v);edSnapshot();}
  else edMsg('‚ö†Ô∏è Selecciona un elemento');
  document.getElementById('edPadding').value='';
}

// ‚îÄ‚îÄ Enlace ‚îÄ‚îÄ
function edAddLink(){
  var url=prompt('URL del enlace (ej: https://frecuenciaintegral.com):');
  if(!url)return;
  var sel=window.getSelection();
  if(_edOn&&sel&&sel.rangeCount>0&&sel.toString()){
    try{
      var range=sel.getRangeAt(0);
      var a=document.createElement('a');
      a.href=url; a.target='_blank'; a.style.color='inherit'; a.style.textDecoration='underline';
      a.appendChild(range.extractContents()); range.insertNode(a); sel.removeAllRanges();
      edMsg('üîó Enlace a√±adido'); edSnapshot(); return;
    }catch(e){}
  }
  if(_edSel){
    _edSel.style.cursor='pointer';
    _edSel.setAttribute('onclick',"window.open('"+url+"','_blank')");
    edMsg('üîó Enlace a√±adido al elemento'); edSnapshot();
  }else edMsg('‚ö†Ô∏è Selecciona texto o un elemento');
}

// ‚îÄ‚îÄ Cambiar imagen ‚îÄ‚îÄ
function edChangeImage(){
  var url=prompt('URL de la nueva imagen:');
  if(!url)return;
  var t=_edSel||document.body;
  var img=t.tagName==='IMG'?t:t.querySelector('img');
  if(img){img.src=url;edMsg('üñºÔ∏è Imagen cambiada');edSnapshot();}
  else if(_edSel){
    var ni=document.createElement('img');
    ni.src=url; ni.style.cssText='width:100%;border-radius:12px;margin-top:12px;object-fit:cover;max-height:400px';
    _edSel.appendChild(ni); edMsg('üñºÔ∏è Imagen a√±adida'); edSnapshot();
  }else edMsg('‚ö†Ô∏è Selecciona un elemento primero');
}

// ‚îÄ‚îÄ Duplicar / Mover / Eliminar ‚îÄ‚îÄ
function edDuplicate(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  edSnapshot();
  var cl=_edSel.cloneNode(true); cl.classList.remove('ed-selected-ring');
  _edSel.parentNode.insertBefore(cl,_edSel.nextSibling);
  edSelectEl(cl); edMsg('üìã Duplicado'); edSnapshot();
}
function edMoveUp(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  var prev=_edSel.previousElementSibling;
  if(prev){edSnapshot();_edSel.parentNode.insertBefore(_edSel,prev);edMsg('‚¨ÜÔ∏è Movido arriba');}
  else edMsg('‚ö†Ô∏è Ya est√° al principio');
}
function edMoveDown(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  var next=_edSel.nextElementSibling;
  if(next){edSnapshot();_edSel.parentNode.insertBefore(next,_edSel);edMsg('‚¨áÔ∏è Movido abajo');}
  else edMsg('‚ö†Ô∏è Ya est√° al final');
}
function edDeleteSelected(){
  if(!_edSel){edMsg('‚ö†Ô∏è Selecciona un elemento');return;}
  if(!confirm('¬øEliminar este elemento? (deshacer con ‚Ü©)'))return;
  edSnapshot(); _edSel.remove(); _edSel=null;
  edMsg('üóëÔ∏è Eliminado ‚Äî ‚Ü© para deshacer'); edSnapshot();
}

// ‚îÄ‚îÄ Men√∫ contextual ‚îÄ‚îÄ
function edCtxClose(){document.getElementById('edCtxMenu').style.display='none';}
function edCtxAction(a){
  edCtxClose();
  if(a==='props'){if(!_edPropsOpen)edToggleProps();else edFillProps(_edSel);}
  else if(a==='editar')edToggleText();
  else if(a==='link')edAddLink();
  else if(a==='imagen')edChangeImage();
  else if(a==='duplicar')edDuplicate();
  else if(a==='subir')edMoveUp();
  else if(a==='bajar')edMoveDown();
  else if(a==='eliminar')edDeleteSelected();
}
document.addEventListener('contextmenu',function(e){
  if(document.getElementById('edPanel').style.display!=='flex')return;
  if(e.target.closest('#edPanel')||e.target.closest('#edCtxMenu'))return;
  e.preventDefault();
  var el=e.target.closest('div,section,article,p,h1,h2,h3,img,button,span');
  if(el&&!el.closest('nav')){
    edSelectEl(el);
    var ctx=document.getElementById('edCtxMenu');
    document.getElementById('edCtxTitle').textContent=el.tagName.toLowerCase()+(el.id?'#'+el.id:'');
    ctx.style.display='block';
    ctx.style.left=Math.min(e.clientX,window.innerWidth-200)+'px';
    ctx.style.top=Math.min(e.clientY,window.innerHeight-290)+'px';
  }
});
document.addEventListener('click',function(e){
  if(e.target.closest('#edCtxMenu'))return;
  edCtxClose();
  var panel=document.getElementById('edPanel');
  if(!panel||panel.style.display!=='flex')return;
  if(e.target.closest('#edPanel')||e.target.closest('#edPropsPanel'))return;
  if(_edOn)return;
  if(_edSelMode){
    var el2=e.target.closest('div[style],section,article,p,h1,h2,h3,h4,img,button,span[style]');
    if(el2&&!el2.closest('nav')){e.stopPropagation();edSelectEl(el2);}
    return;
  }
  var btn=e.target.closest('button');
  if(btn&&!btn.closest('#edPanel')){_edSelBtn=btn;edSelectEl(btn);return;}
  var sec=e.target.closest('[id],[style*="border-radius"],section');
  if(sec&&!sec.closest('#edPanel')&&!sec.closest('nav')&&sec!==document.documentElement&&sec!==document.body)edSelectEl(sec);
});

// ‚îÄ‚îÄ Insertar bloques ‚îÄ‚îÄ
function edInsert(tipo){
  edSnapshot();
  var el,S="font-family:'DM Sans',sans-serif",CG="font-family:'Cormorant Garamond',serif";
  if(tipo==='texto'){
    el=document.createElement('div');
    el.style.cssText='padding:60px 40px;max-width:800px;margin:0 auto;text-align:center';
    el.innerHTML='<h2 style="'+CG+';font-size:36px;font-weight:300;color:#1c1814;margin-bottom:16px">Nuevo t√≠tulo</h2><p style="font-size:15px;color:#7a7168;line-height:1.75;max-width:600px;margin:0 auto">Escribe aqu√≠ el contenido del bloque.</p>';
  }else if(tipo==='tarjeta'){
    var grid=(_edSel&&_edSel.querySelector('[style*="grid"]'))||document.querySelector('#pilares [style*="grid"]');
    if(!grid){edMsg('‚ö†Ô∏è Selecciona primero una secci√≥n con tarjetas');return;}
    el=document.createElement('div');
    el.style.cssText='background:white;border-radius:20px;padding:32px;border:1px solid #d9d2c8';
    el.innerHTML='<div style="font-size:32px;margin-bottom:16px">‚ú®</div><div style="'+CG+';font-size:24px;color:#1c1814;margin-bottom:10px">Nueva Tarjeta</div><div style="font-size:13px;color:#5a5248;line-height:1.75">Descripci√≥n de la tarjeta.</div>';
    grid.appendChild(el);edSelectEl(el);edMsg('‚úÖ Tarjeta a√±adida');edSnapshot();return;
  }else if(tipo==='banner-ancho'){
    el=document.createElement('div');
    el.style.cssText='width:100%;padding:80px 40px;background:linear-gradient(135deg,#2b7d7a,#1c5a58);text-align:center';
    el.innerHTML='<h2 style="'+CG+';font-size:clamp(32px,5vw,56px);font-weight:300;color:white;margin-bottom:16px">Banner Principal</h2><p style="font-size:16px;color:rgba(255,255,255,.8);max-width:600px;margin:0 auto 32px;line-height:1.7">Texto del banner.</p><button style="background:white;color:#2b7d7a;border:none;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;'+S+'">Llamada a la acci√≥n</button>';
  }else if(tipo==='banner-peque√±o'){
    el=document.createElement('div');
    el.style.cssText='max-width:900px;margin:40px auto;padding:40px 48px;background:#f0ece4;border-radius:20px;border:1px solid #d9d2c8;display:flex;align-items:center;gap:32px;flex-wrap:wrap';
    el.innerHTML='<div style="flex:1;min-width:200px"><div style="font-size:11px;font-weight:700;color:#7a7168;text-transform:uppercase;letter-spacing:.1em;margin-bottom:8px">Etiqueta</div><h3 style="'+CG+';font-size:28px;font-weight:300;color:#1c1814;margin-bottom:8px">T√≠tulo</h3><p style="font-size:14px;color:#7a7168;line-height:1.7">Descripci√≥n del contenido.</p></div><button style="background:#2b7d7a;color:white;border:none;padding:12px 28px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;'+S+';flex-shrink:0">Acci√≥n ‚Üí</button>';
  }else if(tipo==='imagen-banner'){
    var ur=prompt('URL de la imagen:')||'https://via.placeholder.com/1400x500/f0ece4/7a7168?text=Banner';
    el=document.createElement('div');
    el.style.cssText='width:100%;height:450px;overflow:hidden;position:relative';
    el.innerHTML='<img src="'+ur+'" style="width:100%;height:100%;object-fit:cover"><div style="position:absolute;inset:0;background:rgba(28,24,20,.4);display:flex;align-items:center;justify-content:center;text-align:center;padding:40px"><div><h2 style="'+CG+';font-size:clamp(32px,5vw,60px);font-weight:300;color:white;margin-bottom:16px">T√≠tulo</h2><p style="font-size:16px;color:rgba(255,255,255,.85);max-width:500px;margin:0 auto">Subt√≠tulo o descripci√≥n</p></div></div>';
  }else if(tipo==='imagen-peque√±a'){
    var ur2=prompt('URL de la imagen:')||'https://via.placeholder.com/600x400/f0ece4/7a7168?text=Imagen';
    el=document.createElement('div');
    el.style.cssText='max-width:1000px;margin:40px auto;display:grid;grid-template-columns:1fr 1fr;gap:48px;align-items:center;padding:0 32px';
    el.innerHTML='<img src="'+ur2+'" style="width:100%;border-radius:16px;object-fit:cover;height:320px"><div><h3 style="'+CG+';font-size:28px;font-weight:300;color:#1c1814;margin-bottom:12px">T√≠tulo</h3><p style="font-size:14px;color:#7a7168;line-height:1.75">Descripci√≥n.</p></div>';
  }else if(tipo==='boton'){
    el=document.createElement('div');
    el.style.cssText='text-align:center;padding:24px';
    var hr=prompt('URL del enlace (o vac√≠o):')||'#';
    el.innerHTML='<a href="'+hr+'" target="_blank" style="display:inline-block;background:#2b7d7a;color:white;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;'+S+';text-decoration:none">Nuevo Bot√≥n</a>';
  }else if(tipo==='separador'){
    el=document.createElement('div');
    el.style.cssText='max-width:600px;margin:40px auto;display:flex;align-items:center;gap:20px;padding:0 32px';
    el.innerHTML='<div style="flex:1;height:1px;background:#e4ddd3"></div><span style="font-size:12px;color:#b8ad9e;font-weight:600;letter-spacing:.1em">‚Ä¢</span><div style="flex:1;height:1px;background:#e4ddd3"></div>';
  }
  if(el){
    var anchor=_edSel?_edSel:(document.getElementById('joyas')||document.getElementById('pilares'));
    var page=document.getElementById('page-public');
    if(anchor&&anchor.parentNode)anchor.parentNode.insertBefore(el,anchor.nextSibling);
    else page.appendChild(el);
    el.scrollIntoView({behavior:'smooth',block:'center'});
    edSelectEl(el);
    edMsg('‚úÖ Bloque a√±adido ‚Äî activa "Editar textos" para modificarlo');
    edSnapshot();
  }
}

// ‚îÄ‚îÄ Guardar ‚îÄ‚îÄ
function edSave(){
  if(_edOn)edToggleText();
  edClearSel(); edCtxClose(); edCloseProps();
  document.querySelectorAll('[contenteditable]').forEach(function(el){
    el.removeAttribute('contenteditable');el.style.outline='';el.style.cursor='';
  });
  var openBtn=document.getElementById('edOpenBtn');
  var panel=document.getElementById('edPanel');
  if(openBtn)openBtn.style.display='none';
  panel.style.display='none';
  setTimeout(function(){
    var blob=new Blob(['<!DOCTYPE html>'+document.documentElement.outerHTML],{type:'text/html'});
    var a=document.createElement('a');
    a.href=URL.createObjectURL(blob);
    a.download='frecuencia-integral-editada.html';
    document.body.appendChild(a);a.click();document.body.removeChild(a);
    if(openBtn)openBtn.style.display='';
    toast('‚úÖ Guardado ‚Äî renombra a index.html y sube a Vercel');
  },200);
}
</script></body></html>
